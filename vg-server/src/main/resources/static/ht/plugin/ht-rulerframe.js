!function(x,D){"use strict";var R="position",l="absolute",J="relative",h="px",Z="left",I="right",V="top",M="bottom",m="display",z="none",S="block",d=ht.Default,w=d.getInternal(),W=Math.floor,f=Math.ceil,F=Math.PI,Y=null,u=x.parseInt,G=function(e){return e.getContext("2d")},B=function(){return document},e=function(a){return B().createElement(a)},L=function(){return e("canvas")},N=function(g,W,U){g.style.setProperty(W,U,Y)},E=function(o,p,A){d.def(ht.widget[o],p,A)},H=function(w,W){w.appendChild(W)},i=function(R,V){R.removeChild(V)},n=d.eventListenerOptionsFalse,$=(d.eventListenerOptionsTrue,function(S,G,c,o){S.addEventListener(G,c,o?n:n)}),O=function(w,k,O,g){w.removeEventListener(k,O,g?n:n)};ht.widget.RulerFrame=function(z){var e=this,a=e._view=w.createView(null,e),d=e.$1k=L(),c=e.$2k=L(),F=e.$3k=L(),B=e.$4k=L();e._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},e._topRulerConfig={visible:!0},e._rightRulerConfig={visible:!1},e._bottomRulerConfig={visible:!1},e._leftRulerConfig={visible:!0},H(a,d),H(a,F),H(a,c),H(a,B),N(a,R,J),N(a,"box-sizing","border-box"),N(a,"-moz-box-sizing","border-box"),N(d,R,l),N(c,R,l),N(F,R,l),N(B,R,l),e.$14k=function(){e.$13k=1,e.iv()},e.$15k=function(T){if(e._topRulerConfig.guideVisible||e._rightRulerConfig.guideVisible||e._bottomRulerConfig.guideVisible||e._leftRulerConfig.guideVisible||e._defaultRulerConfig.guideVisible||(e._topRulerConfig.guideTipVisible||e._rightRulerConfig.guideTipVisible||e._bottomRulerConfig.guideTipVisible||e._leftRulerConfig.guideTipVisible||e._defaultRulerConfig.guideTipVisible)&&e._component){var Q=a.getBoundingClientRect();e.$16k={x:T.clientX-Q.left,y:T.clientY-Q.top},e.$5k()}},e.setComponent(z)},E("RulerFrame",D,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(j){var y=this,P=y._component,I=y.getView();if(I){if(y._component=j,y.fp("component",P,j),P){var V=y.getComponentView(P);i(I,V),O(I,"mousemove",y.$15k),y.removeComponentPropertyChangeListener(P,y.$14k)}if(j){var e=y.getComponentView(j);H(I,e),N(e,R,l),$(I,"mousemove",y.$15k),y.addComponentPropertyChangeListener(j,y.$14k)}}},addComponentPropertyChangeListener:function(c,w){c&&c.mp&&c.mp(w)},removeComponentPropertyChangeListener:function(x,q){x&&x.ump&&x.ump(q)},getComponentHZoom:function(t){return t&&t.getZoom?t.getZoom():1},getComponentVZoom:function(s){return s&&s.getZoom?s.getZoom():1},getComponentViewRect:function(j){return j&&j.getViewRect?j.getViewRect():void 0},getComponentView:function(c){return c&&c.getView?c.getView():c},invalidateComponent:function(n){n&&n.iv&&n.iv()},validateComponent:function(m){m&&m.validate&&m.validate()},$7k:function(L,B,X,Q,G,U,J,A,q,V,F,t){if(B.visible){var D=this._defaultRulerConfig,Z="borderStyle",d="borderColor",k="borderWidth",T="background",g=B[Z]||D[Z],R=B[d]||D[d],b=B[k]||D[k],s=B.size!=Y?B.size:D.size,r=B[T]||D[T],H=s+b,i=this.$6k(b,g,R,L,X,G,H,J,A,q,V,F,t);N(L,G,"0px"),U?w.setCanvas(L,Q-i,s):w.setCanvas(L,s,Q-i),N(L,"background",r),N(L,m,S)}else N(L,m,z),N(this.getComponentView(this._component),G,"0px")},$6k:function(k,F,a,v,X,j,K,y,i,R,w,u,e){var b=0;return N(v,X,k+"px "+F+" "+a),N(this.getComponentView(this._component),j,K+h),y?(N(v,i,R+h),b+=R):N(v,i,"0px"),w?(N(v,u,e+h),b+=e):N(v,u,"0px"),b},validateImpl:function(){var t=this,L=t._component,D=t.$1k,f=t.$2k,b=t.$3k,z=t.$4k,w=t._view,u=t._defaultRulerConfig,R=t._topRulerConfig,l=t._rightRulerConfig,g=t._bottomRulerConfig,v=t._leftRulerConfig,Q=u.size;if(w&&L){var d=R.size!=Y?R.size:Q,S=l.size!=Y?l.size:Q,P=g.size!=Y?g.size:Q,H=v.size!=Y?v.size:Q;t.$7k(D,R,"border-bottom",w.offsetWidth,V,!0,v.visible,Z,H,l.visible,I,S),t.$7k(f,l,"border-left",w.offsetHeight,I,!1,R.visible,V,d,g.visible,M,P),t.$7k(b,g,"border-top",w.offsetWidth,M,!0,v.visible,Z,H,l.visible,I,S),t.$7k(z,v,"border-right",w.offsetHeight,Z,!1,R.visible,V,d,g.visible,M,P),t.$13k?delete t.$13k:t.invalidateComponent(L),t.validateComponent(L),t.$5k()}},$5k:function(){function K(p,j,g,V,v,Q){if(j.visible){var I=G(p),H=j[F]||d,E=j[y]!=Y?j[y]:x,K=j[D]||e,k=j[m]||J,q=j.size!=Y?j.size:u,Fi=j[P]||n,Fc=j[B]||$,zh=j[f]||Z,Ti=j[c]!=Y?j[c]:N,oe=j[t]!=Y?j[t]:s,Rk=j[T]!=Y?j[T]:w,Wj=j[R]!=Y?j[R]:C,Sk=j[z]!=Y?j[z]:_,lo=j[X]!=Y?j[X]:r,Lc=j[o]||Eo,zs=j[A]||Nn;E&&(H=b[Q]=b.$8k(b[Q]||H,j[W]||h,j[U]||l,V?i:M,Fc)),g.call(b,I,S,O,L,a,q,V?i:M,H,K,k,v,Fi,zh);var us=b.$16k;(Ti||oe)&&us&&(V?b.$9k(I,us.x,q,Lc,zs,Ti,oe,Rk,Wj,Sk,lo):b.$10k(I,us.y,q,Lc,zs,Ti,oe,Rk,Wj,Sk,lo,v))}}var b=this,Q=b.$1k,H=b.$2k,E=b.$3k,p=b.$4k,v=b._topRulerConfig,I=b._rightRulerConfig,g=b._bottomRulerConfig,k=b._leftRulerConfig,q=b._defaultRulerConfig,j=b._component,V=b.getComponentViewRect(j),i=b.getComponentHZoom(j),M=b.getComponentVZoom(j),S=V.x*i,L=S+V.width*i,O=V.y*M,a=O+V.height*M,u=b._defaultRulerConfig.size,F="defaultMajorTickSpacing",W="maxPhysicalMajorTickSpacing",U="minPhysicalMajorTickSpacing",y="tickSpacingAdaptable",D="majorTickTextFont",m="majorTickTextColor",P="majorTickColor",f="minorTickColor",c="guideVisible",t="guideTipVisible",T="guideTipBorderColor",R="guideTipTextColor",z="guideTipTextFont",X="guideTipBackground",o="guideColor",A="guideWidth",B="minMajorTickSpacing",d=q[F],h=q[W],l=q[U],x=q[y],e=q[D],J=q[m],n=q[P],$=q[B],Z=q[f],N=q[c],s=q[t],w=q[T],C=q[R],_=q[z],r=q[X],Eo=q[o],Nn=q[A];b._view&&j&&(K(Q,v,b.$11k,!0,!1,"_currentTopMajorTickSpacing"),K(H,I,b.$12k,!1,!0,"_currentRightMajorTickSpacing"),K(E,g,b.$11k,!0,!0,"_currentBottomMajorTickSpacing"),K(p,k,b.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(n,E,k,J,Q){return k>n*J?n=W(E/J/Q)*Q:n*J>E&&(n=f(k/J/Q)*Q),n},getHTipText:function(L){var k=this,x=k._component,M=0,G=k._view.getBoundingClientRect();return x.lp?M=u(x.lp({x:L.x+G.left,y:L.y}).x):M-=u(this.getComponentView(x).style.left)||0,M},$9k:function(R,j,h,b,_,F,o,z,g,v,m){var S=this,c=S._component;R.save(),w.translateAndScale(R,0,0,1);var K=j-(u(this.getComponentView(c).style.left)||0),n=0;if(j=S.getHTipText(S.$16k),F&&(R.beginPath(),R.fillStyle=b,R.rect(K,n,_,h),R.fill()),o){R.beginPath(),R.textAlign="center",R.textBaseline="middle",R.font=v;var G=R.measureText(j).width+6;R.fillStyle=m,R.rect(K-G/2,n,G,h),R.fill(),R.strokeStyle=z,R.stroke(),R.beginPath(),R.fillStyle=g,R.fillText(j,K,n+h/2)}R.restore()},getVTipText:function(e){var G=this,v=G._component,F=0,O=G._view.getBoundingClientRect();return v.lp?F=u(v.lp({x:e.x,y:e.y+O.top}).y):F-=u(this.getComponentView(v).style.top)||0,F},formatScaleText:function(Y){return Math.round(Y)},$10k:function(Z,j,m,y,V,i,s,O,l,I,g,d){var U=this,k=U._component;Z.save(),w.translateAndScale(Z,0,0,1);var T=m/2,L=j-(u(this.getComponentView(k).style.top)||0);if(j=U.getVTipText(U.$16k),i&&(Z.beginPath(),Z.fillStyle=y,Z.rect(T-m/2,L,m,V),Z.fill()),s){Z.translate(T,L),Z.rotate((d?90:-90)*F/180),Z.translate(-T,-L),Z.beginPath(),Z.textAlign="center",Z.textBaseline="middle",Z.font=I;var Y=Z.measureText(j).width+6;Z.fillStyle=g,Z.rect(T-Y/2,L-m/2,Y,m),Z.fill(),Z.strokeStyle=O,Z.stroke(),Z.fillStyle=l,Z.fillText(j,T,L)}Z.restore()},$11k:function(Y,R,n,S,I,L,U,c,F,f,O,k,p){Y.save(),n=0;var M=R,J=S,P=(M+J)/2;R=0,S=J-M,w.translateAndScale(Y,0,0,1);var x=0,z=0,j=u(L/2),K=L-j,a=O?0:j,h=c*U,s=h/10;R-=h,S+=h,Y.clearRect(R,0,S-R,L),Y.beginPath(),Y.fillStyle=p;var Q=W(P/s)*s-M;for(x=Q;S>x;x+=s)Y.rect(x,n+a,1,K);for(x=Q;x>R;x-=s)Y.rect(x,n+a,1,K);for(Y.fill(),a=O?0:1,Y.beginPath(),Y.fillStyle=k,Q=W(P/h)*h-M,x=Q;S>x;x+=h)Y.rect(x,n+a,1,L-1);for(x=Q;x>R;x-=h)Y.rect(x,n+a,1,L-1);Y.fill();var v=u(/\d+px/.exec(F)[0]),H=(v||10)/2;Y.textBaseline="middle",a=O?L-H-2:H+2,Y.beginPath(),Y.fillStyle=f,Y.font=F;var B=W(P/h)*h/U;for(x=Q,z=B;S>x;x+=h,z+=c){var A=this.getHScaleText?this.getHScaleText(x):z;Y.fillText(this.formatScaleText(A),x+2,n+a)}for(x=Q,z=B;x>R;x-=h,z-=c){var A=this.getHScaleText?this.getHScaleText(x):z;Y.fillText(this.formatScaleText(A),x+2,n+a)}Y.restore()},$12k:function(L,P,Z,J,s,r,y,a,O,B,z,Q,k){function E(C,T,q,P,i,Y){i=X.getVScaleText?X.getVScaleText(q):i,i=X.formatScaleText(i),L.translate(C+T,q),L.rotate(-P),L.translate(-C-T,-q),L.fillText(i,C+T+(Y?2:1),q),L.translate(C+T,q),L.rotate(P),L.translate(-C-T,-q)}L.save(),P=0;var S=Z,D=s,j=(S+D)/2;Z=0,s=D-S,w.translateAndScale(L,0,0,1);var _=0,X=this,A=0,p=u(r/2),V=r-p,d=z?0:p,o=a*y,N=o/10;Z-=o,s+=o,L.clearRect(P,0,r,s-Z),L.beginPath(),L.fillStyle=k;var f=W(j/N)*N-S;for(_=f;s>_;_+=N)L.rect(P+d,_,V,1);for(_=f;_>Z;_-=N)L.rect(P+d,_,V,1);for(L.fill(),d=z?0:1,L.beginPath(),L.fillStyle=Q,f=W(j/o)*o-S,_=f;s>_;_+=o)L.rect(P+d,_,r-1,1);for(_=f;_>Z;_-=o)L.rect(P+d,_,r-1,1);L.fill();var K=u(/\d+px/.exec(O)[0]),H=(K||10)/2,t=90*F/180;L.textBaseline="middle",d=z?r-H:H+2,t=z?-t:t,L.beginPath(),L.fillStyle=B,L.font=O;var v=W(j/o)*o/y;for(_=f,A=v;s>_;_+=o,A+=a)E(P,d,_,t,A,z);for(_=f,A=v;_>Z;_-=o,A-=a)E(P,d,_,t,A,z);L.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var y=this,g=y._component,r=y._view;g&&y.removeComponentPropertyChangeListener(g,y.$14k),r&&(O(r,"mousemove",y.$15k),i(r.parentNode,r),y._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);