!function(j){"use strict";function q($){var h,E,R,Z,p,e,T,X=[],k=0;h=Q.createDiv(),h.style.overflow="hidden";var z=$.getView();z.insertBefore(h,$.getCanvas()),E=x.Default.createDiv(),E.style.WebkitTransformStyle="preserve-3d",E.style.MozTransformStyle="preserve-3d",E.style.transformStyle="preserve-3d",h.appendChild(E),[{event:"mousedown",style:"none"},{event:"mouseup",style:"auto"},{event:"touchstart",style:"none"},{event:"touchend",style:"auto"}].forEach(function(t){var Q=t.style;z.addEventListener(t.event,function(){h.style.pointerEvents=Q})}),this.updateWebView=function(){var v=$.getCanvas(),a=1*v.style.width.slice(0,-2),Q=1*v.style.height.slice(0,-2);(X[0]!==a||X[1]!==Q)&&(X[0]=a,X[1]=Q,h.style.width=a+"px",h.style.height=Q+"px",E.style.width=a+"px",E.style.height=Q+"px");var N=$._projectMatrix[5]*X[1]/2;N!==R&&(R=N,h.style.WebkitPerspective=R+"px",h.style.MozPerspective=R+"px",h.style.perspective=R+"px"),e="translateZ("+R+"px)"+M($._viewMatrix);var A=e+"translate("+X[0]/2+"px,"+X[1]/2+"px)";Z===A||p||(E.style.WebkitTransform=A,E.style.MozTransform=A,E.style.transform=A,Z=A),k++,T=!1,$.dm().each(function(H){H.isWebView&&_(H)});for(var f,x=E.children,J=[],c=0,V=x.length;V>c;c++)f=x[c],f._isHtWebView&&f._renderCookie!==k&&J.push(f);J.length&&J.forEach(function(n){E.removeChild(n)})};var A=new Array(16),_=function(C){var c=C.getAttach();if(c){c.parentElement!==E&&E.appendChild(c),c._renderCookie=k,T=!0;var V=C.getFinalScale3d(),B=C._prefrenceSize;B&&B[0]?B[1]||(B[1]=B[0]/V[0]*V[1]):B=[V[0],V[1]],c.style.width=B[0]+"px",c.style.height=B[1]+"px";var Z=1/B[0],m=1/B[1],Y=1,h=C.mat;A[0]=h[0]*Z,A[1]=h[1]*Z,A[2]=h[2]*Z,A[3]=h[3]*Z,A[4]=h[4]*m,A[5]=h[5]*m,A[6]=h[6]*m,A[7]=h[7]*m,A[8]=h[8]*Y,A[9]=h[9]*Y,A[10]=h[10]*Y,A[11]=h[11]*Y,A[12]=h[12],A[13]=h[13],A[14]=h[14],A[15]=h[15];var Q=o(A,p?"translate("+X[0]/2+"px,"+X[1]/2+"px)"+e:""),W=c.$a2;W!==Q&&(c.$a2=Q,c.style.WebkitTransform=Q,c.style.MozTransform=Q,c.style.transform=Q)}}}function e(n){return Math.abs(n)<1e-10?0:n}function M(Z){var d=Z;return"matrix3d("+e(d[0])+","+e(-d[1])+","+e(d[2])+","+e(d[3])+","+e(d[4])+","+e(-d[5])+","+e(d[6])+","+e(d[7])+","+e(d[8])+","+e(-d[9])+","+e(d[10])+","+e(d[11])+","+e(d[12])+","+e(-d[13])+","+e(d[14])+","+e(d[15])+")"}function o(i,n){var A=i,M="matrix3d("+e(A[0])+","+e(A[1])+","+e(A[2])+","+e(A[3])+","+e(-A[4])+","+e(-A[5])+","+e(-A[6])+","+e(-A[7])+","+e(A[8])+","+e(A[9])+","+e(A[10])+","+e(A[11])+","+e(A[12])+","+e(A[13])+","+e(A[14])+","+e(A[15])+")";return"translate(-50%,-50%)"+(n||"")+M}var T="ht",x=j[T],Q=x.Default,n=Q.getInternal(),k=n.superCall,C=x.graph3d.Graph3dView,B=C.prototype.validateImpl;C.prototype.validateImpl=function(){B.call(this);var J=this._webViewRenderer;J||(J=this._webViewRenderer=new q(this)),J.updateWebView()};var l=x.WebView3d=function(){var s=this;k(l,s),s.s({shape3d:"billboard","shape3d.reverse.flip":!0})},p=[1,1,1,1],v=[0,0,0,0];Q.def(T+"."+"WebView3d",x.Node,{ms_ac:["attach"],isWebView:!0,attachDOM:function(D,p,F){if(!D)return this.detachDOM();if("string"==typeof D){var f=document.createElement("iframe");f.src=D,D=f}var B=D.style;B.position="absolute",B.border=0,B.outline=0,B.padding=0,B.margin=0,D._isHtWebView=!0,this.setAttach(D),this._prefrenceSize=[p,F],this.s("shape3d.blend",v)},detachDOM:function(){this.setAttach(null),this.s("shape3d.blend",this.getBgColor())},setBgColor:function(j){this.a("defaultBgColor",j),this.getAttach()||this.s("shape3d.blend",j)},getBgColor:function(){return this.a("defaultBgColor")||p}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);