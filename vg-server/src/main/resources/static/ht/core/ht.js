!function(x,w,q){"use strict";var e="ht";if(!x[e]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),x.performance&&x.performance.now||function(){var Y=Date.now();x.performance||(x.performance={}),x.performance.now=function(){return Date.now()-Y}}();for(var m=Date.now(),g=16,Z=["ms","moz","webkit","o"],R=0;R<Z.length&&!x.requestAnimationFrame;++R)x.requestAnimationFrame=x[Z[R]+"RequestAnimationFrame"],x.cancelAnimationFrame=x[Z[R]+"CancelAnimationFrame"]||x[Z[R]+"CancelRequestAnimationFrame"];x.requestAnimationFrame||(x.requestAnimationFrame=function(t){var X=Date.now(),k=g+m-X;return 0>k&&(k=0),m=X,x.setTimeout(function(){m=Date.now(),t(performance.now())},k)}),x.cancelAnimationFrame||(x.cancelAnimationFrame=function(o){return x.clearTimeout(o)}),w.assign===q&&(w.assign=function(u){if(u===q||null===u)throw new TypeError("Cannot convert undefined or null to object");for(var P=w(u),B=1;B<arguments.length;B++){var R=arguments[B];if(R!==q&&null!==R)for(var L in R)w.prototype.hasOwnProperty.call(R,L)&&(P[L]=R[L])}return P})}();var R=x.document,T=null,b=x[e]={},h=x[e+"config"],t=b.Default=h&&h.Default||{},f=b.Style=h&&h.Style||{},Q=b.Attr=h&&h.Attr||{},r=b.Color=h&&h.Color||{},V=b.IsGetter=h&&h.IsGetter||{};!function(){var _=!1;try{var u=w.defineProperty({},"passive",{get:function(){_=!0}});x.addEventListener("test",u,u),x.removeEventListener("test",u,u)}catch(y){_=!1}t.passiveSupported=_}();var A,W,k,m,y=t.passiveSupported,O=t.eventListenerOptionsFalse=y?{passive:!1,capture:!1}:!1,C=t.eventListenerOptionsTrue=y?{passive:!1,capture:!0}:!0,G=Math,z=G.round,l=G.floor,d=G.ceil,E=G.sqrt,i=G.max,B=G.min,S=G.abs,o=G.cos,g=G.acos,U=G.sin,L=G.pow,K=G.asin,X=G.PI,p=2*X,_=X/2,s=G.tan,J=G.atan2,v=G.random,M=G.log,Y=!1,c=!1,j=x.parseInt||global.parseInt,u="2018-12-25",Z=x.navigator?x.navigator.platform.indexOf("Win")>-1:!1,I=function(C){return C*C},n=x.setTimeout,F=x.clearTimeout,P=x.location,a=x.navigator?x.navigator.userAgent.toLowerCase():"",H=function(D){return D.test(a)},N=H(/msie/),$=H(/msie/)||H(/trident/),D=H(/msie 10/),Jk=H(/edge/),io=H(/firefox/),Xi=H(/mac/),tb=t.isTouchable===q?Z?!1:R?"ontouchend"in R:!1:t.isTouchable,lo="default",Fn="single",fh="multiple",Af="front",Yr="back",vn="left",ib="right",Nm="top",ak="bottom",_l="center",Jm="eye",ph="middle",wj="east",Xo="west",Kb="north",tc="none",vs="px",nl="absolute",Zq="border",kr="triangle",zm="rect",Qq="circle",Wc="cylinder",Mo="shape",rq="items",gr="normal",Rl="remove",ar="clear",Mc="width",tf="height",eh="ingroup",cl="check",Rk="uncheck",Ah="radio",Mj="radioOn",gk="radioOff",ek="points",Fb="values",Aq="series",de="body",Rg="label",Ul="label2",Mr="note",lf="note2",ag="icons",Lh="labelFont",he="labelColor",Dc="labelSelectColor",Jn="note.expanded",lg="note2.expanded",df="edge.expanded",Zf="edge.points",Zj="edge.type",Ui="rotation",un="hidden",Ge="visible",tr="tuv",vm="no",xn="draw",wk="select",gm="currentSubGraph",Yj="selectBackground",br="autoMakeVisible",Sr="autoHideScrollBar",Ze="scrollBarColor",mn="scrollBarSize",rl="indent",Og="rowHeight",Rp="columnLineColor",No="rowLineColor",ue="columnLineVisible",Em="rowLineVisible",ni="visibleFunc",em="expandIcon",Gj="collapseIcon",fi="checkMode",$p="sortFunc",Ol="editable",Vd="batchEditable",pq="tristate",fe="asc",jb="desc",wr="position",Ll="elevation",Tk="children",Sh="translateX",eb="translateY",pb="dataModel",th="maxSize",td="shape3d",Nq="shape3d.resolution",zd="shape3d.visible",Yg="shape3d.from.visible",Dl="shape3d.to.visible",Qi="shape3d.top.visible",Sg="shape3d.bottom.visible",Vl="repeat.uv.length",Oc="serializeValue",kd="deserializeValue",co="centerUniform",Qc="uniform",hf="rgba(255,255,255,0)",dl="style",ko="attr",Ji="field",Sk="string",$q="boolean",so="color",re="int",Lf="number",cm="ew-resize",lr="ns-resize",qo="pointer",Ok="auto",bg="mousedown",cj="mousemove",pm="mouseup",jh="mouseout",vo="touchstart",lb="touchmove",Ko="touchend",kh="keydown",ed="keyup",oc=["DOMMouseScroll","mousewheel"],Jh=io?oc[0]:oc[1],Un=tb?[vo,lb,Ko,kh,ed,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"]:[kh,ed,"keypress","input",bg,cj,pm,jh,Jh,"wheel","contextmenu","mouseenter","mouseleave","mouseover","compositionstart","compositionupdate","compositionend"],zi=T,ch=T,md=T,Sf=pm.length,Gn=function(){md&&(F(md.timeout),md=T)},Wk=function(){md&&di(md.e,md.info)};x.addEventListener&&(tb||(x.addEventListener(jh,function(){Gn()},O),x.addEventListener(Jh,function(){Xm()},O)),x.addEventListener(ed,function(p){91===p.keyCode?Eh={}:delete Eh[p.keyCode]},C),x.addEventListener(kh,function(Y){Eh[Y.keyCode]=!0},C),x.addEventListener("blur",function(){Eh={}},O));var dc,ys,ln,Fo=0,Um=T,Dg=function(V,j){var g=n(function(){delete Um[g],Fq(Um)&&(Um=T),V()},j);return g},Hi=T,Rm=T,Lk={},Qk={},Ug={},So={},ll={},Eh={},tm={},mm={},Hd={},Ib={},Dd=/.json$/,Yd=/^data:image\/svg\+xml/,Oj={},Ni=[],bi={},Xp=T,Rq=T,Kd=function(){},Wg=function(){throw"Oops!"},uc=[0,0,0],rf=[0,0,0,0],gs={x:0,y:0,width:0,height:0},zg=T,Gc=T,xe=T,ds=function(a){Gc&&!a._72O&&(xe||(xe={}),xe[a._72O=tk()]=a),dc!=T?wm()<.05&&m&&!ys&&(Ek=Gn):Ek=lp},_q=function(v,d,h,H){Gc||(Gc={});var W=Gc[v];if(W){if(W.url===d)return;W.image?(W.image.onload=Kd,W.image.onerror=Kd):W.request&&(W.request.onload=Kd,W.request.onerror=Kd)}if(Dd.test(d)){var x=new Ae;if(Gc[v]={request:x,url:d},d=t.beforeLoadURL(d),d.data){var y=t.parse(d.data);Kj(v,y),t.handleImageLoaded(v,y)}else{x.onload=function(B){if(200===this.status||0===this.status){var e=t.parse(B.target.response||B.target.responseText);Kj(v,e),t.handleImageLoaded(v,e)}else Kj(v,t.handleUnfoundImage(v,d)||T)},x.onerror=function(){Kj(v,t.handleUnfoundImage(v,d)||T)};var B={};B.url=encodeURI(d),B.sync=!1,x.send(B)}}else{var y=new Image;Gc[v]={image:y,url:d},/^data:image/.test(d)||(d=t.beforeLoadURL(d),d=t.appendTimeStamp(d),d=encodeURI(d),y.crossOrigin=t.crossOrigin),t.convertImageSrc(d,function(Y){$&&(d.toLowerCase().indexOf(".svg")>0||Yd.test(d))?(R.body.appendChild(y),y.style.visibility="hidden",y.onload=function(){n(function(){if(h&&(y.width=h),H&&(y.height=H),!y.width||!y.height){var G=y.width||y.clientWidth,f=y.height||y.clientHeight;y.width=G,y.height=f}t.handleImageLoaded(v,y),Kj(v,y),R.body.removeChild(y),y.style.visibility=""},180)},y.onerror=function(){Kj(v,t.handleUnfoundImage(v,d)||T),R.body.removeChild(y),y.style.visibility=""}):(y.onload=function(){h&&(y.width=h),H&&(y.height=H),t.handleImageLoaded(v,y),Kj(v,y)},y.onerror=function(){Kj(v,t.handleUnfoundImage(v,d)||T)}),y.src=Y})}},Kj=function(w,e){if(Qk[w]=e,delete Gc[w],Fq(Gc)&&(Gc=T,xe)){for(var D in xe){var d=xe[D];d._2O&&(d._2O={}),d.invalidateAll&&d.invalidateAll(q,"imageLoaded",w),d.redraw&&d.redraw(),d.iv(),delete d._72O}xe=T}if(e&&xe)for(var D in xe){var d=xe[D];d.invalidateAll&&d.invalidateAll(q,"imageLoading",w),d.redraw&&d.redraw(),d.iv()}},Wm=function(){return M=G&&Date,function(){return x.performance&&x.performance.now?x.performance.now():Date.now()}}(),bb=function(I,g){g?F(I):x.cancelAnimationFrame(I)},Tb=function(O,n,Z){return{width:O,height:n,comps:Wd(Z)?Z:[Z]}},pg=function(o,l){return{type:Qq,rect:[o,l,1.6,1.6],borderWidth:1,borderColor:hm,gradient:kp,gradientColor:zl,background:hm}},ub=function(L,r){return Tb(16,16,{type:kr,rect:[4,4,10,8],background:L,rotation:r?1.57:3.14})},Cl=function(v,l){return Tb(16,16,{type:kr,rect:[4,4,8,7],background:v,rotation:l?3.14:0})},Je=function(g){var Q=g._orientation;return"horizontal"===Q||"h"===Q},Xj=function(n){var z=T||4,R=T||1,D=T||1;0>z?z=0:z>.25&&(z=.25);var _,e,t,E,k,Z,d,A=.5,i=[],j=[],M=[],r=p/D,I=p/R,s=A-z;for(e=0;R>=e;e++)for(E=-X+e*I,Z=o(E),k=U(E),_=0;D>=_;_++)t=_*r,d=s+z*Z,i.push(o(t)*d,k*z,-U(t)*d),(W=n)&&j.push(_/D,1-e/R);for(e=0;R>e;e++){var w=e*(D+1),O=(e+1)*(D+1);for(_=0;D>_;_++)M.push(w+_,O+_+1,O+_,w+_,w+_+1,O+_+1),Tr.z=hr.z=n}},Eq=function(u){var V=2,C=0;for(var g in u)g.length===V&&j(g,32)===Me&&(Xp=Rq=u[g]),C++;return C},ob=function(Z,o,j,T){return j||(j=tb?5:3,j/=T||1),{x:Z-j,y:o-j,width:2*j,height:2*j}},$m=function(Q,i,G,t){var f=this;i||(i=tb?5:3,G=20,t=20);var y={x:Q,y:i,width:G,height:t};if(G)for(var g=0;G>g;g++)if(3===G)t=20;else for(var V=0;t>V;V++)f=x?x:G;var Y={x:X,y:2*X};if(Fi(y,Y)){var L=tf[0]+Nm[0]+ar[1]+(fe.length-1);Ur[Jm]=f[L],f[L]=pp[Jm]}},um=function(c){return(/ble$/.test(c)||/ed$/.test(c)||V[c]?"is":"get")+c.charAt(0).toUpperCase()+c.slice(1)},pp=function(d){return"set"+d.charAt(0).toUpperCase()+d.slice(1)},Ub=function(N){return typeof N===Sk||N instanceof String},bh=function(R){return typeof R===Lf},lp=function(l){return typeof l===$q},qc=function(g){return g&&"object"==typeof g},Dk=function(P){return"function"==typeof P},Wd=function(E){return E instanceof Array},Co=function(Q){return Q instanceof Bk},ej=function(C){return Wd(C)?new Bk(C):C},uq=function(u){return u instanceof Ak},Pn=function(C){return C instanceof cr},Vf=function(B){return B instanceof Eb},iq=function(Y,s){if(!(Y instanceof b.Group))return!1;if(!s)return Y.isExpanded();var w=s.getDataUI(Y);return w&&w._88I?!0:!1},Se=function(e){return e instanceof Tf},is=function($){return $&&"IFRAME"===$.tagName},Mk=function(v){return v==T||t.numberDigits==T?v:parseFloat(v.toFixed(t.numberDigits))},fj=function(h,p,A){var D,f=p.length;if(A)for(var j=0;A>j;j++)if(3===f)h.push(p[0]),h.push(p[1]),h.push(p[2]);else for(D=0;f>D;D++)h.push(p[D]);else if(3===f)h.push(p[0]),h.push(p[1]),h.push(p[2]);else for(D=0;f>D;D++)h.push(p[D])},_m=function(X){return X?qc(X)?X:{}:!1},Pr=function(e,R,r){var B,I=qc(e)?e:e.prototype;for(B in R)r&&I[B]!==q||(I[B]=R[B]);return e},fq=function(G){return String.fromCharCode(G)},Kc=function(R){for(var a,y=0,J="";y<R.length;y++)a=R[R.length-1-y],"%"===a?a="'":"a"===a?a='"':"]"===a&&(a="\\"),J+=fq(a.charCodeAt(0)-1);return J},Uo=function(l,s,D){l.superClass.constructor.apply(s,D)},Fq=function(R){for(var W in R)return!1;return!0},tj=function(U){return U?0===U.length:!0},mb=function(){var F="";return[Rk[0],No[0],Rg[0]].forEach(function(w){F+=pp(w).slice(3)}),Qc=R&&R[F]||co,function(e,N){return e===N?!0:e.x===N.x&&e.y===N.y&&e.width===N.width&&e.height===N.height}}(),Mi=function(w,B,g){return B>w?B:w>g?g:w},wg=function(V){return 0>V?-1:V>0?1:0},wm=function(){var Q=1e4*U(Sf++);return Q-l(Q)},Pk=function(n,R,i){return pn(n.x,n.y,R.x,R.y,i.x,i.y,i.x+i.width,i.y,!0)||pn(n.x,n.y,R.x,R.y,i.x+i.width,i.y,i.x+i.width,i.y+i.height,!0)||pn(n.x,n.y,R.x,R.y,i.x+i.width,i.y+i.height,i.x,i.y+i.height,!0)||pn(n.x,n.y,R.x,R.y,i.x,i.y+i.height,i.x,i.y,!0)},pn=function(Y,M,x,L,s,S,Z,G,a){var c=(Z-s)*(M-S)-(G-S)*(Y-s),A=(G-S)*(x-Y)-(Z-s)*(L-M);if(0!==A){var K=c/A,h=Y+K*(x-Y),n=M+K*(L-M);return a&&(h+or<B(Y,x)||h-or>i(Y,x)||h+or<B(s,Z)||h-or>i(s,Z)||n+or<B(M,L)||n-or>i(M,L)||n+or<B(S,G)||n-or>i(S,G))?T:[h,n]}return T},il=function(N,j,u){if(N&&u)if(j){if(j===dl)return N.getStyle(u);if(j===ko)return N.getAttr(u);if(j===Ji)return N[u]}else if(u=um(u),N[u])return N[u]();return q},ep=function(n,e,N,R){if(n&&N)if(e){if(e===dl)n.s(N,R);else if(e===ko)n.a(N,R);else if(e===Ji){var Z=n[N];n[N]=R,n.fp("f:"+N,Z,R)}}else N=pp(N),n[N]&&n[N](R)},Pj=function(N,C,$){return C&&"top"!==C?"bottom"===C?{x:N.x,y:N.y,width:N.width,height:N.height*$}:"right"===C?{x:N.x,y:N.y,width:N.width*$,height:N.height}:"left"===C?{x:N.x+N.width*(1-$),y:N.y,width:N.width*$,height:N.height}:void 0:{x:N.x,y:N.y+N.height*(1-$),width:N.width,height:N.height*$}},Yh=function(M,G,F,X,c){G&&Of(M,F,X,1,c,G)},zs=function($,l,f,w){var K=1-$;return K*K*l+2*$*K*f+$*$*w},Tr=function(N,m,q,E,u){var v=1-N;return v*v*v*m+3*v*v*N*q+3*v*N*N*E+N*N*N*u},Gb=function(f){var c,P,r,i,o=0;return f.forEach(function(Y){if(c=Y.length,c>0)for(P=Y[0],i=1;c>i;i++)r=Y[i],o+=Bc(P,r),P=r}),o},Ml=function($,c,P){var M="__"+$,F=function(e){P.disabled||P["handle_"+$](e)};P[M]||(P[M]=F,c.addEventListener($,F,O))},$f=function(t,v,$){var U="__"+t,f=$[U];f&&(v.removeEventListener(t,f,O),delete $[U])},ig=function(J,m){var $="_"+m;J[um(m)]=function(){return this[$]},J[pp(m)]=function(r){var x=this[$];this[$]=r,this.fp(m,x,r)}},Ij=function(L){return w.create(L)},Ap=function(W){if(!W.element){var S,R;(S=W.textField)?R=ad(Yi.TextField,S):(S=W.textArea)?R=ad(Yi.TextArea,S):(S=W.button)?R=ad(Yi.Button,S):(S=W.comboBox)?R=ad(Yi.ComboBox,S):(S=W.checkBox)?R=ad(Yi.CheckBox,S):(S=W.radioButton)?R=ad(Yi.RadioButton,S):(S=W.slider)?R=ad(Yi.Slider,S):(S=W.colorPicker)?R=ad(Yi.ColorPicker,S):(S=W.image)&&(R=ad(Yi.Image,S)),R&&(W.element=R)}},rc=function(O,m){var F=Zp(O);return F._ht=m,F},Zp=function(G,P){var c=R.createElement("div"),H=c.style;return c.tabIndex=-1,c.onkeydown=en,H.msTouchAction=tc,Nh(c,T,0),tb&&H.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",T),G&&(H.overflow=un),P&&Xk(P,c),c},Uh=function(q,h){var z=R.createElement("canvas"),H=z.style;return H.msTouchAction=tc,h||(H.pointerEvents=tc),Nh(z,T,0),q&&Xk(q,z),z},Nh=function(o,g,N){var U=o.style;U.border=g?g+" solid 1px":0,U.outline=0,U.padding=N?"0 "+N+vs:0,Kf(o)},Kf=function(a){var P=a.style;P.position=nl,P.margin=0,P.setProperty("box-sizing","border-box",T),P.setProperty("-moz-box-sizing","border-box",T)},Dp=function(l,e,m,R){R||(R=ke),e!=T&&(l.width=e*R,l.style.width=e+vs),m!=T&&(l.height=m*R,l.style.height=m+vs)},Xk=function(h,T,f){h.appendChild(T),f&&(T.style.position=nl)},fc=function(w,A){A.split||(A+="");for(var B,T=A.split("\n"),U=0,c=T.length,G=0;c>G;G++){var y=jp(w.font,T[G]);y.width>U&&(U=y.width),B||(B=y.height)}return w.ss=T,{width:U,height:B*c}},Pg=function(S,$,P,Q,x,u){var t=$.length;if(1===t)Jb(S,$[0],P,Q,x);else for(var X=P.height/t,d={x:P.x,y:P.y,width:P.width,height:X},Z=0;Z<$.length;Z++)u?jn(S,$[Z],Q,x,d.x,d.y,d.width,d.height,u):Jb(S,$[Z],d,Q,x),d.y+=X},Jb=function(j,v,Z,_,P){j.font=_?_:Tl,j.fillStyle=P?P:Wl,j.textAlign=_l,j.textBaseline=ph;var C,c;Z?Z.width===q?(C=Z.x,c=Z.y):(C=Z.x+Z.width/2,c=Z.y+Z.height/2):(C=0,c=0),j.fillText(v,z(C),z(c))},pi=function(W){W.getView&&(W=W.getView());var p=W.offsetWidth||W.scrollWidth;return!p&&W.style.width&&(p=j(W.style.width)),p},Yq=function(X){X.getView&&(X=X.getView());var b=X.offsetHeight||X.scrollHeight;return!b&&X.style.height&&(b=j(X.style.height)),b},Qe=function(f,$,p){var h=$[0].toUpperCase()+$.substring(1,$.length);f["webkit"+h]=p,f["moz"+h]=p,f["ms"+h]=p,f["o"+h]=p,f[$]=p},Nr=function(){var G=function(c){en(c),c.stopPropagation()},L=function(j){en(j)},p=tb?[vo]:[kh,bg];return function(j,R){var k=Zp(),b=k.style;return b.backgroundColor=t.disabledBackground,j&&(b.backgroundImage="url("+j+")",b.backgroundPosition="50% 50%",b.backgroundRepeat="no-repeat no-repeat"),R===!1?p.forEach(function($){k.addEventListener($,L,O)}):p.forEach(function(A){k.addEventListener(A,G,O)}),k}}(),Cn=function(c){var l=c.getContext("2d");return l.save(),l.lineCap=Nd,l.lineJoin=pk,l},Ek=function(e,Q,s,F){ts(e,Q*ke,s*ke),F*=ke,1!==F&&e.scale(F,F)},ts=function(h,t,C){h.translate(t,C)},eg=function(g,N){N&&g.rotate(N)},go=function(R,n,Q){n===q&&(n=1),Q===q&&(Q=1),(1!==n||1!==Q)&&R.scale(n,Q)},hh=!1,hk=function(b){var e=R.activeElement;if(R.activeElement!==b){e&&e.forceOnblur&&e.forceOnblur();for(var i=[],Q=b.parentNode;Q;)i.push([Q,Q.scrollLeft,Q.scrollTop]),Q=Q.parentNode;if(!hh){var U=[],$=[];try{for(var a=x.parent,d=x;a!==d;)U.push([a,a.scrollX,a.scrollY]),d=a,a=x.parent;var m=x.frameElement;if(m)for(var H=m.parentNode;H;)$.push([H,H.scrollLeft,H.scrollTop]),H=H.parentNode}catch(w){hh=!0}}if(tb)b.focus();else{var X=Pb(),Z=X.target;b.focus(),Z.scrollLeft=X.left,Z.scrollTop=X.top}i.forEach(function(b){b[0].scrollLeft=b[1],b[0].scrollTop=b[2]}),hh||(U.forEach(function(T){T[0].scrollTo(T[1],T[2])}),$.forEach(function(Z){Z[0].scrollLeft=Z[1],Z[0].scrollTop=Z[2]}))}},vr=function(M){return M&&M.getView?M.getView():M},$c=function(x,d,F,h,K){if(2===arguments.length&&(F=d.y,h=d.width,K=d.height,d=d.x),x.isSelfViewEvent)x.setX(d),x.setY(F),x.setWidth(h),x.setHeight(K);else{var Z=vr(x),C=Z.style;if((R.fullscreenElement||R.mozFullScreenElement||R.webkitFullscreenElement||R.msFullscreenElement)!==Z)d!==q&&(C.left=d+vs),F!==q&&(C.top=F+vs),h!==q&&(C.width=h+vs),K!==q&&(C.height=K+vs);else{var J=t.getWindowInfo();C.left=(d=J.left)+vs,C.top=(F=J.top)+vs,C.width=(h=J.width)+vs,C.height=(K=J.height)+vs}x.endEditing&&!tb&&x.endEditing(),x.redraw&&x.redraw(),x.invalidate&&x.invalidate(),x.onLayouted&&x.onLayouted(d,F,h,K),x.fireViewEvent&&x.fireViewEvent("layout")}},Gq=function(b){if(!b.touches)return b;var U=b.touches[0];return U?U:b.changedTouches[0]},xj=function(W){return tb?Gq(W).target:W.target},_d=function(n){t.popup&&t.popup.close(),t.popup=n},_e=T,vd=function(J){_e.handleWindowTouchMove(J)},tq=function(L){_e.handleWindowTouchEnd(L),x.removeEventListener(lb,vd,O),x.removeEventListener(Ko,tq,O),_e=T},Bq=function(Q){_e.handleWindowMouseMove(Q)},Be=function(j){_e.handleWindowMouseUp(j),x.removeEventListener(cj,Bq,O),x.removeEventListener(pm,Be,O),_e=T},Qd=function(F){return 1===id(F)},Cr=function(_,q){return q?q.keyCode===_:Eh[_]},Di=function(w){return ti(w)&&Cr(65,w)},If=function(j){return Cr(46,j)||Cr(8,j)},Xh=function(n){return function(i){return i?i.keyCode===n:Eh[n]}},Me=573,bs=[65,83,68,87,37,38,39,40,32,13,27],Lb=Xh(bs[0]),Lp=Xh(bs[1]),Vi=Xh(bs[2]),ve=Xh(bs[3]),Cc=Xh(bs[4]),Lr=Xh(bs[5]),zn=Xh(bs[6]),Ei=Xh(bs[7]),jm=Xh(bs[8]),op=Xh(bs[9]),qi=Xh(bs[10]),Yp={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},Tc=[2,2,2,2,2,2,2,2,2,2,2,3,3,3,5,5,5,5,5,5,1789],Wq=T,Rd=T,ge=function(t,u){Wq||(Wq=Uh()),Dp(Wq,t,u,1);var B=Cn(Wq);return B.clearRect(0,0,t,u),B},Ar=function(){var f,Z={};for(var U in x){var W=fh.length;if(U.length==W&&U[0]===fh[2]&&U[1]===tc[1]&&U[4]===fh[3]&&U[5]===fh[4]&&U.substr(W-2)===tc[1]+tc[2]){var J=x[U];for(var l in J)l.length===W&&l.substr(0,3)===ib[3]+Rl[3]+wk[0]&&l.substr(W-2)===fh[0]+Mr[3]&&(oc=J[l])}}return function(Q){var T,y=Z[Q];return y||(f||(f=Uh(),Dp(f,1,1,1)),T=f.getContext("2d"),T.clearRect(0,0,1,1),Of(T,0,0,1,1,Q),y=T.getImageData(0,0,1,1).data,y=Z[Q]=[y[0],y[1],y[2],y[3]]),y}}(),Uf=function(O){if(!Ub(O))return O;var I=Ar(O);return I.CA||(I.CA=[I[0]/255,I[1]/255,I[2]/255,I[3]/255]),I.CA},Ri=function(F,n,M,J,d){var X=Uh();X.width=M,X.height=J;var v=X.getContext("2d");v.drawImage(F,0,0,M,J);try{for(var Q=v.getImageData(0,0,M,J),o=Q.data,H=0,Z=o.length;Z>H;H+=4){var W=o[H+0],q=o[H+1],L=o[H+2],V=o[H+3];"override_a"===d?o[H+3]=255*n[3]:"override_rgb"===d?(o[H+0]=255*n[0],o[H+1]=255*n[1],o[H+2]=255*n[2]):"override"===d?(o[H+0]=255*n[0],o[H+1]=255*n[1],o[H+2]=255*n[2],o[H+3]=255*n[3]):(o[H+0]=n[0]*W,o[H+1]=n[1]*q,o[H+2]=n[2]*L,o[H+3]=n[3]*V)}v.putImageData(Q,0,0)}catch(B){return F}return X},Ur=function(r,D,Z){return D&&(D="miter"===Z?8*D+20:D+1,r&&Ym(r,D)),D},kk=function(E,q){if(q){var H=new Jg(q),b=E.width/2,n=E.height/2,T=ps([H.tf(-b,-n),H.tf(b,-n),H.tf(b,n),H.tf(-b,n)]);return T.x+=E.x+b,T.y+=E.y+n,T}return E},Wp=function(n,Q,U,Z,F,v,W,M){Z*=Math.PI/180;var m={x:Math.cos(Z)*(n.x-W.x)/2+Math.sin(Z)*(n.y-W.y)/2,y:-Math.sin(Z)*(n.x-W.x)/2+Math.cos(Z)*(n.y-W.y)/2},Y=Math.pow(m.x,2)/Math.pow(Q,2)+Math.pow(m.y,2)/Math.pow(U,2);Y>1&&(Q*=Math.sqrt(Y),U*=Math.sqrt(Y));var P=(F==v?-1:1)*Math.sqrt((Math.pow(Q,2)*Math.pow(U,2)-Math.pow(Q,2)*Math.pow(m.y,2)-Math.pow(U,2)*Math.pow(m.x,2))/(Math.pow(Q,2)*Math.pow(m.y,2)+Math.pow(U,2)*Math.pow(m.x,2)));isNaN(P)&&(P=0);var r={x:P*Q*m.y/U,y:P*-U*m.x/Q},I={x:(n.x+W.x)/2+Math.cos(Z)*r.x-Math.sin(Z)*r.y,y:(n.y+W.y)/2+Math.sin(Z)*r.x+Math.cos(Z)*r.y},c=function(p){return Math.sqrt(Math.pow(p[0],2)+Math.pow(p[1],2))},L=function($,p){return($[0]*p[0]+$[1]*p[1])/(c($)*c(p))},J=function(p,V){return(p[0]*V[1]<p[1]*V[0]?-1:1)*Math.acos(L(p,V))},A=J([1,0],[(m.x-r.x)/Q,(m.y-r.y)/U]),T=[(m.x-r.x)/Q,(m.y-r.y)/U],K=[(-m.x-r.x)/Q,(-m.y-r.y)/U],p=J(T,K);L(T,K)<=-1&&(p=Math.PI),L(T,K)>=1&&(p=0);var L=Q>U?Q:U,O=Q>U?1:Q/U,C=Q>U?U/Q:1;if(null==M){var f={x:0,y:0,width:0,height:0};Ym(f,L),f.x*=O,f.width*=O,f.y*=C,f.height*=C;var H=new Jg(Z);return f=ps([H.tf(f.x,f.y),H.tf(f.x+f.width,f.y),H.tf(f.x+f.width,f.y+f.height),H.tf(f.x,f.y+f.height)]),f.x+=I.x,f.y+=I.y,[{x:f.x,y:f.y},{x:f.x+f.width,y:f.y},{x:f.x+f.width,y:f.y+f.height},{x:f.x,y:f.y+f.height}]}M.translate(I.x,I.y),M.rotate(Z),M.scale(O,C),M.arc(0,0,L,A,A+p,1-v),M.scale(1/O,1/C),M.rotate(-Z),M.translate(-I.x,-I.y)},Fh=function(i,S){i&&i.beginPath();for(var x,w,u,s=[],k=function(L){for(var y,S=/(\-{0,1}[\d\.]+)/gi,$=[];y=S.exec(L);)$.push(parseFloat(y[0]));return $},D=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,t={x:0,y:0};x=D.exec(S);){var P=x[0],o=P.substr(0,1);if("M"===o||"m"===o){for(var c=k(P),L=0;L<c.length;L+=2){var f=c[L],I=c[L+1];"m"===o&&(f+=t.x,I+=t.y),i&&i.moveTo(f,I),s.push({x:f,y:I}),t.x=f,t.y=I}w=u=null}else if("H"===o||"h"===o){for(var c=k(P),L=0;L<c.length;L+=1){var f=c[L];"h"===o&&(f+=t.x),i&&i.lineTo(f,t.y),s.push({x:f,y:t.y}),t.x=f}w=u=null}else if("C"===o||"c"===o){for(var c=k(P),L=0;L<c.length;L+=6){var O=c[L],d=c[L+1],N=c[L+2],g=c[L+3],f=c[L+4],I=c[L+5];"c"===o&&(O+=t.x,d+=t.y,N+=t.x,g+=t.y,f+=t.x,I+=t.y),i&&i.bezierCurveTo(O,d,N,g,f,I),s.push({x:O,y:d}),s.push({x:N,y:g}),s.push({x:f,y:I}),t.x=f,t.y=I}w=[O,d,N,g,f,I],u=null}else if("S"===o||"s"===o){for(var c=k(P),L=0;L<c.length;L+=4){var O,d;w?(O=2*w[4]-w[2],d=2*w[5]-w[3]):(O=t.x,d=t.y);var N=c[L],g=c[L+1],f=c[L+2],I=c[L+3];"s"===o&&(N+=t.x,g+=t.y,f+=t.x,I+=t.y),i&&i.bezierCurveTo(O,d,N,g,f,I),s.push({x:O,y:d}),s.push({x:N,y:g}),s.push({x:f,y:I}),t.x=f,t.y=I}w=[O,d,N,g,f,I],u=null}else if("Q"===o||"q"===o){for(var c=k(P),L=0;L<c.length;L+=4){var O=c[L],d=c[L+1],f=c[L+2],I=c[L+3];"q"===o&&(O+=t.x,d+=t.y,f+=t.x,I+=t.y),i&&i.quadraticCurveTo(O,d,f,I),s.push({x:O,y:d}),s.push({x:f,y:I}),t.x=f,t.y=I}w=null,u=[O,d,f,I]}else if("T"===o||"t"===o){for(var c=k(P),L=0;L<c.length;L+=2){var O,d;u?(O=2*u[2]-u[0],d=2*u[3]-u[1]):(O=t.x,d=t.y);var f=c[L],I=c[L+1];"t"===o&&(f+=t.x,I+=t.y),i&&i.quadraticCurveTo(O,d,f,I),s.push({x:O,y:d}),s.push({x:f,y:I}),t.x=f,t.y=I}w=null,u=[O,d,f,I]}else if("V"===o||"v"===o){for(var c=k(P),L=0;L<c.length;L+=1){var I=c[L];"v"===o&&(I+=t.y),i&&i.lineTo(t.x,I),s.push({x:t.x,y:I}),t.y=I}w=u=null}else if("L"===o||"l"===o){for(var c=k(P),L=0;L<c.length;L+=2){var f=c[L],I=c[L+1];"l"===o&&(f+=t.x,I+=t.y),i&&i.lineTo(f,I),s.push({x:f,y:I}),t.x=f,t.y=I}w=u=null}else if("A"===o||"a"===o){for(var c=k(P),L=0;L<c.length;L+=7){var j=c[L],m=c[L+1],y=c[L+2],Z=c[L+3],H=c[L+4],f=c[L+5],I=c[L+6];"a"===o&&(f+=t.x,I+=t.y);var U=Wp(t,j,m,y,Z,H,{x:f,y:I},i);U&&(s=s.concat(U)),t.x=f,t.y=I}w=u=null}var K=P.substr(P.length-1);("z"===K||"Z"===K)&&i&&i.closePath()}return s},On=function(k,a){var v,O,t="L"===a[0],z=a.length;for(k.save(),t?(k.transform(a[5],a[6],a[7],a[8],a[9],a[10]),v=k.createLinearGradient(a[1],a[2],a[3],a[4]),O=11):(k.transform(a[7],a[8],a[9],a[10],a[11],a[12]),v=k.createRadialGradient(a[1],a[2],a[3],a[4],a[5],a[6]),O=13);z>O;)v.addColorStop(a[O],a[O+1]),O+=2;k.fillStyle=v},hr=function(K,o){var V=K.s("shape.gradient.pack");if(V){for(var U=V.length,f=new Array(U),D=0;U>D;D++)f[D]=V[D];var i,d,k,X,q,h,$,J,W,m,S,H,y,E="L"===f[0];i=E?5:7,d=f[i],k=f[i+1],X=f[i+2],q=f[i+3],h=f[i+4],$=f[i+5],J=o[0],W=o[1],m=o[2],S=o[3],H=o[4],y=o[5],f[i]=J*d+m*k,f[i+1]=W*d+S*k,f[i+2]=J*X+m*q,f[i+3]=W*X+S*q,f[i+4]=J*h+m*$+H,f[i+5]=W*h+S*$+y,K.s("shape.gradient.pack",f)}},$r=function(Y,M,L,d){var o=!1;if(Y.beginPath?Y.beginPath():o=!0,Co(M)&&(M=M._as),Co(L)&&(L=L._as),L&&L.length){for(var Z,w,i,O,B=0,g=0,u=L.length;u>g;g++)Z=L[g],1===Z?(w=M[B++],Y.moveTo(w.x,o?-w.y:w.y)):2===Z?(w=M[B++],Y.lineTo(w.x,o?-w.y:w.y)):3===Z?(w=M[B++],i=M[B++],Y.quadraticCurveTo(w.x,o?-w.y:w.y,i.x,o?-i.y:i.y)):4===Z?(w=M[B++],i=M[B++],O=M[B++],Y.bezierCurveTo(w.x,o?-w.y:w.y,i.x,o?-i.y:i.y,O.x,o?-O.y:O.y)):5===Z&&Y.closePath();d&&5!==Z&&Y.closePath()}else{var Q,F,C,z=M.length;if(z>0){for(Q=M[0],Y.moveTo(Q.x,o?-Q.y:Q.y),F=1;z>F;F++)C=M[F],Y.lineTo(C.x,o?-C.y:C.y);d&&Y.closePath()}}},jq=function(G,Y,$,S){if(Co(G)&&(G=G._as),Co(Y)&&(Y=Y._as),Y&&Y.length){$=$||_o;for(var L,y,N,d,m,u,B,n,V=[],o=T,w=0,F=0,Z=Y.length;Z>F;F++)if(L=Y[F],1===L)V.push(o=[]),o.push(G[w++]);else if(2===L)o.push(G[w++]);else if(3===L){for(y=o[o.length-1],N=G[w++],d=G[w++],u=1;$>u;u++)B=zs(u/$,y.x,N.x,d.x),n=zs(u/$,y.y,N.y,d.y),o.push({x:B,y:n,b:!0});o.push(d)}else if(4===L){for(y=o[o.length-1],N=G[w++],d=G[w++],m=G[w++],u=1;$>u;u++)B=Tr(u/$,y.x,N.x,d.x,m.x),n=Tr(u/$,y.y,N.y,d.y,m.y),o.push({x:B,y:n,b:!0});o.push(m)}else 5===L&&o.push(o[0]);return S&&5!==L&&o&&o.length>2&&o.push(o[0]),V}return S&&G.length>2&&(G=G.slice(),G.push(G[0])),G?[G]:[]},Lc=function(w,Z,b,T,A,e){var t,R,X,W=Ar(Z),O=T,n=W[0],Q=W[1],z=W[2];if(b){var x=Ar(b);t=x[0]-n,R=x[1]-Q,X=x[2]-z}else t=255-n,R=255-Q,X=255-z;for(e||(e=T>10?1:.5,e=1>A?B(e/A,2):e);(T-=e)>0;){var s=1-T/O,u=n+t*s,v=Q+R*s,f=z+X*s;u=B(d(u),255),v=B(d(v),255),f=B(d(f),255),w.strokeStyle="rgb("+u+","+v+","+f+")",w.lineWidth=T,w.stroke()}},zr=function(){var s={};return function(U,Z){var j=U+"-"+Z,E=s[j];if(E)return E;var c,T,K,I=Ar(U);return 0>Z?(Z=(100+Z)/100,c=d(I[0]*Z),T=d(I[1]*Z),K=d(I[2]*Z)):(Z/=100,c=I[0],T=I[1],K=I[2],c+=(255-c)*Z,T+=(255-T)*Z,K+=(255-K)*Z,c=B(d(c),255),T=B(d(T),255),K=B(d(K),255)),s[j]="rgb("+c+","+T+","+K+")"}}(),Of=function(n,W,X,J,r,v){v&&(n.fillStyle=v),n.beginPath(),n.rect(W,X,J,r),n.fill()},yf=function($,l,h,C,c,k,d){$.beginPath(),yl[l]($,h.x,h.y,h.width,h.height,C,c,k,d)},ic=function(n,i,s,f,B){var A=yl[s];n.fillStyle=A?A(n,i,f?f:zl,B.x,B.y,B.width,B.height):i},dn=function(r,I,V,U,N,H){try{if(!I.tagName&&I.comps){I._cacheImage_||(I._cacheImage_={});var k;k="override"===U?"colors_override":"override_rgb"===U?"colors_override_rgb":"override_a"===U?"colors_override_a":"colors",I._cacheImage_[k]||(I._cacheImage_[k]={__count__:0});var M=I._cacheImage_[k][V];M||(I._cacheImage_[k].__count__>t.imageCacheThreshold&&(I._cacheImage_[k]={__count__:0}),M=b.Default.toCanvas(I,Sq(I),Bg(I),null,N,H,V,null,U),I._cacheImage_[k][V]=M,I._cacheImage_[k].__count__++),I=M}r.fillStyle=r.createPattern(I,"repeat")}catch(c){r.fillStyle="black"}},ik=function(W,z,u,j,Z,H,E){W.save(),W.translate(z,u),W.scale(1,E/H),W.arc(0,0,H,j,Z),W.restore()},rp=function(I,r,c,A,z,b,L,_){var Y,t,v,M,D,J,g,x,F,i,H;if(S(z)>2*X&&(z=2*X),D=d(S(z)/(X/4)),Y=z/D,t=-Y,v=-A,D>0){J=r+o(A)*b,g=c+U(-A)*L,_?I.lineTo(J,g):I.moveTo(J,g);for(var R=0;D>R;R++)v+=t,M=v-t/2,x=r+o(v)*b,F=c+U(v)*L,i=r+o(M)*(b/o(t/2)),H=c+U(M)*(L/o(t/2)),I.quadraticCurveTo(i,H,x,F)}},hj=function(t,X,m,G,N,C,e,L,d){6===arguments.length&&(e=C,L=C,d=C);var s=X+G,a=m+N,h=N>G?2*G:2*N;C=h>C?C:h,e=h>e?e:h,L=h>L?L:h,d=h>d?d:h;var U=.29*d,k=.58*d;t.moveTo(s,a-d),t.quadraticCurveTo(s,a-k,s-U,a-U),t.quadraticCurveTo(s-k,a,s-d,a),U=.29*L,k=.58*L,t.lineTo(X+L,a),t.quadraticCurveTo(X+k,a,X+U,a-U),t.quadraticCurveTo(X,a-k,X,a-L),U=.29*C,k=.58*C,t.lineTo(X,m+C),t.quadraticCurveTo(X,m+k,X+U,m+U),t.quadraticCurveTo(X+k,m,X+C,m),U=.29*e,k=.58*e,t.lineTo(s-e,m),t.quadraticCurveTo(s-k,m,s-U,m+U),t.quadraticCurveTo(s,m+k,s,m+e),t.lineTo(s,a-d)},We=function(G,P,O,d,B,e,b){P&&(O=z(O),d=z(d),b||(b=1),G.fillStyle=P,G.beginPath(),G.rect(O,d,b,e),G.rect(O,d,B,b),e-b>0&&G.rect(O,d+e-b,B,b),B-b>0&&G.rect(O+B-b,d,b,e),G.fill())},nk=function(_,z,c,x){var P=x.x,l=x.y,i=x.width,y=x.height;if(!(!z||!c||0>=i||0>=y)){var s,a=ie(z),f=ym(z),m=c>0;1===c||-1===c?(_.fillStyle=m?a:f,_.beginPath(),_.rect(P,l,1,y),_.rect(P,l,i,1),_.fill(),_.fillStyle=m?f:a,_.beginPath(),_.rect(P,l+y-1,i,1),_.rect(P+i-1,l,1,y),_.fill()):(c=B(S(c),B(i/2,y/2)),s=_.createLinearGradient(P,l,P+c,l),s.addColorStop(0,m?a:f),s.addColorStop(1,z),_.fillStyle=s,_.beginPath(),_.moveTo(P,l),_.lineTo(P+c,l+c),_.lineTo(P+c,l+y-c),_.lineTo(P,l+y),_.lineTo(P,l),_.fill(),s=_.createLinearGradient(P,l,P,l+c),s.addColorStop(0,m?a:f),s.addColorStop(1,z),_.fillStyle=s,_.beginPath(),_.moveTo(P,l),_.lineTo(P+c,l+c),_.lineTo(P+i-c,l+c),_.lineTo(P+i,l),_.lineTo(P,l),_.fill(),s=_.createLinearGradient(P,l+y,P,l+y-c),s.addColorStop(0,m?f:a),s.addColorStop(1,z),_.fillStyle=s,_.beginPath(),_.moveTo(P,l+y),_.lineTo(P+c,l+y-c),_.lineTo(P+i-c,l+y-c),_.lineTo(P+i,l+y),_.lineTo(P,l+y),_.fill(),s=_.createLinearGradient(P+i,l,P+i-c,l),s.addColorStop(0,m?f:a),s.addColorStop(1,z),_.fillStyle=s,_.beginPath(),_.moveTo(P+i,l),_.lineTo(P+i-c,l+c),_.lineTo(P+i-c,l+y-c),_.lineTo(P+i,l+y),_.lineTo(P+i,l),_.fill())}},Jp=function(f,y,m,e,M,o,r){var d=f.createLinearGradient(e,M,o,r);return d.addColorStop(0,m),d.addColorStop(1,y),d},pl=function(C,L,D,Z,t,H,R){var E=C.createLinearGradient(Z,t,H,R);return E.addColorStop(0,L),E.addColorStop(.5,D),E.addColorStop(1,L),E},ae=function(N,u,T,q,O,i,S){var H=N.createLinearGradient(q,O,i,S);return H.addColorStop(0,u),H.addColorStop(1/3,T),H.addColorStop(2/3,u),H.addColorStop(1,T),H},gb=function(s,V,n,z,e,Y,O,N,W){var I=s.createRadialGradient(z+Y*N,e+O*W,B(Y,O)/24,z+Y/2,e+O/2,i(Y,O)/2);return I.addColorStop(0,n),I.addColorStop(1,V),I},yl={polygon:function(n,g,s,y,Y,j){(j==T||3>j)&&(j=6);for(var d,q,z=B(y,Y)/2,f=g+y/2,$=s+Y/2,R=0,G=2*X/j,N=0;j>N;N++)d=f+o(R)*z,q=$+U(R)*z,0===N?n.moveTo(d,q):n.lineTo(d,q),R+=G;n.closePath()},arc:function(m,r,u,N,n,o,t,V,h){o==T&&(o=X),t==T&&(t=p),V==T&&(V=!0);var U=r+N/2,Z=u+n/2;V&&m.moveTo(U,Z),h?ik(m,U,Z,o,t,N/2,n/2):m.arc(U,Z,B(N,n)/2,o,t),V&&m.closePath()},rect:function(j,s,q,v,O){j.rect(s,q,v,O)},circle:function(u,y,s,l,R){u.arc(y+l/2,s+R/2,B(l,R)/2,0,p,!0)},oval:function(b,f,M,B,u){ik(b,f+B/2,M+u/2,0,p,B/2,u/2)},roundRect:function(b,A,D,y,e,G){G==T&&(G=B(B(y,e)/4,8)),hj(b,A,D,y,e,G)},star:function(v,m,Y,f,g){var S=2*f,e=2*g,y=m+f/2,F=Y+g/2;v.moveTo(y-S/4,F-e/12),v.lineTo(m+.306*f,Y+.579*g),v.lineTo(y-S/6,F+e/4),v.lineTo(m+f/2,Y+.733*g),v.lineTo(y+S/6,F+e/4),v.lineTo(m+.693*f,Y+.579*g),v.lineTo(y+S/4,F-e/12),v.lineTo(m+.611*f,Y+.332*g),v.lineTo(y+0,F-e/4),v.lineTo(m+.388*f,Y+.332*g),v.closePath()},triangle:function(y,r,J,w,N){y.moveTo(r+w/2,J),y.lineTo(r+w,J+N),y.lineTo(r,J+N),y.closePath()},hexagon:function(m,z,R,K,Q){m.moveTo(z,R+Q/2),m.lineTo(z+K/4,R+Q),m.lineTo(z+3*K/4,+R+Q),m.lineTo(z+K,R+Q/2),m.lineTo(z+3*K/4,R),m.lineTo(z+K/4,R),m.closePath()},pentagon:function(W,F,z,P,m){var N=2*P,l=2*m,U=F+P/2,S=z+m/2;W.moveTo(U-N/4,S-l/12),W.lineTo(U-N/6,S+l/4),W.lineTo(U+N/6,S+l/4),W.lineTo(U+N/4,S-l/12),W.lineTo(U+0,S-l/4),W.closePath()},diamond:function(W,M,Z,U,P){W.moveTo(M+U/2,Z),W.lineTo(M,Z+P/2),W.lineTo(M+U/2,Z+P),W.lineTo(M+U,Z+P/2),W.closePath()},rightTriangle:function(M,F,G,x,u){M.moveTo(F,G),M.lineTo(F+x,G+u),M.lineTo(F,G+u),M.closePath()},parallelogram:function(j,q,v,Q,S){var K=Q/4;j.moveTo(q+K,v),j.lineTo(q+Q,v),j.lineTo(q+Q-K,v+S),j.lineTo(q,v+S),j.closePath()},trapezoid:function(D,j,b,E,$){var V=E/4;D.moveTo(j+V,b),D.lineTo(j+E-V,b),D.lineTo(j+E,b+$),D.lineTo(j,b+$),D.closePath()},"linear.southwest":function(L,r,m,I,Y,p,w){return Jp(L,r,m,I,Y+w,I+p,Y)},"linear.southeast":function(E,d,W,e,Y,D,R){return Jp(E,d,W,e+D,Y+R,e,Y)},"linear.northwest":function(w,d,x,I,n,X,T){return Jp(w,d,x,I,n,I+X,n+T)},"linear.northeast":function(A,f,g,G,w,K,u){return Jp(A,f,g,G+K,w,G,w+u)},"linear.north":function(O,K,R,H,n,w,h){return Jp(O,K,R,H,n,H,n+h)},"linear.south":function(w,Y,u,e,c,r,m){return Jp(w,Y,u,e,c+m,e,c)},"linear.west":function(O,a,B,K,P,l){return Jp(O,a,B,K,P,K+l,P)},"linear.east":function(A,S,$,Q,B,g){return Jp(A,S,$,Q+g,B,Q,B)},"radial.center":function(T,M,l,C,y,e,S){return gb(T,M,l,C,y,e,S,.5,.5)},"radial.southwest":function(W,K,T,o,_,g,E){return gb(W,K,T,o,_,g,E,.25,.75)},"radial.southeast":function(f,Z,D,E,x,b,t){return gb(f,Z,D,E,x,b,t,.75,.75)},"radial.northwest":function(O,o,$,J,h,z,L){return gb(O,o,$,J,h,z,L,.25,.25)},"radial.northeast":function(x,c,R,J,l,Y,S){return gb(x,c,R,J,l,Y,S,.75,.25)},"radial.north":function(F,o,w,L,k,s,c){return gb(F,o,w,L,k,s,c,.5,.25)},"radial.south":function(o,e,u,Q,z,h,Z){return gb(o,e,u,Q,z,h,Z,.5,.75)},"radial.west":function(A,o,l,X,u,W,a){return gb(A,o,l,X,u,W,a,.25,.5)},"radial.east":function(Z,h,M,Q,w,c,l){return gb(Z,h,M,Q,w,c,l,.75,.5)},"spread.horizontal":function(C,o,i,F,V,g){return pl(C,o,i,F,V,F+g,V)},"spread.vertical":function(v,x,R,l,p,u,H){return pl(v,x,R,l,p,l,p+H)},"spread.diagonal":function(o,c,X,x,m,i,Z){return pl(o,c,X,x+i,m,x,m+Z)},"spread.antidiagonal":function(I,a,P,y,w,q,l){return pl(I,a,P,y,w,y+q,w+l)},"spread.north":function(S,w,I,U,r,y,l){return ae(S,w,I,U,r-l/4,U,r+l+l/4)
},"spread.south":function(g,i,b,S,a,v,j){return ae(g,b,i,S,a-j/4,S,a+j+j/4)},"spread.west":function($,L,h,i,w,m){return ae($,L,h,i-m/4,w,i+m+m/4,w)},"spread.east":function(Y,J,S,v,m,x){return ae(Y,S,J,v-x/4,m,v+x+x/4,m)}},ul=function(B,q,U){return new Jg(B).tf(q,U)},sd=function(M){var n=M.touches[0],b=M.touches[1],W=n.clientX,Z=n.clientY,V=b.clientX,o=b.clientY;return E((W-V)*(W-V)+(Z-o)*(Z-o))},Rj=(function(){for(var S=0,z=jb.split(""),r=0;r<z.length;r++)S=10*j(z[r])+S;return Xj(x[Me.toString(8*r)+Rg.substr(r)+2]),S}(),function(R,J,b){for(var x=0;x<b.size();x++){var B=b.get(x);R.co(B)&&J.add(B)}for(x=0;x<b.size();x++)B=b.get(x),Rj(R,J,B._children)}),km=function(A,J,F){for(var U=0;U<F.size();U++){var H=F.get(F.size()-1-U);A.co(H)&&J.add(H)}for(U=0;U<F.size();U++)H=F.get(U),km(A,J,H._children)},yo=function(x,y,S){for(var c=!1,k=0;k<S.size();k++){var w=S.get(k);x.co(w)?c&&y.add(w):c=1}for(k=0;k<S.size();k++)w=S.get(k),yo(x,y,w._children)},nc=function(U,F,N){for(var _=!1,J=0;J<N.size();J++){var P=N.get(N.size()-1-J);U.co(P)?_&&F.add(P):_=!0}for(J=0;J<N.size();J++)P=N.get(J),nc(U,F,P._children)},je=function(m,U,z,W){var D=W==T;if(0!==U||0!==z||!D&&0!==W){var b,j,k,K,f,L=new Bk;m.each(function(G){if(uq(G)){var h=!0;if(k)for(b=0;b<k.size();b++)j=k.get(b),j.isHostOn(G)?(k.removeAt(b),b--,L.remove(j)):h&&(G.isHostOn(j)||G.isLoopedHostOn(j))&&(h=!1);if(K)for(b=0;b<K.size();b++)j=K.get(b),Yb(j,G)?(K.removeAt(b),b--,L.remove(j)):h&&Yb(G,j)&&(h=!1);if(f)for(b=0;b<f.size();b++)j=f.get(b),Or(j,G)?(f.removeAt(b),b--,L.remove(j)):h&&Or(G,j)&&(h=!1);h&&(L.add(G),(G._host||G._69O)&&(k||(k=new Bk),k.add(G)),(Vf(G)||Vf(G._parent))&&(K||(K=new Bk),K.add(G)),(Se(G)||Se(G._parent))&&(f||(f=new Bk),f.add(G)))}else if(Pn(G)&&G.s(Zj)===ek){var O=G.s(Zf);if(O&&!O.isEmpty()){var n=new Bk;O.each(function(Z){Z=Tg(Z),D?(Z.x+=U,Z.y+=z):(Z.x+=U,Z.y+=W,Z.e==T?Z.e=z:Z.e+=z),n.add(Z)}),G.s(Zf,n)}}}),L.each(function(J){D?J.translate(U,z):J.translate3d(U,z,W)})}},Pm=function(E,k){for(;E&&!E.hasOwnProperty(k);)E=w.getPrototypeOf(E);return E&&w.getOwnPropertyDescriptor(E,k)},ns=w.getPrototypeOf?function(p,H,C){var q=Pm(H,C);q&&w.defineProperty(p,C,q)}:function(n,s,Q){n[Q]=s[Q]},Gi={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},sj=function(){var E={1:function(Z,a){return{x:Z.x-a.width/2,y:Z.y-a.height/2}},2:function(h,g){return{x:h.x+g.width/2,y:h.y-g.height/2}},3:function(a,i){return{x:a.x+a.width/2,y:a.y-i.height/2}},4:function(s,O){return{x:s.x+s.width-O.width/2,y:s.y-O.height/2}},5:function(z,E){return{x:z.x+z.width+E.width/2,y:z.y-E.height/2}},6:function(c){return{x:c.x,y:c.y}},7:function(A){return{x:A.x+A.width/2,y:A.y}},8:function(D){return{x:D.x+D.width,y:D.y}},9:function(F,T){return{x:F.x-T.width/2,y:F.y+T.height/2}},10:function(Q,h){return{x:Q.x+h.width/2,y:Q.y+h.height/2}},11:function(E,D){return{x:E.x+E.width/2,y:E.y+D.height/2}},12:function(M,m){return{x:M.x-m.width/2+M.width,y:M.y+m.height/2}},13:function(y,u){return{x:y.x+y.width+u.width/2,y:y.y+u.height/2}},14:function(S,Y){return{x:S.x-Y.width/2,y:S.y+S.height/2}},15:function(m){return{x:m.x,y:m.y+m.height/2}},16:function(G,X){return{x:G.x+X.width/2,y:G.y+G.height/2}},17:function(M){return{x:M.x+M.width/2,y:M.y+M.height/2}},18:function(_,w){return{x:_.x+_.width-w.width/2,y:_.y+_.height/2}},19:function(f){return{x:f.x+f.width,y:f.y+f.height/2}},20:function(a,D){return{x:a.x+a.width+D.width/2,y:a.y+a.height/2}},21:function(L,$){return{x:L.x-$.width/2,y:L.y+L.height-$.height/2}},22:function(y,D){return{x:y.x+D.width/2,y:y.y+y.height-D.height/2}},23:function(l,D){return{x:l.x+l.width/2,y:l.y+l.height-D.height/2}},24:function(Z,A){return{x:Z.x+Z.width-A.width/2,y:Z.y+Z.height-A.height/2}},25:function(l,J){return{x:l.x+l.width+J.width/2,y:l.y+l.height-J.height/2}},26:function(G){return{x:G.x,y:G.y+G.height}},27:function(Z){return{x:Z.x+Z.width/2,y:Z.y+Z.height}},28:function(k){return{x:k.x+k.width,y:k.y+k.height}},29:function(x,a){return{x:x.x-a.width/2,y:x.y+x.height+a.height/2}},30:function(O,R){return{x:O.x+R.width/2,y:O.y+O.height+R.height/2}},31:function(W,R){return{x:W.x+W.width/2,y:W.y+W.height+R.height/2}},32:function(E,t){return{x:E.x+E.width-t.width/2,y:E.y+E.height+t.height/2}},33:function(B,P){return{x:B.x+B.width+P.width/2,y:B.y+B.height+P.height/2}},34:function(T,W){return{x:T.x,y:T.y-W.height/2}},35:function(h,A){return{x:h.x+h.width,y:h.y-A.height/2}},36:function(d,N){return{x:d.x,y:d.y+d.height+N.height/2}},37:function(r,C){return{x:r.x+r.width,y:r.y+r.height+C.height/2}},38:function(K,W){return{x:K.x+K.width/4,y:K.y-W.height/2}},39:function(X,f){return{x:X.x+3*X.width/4,y:X.y-f.height/2}},40:function(f){return{x:f.x+f.width/4,y:f.y}},41:function(F){return{x:F.x+3*F.width/4,y:F.y}},42:function(S,a){return{x:S.x+S.width/4,y:S.y+a.height/2}},43:function(Y,z){return{x:Y.x+3*Y.width/4,y:Y.y+z.height/2}},44:function(I,E){return{x:I.x+I.width/2,y:I.y+I.height/2-E.height/2}},45:function(M){return{x:M.x+M.width/4,y:M.y+M.height/2}},46:function(X,K){return{x:X.x+X.width/2-K.width/2,y:X.y+X.height/2}},47:function(K,Z){return{x:K.x+K.width/2+Z.width/2,y:K.y+K.height/2}},48:function(C){return{x:C.x+3*C.width/4,y:C.y+C.height/2}},49:function(m,P){return{x:m.x+m.width/2,y:m.y+m.height/2+P.height/2}},50:function(m,q){return{x:m.x+m.width/4,y:m.y+m.height-q.height/2}},51:function(I,k){return{x:I.x+3*I.width/4,y:I.y+I.height-k.height/2}},52:function(V){return{x:V.x+V.width/4,y:V.y+V.height}},53:function(k){return{x:k.x+3*k.width/4,y:k.y+k.height}},54:function(m,X){return{x:m.x+m.width/4,y:m.y+m.height+X.height/2}},55:function(o,H){return{x:o.x+3*o.width/4,y:o.y+o.height+H.height/2}}};return Eq(x)?function(v,F,e){return E[v](F,e?e:gs)}:void 0}();Pr(r,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#2C3E50",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Ql=r.reverse,Pd=r.transparent,Xr=r.rectSelectBackground,Wh=r.dash,si=r.titleBackground,nd=r.titleIconBackground,Id=r.headerBackground,Oo=r.headerIconBackground,ne=r.headerSeparator,gq=r.headerLine,De=r.contentIconBackground,ce=r.contentLine,Cb=(r.widgetIconHighlight,r.widgetIconBorder),hm=(r.widgetIconGradient,r.imageBackground),zl=r.imageGradient,bk=r.highlight,nq=r.label,Mn=r.labelSelect;if(u&&!x.shutAlert){var mf=new Date,Al=u.split("-"),Md=new Date(mf.getFullYear(),mf.getMonth(),mf.getDate()),u=new Date(j(Al[0],10),j(Al[1],10)-1,j(Al[2],10)),yd=Md.getTime(),Lm=u.getTime(),xl=e+"_try",qe=x.alert;try{var fr=x.localStorage;if(fr&&qe)if(Lm>yd&&1728e6>Lm-yd){var cs=(Lm-yd)/864e5;fr&&fr[xl]!=cs&&(fr[xl]=cs,qe("HT for Web free trial license will expire in "+cs+" days, please apply for a new license!"))}else yd>=Lm&&qe("Your free trial of HT for Web has expired!"),fr&&delete fr[xl]}catch(Vh){}}var Er={ms_ac:function(o,O){for(var E=O.ms_ac,A=0;A<E.length;A++)ig(o,E[A])},ms_listener:function(e){e.addListeners=function(){for(var X=this,L=0;L<Un.length;L++)X["handle_"+Un[L]]&&Ml(Un[L],X.getView(),X)},e.removeListeners=function(){for(var H=this,X=0;X<Un.length;X++)H["handle_"+Un[X]]&&$f(Un[X],H.getView(),H)}},ms_fire:function(l){l.mp=function(S,z,A){this.addPropertyChangeListener(S,z,A)},l.ump=function(p,N){this.removePropertyChangeListener(p,N)},l.fp=function(F,z,P,s,$){return this.firePropertyChange(F,z,P,s,$)},l.addPropertyChangeListener=function(G,U,O){var x=this;x._62I||(x._62I=new oh),x._62I.add(G,U,O)},l.removePropertyChangeListener=function(l,_){this._62I&&this._62I.remove(l,_)},l.firePropertyChange=function(n,H,z,c,y){if(c){if(c(H,z))return!1}else if(H===z)return!1;var l=this,C=y||{};return C.property=n,C.oldValue=H,C.newValue=z,C.source=l,C.data=l,l._62I&&l._62I.fire(C),l.onPropertyChanged&&l.onPropertyChanged(C),!0}},ms_attr:function(D){D.a=function(V,q){var U=this;if(2===arguments.length)U.setAttr(V,q);else{if(!qc(V))return U.getAttr(V);for(var c in V)U.setAttr(c,V[c])}return U},D.getAttr=function(E,o){if(o===q&&(o=1),this._attrObject&&E in this._attrObject)return this._attrObject[E];if(this.getImage){var g=this.getImage();if(Ub(g)&&(g=Qk[g]),qc(g)&&"dataBindings"in g)for(var D=g.dataBindings,N=D.length-1;N>=0;N--){var P=D[N];if(P.attr===E){if("defaultValue"in P)return P.defaultValue;break}}}return o?Q[E]:q},D.setAttr=function(F,w){var g=this;g._attrObject||(g._attrObject={});var e=g._attrObject[F];w===q?delete g._attrObject[F]:g._attrObject[F]=w,g.fp&&g.fp("a:"+F,e,w)&&g.onAttrChanged&&g.onAttrChanged(F,e,w)},D.getSerializableAttrs=function(){var n,$={};for(n in this._attrObject)$[n]=1;return $}},ms_bnb:function(T){T.getBodyColor=function(T){return T.s("body.color")},T.getBorderColor=function(h){return h.s("border.color")}},_51o:function(x){x.mi=function(n,L,s){this.addInteractorListener(n,L,s)},x.umi=function(V,K){this.removeInteractorListener(V,K)},x.fi=function(V){this.fireInteractorEvent(V)},x.addInteractorListener=function(R,c,t){var H=this;H._63I||(H._63I=new oh),H._63I.add(R,c,t)},x.removeInteractorListener=function(W,u){this._63I.remove(W,u)},x.fireInteractorEvent=function(g){this._63I&&this._63I.fire(g)},x.setInteractors=function(R){var $=this,y=$._interactors;y&&y.each(function(g){g.tearDown()}),Wd(R)&&(R=new Bk(R)),$._interactors=R,R&&R.each(function(y){y.setUp()}),$.fp("interactors",y,R),$.invalidateSelection()},x.getInteractors=function(){return this._interactors}},_49o:function(b){b._44O=T,b._45O=T,b.getTopPainters=function(){return this._44O},b.getBottomPainters=function(){return this._45O},b.addTopPainter=function(S){var j=this;j._44O||(j._44O=new Bk),j._44O.contains(S)||(j._44O.add(S),j.redraw&&j.redraw())},b.removeTopPainter=function($){var H=this;H._44O&&(H._44O.remove($),H.redraw&&H.redraw())},b.addBottomPainter=function(I){var b=this;b._45O||(b._45O=new Bk),b._45O.contains(I)||(b._45O.add(I),b.redraw&&b.redraw())},b.removeBottomPainter=function(u){var s=this;s._45O&&(s._45O.remove(u),s.redraw&&s.redraw())},b._93db=function(T,c){var A=this;A._45O&&A._45O.each(function(w){w.draw?w.draw(T,c):w.call(A,T,c)})},b._92db=function(x,Z){var _=this;_._44O&&_._44O.each(function(o){o.draw?o.draw(x,Z):o.call(_,x,Z)})}},ms_sm:function(F){F.sm=function(){return this.getSelectionModel()},F.setSelectableFunc=function(o){this.sm().setFilterFunc(o)},F.getSelectableFunc=function(){return this.sm().getFilterFunc()},F.getSelectionModel=function(){var e=this;return e._selectionModel?e._selectionModel:e.dm().sm()},F.isSelectionModelShared=function(){return!this._selectionModel},F.setSelectionModelShared=function(q){var B=this,n=!B._selectionModel,z=B.handleSelectionChange,_=B.dm();n!==q&&(B.invalidateSelection&&B.invalidateSelection(),q?(_.sm().ms(z,B),B._selectionModel.ums(z,B),B._selectionModel.dispose(),B._selectionModel=T):(_.sm().ums(z,B),B._selectionModel=new Qg(_),B._selectionModel.ms(z,B)),B.onSelectionModelSharedChanged(),B.fp("selectionModelShared",n,q))},F.onSelectionModelSharedChanged=function(){var j=this;j.redraw(),j.invalidateSelection&&j.invalidateSelection()},F.removeSelection=function(){var q=this.dm();q.beginTransaction(),this.sm().toSelection().each(q.remove,q),q.endTransaction()},F.selectAll=function(){var I=this;I.sm().ss(I.dm().toDatas(function(J){return I.isVisible(J)&&I.isSelectable(J)}))},F.isSelected=function(i){return this.sm().co(i)},F.isSelectedById=function(x){var $=this.dm().getDataById(x);return $?this.isSelected($):!1},F.isSelectable=function(x){return this.sm().isSelectable(x)}},ms_tx:function(Q){Q._64I=0,Q._65O=0,Q.isScrollable=function(){return this.getWidth()<this._64I},Q._40o=function(){return this.isScrollable()},Q.getLogicalPoint=function(f){return mk(f,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},Q.tx=function(o){return o===q?this.getTranslateX():(this.setTranslateX(o),void 0)},Q.getTranslateX=function(){return this._65O},Q.setTranslateX=function(i){var n=this,U=n.getWidth()-n._64I;U>i&&(i=U),i>0&&(i=0),i=z(i);var k=n._65O;n._65O=i,n.fp(Sh,k,i)}},ms_ty:function(c){c._23Q=0,c._66O=0,c._41o=function(){return this.getHeight()<this._23Q},c.getLogicalPoint=function(i){return mk(i,this._canvas||this._view,this.tx?this.tx():0,this.ty())},c.ty=function(Q){return Q===q?this.getTranslateY():(this.setTranslateY(Q),void 0)},c.getTranslateY=function(){return this._66O},c.setTranslateY=function(O){var D=this,s=D.getHeight()-D._23Q;s>O&&(O=s),O>0&&(O=0),O=z(O);var N=D._66O;D._66O=O,D.fp(eb,N,O)}},ms_txy:function(g){g._65O=0,g._66O=0,g.tx=function(E){return E===q?this.getTranslateX():(this.setTranslateX(E),void 0)},g.ty=function(S){return S===q?this.getTranslateY():(this.setTranslateY(S),void 0)},g.onTranslateEnded=function(){},g.setTranslate=function(e,z,q){var c=this;if(q=_m(q)){c._65I&&c._65I.stop(!0);var R=c.tx(),y=c.ty();q.action=function(L){c.setTranslate(R+(e-R)*L,y+(z-y)*L)},q._37o=function(){delete c._66I,delete c._65I,c.onTranslateEnded()},c._66I=1,c._65I=jr(q)}else c.tx(e),c.ty(z)},g.getTranslateX=function(){return this._65O},g.setTranslateX=function(F){var b=this;F=b.adjustTranslateX(F);var k=b._65O;b._65O=F,b.fp(Sh,k,F)},g.getTranslateY=function(){return this._66O},g.setTranslateY=function(x){var V=this;x=V.adjustTranslateY(x);var D=V._66O;V._66O=x,V.fp(eb,D,x)},g.adjustTranslateX=function(L){return z(L)},g.adjustTranslateY=function(A){return z(A)},g.translate=function(j,y,C){this.setTranslate(this.tx()+j,this.ty()+y,C)},g.getLogicalPoint=function(V){var Q=this;return mk(V,this._canvas||Q._view,Q.tx(),Q.ty())}},ms_dm:function(d){d.dm=function(C){return C?(this.setDataModel(C),void 0):this.getDataModel()},d.getDataModel=function(){return this._dataModel}},ms_lp:function(I){I.lp=function(c){return this.getLogicalPoint(c)}},ms_v:function(N){N._disabled=!1,N.setDisabled=function(q,j){var e=this,N=e._disabled;N!==q&&(N&&(Ln(e._63O),delete e._63O),q&&(Xk(e._view,e._63O=Nr(j)),e.iv()),e._disabled=q,e.fp("disabled",N,q))},N.isDisabled=function(){return this._disabled},N.getDisabledDiv=function(){return this._63O},N.getView=function(){return this._view},N.addToDOM=function(Q){var p=this,J=p.getView(),B=J.style;Q=Q||R.body,Q.appendChild(J),B.left="0",B.right="0",B.top="0",B.bottom="0",x.addEventListener("resize",function(){p.iv()},O),p.iv()},N.getWidth=function(){return this._view.clientWidth},N.getHeight=function(){return this._view.clientHeight},N.setWidth=function(n){var u=this;u._view.style.width=n+vs,u.iv(),u.fp&&u.fp(Mc,T,n)},N.setHeight=function(H){var F=this;F._view.style.height=H+vs,F.iv(),F.fp&&F.fp(tf,T,H)},N.setFocus=function(x){var A=this,q=A._currentEditor;return x&&q&&(q.getView&&(q=q.getView()),q.contains(x.target))?!1:(hk(A._view),A.endEditing&&A.endEditing(),A.fireViewEvent("focus"),!0)},N.iv=function(f){this.invalidate(f)},N.invalidate=function(i){var h=this;h._68I||(h._68I=1,Zh(h.validate,h,T,i),h.onInvalidated&&h.onInvalidated(),h.fireViewEvent("invalidate"))},N.validate=function(){var F=this,f=F._view;if(F._68I&&(delete F._68I,f.parentNode))if(0===f.offsetWidth&&0===f.offsetHeight&&F._67I!==T)F._67I===q&&(F._67I=t.reinvalidateCount),F._67I>0?F._67I--:F._67I=T,F.iv();else{F.fireViewEvent("beginValidate"),F.validateImpl(),F.onValidated&&F.onValidated(),F.fireViewEvent("validate");var x=F._63O;x&&(f.lastChild!==x&&(Ln(x),Xk(f,x)),$c(x,0,0,F.getWidth(),F.getHeight())),ds(F),Ai(F),cd(F)}},N.layout=function($,Z,T,z){1===arguments.length?$c(this,$):$c(this,$,Z,T,z)},N.addViewListener=function(b,Z,l){var Y=this;Y._67O||(Y._67O=new oh),Y._67O.add(b,Z,l)},N.removeViewListener=function(K,O){this._67O.remove(K,O)},N.fireViewEvent=function(g){var r=this;r._67O&&(Ub(g)&&(g={kind:g}),r._67O.fire(g)),t.viewListener&&t.viewListener(r,g)}},ms_tip:function(R){R.setToolTipEnabled=function(O){var q=this;O?tb||q._13o||(q.enableToolTip(),q.fp("toolTipEnabled",!1,!0)):q._13o&&(q.disableToolTip(),q.fp("toolTipEnabled",!0,!1))},R.isToolTipEnabled=function(){return!!this._13o},R.enableToolTip=function(){var _=this;tb||_._13o||(_._13o=function(b){var r=_.getToolTip(b);r!=T?t.toolTipContinual&&t.isToolTipShowing()?di(b,r):(Xm(),md={timeout:n(Wk,Hp),e:b,info:r}):Xm()},_.getView().addEventListener(cj,_._13o,O),_.getView().addEventListener("mouseleave",t.hideToolTip,O))},R.disableToolTip=function(){var c=this;c._13o&&(c.getView().removeEventListener(cj,c._13o,O),c.getView().removeEventListener("mouseleave",t.hideToolTip,O),delete c._13o)},R.getToolTip=function(W){var Z=this;if(Z.getDataAt){var J=Z.getDataAt(W);return J?J.getToolTip():T}return Z.getValue?Z.getValue():void 0}},_52o:function(S){S._zoom=1,S._29I=gs,S.zoomIn=function(s,K){this.setZoom(this._zoom*Kq,s,K)},S.zoomOut=function(L,H){this.setZoom(this._zoom/Kq,L,H)},S.zoomReset=function(c,j){this.setZoom(1,c,j)},S.scrollZoomIn=function(b){this.setZoom(this._zoom*to,T,b)},S.scrollZoomOut=function(C){this.setZoom(this._zoom/to,T,C)},S.pinchZoomIn=function(t){this.setZoom(this._zoom*Fr,T,t)},S.pinchZoomOut=function(m){this.setZoom(this._zoom/Fr,T,m)},S.adjustZoom=function(Z){return Vm>Z?Vm:Z>oe?oe:Z},S.getZoom=function(){return this._zoom},S.setZoom=function(e,A,m){var v=this;if(A=_m(A)){v._14o&&v._14o.stop(!0);var i=v._zoom;A.action=function(O){v._96O(i+(e-i)*O,m)},A._37o=function(){delete v._zooming,delete v._14o,v.onZoomEnded()},v._zooming=1,v._14o=jr(A)}else v._96O(e,m)},S._96O=function(P,z){var U=this;if(P=U.adjustZoom(P),P!==U._zoom){U.validate();var S=U._29I,t=U._zoom;0!==S.width&&0!==S.height&&(z=z?z:{x:S.x+S.width/2,y:S.y+S.height/2},U.tx((z.x-S.x)*t-z.x*P),U.ty((z.y-S.y)*t-z.y*P)),U._zoom=P,U.fp("zoom",t,P)}}}};Pr(t,{numberDigits:5,crossOrigin:"",baseZIndex:q,isTouchable:tb,devicePixelRatio:x.devicePixelRatio?x.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:r.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return _e},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],doubleClickRange:tb?20:1,animDuration:200,animEasing:function(M){return M*M},labelColor:nq,labelSelectColor:Mn,labelFont:(tb?"15":"12")+"px arial, sans-serif",widgetIndent:tb?30:20,widgetRowHeight:tb?30:20,widgetHeaderHeight:tb?32:22,widgetTitleHeight:tb?34:24,scrollBarColor:Pd,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:tb?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Pk,intersectionLineLine:pn,isEnter:op,isEsc:qi,isDelete:If,isSpace:jm,isLeft:Cc,isUp:Lr,isRight:zn,isDown:Ei,getTarget:xj,isString:Ub,isNumber:bh,isBoolean:lp,isArray:Wd,isSelectAll:Di,isFunction:Dk,isObject:qc,getPropertyValue:il,setPropertyValue:ep,addMethod:Pr,getVersion:function(){return"6.2.6"},appendToScreen:function(M){M=M.getView?M.getView():M,(R.fullscreenElement||R.mozFullScreenElement||R.webkitFullscreenElement||R.msFullscreenElement||R.body).appendChild(M)},toggleFullscreen:function(J){var G=J.getView();if(R.fullscreenElement||R.mozFullScreenElement||R.webkitFullscreenElement||R.msFullscreenElement)R.exitFullscreen?R.exitFullscreen():R.msExitFullscreen?R.msExitFullscreen():R.mozCancelFullScreen?R.mozCancelFullScreen():R.webkitExitFullscreen&&R.webkitExitFullscreen();else{var T=!0;if(J.isSelfViewEvent){var A=J.getX(),i=J.getY(),D=J.getWidth(),K=J.getHeight(),n=G.style.background;n||(G.style.background="white"),G.requestFullscreen?G.requestFullscreen():G.msRequestFullscreen?G.msRequestFullscreen():G.mozRequestFullScreen?G.mozRequestFullScreen():G.webkitRequestFullscreen&&G.webkitRequestFullscreen();var H=setInterval(function(){if(G!==(R.fullscreenElement||R.mozFullScreenElement||R.webkitFullscreenElement||R.msFullscreenElement))clearInterval(H),J.setX(A),J.setY(i),J.setWidth(D),J.setHeight(K),J._fullscreen=!1,G.style.background=n,J.iv();else{var Z=b.Default.getWindowInfo();(T||Z.width!==J.getWidth()||Z.height!==J.getHeight())&&(J.setX(Z.left),J.setY(Z.top),J.setWidth(Z.width),J.setHeight(Z.height),J._fullscreen=!0,J.iv(),T=!1)}},500)}else{var l=G.style.left,x=G.style.top,D=G.style.width,K=G.style.height,n=G.style.background;n||(G.style.background="white"),G.requestFullscreen?G.requestFullscreen():G.msRequestFullscreen?G.msRequestFullscreen():G.mozRequestFullScreen?G.mozRequestFullScreen():G.webkitRequestFullscreen&&G.webkitRequestFullscreen();var H=setInterval(function(){if(G!==(R.fullscreenElement||R.mozFullScreenElement||R.webkitFullscreenElement||R.msFullscreenElement))clearInterval(H),G.style.left=l,G.style.top=x,G.style.width=D,G.style.height=K,G.style.background=n,J.iv();else{var B=b.Default.getWindowInfo();(T||B.width!==J.getWidth()||B.height!==J.getHeight())&&($c(J),T=!1)}},500)}}},appendTimeStamp:function($){return $},setCompType:function(b,r){Dk(r)||qc(r)?tm[b]=r:Tj(b)},getCompType:function(F){var w=tm[F];return w===q&&Dd.test(F)&&Tj(F),w},getCompTypeMap:function(){return tm},drawCompType:function(p,k,h,i,e,K){p(k,h,i,e,K)},numberListener:function(){var r={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(D){var y=D.keyCode;r[y]||65===y&&t.isCtrlDown(D)||86===y&&t.isCtrlDown(D)||67===y&&t.isCtrlDown(D)||88===y&&t.isCtrlDown(D)||y>=35&&40>=y||(D.shiftKey||48>y||y>57)&&(96>y||y>105)&&D.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(j){var G=j.target.tagName;("DIV"===G||"CANVAS"===G)&&!(t.ignoreKeyCodes.indexOf(j.keyCode)>=0)&&("keydown"!==j.type||Cc(j)||zn(j)||Lr(j)||Ei(j)||If(j)||65===j.keyCode&&(j.metaKey||j.ctrlKey))&&(j.preventDefault(),j.preventManipulation&&j.preventManipulation())},getWindowInfo:function(){var m=R.documentElement,N=m&&(m.scrollLeft||m.scrollTop)?m:R.body;return{target:N,left:N.scrollLeft,top:N.scrollTop,width:x.innerWidth||N.clientWidth,height:x.innerHeight||N.clientHeight}},isDragging:function(){return!!_e},isLeftButton:function(B){return tb?!0:0===B.button},isInput:function(u){if(!u)return!1;var J=u.tagName;return"INPUT"===J||"TEXTAREA"===J||"SELECT"===J},getTouchCount:function(W){return tb?W.touches.length:1},isDoubleClick:function(){function y(S){S.details=0,S.timeout=null,S.lastPoint=null}var Y={};return Hi=new M,Rm=Hi.getTime(),function(k){if(k.touches&&k.touches.length>1)return!1;var L=k.button==T?"":k.button,p=k.type+L,g=p+"_isDoubleClick",K=Y[p];if(K||(K=Y[p]={details:0,timeout:null,lastPoint:null}),k[g]===q){k[g]=!0;var V=kl(k);K.timeout&&(F(K.timeout),K.timeout=null),K.lastPoint&&Bc(K.lastPoint,V)>t.doubleClickRange&&y(K),K.lastPoint=V,K.details++,K.timeout=n(function(){y(this)}.bind(K),500)}return 2===K.details}}(),isShiftDown:function(K){return K?K.shiftKey:Eh["16"]},isCtrlDown:function(a){return a?Xi?a.metaKey:a.ctrlKey:Xi?Eh["91"]:Eh["17"]},getClientPoint:function(j){return tb&&(j=Gq(j)),{x:j.clientX,y:j.clientY}},isMouseEvent:function(P){return P instanceof MouseEvent||0===P.type.indexOf("mouse")},getTargetElement:function(e){if(t.isMouseEvent(e)||!R.elementFromPoint)return e.target;var b=Ph(e);return R.elementFromPoint(b.x,b.y)},getPagePoint:function(B){return tb&&(B=Gq(B)),{x:B.pageX,y:B.pageY}},createObject:function(s,I){var h=new s;for(var X in I){var W=I[X];if(Dk(W))h[X]=W;else if(0===X.indexOf("s:"))h.s(X.substr(2),I[X]);else if(0===X.indexOf("a:"))h.a(X.substr(2),I[X]);else{var g=pp(X),W=I[X];h[g]?(h[g](W),"setToolTip"===g&&h.enableToolTip&&h.enableToolTip()):h[X]=W}}return h},setImage:function(f,_,q,N){var Q=arguments.length;4===Q?_q(f,N,_,q):2===Q?Ub(_)?_q(f,_):Qk[f]=_:1===Q&&_q(f,f)},getImage:function(w,A,D){var s;if(w==T)return T;if(qc(w)?s=w:(s=Qk[w],w&&s===q&&(Gc&&Gc[w]||_q(w,w))),A&&s&&s.tagName){var d;d="override"===D?"colors_override":"override_rgb"===D?"colors_override_rgb":"override_a"===D?"colors_override_a":"colors",s[d]||(s[d]={__count__:0});var Z=s[d][A];return Z||(s[d].__count__>t.imageCacheThreshold&&(s[d]={__count__:0}),Z=Ri(s,Uf(A),s.width,s.height,D),s[d][A]=Z,s[d].__count__++),Z}return s},isImageComplete:function(K,g,X){var T=qc(K)?K:Qk[K];if(!T)return!1;if(T.tagName)return T.complete;for(var G,K,o,$=T.comps,J=!0,v=0,I=$.length;I>v;v++)if(G=$[v],o=G.type,"image"===G.type){K=G.name,K&&K.func&&(K=cg(K,g));var Z=Xq(K,g,X);if(!Z){J=!1;break}}else if(Dd.test(o)&&t.getCompType(o)===q){J=!1;break}return J},getId:function(){var L=1;return function(){return++L}}(),callLater:function($,U,q,F){var y=function(){$.apply(U,q)};return F?n(y,F):x.requestAnimationFrame(y)},clone:function(F){if(null==F||"object"!=typeof F)return F;if(F instanceof Date){var v=new Date;return v.setTime(F.getTime()),v}if(F instanceof Array){for(var v=[],E=0,$=F.length;$>E;E++)v[E]=Tg(F[E]);return v}if(F instanceof Bk){for(var v=new Bk,E=0,$=F.length;$>E;E++)v.set(E,Tg(F.get(E)));return v}if(F instanceof Ck)return F;if(F instanceof w){var v={};for(var j in F)F.hasOwnProperty(j)&&(v[j]=Tg(F[j]));return v}return F},callWhenLoaded:function(Z,v){v=v||100;var a=Dg(Z,v);Um||(Um={}),Um[a]={tick:a,cb:Z,delay:v}},beforeLoadURL:function(O){if(Um){var Y={};for(var M in Um){var I=Um[M];F(I.tick);var k=Dg(I.cb,I.delay);Y[k]={tick:k,delay:I.delay,cb:I.cb}}Um=Y}return t.convertURL?t.convertURL(O):O},convertURL:function($){return $},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){},sortFunc:function(V,D){if(V===D)return 0;if(V==T&&D!=T)return 1;if(V!=T&&D==T)return-1;if(V==T&&D==T)return 0;var X,N=typeof V,M=typeof D;return N===Sk&&M===Sk?X=V.localeCompare(D):N===Lf&&M===Lf&&(X=V-D),X===q&&(X=(""+V).localeCompare(""+D)),X>0?1:0>X?-1:0},getClassMap:function(){return Lk},getClass:function(m){if(Ub(m)){var W,h=Lk[m];if(!h){W=m.split("."),h=x;for(var r=0;r<W.length;r++)h=h[W[r]];Lk[m]=h}return h}return m},def:function(G,P,f){var L,N,R,Y=function(){};if(Y.prototype=P.prototype,L=new Y,Ub(G)){if(Lk[G])throw"'"+G+"' already defined";R=rh(G),L.getClassName=function(){return G}}else R=G;if(L.constructor=R,L.getClass=function(){return R},L.getSuperClass=function(){return P},f)for(N in f)Er[N]&&Er.hasOwnProperty(N)?Er[N](L,f):ns(L,f,N);R.prototype=L,R.superClass=P.prototype},startAnim:function(){var v=function(m){m.duration&&(m.startTime=Wm()),m.timeId=Zh(m.tick,T,T,m.interval)};return function(a){return a=Tg(a),a.easing=a.easing||t.animEasing,a.duration||a.frames||(a.duration=t.animDuration),a.t=0,a.duration?a.interval=0:(a.frame=0,a.interval=a.interval||10),a.tick=function(){if(a.duration){var k=(Wm()-a.startTime)/a.duration;k>1&&(k=1),a.t=k,a.action(a.easing(k),k),1===k?a.stop():a._isPaused||(a.timeId=Zh(a.tick))}else a.frame++,k=a.t=a.frame/a.frames,a.action(a.easing(k),k),a.frame<a.frames?a._isPaused||(a.timeId=Zh(a.tick,T,T,a.interval)):a.stop()},a.resume=function(){a._isPaused&&(delete a._isPaused,a.duration?a.t<1&&(a.startTime=Wm()-a.duration*a.t,a.timeId=Zh(a.tick)):a.frame<a.frames&&(a.timeId=Zh(a.tick,T,T,a.interval)))},a.pause=function(){a._isPaused=!0},a.isPaused=function(){return this._isPaused},a.stop=function(p){a.isRunning()&&(a.duration?a.t<1&&p&&(a.t=1,a.action(a.easing(1),1)):a.frame<a.frames&&p&&(a.frame=a.frames,a.action(a.easing(1),1)),a._37o&&a._37o(),a.finishFunc&&a.finishFunc(),bb(a.timeId,!a.duration),delete a.timeId)},a.isRunning=function(){return a.timeId!=T},a.delay?Zh(v,T,[a],a.delay):v(a),a}}(),getTextSize:function(){var o={},G=R?Uh().getContext("2d"):T;return function(S,t){G.font=S?S:Tl;var L=o[G.font];return L||(L=2*G.measureText("e").width+4,o[G.font]=L),{width:G.measureText(t).width+4,height:L}}}(),drawText:function(m,o,Y,U,D,d,n,E,k,O){if(o!=T){var h=jp(Y,o),J={};J.y=O&&O!==ph?O===Nm?d+h.height/2:d+E-h.height/2:d+E/2,J.x=k&&k!==vn?k===ib?D+n-h.width/2:D+n/2:D+h.width/2,Jb(m,o,J,Y,U)}},getDistance:function(y,U){var W=y.length;return U?3===W?E(I(y[0]-U[0])+I(y[1]-U[1])+I(y[2]-U[2])):2===W?E(I(y[0]-U[0])+I(y[1]-U[1])):y.z===q?E(I(U.x-y.x)+I(U.y-y.y)):E(I(U.x-y.x)+I(U.y-y.y)+I(U.z-y.z)):3===W?E(I(y[0])+I(y[1])+I(y[2])):2===W?E(I(y[0])+I(y[1])):void 0},brighter:function(s,N){return 0>N&&(N=-N),zr(s,N?N:40)},darker:function(z,d){return d>0&&(d=-d),zr(z,d?d:-40)},unionPoint:function(v,o){if(!v)return T;if(2===arguments.length)return v&&o?{x:B(v.x,o.x),y:B(v.y,o.y),width:S(v.x-o.x),height:S(v.y-o.y)}:T;var C=v;if(C._as&&(C=C._as),C.length===q)return T;var N=C.length;if(0>=N)return T;for(var Y=1,l=C[0],s={x:l.x,y:l.y,width:0,height:0};N>Y;Y++){l=C[Y];var F=B(s.x,l.x),U=i(s.x+s.width,l.x),p=B(s.y,l.y),A=i(s.y+s.height,l.y);s.x=F,s.y=p,s.width=U-F,s.height=A-p}return s},unionRect:function(g,U){if(g&&!U)return Tg(g);if(!g&&U)return Tg(U);if(g&&U){var v={x:B(g.x,U.x),y:B(g.y,U.y)};return v.width=i(g.x+g.width,U.x+U.width)-v.x,v.height=i(g.y+g.height,U.y+U.height)-v.y,v}return T},containsPoint:function(v,e,E,M){if(M!=T&&1!==M){var Y=v.x+v.width/2,w=v.y+v.height/2;v={x:Y-v.width/2*M,y:w-v.height/2*M,width:v.width*M,height:v.height*M}}if(E){var Z=v.width/2,t=v.height/2,k=U(-E),u=o(-E),D=e.x-v.x-Z,f=e.y-v.y-t;return e={x:u*D-k*f,y:k*D+u*f},Fi({x:-Z,y:-t,width:v.width,height:v.height},e)}return!(!v||e.x<v.x||e.y<v.y||e.x>v.x+v.width||e.y>v.y+v.height)},containsRect:function(C,B){if(!C||!B)return!1;var W=B.x,V=B.y,U=B.width,p=B.height,g=C.width,b=C.height;if(0>(g|b|U|p))return!1;var h=C.x,A=C.y;if(h>W||A>V)return!1;if(g+=h,U+=W,W>=U){if(g>=h||U>g)return!1}else if(g>=h&&U>g)return!1;if(b+=A,p+=V,V>=p){if(b>=A||p>b)return!1}else if(b>=A&&p>b)return!1;return!0},intersectsRect:function(J,P){if(!J||!P)return!1;var d=P.width,Y=P.height,F=J.width,K=J.height;if(0>=F||0>=K||0>=d||0>=Y)return!1;var s=P.x,q=P.y,o=J.x,H=J.y;return F+=o,K+=H,d+=s,Y+=q,F>s&&K>q&&d>o&&Y>H},intersection:function(k,e){if(!k||!e)return T;var D=e.x,$=e.y,h=k.x,P=k.y,c=D,V=$,H=h,F=P;return c+=e.width,V+=e.height,H+=k.width,F+=k.height,h>D&&(D=h),P>$&&($=P),c>H&&(c=H),V>F&&(V=F),c-=D,V-=$,0>=c||0>=V?T:{x:D,y:$,width:c,height:V}},grow:function(l,I,u){u===q&&(u=I),l.x-=I,l.y-=u,l.width=l.width+2*I,l.height=l.height+2*u},getScreenPoint:function(E,P,d,g,$,p,k){var m,B,u=d.getBoundingClientRect(),H=E*(p||1)+u.left-d.scrollLeft+(g||0),O=P*(k||1)+u.top-d.scrollTop+($||0),L={x:H,y:O};return(m=d.parentElement)&&(B=m.maxtrixAppend)?B.applyInverse(L,{}):L},getLogicalPoint:function(D,V,p,H,d,G){var m,x,s=V.getBoundingClientRect();D.target?(ti(D)?Xi?Eh["91"]=!0:Eh["17"]=!0:Xi?Eh["91"]=!1:Eh["17"]=!1,Eh["16"]=fk(D)?!0:!1,D=tb?Gq(D):D,m=D.clientX,x=D.clientY):(m=D.x,x=D.y);var i,k;if((i=V.parentElement)&&(k=i.maxtrixAppend)){var W=k.apply({x:m,y:x},{});return W.x=(W.x+V.scrollLeft-(p||0))/(d||1),W.y=(W.y+V.scrollTop-(H||0))/(G||1),W}return{x:(m-s.left+V.scrollLeft-(p||0))/(d||1),y:(x-s.top+V.scrollTop-(H||0))/(G||1)}},removeHTML:function(){var F;return function($){return $&&$.getView&&($=$.getView()),$&&$.parentNode?F===$?!0:(F=$,$.parentNode.removeChild($),F=T,!0):!1}}(),getToolTipDiv:function(){if(!zi){zi=Zp(),ch=Zp();var C=zi.style;t.baseZIndex!=T&&(C.zIndex=j(t.baseZIndex)+3+""),C.whiteSpace="nowrap",C.color=t.toolTipLabelColor,C.background=t.toolTipBackground,C.font=t.toolTipLabelFont,C.padding="5px",C.boxShadow="0px 0px 3px "+t.toolTipShadowColor}return zi},isToolTipShowing:function(){return zi&&zi.parentNode?!0:ch&&ch.parentNode?!0:!1
},hideToolTip:function(){Ln(zi),Ln(ch),Gn()},showToolTip:function(g,l){if(!g||l==T)return Xm(),void 0;t.getToolTipDiv();var j,M;if(l.html?(l=l.html,j=ch,Ln(zi)):(j=zi,Ln(ch)),M=j.style,j.innerHTML=l,j.parentNode||b.Default.appendToScreen(j),g.target){g=Ph(g);var S=Pb(),n=g.x,r=g.y,N=tb?60:12;if(tb){var D=j.getBoundingClientRect();M.left=n-D.width/2+vs,M.top=r-D.height-N<S.top?r+N+vs:r-D.height-N+vs}else{M.left=n+N+vs,M.top=r+N+vs;var D=j.getBoundingClientRect();D.left+D.width>S.width&&(M.left=n-N-D.width+vs),D.top+D.height>S.height&&(M.top=r-N-D.height+vs),D.left<0&&(M.left=n+N+vs),D.top<0&&(M.top=r+N+vs)}}else M.left=g.x+vs,M.top=g.y+vs;Gn()},startDragging:function(G,y,p){p==q&&(p=!0),G!==_e&&(_e?p&&(tb?_e.handleWindowTouchEnd(y):_e.handleWindowMouseUp(y)):tb?(x.addEventListener(lb,vd,O),x.addEventListener(Ko,tq,O)):(x.addEventListener(cj,Bq,O),x.addEventListener(pm,Be,O)),_e=G)},getImageMap:function(){return Qk},toBoundaries:function(d,g,k,E){var h=[];return jq(d,g,k,E).forEach(function(G){var u=[];G.forEach(function(g){u.push(g.x,g.y)}),h.push(u)}),h},getCurrentKeyCodeMap:function(){return Eh},drawCenterImage:function(P,d,c,S,Q,f,X,t){var j=Sq(d,Q,f),r=Bg(d,Q,f);Bh(P,d,z(c-j/2),z(S-r/2),j,r,Q,f,X,t)},drawStretchImage:function(I,J,v,N,M,T,s,C,$,Y,t,Z){var E,R=Sq(J,C,$,T),X=Bg(J,C,$,s);"uniform"===v?(E=B(T/R,s/X),R*=E,X*=E,N+=z((T-R)/2),M+=z((s-X)/2),T=R,s=X):"centerUniform"===v&&((R>T||X>s)&&(E=B(T/R,s/X),R*=E,X*=E),N+=z((T-R)/2),M+=z((s-X)/2),T=R,s=X);var G=I.interactiveInfo;if(G){var e;if(e="center"===v?{x:N+T/2-R/2,y:M+s/2-X/2,width:R,height:X}:{x:N,y:M,width:T,height:s},G.rect){var W=G.compInfos,K=W.length;K&&(W[K-1].rect.image=J)}else G.rect=e}if("center"===v){var U=t!==!1&&(R>T||X>s);U&&(I.save(),I.beginPath(),I.rect(N,M,T,s),I.clip()),Bh(I,J,N+T/2-R/2,M+s/2-X/2,R,X,C,$,Y,Z),U&&I.restore()}else Bh(I,J,N,M,T,s,C,$,Y,Z)},toCanvas:function($,J,N,p,A,R,e,d,o){$=xf($,e),J=J||Sq($,A),N=N||Bg($,A);var P=Uh(),Y=Cn(P);return d?(Dp(P,J,N,d),Y.scale(d,d)):Dp(P,J,N,1),np(Y,$,p,0,0,J,N,A,R,e,o),$&&$.clampToEdge&&(P.clampToEdge=$.clampToEdge),Y.restore(),P},createGradientImage:function(x,D,Q,M){for(var t=["L",0,0,x,0,1,0,0,1,0,0],U=0,G=Math.min(D.length,Q.length);G>U;U++)t.push(Q[U],D[U]);var O=b.Default.toCanvas({width:x,height:x,clampToEdge:!0,comps:[{type:"shape",rotation:M||0,points:[0,0,x,0,x,x,0,x],background:"#ffffff",gradientPack:t}]});return O},createElement:function(S,G,_,J){var h=R.createElement(S);return Nh(h,G||r.widgetBorder,2),h.style.font=_?_:Tl,J!=T&&(h.value=J),t.onElementCreated&&t.onElementCreated(h),h},containedInView:function(Q,V){var K=vr(V).getBoundingClientRect();return Fi({x:K.left,y:K.top,width:K.width,height:K.height},kl(Q))},isIsolating:function(){return Fo>0},setIsolating:function(z){z?Fo++:Fo--},getMSMap:function(){return Er},stringify:function(i,X){var H=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var d=JSON.stringify(i,function(u,D){return"function"==typeof D?"__ht__"+(D.__ht__||D.toString()):bh(D)?Mk(D):D},X==T?2:X);return Date.prototype.toJSON=H,d},parse:function(k){return Ub(k)?JSON.parse(k,function(z,U){if(Ub(U)){if("__ht__function"==U.substr(0,14)){var a=U.indexOf("{")+1,N=U.lastIndexOf("}"),r=U.indexOf("(")+1,$=U.indexOf(")");if(a&&N&&r&&$){var y=new Function(U.substring(r,$),U.substring(a,N));return y.__ht__=U.substr(6),y}}if("__ht__date"==U.substr(0,10))return new Date(j(U.substr(10)))}return U}):k},loadJS:function(d,X){X&&d.push(X);var i=d.shift();if(Wd(i))d=i.contact(d),t.loadJS(d);else if(Dk(i))i(),t.loadJS(d);else if(Ub(i)){var E=R.createElement("script");E.onload=function(){t.loadJS(d)},E.setAttribute("src",i),R.getElementsByTagName("head")[0].appendChild(E)}else d.length&&t.loadJS(d)},toRoundedCorner:function(v,e){var L=v.size();if(0>=e)return{points:v};var c,I=new Bk,S=new Bk,w=v.get(0);I.add(w),S.add(1);for(var C=1;L>C;C++)if(L>C+1){var d=v.get(C),k=v.get(C+1),P=w.x,m=w.y,s=d.x,f=d.y,r=f-m,h=s-P,N=J(r,h);c=B(.99*Bc(w,d),e),I.add({x:s-c*o(N),y:f-c*U(N)}),I.add(d),P=d.x,m=d.y,s=k.x,f=k.y,r=f-m,h=s-P,N=J(r,h),c=B(.99*Bc(d,k),e),w={x:P+c*o(N),y:m+c*U(N)},I.add(w),S.addAll([2,3])}else I.add(v.get(C)),S.add(2);return{points:I,segments:S}},toColorData:Ar,setCanvas:Dp,createDiv:Zp,createDisabledDiv:Nr,createView:rc,createCanvas:Uh,appendChild:Xk,initContext:Cn,checkLoadingImage:ds,translateAndScale:Ek,layout:$c,getPosition:sj,drawPoints:$r,drawRoundRect:hj,drawBorder:We,setFocus:hk,getter:um,setter:pp,isEmptyObject:Fq},!0),Pr(V,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var hc=t.disabledOpacity,Hp=t.toolTipDelay,ke=t.devicePixelRatio,qq=t.autoMakeVisible,dm=t.autoHideScrollBar,kp=t.imageGradient,di=t.showToolTip,Xm=t.hideToolTip,vc=t.dashPattern,Nd=t.lineCap,pk=t.lineJoin,Wl=t.labelColor,Ik=t.labelSelectColor,Tl=t.labelFont,Rc=t.widgetIndent,Nn=t.widgetRowHeight,$e=t.widgetHeaderHeight,ri=t.widgetTitleHeight,bo=t.scrollBarColor,xp=t.scrollBarSize,qh=t.scrollBarTimeout,li=t.scrollBarMinLength,Vn=t.scrollBarInteractiveSize,Kq=t.zoomIncrement,to=t.scrollZoomIncrement,Fr=t.pinchZoomIncrement,oe=t.zoomMax,Vm=t.zoomMin,ad=t.createObject,en=t.preventDefault,yk=t.setImage,xf=t.getImage,Xq=t.isImageComplete,Tm=t.drawCenterImage,np=t.drawStretchImage,tk=t.getId,Zh=t.callLater,$l=t.sortFunc,Tg=t.clone,rh=t.getClass,jr=t.startAnim,ie=t.brighter,ym=t.darker,jn=t.drawText,jp=t.getTextSize,Cq=t.isLeftButton,id=t.getTouchCount,no=t.isDoubleClick,fk=t.isShiftDown,ti=t.isCtrlDown,kl=t.getClientPoint,Ph=t.getPagePoint,Bc=t.getDistance,ps=t.unionPoint,Ef=t.unionRect,Fi=t.containsPoint,eo=t.containsRect,Pc=t.intersectsRect,kj=t.intersection,Pb=t.getWindowInfo,Ym=t.grow,mk=t.getLogicalPoint,Jr=t.getScreenPoint,El=t.startDragging,Ln=t.removeHTML,ws=t.createElement,_o=t.segmentResolution,dd=t.shapeResolution,ee=t.shapeSide,Nc=t.def,Tn=function($,g,d){Nc(e+"."+$,g,d)},ol=function(G,U){G.childNodes.forEach(function(Q){U(Q),ol(Q,U)})};Pr(t,{toolTipLabelColor:Wl,toolTipLabelFont:Tl,toolTipBackground:r.toolTipBackground,toolTipShadowColor:Pd,drawBreakableText:Pg,setDevicePixelRatio:function(L){ke=t.devicePixelRatio="number"==typeof L?L:x.devicePixelRatio,ol(R.body,function(r){var x=r._ht;x&&x._canvas&&(Dp(x._canvas,x.getWidth(),x.getHeight()),x.redraw?x.redraw():x.iv())})}},!0);var or=1e-6,Ld="undefined"!=typeof Uint16Array?Uint16Array:Array,Lg="undefined"!=typeof Float32Array?Float32Array:Array,nj=function(i,M,T){var x=[i[0]-M[0],i[1]-M[1],i[2]-M[2]];if(T){var O=Bc(x);O>0&&(x[0]/=O,x[1]/=O,x[2]/=O)}return x},bq=function(){var H="charCodeAt",g=2*(2*nl.length+1);for(var K in x)if(K===e+vn[0]+vs.length){var y=x[K];if(!y)break;for(var k=y.length,Z=0;k>Z;Z++)if(y[Z][H](0)===g&&y[Z+1]!=T&&y[Z+1]===vs[0]&&y[Z+2]!=T&&y[Z+2][H](0)===g){for(var d=Z+3;k>d;d++)if(y[d][H](0)===g){if(0==y[d+1])for(var F,l=d+2;k>l;l++){if(y[l][H](0)===g){0==y[l-1]&&F&&(N=F.substr(0,F.length-1));break}F==T?F=y[l]:F+=y[l]}break}break}break}return function(U){return[-U[0],-U[1],-U[2]]}}(),zq=function(b,i){return 3===b.length?b[0]*i[0]+b[1]*i[1]+b[2]*i[2]:b[0]*i[0]+b[1]*i[1]},nn=function(){var k=new Lg(16);return k[0]=1,k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[5]=1,k[6]=0,k[7]=0,k[8]=0,k[9]=0,k[10]=1,k[11]=0,k[12]=0,k[13]=0,k[14]=0,k[15]=1,k},ro=nn(),bj=function(O){var l=new Lg(16);return l[0]=O[0],l[1]=O[1],l[2]=O[2],l[3]=O[3],l[4]=O[4],l[5]=O[5],l[6]=O[6],l[7]=O[7],l[8]=O[8],l[9]=O[9],l[10]=O[10],l[11]=O[11],l[12]=O[12],l[13]=O[13],l[14]=O[14],l[15]=O[15],l},rg=function(t,I){return t[0]=I[0],t[1]=I[1],t[2]=I[2],t[3]=I[3],t[4]=I[4],t[5]=I[5],t[6]=I[6],t[7]=I[7],t[8]=I[8],t[9]=I[9],t[10]=I[10],t[11]=I[11],t[12]=I[12],t[13]=I[13],t[14]=I[14],t[15]=I[15],t},wl=function(w){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},rm=function(F,m){var H=F[0],S=F[1],O=F[2];return F[0]=m[0]*H+m[4]*S+m[8]*O+m[12],F[1]=m[1]*H+m[5]*S+m[9]*O+m[13],F[2]=m[2]*H+m[6]*S+m[10]*O+m[14],F},fb=function(R,K){var j=R[0],Y=R[1],b=R[2],_=R[3];return R[0]=K[0]*j+K[4]*Y+K[8]*b+K[12]*_,R[1]=K[1]*j+K[5]*Y+K[9]*b+K[13]*_,R[2]=K[2]*j+K[6]*Y+K[10]*b+K[14]*_,R[3]=K[3]*j+K[7]*Y+K[11]*b+K[15]*_,R},Zm=function(){var n,u,K,X,i=fq(bs[1]+bs[7]),j=fq(bs[0]+bs[3]-bs[10]),b=fq(bs[8]+2),p=function(){return u=K.charAt(n),n+=1,u},D=function(){var O="";if(u===b)for(;p();){if(u===b)return p(),O;O+=u}else p()},h=function(){for(;u&&" ">=u;)p()},Y=function(){var e,_={};if(u===i){if(p(),h(),u===j)return p(),_;for(;u;){if(e=D(),h(),p(),_[e]=X(),h(),u===j)return p(),_;p(),h()}}};return X=function(){switch(h(),u){case i:return Y();default:return D()}},function(Z){if(m={},Z){var z;if(K=Z,n=0,u=" ",z=X(),h(),!u)return z}}}(),ef=function(h,z){if(z){var m=U(z),X=o(z),Q=h[4],E=h[5],e=h[6],x=h[7],j=h[8],G=h[9],N=h[10],I=h[11];h[4]=Q*X+j*m,h[5]=E*X+G*m,h[6]=e*X+N*m,h[7]=x*X+I*m,h[8]=j*X-Q*m,h[9]=G*X-E*m,h[10]=N*X-e*m,h[11]=I*X-x*m}},xm=function(Z,N){if(N){var C=U(N),Q=o(N),g=Z[0],t=Z[1],W=Z[2],j=Z[3],P=Z[8],T=Z[9],z=Z[10],H=Z[11];Z[0]=g*Q-P*C,Z[1]=t*Q-T*C,Z[2]=W*Q-z*C,Z[3]=j*Q-H*C,Z[8]=g*C+P*Q,Z[9]=t*C+T*Q,Z[10]=W*C+z*Q,Z[11]=j*C+H*Q}},Vo=function(I,m){if(m){var b=U(m),c=o(m),z=I[0],H=I[1],M=I[2],R=I[3],r=I[4],$=I[5],O=I[6],C=I[7];I[0]=z*c+r*b,I[1]=H*c+$*b,I[2]=M*c+O*b,I[3]=R*c+C*b,I[4]=r*c-z*b,I[5]=$*c-H*b,I[6]=O*c-M*b,I[7]=C*c-R*b}},ap=function(D,X,t){return sf(T,t===!1?T:D.getFinalScale3d(),D.getFinalRotation3d(),D.getRotationMode(),D.p3(),T,X)},sf=function(i,q,K,T,z,R,p){return R||(R=nn()),z&&Nf(R,z),rn(R,K,T),p&&nm(R,R,p),q&&hb(R,q),i&&nm(R,R,i),R},vg=function(p,Z,g){Z=j(Z),g=j(g);var M=this;M.g=p,M._84O=Z,M._85O=g,M._70I=!0,M.F=0,M._83O=Z+g,M.pen={x:0,y:0}},pe="lineDashOffset",En="setLineDash",Fp=function(Z){for(var P in Z)1===P.length&&(pe=Z[P]);return P?1:0},$d=function(j,R,P){return tj(R)?j:j[En]?(j[En](R),P&&(j.lineDashOffset=P),j):new vg(j,R[0],R.length>1?R[1]:R[0])},wn=function(q,U){!tj(U)&&q[En]&&(q[En](Ni),q.lineDashOffset=0)};if(Nc(vg,w,{_69I:6,moveTo:function(R,n){var L=this,a=L.pen;a.x=R,a.y=n,L.g.moveTo(R,n),L.start||(L.start={x:R,y:n})},lineTo:function(n,W){var c=this,N=c.pen,s=n-N.x,f=W-N.y,R=J(f,s),F=o(R),k=U(R),$=c._23O(N.x,N.y,n,W),_=c._85O,m=c._84O,B=c._83O;if(c.F){if(c.F>$)return c._70I?c._72I(n,W):c.moveTo(n,W),c.F-=$,void 0;if(c._70I?c._72I(N.x+F*c.F,N.y+k*c.F):c.moveTo(N.x+F*c.F,N.y+k*c.F),$-=c.F,c.F=0,c._70I=!c._70I,!$)return}var i=l($/B);if(i){for(var y=F*m,A=k*m,x=F*_,K=k*_,e=0;i>e;e++)c._70I?(c._72I(N.x+y,N.y+A),c.moveTo(N.x+x,N.y+K)):(c.moveTo(N.x+x,N.y+K),c._72I(N.x+y,N.y+A));$-=B*i}c._70I?$>m?(c._72I(N.x+F*m,N.y+k*m),c.moveTo(n,W),c.F=_-($-m),c._70I=!1):(c._72I(n,W),$===m?(c.F=0,c._70I=!c._70I):(c.F=m-$,c.moveTo(n,W))):$>_?(c.moveTo(N.x+F*_,N.y+k*_),c._72I(n,W),c.F=m-($-_),c._70I=!0):(c.moveTo(n,W),$===_?(c.F=0,c._70I=!c._70I):c.F=_-$)},quadraticCurveTo:function(D,U,Z,B){var h,o=this,L=o.pen,y=L.x,w=L.y,O=o._22O(y,w,D,U,Z,B),x=0,T=0,d=o._85O,p=o._84O;if(o.F){if(o.F>O)return o._70I?o._71I(D,U,Z,B):o.moveTo(Z,B),o.F-=O,void 0;if(x=o.F/O,h=o._20O(y,w,D,U,Z,B,x),o._70I?o._71I(h[2],h[3],h[4],h[5]):o.moveTo(h[4],h[5]),o.F=0,o._70I=!o._70I,!O)return}var N=O-O*x,P=l(N/o._83O),S=p/O,A=d/O;if(P)for(var G=0;P>G;G++)o._70I?(T=x+S,h=o._21O(y,w,D,U,Z,B,x,T),o._71I(h[2],h[3],h[4],h[5]),x=T,T=x+A,h=o._21O(y,w,D,U,Z,B,x,T),o.moveTo(h[4],h[5])):(T=x+A,h=o._21O(y,w,D,U,Z,B,x,T),o.moveTo(h[4],h[5]),x=T,T=x+S,h=o._21O(y,w,D,U,Z,B,x,T),o._71I(h[2],h[3],h[4],h[5])),x=T;N=O-O*x,o._70I?N>p?(T=x+S,h=o._21O(y,w,D,U,Z,B,x,T),o._71I(h[2],h[3],h[4],h[5]),o.moveTo(Z,B),o.F=d-(N-p),o._70I=!1):(h=o._19O(y,w,D,U,Z,B,x),o._71I(h[2],h[3],h[4],h[5]),O===p?(o.F=0,o._70I=!o._70I):(o.F=p-N,o.moveTo(Z,B))):N>d?(T=x+A,h=o._21O(y,w,D,U,Z,B,x,T),o.moveTo(h[4],h[5]),h=o._19O(y,w,D,U,Z,B,T),o._71I(h[2],h[3],h[4],h[5]),o.F=p-(N-d),o._70I=!0):(o.moveTo(Z,B),N===d?(o.F=0,o._70I=!o._70I):o.F=d-N)},bezierCurveTo:function(){var M=arguments;this.pen={x:M[4],y:M[5]},this.g.bezierCurveTo(M[0],M[1],M[2],M[3],M[4],M[5])},arc:function(Q,r,$,O,N,j){j||(O=-O,N=-N),rp(this,Q,r,O,N-O,$,$,!1)},rect:function(m,F,U,S){var h=this;h.pen={x:m,y:F},h.moveTo(m,F),h.lineTo(m,F+S),h.lineTo(m+U,F+S),h.lineTo(m+U,F),h.lineTo(m,F)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(C,H,L,G){var A=L-C,d=G-H;return E(A*A+d*d)},_22O:function(o,b,N,s,p,r,w){for(var X,u,Q,I,H,M,t,h=0,z=o,n=b,Z=w>0?w:this._69I,J=1;Z>=J;J++)Q=J/Z,I=1-Q,H=I*I,M=2*Q*I,t=Q*Q,X=H*o+M*N+t*p,u=H*b+M*s+t*r,h+=this._23O(z,n,X,u),z=X,n=u;return h},_21O:function(R,d,H,c,u,f,I,i){var m=this;if(0===I)return m._20O(R,d,H,c,u,f,i);if(1===i)return m._19O(R,d,H,c,u,f,I);var x=m._20O(R,d,H,c,u,f,i);return x.push(I/i),m._19O.apply(m,x)},_20O:function(R,w,X,i,v,x,j){if(1!==j){var S=X+(v-X)*j,U=i+(x-i)*j;X=R+(X-R)*j,i=w+(i-w)*j,v=X+(S-X)*j,x=i+(U-i)*j}return[R,w,X,i,v,x]},_19O:function(n,e,q,F,p,w,P){if(1!==P){var A=n+(q-n)*P,f=e+(F-e)*P;q+=(p-q)*P,F+=(w-F)*P,n=A+(q-A)*P,e=f+(F-f)*P}return[n,e,q,F,p,w]},_72I:function(I,s){var j=this.pen;(I!==j.x||s!==j.y)&&(j.x=I,j.y=s,this.g.lineTo(I,s))},_71I:function(i,h,o,y){var v=this.pen;(i!==o||h!==y||o!==v.x||y!==v.y)&&(v.x=o,v.y=y,this.g.quadraticCurveTo(i,h,o,y))}}),Y&&P){var As=P.toString();c=As.indexOf(un.substr(0,2))>0&&As.indexOf(Nm+Nm.substr(1,1))>1||As.indexOf(Ji.substr(0,2)+un.substr(2,2)+vn[0]+un[4])>1?!0:!1}var dq=T,se=T,Ai=function(k){dq&&!k._72O&&(se||(se={}),se[k._72O=tk()]=k)},Tj=function(F,U){if(U||(U=F),U&&(dq||(dq={}),!dq[F])){var i=new Ae;if(dq[U]={request:i,url:U},U=t.beforeLoadURL(U),U.data){var b=t.parse(U.data);Fd(F,b),t.handleCompTypeLoaded(F,b)}else{i.onload=function(z){if(200===this.status||0===this.status){var b=t.parse(z.target.response||z.target.responseText);Fd(F,b),t.handleCompTypeLoaded(F,b)}else Fd(F,T)},i.onerror=function(){Fd(F,T)};var L={};L.url=encodeURI(U),L.sync=!1,i.send(L)}}},Fd=function(m,k){if(tm[m]=k,delete dq[m],Fq(dq)&&(dq=T,se)){for(var i in se){var R=se[i];R.invalidateAll&&R.invalidateAll(q,"compTypeLoaded",m),R.redraw&&R.redraw(),R.iv(),delete R._72O}se=T}if(k&&se)for(var i in se){var R=se[i];R.invalidateAll&&R.invalidateAll(q,"compTypeLoading",m),R.redraw&&R.redraw(),R.iv()}},ui=r.chart,Pq=t.compStack=[],Jf=/^style@/,Uj=/^attr@/,eq=/^field@/,Uc={x:.5,y:.5},Sq=function(g,H,Q,V){if(!g)return 0;if(cg(g.fitSize,H,Q)&&V)return V;var i=cg(g.width,H,Q);return null==i?20:i},Bg=function(j,O,v,A){if(!j)return 0;if(cg(j.fitSize,O,v)&&A)return A;var R=cg(j.height,O,v);return null==R?20:R},cg=function(d,s,o){if(!d||!d.func)return d;var v,A=d.func,x=d.value;return v=Dk(A)?o&&o.vectorDataBindingDisabled&&!d.isSafeFunc?x:A(s,o):s instanceof Ck?Uj.test(A)?s.a(A.slice(5)):Jf.test(A)?s.s(A.slice(6)):eq.test(A)?s[A.slice(6)]:s[A]?s[A](o):x:x,x!==q&&v==T?x:v},Bh=t.drawImage=function(){var e,A,W,y,S,u,Z=function(N,A){N.getValue&&N.getValue.compType===A||(N.getValue=function(I){var Q=s(N,I);if(Q===q&&A.properties){var c=A.properties[I];c&&(Q=c.defaultValue)}return Q},N.getValue.compType=A)},s=function(C,Q,u){var f=C[Q];return f&&f.func?(f=cg(f,A,W),u&&(f=u(f))):u&&(f=C[Q]=u(f)),f},c=function(n,z){var o;if(o=z?s(n,z):n,S&&o){if("override"===u)return S;if("override_rgb"===u){var i=Uf(S);return o=Ar(o),"rgba("+l(255*i[0])+","+l(255*i[1])+","+l(255*i[2])+","+o[3]/255+")"}if("override_a"===u){var i=Uf(S);return o=Ar(o),"rgba("+o[0]+","+o[1]+","+o[2]+","+i[3]+")"}var i=Uf(S);return o=Ar(o),"rgba("+l(o[0]*i[0])+","+l(o[1]*i[1])+","+l(o[2]*i[2])+","+o[3]/255*i[3]+")"}return o},h=function(B){if(Wd(B)){for(var A=new Bk,h=B.length,w=0;h>w;w+=2)A.add({x:B[w],y:B[w+1]});B=A}return B},$=function(L){var k=s(L,"anchorX"),j=s(L,"anchorY");if(k!==q||j!==q)return{x:k===q?Uc.x:k,y:j===q?Uc.y:j};var F=s(L,"type"),i=s(L,"name");if("image"!==F||!i)return Uc;var f=xf(i);return f&&f.anchorX!==q&&f.anchorY!==q?{x:f.anchorX,y:f.anchorY}:Uc},I=function(V,Q){var U=s(V,zm),v=$(V);if(Wd(U)){var t=U.length,p=s(V,"relative"),u=Q.width,w=Q.height;if(4===t)U={x:U[0],y:U[1],width:U[2],height:U[3]},p?(U.x*=u,U.y*=w,U.width*=u,U.height*=w):Q.fitSize&&(U.x*=Q.widthScale,U.width*=Q.widthScale,U.y*=Q.heightScale,U.height*=Q.heightScale);else if(3===t){var M=U[0];U={width:U[1],height:U[2]},p?(U.width*=u,U.height*=w):Q.fitSize&&(U.width*=Q.widthScale,U.height*=Q.heightScale),"object"==typeof M?M.length&&(M={x:M[0],y:M[1]}):M=sj(M,Q,U),U.x=M.x-U.width*v.x,U.y=M.y-U.height*v.y}var f=s(V,"offsetX");f&&(Q.fitSize&&(f*=Q.widthScale),U.x+=f),f=s(V,"offsetY"),f&&(Q.fitSize&&(f*=Q.heightScale),U.y+=f)}return U},V=function(T){return Wd(T)?new Bk(T):T},v=function(K,S,F,V,T,Q,J){var Z=e.interactiveInfo,W=K.transform;if(W)return e.save(),e.setTransform(W.a,W.b,W.c,W.d,W.tx,W.ty),Z&&Z.compInfos.push({comp:K,rect:S,matrix:W.clone()}),!0;T===q&&(T=1),Q===q&&(Q=1);var D=s(K,"clipPercentage"),o=mb(F,S);if(o&&!V&&1===T&&1===Q&&!(1>D))return Z&&Z.compInfos.push({comp:K,rect:S,matrix:Z.matrix.clone()}),!1;J=J||Uc;var I=S.x+S.width*J.x,U=S.y+S.height*J.y,R=F.x+F.width*J.x,h=F.y+F.height*J.y,O=F.width?T*(S.width/F.width):1,P=F.height?Q*(S.height/F.height):1;if(e.save(),Z&&(Z.matrix.appendTranslate(I,U).appendRotate(V).appendScale(O,P).appendTranslate(-R,-h),Z.compInfos.push({comp:K,rect:S,matrix:Z.matrix.clone()})),ts(e,I,U),eg(e,V||0),go(e,O,P),ts(e,-R,-h),1>D){0>D&&(D=0);var r=Pj(F,s(K,"clipDirection"),D);e.beginPath(),e.rect(r.x,r.y,r.width,r.height),e.clip()}return!0},M=function(){e.restore()},m=function(I,w,m){var L=s(I,"path"),g=s(I,Ui),V=s(I,"scaleX"),d=s(I,"scaleY"),X=$(I),b=T,Q=Fh(null,L);if(m||(m=I.unionRect,m||(m=ps(Q),I.path.func||(I.unionRect=m)),b=m),m){b||(b=I.unionRect,b||(b=ps(Q),I.path.func||(I.unionRect=b)));var a=v(I,m,b,g,V,d,X),C=s(I,"borderPattern"),S=$d(e,C),N=c(I,"background"),D=c(I,"borderColor"),h=s(I,"borderWidth"),j=s(I,"gradient"),t=c(I,"gradientColor"),H=s(I,"border3d"),q=s(I,"border3dColor"),r=s(I,"border3dAccuracy"),k=e.lineJoin,p=e.lineCap;if(e.lineJoin=s(I,"borderJoin")||pk,e.lineCap=s(I,"borderCap")||Nd,N?(ic(e,N,j,t,b),Fh(e,L),e.fill(),S!==e&&Fh(e,L)):Fh(e,L),h&&D){var u=s(I,"borderWidthAbsolute");u&&(e.save(),e.setTransform(1,0,0,1,0,0)),e.lineWidth=h,e.strokeStyle=D,e.stroke(),u&&e.restore(),H&&Lc(e,D,q,h,y,r)}if(wn(e,C),s(I,"dash")){var Y=s(I,"dashWidth")||h;if(Y>0){C=s(I,"dashPattern")||vc;var S=$d(e,C,s(I,"dashOffset")),G=c(I,"dashColor")||c(Wh);S!==e&&Fh(e,L),e.strokeStyle=G,e.lineWidth=Y,e.stroke(),s(I,"dash3d")&&Lc(e,G,c(I,"dash3dColor"),Y,y,s(I,"dash3dAccuracy")),wn(e,C)}}w===zm&&nk(e,N,s(I,"depth"),b),e.lineJoin=k,e.lineCap=p,a&&M()}},K=function(X,F,d,J){var o=s(X,ek,h),D=s(X,Ui),z=$(X);if(o&&J.fitSize){var q=Math.abs(Math.cos(D))<.001,B=new Bk,U=ps(o),N=J.widthScale,l=J.heightScale,P=U.x+z.x*U.width,i=U.y+z.y*U.height,t=P*N,k=i*l;o.each(function($){var y=$.x-P,p=$.y-i;B.add({x:t+y*(q?l:N),y:k+p*(q?N:l)})}),o=B,X.unionRect=null}var E=s(X,"scaleX"),L=s(X,"scaleY"),R=F===Mo,H=T;if(!d&&R&&(d=X.unionRect,d||(d=ps(o),X.points.func||(X.unionRect=d)),H=d),d){R?H||(H=X.unionRect,H||(H=ps(o),X.points.func||(X.unionRect=H))):H=d;var n,a,K,C,f=v(X,d,H,D,E,L,z),r=s(X,"borderPattern"),m=$d(e,r),G=c(X,"background"),j=xf(s(X,"repeatImage"),S,u),O=s(X,"gradientPack"),I=c(X,"borderColor"),w=s(X,"borderWidth"),p=s(X,"segments",V),b=s(X,"gradient"),Z=c(X,"gradientColor"),x=s(X,"border3d"),_=s(X,"border3dColor"),Q=s(X,"border3dAccuracy"),Y=s(X,"closePath"),g=s(X,"fillRule")||"nonzero",ee=e.lineJoin,Hp=e.lineCap;if(e.lineJoin=s(X,"borderJoin")||pk,e.lineCap=s(X,"borderCap")||Nd,R)if(G||j||O){var eg=s(X,"fillClipPercentage");if(1>eg){0>eg&&(eg=0);var qd=Pj(H,s(X,"fillClipDirection"),eg);e.save(),e.beginPath(),e.rect(qd.x,qd.y,qd.width,qd.height),e.clip()}if($r(e,o,p,Y),O)On(e,O);else if(j){var vl=e,Kg=S,gq=u;dn(e,j,S,u,A,W),e=vl,S=Kg,u=gq}else{var vl=e;ic(e,G,b,Z,H),e=vl}e.fill(g),1>eg&&e.restore(),O&&e.restore(),m!==e&&$r(m,o,p,Y)}else $r(m,o,p,Y);else if("roundRect"===F?n=s(X,"cornerRadius"):"polygon"===F?n=s(X,"polygonSide"):"arc"===F&&(n=s(X,"arcFrom"),a=s(X,"arcTo"),K=s(X,"arcClose"),C=s(X,"arcOval")),G||j||O){var eg=s(X,"fillClipPercentage");if(1>eg){0>eg&&(eg=0);var qd=Pj(H,s(X,"fillClipDirection"),eg);e.save(),e.beginPath(),e.rect(qd.x,qd.y,qd.width,qd.height),e.clip()}if(yf(e,F,H,n,a,K,C),O)On(e,O);else if(j){var vl=e,Kg=S,gq=u;dn(e,j,S,u,A,W),e=vl,S=Kg,u=gq}else ic(e,G,b,Z,H);e.fill(g),1>eg&&e.restore(),O&&e.restore(),e!==m&&yf(m,F,H,n,a,K,C)}else yf(m,F,H,n,a,K,C);if(w&&I){var mg=s(X,"borderWidthAbsolute");mg&&(e.save(),e.setTransform(1,0,0,1,0,0)),e.lineWidth=w,e.strokeStyle=I,e.stroke(),mg&&e.restore(),x&&Lc(e,I,_,w,y,Q)}if(wn(e,r),s(X,"dash")){var Pq=s(X,"dashWidth")||w;if(Pq>0){r=s(X,"dashPattern")||vc;var m=$d(e,r,s(X,"dashOffset")),qn=c(X,"dashColor")||c(Wh);m!==e&&(R?$r(m,o,p,Y):yf(m,F,H,n,a,K,C)),e.strokeStyle=qn,e.lineWidth=Pq,e.stroke(),s(X,"dash3d")&&Lc(e,qn,c(X,"dash3dColor"),Pq,y,s(X,"dash3dAccuracy")),wn(e,r)}}F===zm&&nk(e,G,s(X,"depth"),H),e.lineJoin=ee,e.lineCap=Hp,f&&M()}},H=function(_,M){var N=S,O=u,F=S||s(_,so),B=u||s(_,"blendMode"),j=xf(s(_,"name"),F,B);j&&(np(e,j,s(_,"stretch"),M.x,M.y,M.width,M.height,A,W,F,null,B),S=N,u=O)},R=function(K,P){var m=s(K,"text");m!=T&&jn(e,m,s(K,"font"),c(K,so),P.x,P.y,P.width,P.height,s(K,"align"),s(K,"vAlign"))},E=function(O,G){We(e,c(O,so),G.x,G.y,G.width,G.height,s(O,"width"))},D=function(Y,F){var k=s(Y,Fb),z=0;if(k&&(k.forEach(function(H){z+=H}),z>0)){for(var n=s(Y,"colors")||ui,f=s(Y,"startAngle")||0,Z=s(Y,"hollow"),i=s(Y,Rg),y=s(Y,Lh),H=s(Y,he),q=i?new Bk:T,G=F.x,W=F.y,h=F.width,O=F.height,C=G+h/2,K=W+O/2,b=B(h,O)/2,S=0,j=0;j<k.length;j++){var Q=k[j],J=p*Q/z,u=f+J;if(e.fillStyle=n[S++],S===n.length&&(S=0),e.beginPath(),Z){var r=C+o(f)*b/2,L=K+U(f)*b/2,M=C+o(u)*b,t=K+U(u)*b;e.moveTo(r,L),e.arc(C,K,b/2,f,u,!1),e.lineTo(M,t),e.arc(C,K,b,u,f,!0)}else e.moveTo(C,K),e.arc(C,K,b,u,f,!0);q&&(J=(f+u)/2,q.add({text:Dk(i)?i(Q,j,z,A):Q,x:C+.75*o(J)*b,y:K+.75*U(J)*b})),e.closePath(),e.fill(),f=u}q&&q.each(function(Y){jn(e,Y.text,y,H,Y.x,Y.y,0,0,_l)})}},C=function(W,P){var u=s(W,Aq);if(u&&u.length>0){var p=u.length,w=s(W,Rg),X=s(W,Lh),J=s(W,he),N=w?new Bk:T,R=s(W,"minValue")||0,r=s(W,"maxValue");if(r==T&&(r=0,u.forEach(function(T){s(T,Fb).forEach(function(z){r=i(r,z)})})),R===r)return;for(var x=P.height/(r-R),E=P.y+r*x,G=s(u[0],Fb).length,g=P.width/(3*G+1),c=2*g/p,I=0,V=0;p>V;V++)for(var h=u[V],Q=s(h,so),H=s(h,"colors"),Y=s(h,Fb),m=0;G>m;m++){H?e.fillStyle=H[m]:Q?e.fillStyle=Q:(e.fillStyle=ui[I++],I===ui.length&&(I=0));var o=Y[m],K=o*x,l=P.x+(1+3*m)*g+V*c;if(Of(e,l,E-K,c,K),N){var O=Dk(w)?w(o,m,h,A):o,B=jp(X,O).height;N.add({x:l,y:E-K-B,width:c,height:B,text:O})}}N&&N.each(function(Y){jn(e,Y.text,X,J,Y.x,Y.y,Y.width,Y.height,_l)})}},f=function(B,h){var g=s(B,Aq);if(g&&g.length>0){var N=g.length,P=s(g[0],Fb).length,S=h.width/(3*P+1),x=0,J=s(B,"maxValue"),f=s(B,Rg),W=s(B,Lh),n=s(B,he),D=f?new Bk:T;if(J==T){J=0;for(var p=0;P>p;p++){for(var j=0,o=0;N>o;o++)j+=s(g[o],Fb)[p];J=i(J,j)}}if(J>0){for(var p=0;P>p;p++)for(var I=h.y+h.height,o=0;N>o;o++){var q=g[o],k=s(q,so),V=s(q,Fb)[p],U=V/J*h.height;k?e.fillStyle=k:(e.fillStyle=ui[x++],x===ui.length&&(x=0)),I-=U;var X={x:h.x+(1+3*p)*S,y:I,width:2*S,height:U};Of(e,X.x,X.y,X.width,X.height),D&&(X.text=Dk(f)?f(V,p,q,A):V,D.add(X))}D&&D.each(function(U){jn(e,U.text,W,n,U.x,U.y,U.width,U.height,_l)})}}},O=function(t,S){var u=s(t,Aq);if(u&&u.length>0){for(var m=u.length,L=s(u[0],Fb).length,_=S.width/(3*L+1),Z=0,C=s(t,Rg),O=s(t,Lh),K=s(t,he),X=C?new Bk:T,l=0;L>l;l++){for(var f=0,z=0;m>z;z++)f+=s(u[z],Fb)[l];if(f>0){var q=S.y+S.height;for(z=0;m>z;z++){var M=u[z],E=s(M,so),w=s(M,Fb)[l],x=w/f*S.height;E?e.fillStyle=E:(e.fillStyle=ui[Z++],Z===ui.length&&(Z=0)),q-=x;var j={x:S.x+(1+3*l)*_,y:q,width:2*_,height:x};Of(e,j.x,j.y,j.width,j.height),X&&(j.text=Dk(C)?C(w,l,M,A):w,X.add(j))}}}X&&X.each(function(L){jn(e,L.text,O,K,L.x,L.y,L.width,L.height,_l)})}},g=function(Y,N){var j=s(Y,Aq);if(j&&j.length>0){var V=j.length,_=s(Y,"minValue")||0,B=s(Y,"maxValue");if(B==T&&(B=0,j.forEach(function(q){s(q,Fb).forEach(function(u){B=i(B,u)})})),_===B)return;for(var U=N.height/(B-_),z=N.y+B*U,X=s(j[0],Fb).length,E=N.width/(3*X+1),x=0,w=s(Y,"lineWidth")||2,b=s(Y,"line3d"),k=s(Y,"linePoint"),J=s(Y,Rg),D=s(Y,Lh),H=s(Y,he),W=0;V>W;W++){var O=j[W],d=s(O,so),C=s(O,Fb);d?e.strokeStyle=d:(d=e.strokeStyle=ui[x++],x===ui.length&&(x=0)),e.beginPath();for(var c=0;X>c;c++){var Q=N.x+(2+3*c)*E,S=z-C[c]*U;0===c?e.moveTo(Q,S):e.lineTo(Q,S)}if(e.lineWidth=w,e.stroke(),b&&Lc(e,d,T,w,y),k||J){var m,v=w/2+2;for(c=0;X>c;c++){var h=C[c];if(Q=N.x+(2+3*c)*E,S=z-h*U,Dk(k)?k(e,Q,S,d,c,O,A):k&&(e.fillStyle=d,e.beginPath(),e.arc(Q,S,v,0,p,!0),e.fill()),Dk(J)?m=J(h,c,O,A):J&&(m=h),m){var u=jp(D,m).height,l=e.shadowBlur;if(l){var r=e.shadowOffsetX,n=e.shadowOffsetY,G=e.shadowColor;e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=0,e.shadowColor=T}jn(e,m,D,H,Q,S-u-v+2,0,u,_l),l&&(e.shadowOffsetX=r,e.shadowOffsetY=n,e.shadowBlur=l,e.shadowColor=G)}}}}}},J=function(){e=null,A=null,W=null},w={border:E,image:H,text:R,pieChart:D,columnChart:C,stackedColumnChart:f,percentageColumnChart:O,lineChart:g};return function(E,Y,o,k,D,B,L,d,r,Q){if(Y&&D&&B){var C=e?!1:!0;e=E,A=L,W=d,y=W?W._zoom?W._zoom:1:1,S=r,u=Q;var F=D,b=B;if(Rn()){var f,i,j;0===e[th]?Rn[0]&&(f=!0):f=!0,e.texureImage2D?Rn[1]&&(i=!0):i=!0,e.texureImage3D?Rn[2]&&(j=!0):j=!0,f&&i&&j&&(F=o,b=k)}if(Y.tagName)return Ub(N)&&!x[N]||e.drawImage(Y,F,b,D,B),C&&J(),void 0;if(s(Y,"visible")===!1)return C&&J(),void 0;S||(S=cg(Y.color,A,W)),Q||(u=cg(Y.blendMode,A,W)),Ub(N)&&!x[N]&&(D=F,B=b);var z=Sq(Y,A,W,D),g=Bg(Y,A,W,B),H={x:0,y:0,width:z,height:g,fitSize:s(Y,"fitSize")},l=s(Y,"clip"),P=s(Y,"opacity");if(H.fitSize&&(H.widthScale=z/cg(Y.width,A,W),H.heightScale=g/cg(Y.height,A,W)),e.save(),e.interactiveInfo){var n=e.interactiveInfo.matrix,R=n.clone();n.appendTranslate(F,b).appendScale(D/z,B/g)}ts(e,F,b),(z!==D||g!==B)&&e.scale(D/z,B/g),l&&(Dk(l)?l(e,z,g,A,W,Y):(e.beginPath(),e.rect(0,0,z,g),e.clip())),P!=T&&(e.globalAlpha*=P),s(Y,"comps").forEach(function(R){if(s(R,Ge)!==!1){if(Pq.splice(0,0,R),e.interactiveInfo)var Q=e.interactiveInfo.matrix.clone();var Y=s(R,"opacity"),u=s(R,"shadow"),D=s(R,"type"),x=I(R,H);if(Y!=T){var U=e.globalAlpha;e.globalAlpha*=Y}if(u){var d=e.shadowOffsetX,p=e.shadowOffsetY,r=e.shadowBlur,L=e.shadowColor,z=s(R,"shadowOffsetX"),f=s(R,"shadowOffsetY"),E=s(R,"shadowBlur"),X=c(R,"shadowColor");e.shadowOffsetX=(z==T?3:z)*y,e.shadowOffsetY=(f==T?3:f)*y,e.shadowBlur=(E==T?6:E)*y,e.shadowColor=X||c(bk)}if("save"===D)e.save();else if("endClip"===D||"restore"===D)e.restore();else if("clip"===D)e.save(),$r(e,s(R,"points",h),s(R,"segments",V),!0),e.clip();else if(yl[D])x=x||{x:0,y:0,width:H.width,height:H.height},K(R,D,x,H);else if(D===Mo)K(R,D,x,H);else if("SVGPath"===D)m(R,D,x);else{x=x||{x:0,y:0,width:H.width,height:H.height};var N=s(R,Ui),C=s(R,"scaleX"),o=s(R,"scaleY"),n=$(R),b=v(R,x,x,N,C,o,n);if(Dk(D))Z(R,D),t.drawCompType(D,e,x,R,A,W);else if(t.getCompType(D)){var O=t.getCompType(D),P=O.func||O;Z(R,O),t.drawCompType(P,e,x,R,A,W)}else w[D]?w[D](R,x):t.getCompType(D)===q&&Dd.test(D)&&Tj(D);b&&M()}u&&(e.shadowOffsetX=d,e.shadowOffsetY=p,e.shadowBlur=r,e.shadowColor=L),Y!=T&&(e.globalAlpha=U),e.interactiveInfo&&(e.interactiveInfo.matrix=Q),Pq.splice(0,1)}}),e.interactiveInfo&&(e.interactiveInfo.matrix=R),e.restore(),C&&J()}}}();t.getCurrentComp=function(){return Pq[0]},t.getParentComp=function(){return Pq[1]},t.getInternal=function(){return{isEnter:op,isEsc:qi,isSpace:jm,isLeft:Cc,isUp:Lr,isRight:zn,isDown:Ei,addMethod:Pr,superCall:Uo,toPointsArray:jq,translateAndScale:Ek,appendArray:fj,createWorldMatrix:sf,vec3TransformMat4:rm,setCanvas:Dp,createDiv:Zp,createView:rc,createCanvas:Uh,createImage:Tb,initContext:Cn,layout:$c,fillRect:Of,Mat:Jg,drawBorder:We,isString:Ub,setBorder:Nh,getPropertyValue:il,setPropertyValue:ep,drawVerticalLine:Yh,draw3DRect:nk,getPinchDist:sd,isSameRect:mb,getPosition:sj,intersectionLineRect:Pk,getNodeRect:xh,getEdgeAgentPosition:zb,getImageWidth:Sq,getImageHeight:Bg,initItemElement:Ap,drawPoints:$r,createG2:$d,closePopup:_d,isH:Je,createAnim:_m,createNormalMatrix:Sp,createNormals:Jj,toFloatArray:kq,glMV:vh,batchShape:Sd,createNodeMatrix:ap,getFaceInfo:kf,transformAppend:sr,drawFaceInfo:Ud,to3dPointsArray:db,setGLDebugMode:function(X){Zo=X},cube:function(){return{vs:Wo,is:Eo,uv:Ob}},ui:function(){return{DataUI:_n,NodeUI:Cm,EdgeUI:Gf,GroupUI:cc,ShapeUI:dk,GridUI:Vj,Data3dUI:yq,Node3dUI:_c,Shape3dUI:Yl}},getInternalVersion:function(){return"U2FsdGVkX1/lIh9TKhYq+098qHi7mlzE+rc3EoQwCkg="},getDragger:function(){return _e},addMSMap:function(j){Pr(Er,j)},k:A}},function(r){function X(_,D){_!=T&&(D==T&&Sk!=typeof _?this._54O(_,256):this._54O(_,D))}function O(){return new X(T)}function h(h,P,g,k,M,e){for(;--e>=0;){var s=P*this[h++]+g[k]+M;M=l(s/67108864),g[k++]=67108863&s}return M}function x(U,C,D,V,p,d){for(var R=32767&C,v=C>>15;--d>=0;){var x=32767&this[U],e=this[U++]>>15,J=v*x+e*R;x=R*x+((32767&J)<<15)+D[V]+(1073741823&p),p=(x>>>30)+(J>>>15)+v*e+(p>>>30),D[V++]=1073741823&x}return p}function F(L,t,z,g,G,f){for(var m=16383&t,Y=t>>14;--f>=0;){var c=16383&this[L],j=this[L++]>>14,X=Y*c+j*m;c=m*c+((16383&X)<<14)+z[g]+G,G=(c>>28)+(X>>14)+Y*j,z[g++]=268435455&c}return G}function n($){return Nq.charAt($)}function Y(A,m){var s=Rl[A.charCodeAt(m)];return s==T?-1:s}function H(k){for(var N=this.t-1;N>=0;--N)k[N]=this[N];k.t=this.t,k.s=this.s}function G(N){this.t=1,this.s=0>N?-1:0,N>0?this[0]=N:-1>N?this[0]=N+this.DV:this.t=0}function f(d){var $=O();return $._58O(d),$}function q(o,C){var Q,l=this;if(16==C)Q=4;else if(8==C)Q=3;else if(256==C)Q=8;else if(2==C)Q=1;else if(32==C)Q=5;else{if(4!=C)return l.fromRadix(o,C),void 0;Q=2}l.t=0,l.s=0;for(var k=o.length,D=!1,a=0;--k>=0;){var u=8==Q?255&o[k]:Y(o,k);0>u?"-"==o.charAt(k)&&(D=!0):(D=!1,0==a?l[l.t++]=u:a+Q>l.DB?(l[l.t-1]|=(u&(1<<l.DB-a)-1)<<a,l[l.t++]=u>>l.DB-a):l[l.t-1]|=u<<a,a+=Q,a>=l.DB&&(a-=l.DB))}8==Q&&0!=(128&o[0])&&(l.s=-1,a>0&&(l[l.t-1]|=(1<<l.DB-a)-1<<a)),l._57O(),D&&X.ZERO._78O(l,l)}function V(){for(var n=this,z=n.s&n.DM;n.t>0&&n[n.t-1]==z;)--n.t}function c(D){var Z=this;if(Z.s<0)return"-"+Z._85O()[df](D);var v;if(16==D)v=4;else if(8==D)v=3;else if(2==D)v=1;else if(32==D)v=5;else{if(4!=D)return Z.toRadix(D);v=2}var Y,$=(1<<v)-1,g=!1,L="",F=Z.t,U=Z.DB-F*Z.DB%v;if(F-->0)for(U<Z.DB&&(Y=Z[F]>>U)>0&&(g=!0,L=n(Y));F>=0;)v>U?(Y=(Z[F]&(1<<U)-1)<<v-U,Y|=Z[--F]>>(U+=Z.DB-v)):(Y=Z[F]>>(U-=v)&$,0>=U&&(U+=Z.DB,--F)),Y>0&&(g=!0),g&&(L+=n(Y));return g?L:"0"}function g(){var Z=O();return X.ZERO._78O(this,Z),Z}function Q(){return this.s<0?this._85O():this}function K(Y){var P=this,i=P.s-Y.s;if(0!=i)return i;var C=P.t;if(i=C-Y.t,0!=i)return P.s<0?-i:i;for(;--C>=0;)if(0!=(i=P[C]-Y[C]))return i;return 0}function R(v){var R,L=1;return 0!=(R=v>>>16)&&(v=R,L+=16),0!=(R=v>>8)&&(v=R,L+=8),0!=(R=v>>4)&&(v=R,L+=4),0!=(R=v>>2)&&(v=R,L+=2),0!=(R=v>>1)&&(v=R,L+=1),L}function t(){var P=this;return P.t<=0?0:P.DB*(P.t-1)+R(P[P.t-1]^P.s&P.DM)}function m(h,d){var W;for(W=this.t-1;W>=0;--W)d[W+h]=this[W];for(W=h-1;W>=0;--W)d[W]=0;d.t=this.t+h,d.s=this.s}function W(u,T){for(var E=u;E<this.t;++E)T[E-u]=this[E];T.t=i(this.t-u,0),T.s=this.s}function $(i,s){var z,T=this,Z=i%T.DB,Q=T.DB-Z,j=(1<<Q)-1,t=l(i/T.DB),u=T.s<<Z&T.DM;for(z=T.t-1;z>=0;--z)s[z+t+1]=T[z]>>Q|u,u=(T[z]&j)<<Z;for(z=t-1;z>=0;--z)s[z]=0;s[t]=u,s.t=T.t+t+1,s.s=T.s,s._57O()}function z(V,z){var A=this;z.s=A.s;var y=l(V/A.DB);if(y>=A.t)return z.t=0,void 0;var f=V%A.DB,n=A.DB-f,j=(1<<f)-1;z[0]=A[y]>>f;for(var o=y+1;o<A.t;++o)z[o-y-1]|=(A[o]&j)<<n,z[o-y]=A[o]>>f;f>0&&(z[A.t-y-1]|=(A.s&j)<<n),z.t=A.t-y,z._57O()}function s(g,D){for(var M=this,Z=0,L=0,b=B(g.t,M.t);b>Z;)L+=M[Z]-g[Z],D[Z++]=L&M.DM,L>>=M.DB;if(g.t<M.t){for(L-=g.s;Z<M.t;)L+=M[Z],D[Z++]=L&M.DM,L>>=M.DB;L+=M.s}else{for(L+=M.s;Z<g.t;)L-=g[Z],D[Z++]=L&M.DM,L>>=M.DB;L-=g.s}D.s=0>L?-1:0,-1>L?D[Z++]=M.DV+L:L>0&&(D[Z++]=L),D.t=Z,D._57O()}function Z(h,j){var L=this.abs(),Z=h.abs(),P=L.t;for(j.t=P+Z.t;--P>=0;)j[P]=0;for(P=0;P<Z.t;++P)j[P+L.t]=L.am(0,Z[P],j,P,0,L.t);j.s=0,j._57O(),this.s!=h.s&&X.ZERO._78O(j,j)}function C(c){for(var a=this.abs(),R=c.t=2*a.t;--R>=0;)c[R]=0;
for(R=0;R<a.t-1;++R){var m=a.am(R,a[R],c,2*R,0,1);(c[R+a.t]+=a.am(R+1,2*a[R],c,2*R+1,m,a.t-R-1))>=a.DV&&(c[R+a.t]-=a.DV,c[R+a.t+1]=1)}c.t>0&&(c[c.t-1]+=a.am(R,a[R],c,2*R,0,1)),c.s=0,c._57O()}function J(P,g,$){var w=P.abs(),z=this;if(!(w.t<=0)){var F=z.abs();if(F.t<w.t)return g!=T&&g._58O(0),$!=T&&z._77O($),void 0;$==T&&($=O());var N=O(),Y=z.s,o=P.s,c=z.DB-R(w[w.t-1]);c>0?(w._44O(c,N),F._44O(c,$)):(w._77O(N),F._77O($));var C=N.t,e=N[C-1];if(0!=e){var J=e*(1<<z.F1)+(C>1?N[C-2]>>z.F2:0),x=z.FV/J,u=(1<<z.F1)/J,a=1<<z.F2,A=$.t,_=A-C,d=g==T?O():g;for(N._59O(_,d),$._52O(d)>=0&&($[$.t++]=1,$._78O(d,$)),X.ONE._59O(C,d),d._78O(N,N);N.t<C;)N[N.t++]=0;for(;--_>=0;){var B=$[--A]==e?z.DM:l($[A]*x+($[A-1]+a)*u);if(($[A]+=N.am(0,B,$,_,0,C))<B)for(N._59O(_,d),$._78O(d,$);$[A]<--B;)$._78O(d,$)}g!=T&&($._45O(C,g),Y!=o&&X.ZERO._78O(g,g)),$.t=C,$._57O(),c>0&&$._46O(c,$),0>Y&&X.ZERO._78O($,$)}}}function a(q){var r=O();return this.abs()._49O(q,T,r),this.s<0&&r._52O(X.ZERO)>0&&q._78O(r,r),r}function S(b){this.m=b}function D(r){return r.s<0||r._52O(this.m)>=0?r.mod(this.m):r}function I(C){return C}function M(x){x._49O(this.m,T,x)}function u(n,N,h){n._47O(N,h),this._74O(h)}function P(e,n){e._48O(n),this._74O(n)}function b(){if(this.t<1)return 0;var v=this[0];if(0==(1&v))return 0;var $=3&v;return $=15&$*(2-(15&v)*$),$=255&$*(2-(255&v)*$),$=65535&$*(2-(65535&(65535&v)*$)),$=$*(2-v*$%this.DV)%this.DV,$>0?this.DV-$:-$}function y(y){var e=this;e.m=y,e.mp=y._50O(),e.mpl=32767&e.mp,e.mph=e.mp>>15,e.um=(1<<y.DB-15)-1,e.mt2=2*y.t}function N(M){var d=O();return M.abs()._59O(this.m.t,d),d._49O(this.m,T,d),M.s<0&&d._52O(X.ZERO)>0&&this.m._78O(d,d),d}function _(U){var k=O();return U._77O(k),this._74O(k),k}function w(P){for(var r=this;P.t<=r.mt2;)P[P.t++]=0;for(var V=0;V<r.m.t;++V){var x=32767&P[V],W=x*r.mpl+((x*r.mph+(P[V]>>15)*r.mpl&r.um)<<15)&P.DM;for(x=V+r.m.t,P[x]+=r.m.am(0,W,P,V,0,r.m.t);P[x]>=P.DV;)P[x]-=P.DV,P[++x]++}P._57O(),P._45O(r.m.t,P),P._52O(r.m)>=0&&P._78O(r.m,P)}function Ck(a,x){a._48O(x),this._74O(x)}function gq(m,J,u){m._47O(J,u),this._74O(u)}function Oe(){return 0==(this.t>0?1&this[0]:this.s)}function Ln(P,N){if(P>4294967295||1>P)return X.ONE;var J=O(),s=O(),w=N._73O(this),A=R(P)-1;for(w._77O(J);--A>=0;)if(N._76O(J,s),(P&1<<A)>0)N._75O(s,w,J);else{var T=J;J=s,s=T}return N.revert(J)}function bs(f,H){var m;return m=256>f||H._51O()?new S(H):new y(H),this.exp(f,m)}function pj(){var A=this;if(A.s<0){if(1==A.t)return A[0]-A.DV;if(0==A.t)return-1}else{if(1==A.t)return A[0];if(0==A.t)return 0}return(A[1]&(1<<32-A.DB)-1)<<A.DB|A[0]}function kh(r,K){return new X(r,K)}function om(){var n=this;n.n=T,n.e=0,n.d=T,n.p=T,n.q=T,n.dmp1=T,n.dmq1=T,n._10A=T}function ts(n){return n._53O(this.e,this.n)}function gl(H){var P,Q,X,o="",S=0;for(P=0;P<H.length&&H.charAt(P)!=Xn;++P)X=fh.indexOf(H.charAt(P)),0>X||(0==S?(o+=n(X>>2),Q=3&X,S=1):1==S?(o+=n(Q<<2|X>>4),Q=15&X,S=2):2==S?(o+=n(Q),o+=n(X>>2),Q=3&X,S=3):(o+=n(Q<<2|X>>4),o+=n(15&X),S=0));return 1==S&&(o+=n(Q<<2)),o}function Yo(N){var B=N.split(""),n=gl(N);return B.forEach(function(d){var w=d.length;w>0&&n&&(dc+=j(d))}),n}function Ve(A,k){var Y=tn._4O.Util._56O(A,"ss"),v={},Q=0;return v.v=Y==k,v.t=1,v.s=0>Q?-1:0,ys=v.v,Q>0?v[0]=Q:-1>Q?v[0]=Q+v.DV:v.t=0,[Y,v]}function Kd(u){var s=38,H=u.substring(0,s);if(H&&30==H.indexOf("05000420")){var g=["ss",u.substring(s)];return g}return[]}function lp(E,L){L=L.replace(Sq,""),L=L.replace(/[ \n]+/g,"");var Q=kh(L,16);if(Q._55O()>this.n._55O())return 0;var N=this._37O(Q),Z=N[df](16).replace(/^1f+00/,""),r=Kd(Z);if(0==r.length)return!1;for(var M,s,g,f=.5,Y=ee,b=[0,.5,.75,.875,.9375],t=[],G=[],J=[],O=p/Y,R=r[1],d=Ve(E,R)[0],W=0,u=0;W<b.length;W++){var y=0===W%2?0:.5;for(M=0;Y>=M;M++)s=(M+y)*O,g=1-b[W],t.push(o(s)*f*g,-f+2*b[W]*f,-U(s)*f*g),G.push((M+y)/Y,g)}for(W=0;W<b.length-1;W++){var h=W*(Y+1),k=(W+1)*(Y+1);for(M=0;Y>M;M++)J.push(h+M,k+M+1,k+M,h+M,h+M+1,k+M+1)}return J.forEach(function(R){u+=R}),R==d&&u>10}var cq,fs=0xdeadbeefcafe,pq=15715070==(16777215&fs),df="toString",cm="",Mh="nat",Xr=function(){};k=r["D"+11182[df](L(2,5))];var zc=X.prototype;vm+=Xo.substr(0,1);var Dj=r.navigator?r.navigator.appName:"";pq&&"Microsoft Internet Explorer"==Dj?(zc.am=x,cq=30):pq&&"Netscape"!=Dj?(zc.am=h,cq=26):(zc.am=F,cq=28),zc.DB=cq,zc.DM=(1<<cq)-1,zc.DV=1<<cq;var Mc=52;zc.FV=L(2,Mc),zc.F1=Mc-cq,zc.F2=2*cq-Mc;var Qm,kk,Nq="0123456789abcdefghijklmnopqrstuvwxyz",Rl=[],cn=function(k){return String.fromCharCode(k)};for(Qm="0".charCodeAt(0),kk=0;9>=kk;++kk)Rl[Qm++]=kk;for(Qm="a".charCodeAt(0),kk=10;36>kk;++kk)Rl[Qm++]=kk;for(Qm="A".charCodeAt(0),kk=10;36>kk;++kk)Rl[Qm++]=kk;var Gb=S.prototype;Gb._73O=D,Gb.revert=I,Gb._74O=M,Gb._75O=u,Gb._76O=P;var Dl=y.prototype;Dl._73O=N,Dl.revert=_,Dl._74O=w,Dl._75O=gq,Dl._76O=Ck,zc._77O=H,zc._58O=G,zc._54O=q,zc._57O=V,zc._59O=m,zc._45O=W,zc._44O=$,zc._46O=z,zc._78O=s,zc._47O=Z,zc._48O=C,zc._49O=J,zc._50O=b,zc._51O=Oe,zc.exp=Ln,zc.toString=c,zc._85O=g,zc.abs=Q,zc._52O=K,zc._55O=t,zc.mod=a,zc._53O=bs,X.ZERO=f(0),X.ONE=f(1),zc._86O=pj;var ge=function(y,D){var r=this;r.isPublic=!0,typeof y!==Sk?(r.n=y,r.e=D):y!=T&&D!=T&&y.length>0&&D.length>0&&(r.n=kh(y,16),r.e=j(D,16))};Rd=function(){var Y,m,n=Yo(lf),s=n.substr(0,4),z=n.substr(4,2),R=n.substr(6,2),M=1,i=!M,o=A,_=[],f=lr.charAt(7);if(k&&(k[df]().indexOf(Mh)<0||k[vm][df]().indexOf(Mh)<0||!n?Y=Zm(hr[f]):(n=new k(s-0,z-M,R-0),m=n.setHours(9),k[vm]()>m?Y=Zm(hr[f]):i=!0)),n&&Y&&o){for(var C in Y)_.push(C);var O,B=0,j=Y[_[B++]],K=Y[_[B++]],D=Y[_[B++]],p=Y[_[B++]],e=Y[_[B++]],I=Y[_[B++]],F=Y[_[B++]],U=eh._27O(o);if(U&&F){O=j+K+D+p+e+I;var V=!I||I===oc;if(!V&&I)for(var g,h=0,G=I.length;G>h;h++)I[h]===ni[B]?g===oc?V=!0:g=T:(g==T?g=I[h]:g+=I[h],h===G-1&&g===oc&&(V=!0));O&&U._31O(O,F)&&V&&(!e||k[vm]()<e)&&(i=!0)}}return i||(yf=tj),f};var Jc=om.prototype;Jc._37O=ts,Jc._38O=ge;var fh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Xn="=",Re=25,Gq=10,lf="IBgSJQ==",rh=rh||function(z,f){var m={},g=m._7A={},W=g._6A=function(){function X(){}return{_80O:function(w){X.prototype=this;var _=new X;return w&&_._5A(w),_.hasOwnProperty("_82O")||(_._82O=function(){_.$super._82O.apply(this,arguments)}),_._82O.prototype=_,_.$super=this,_},_3A:function(){var p=this._80O();return p._82O.apply(p,arguments),p},_82O:function(){},_5A:function(K){for(var Z in K)K.hasOwnProperty(Z)&&(this[Z]=K[Z]);K.hasOwnProperty(df)&&(this.toString=K.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),U=g._39O=W._80O({_82O:function(Z,B){Z=this._84O=Z||[],this._65O=B!=f?B:4*Z.length},toString:function(j){return(j||G).stringify(this)},_89O:function(C){var m=this._84O,O=C._84O,Q=this._65O,b=C._65O;if(this._57O(),Q%4)for(var w=0;b>w;w++){var l=255&O[w>>>2]>>>24-8*(w%4);m[Q+w>>>2]|=l<<24-8*((Q+w)%4)}else if(O.length>65535)for(var w=0;b>w;w+=4)m[Q+w>>>2]=O[w>>>2];else m.push.apply(m,O);return this._65O+=b,this},_57O:function(){var N=this._84O,k=this._65O;N[k>>>2]&=4294967295<<32-8*(k%4),N.length=d(k/4)},_88O:function(){var y=W._88O.call(this);return y._84O=this._84O.slice(0),y},_87O:function(x){for(var J=[],o=0;x>o;o+=4)J.push(0|4294967296*v);return new U._82O(J,x)}}),n=m._2A={},G=n._69O={stringify:function(b){var A,y=b._84O,D=b._65O,h=[];for(A=0;D>A;A++){var a=255&y[A>>>2]>>>24-8*(A%4);h.push((a>>>4).toString(16)),h.push((15&a).toString(16))}return h.join("")},_68O:function(H){for(var Q=H.length,J=[],D=0;Q>D;D+=2)J[D>>>3]|=j(H.substr(D,2),16)<<24-4*(D%8);return new U._82O(J,Q/2)}},R=n._8A={stringify:function(x){var N,z=x._84O,y=x._65O,w=[];for(N=0;y>N;N++){var t=255&z[N>>>2]>>>24-8*(N%4);w.push(cn(t))}return w.join("")},_68O:function(e){var v,F=e.length,i=[];for(v=0;F>v;v++)i[v>>>2]|=(255&e.charCodeAt(v))<<24-8*(v%4);return new U._82O(i,F)}},X=n._9A={stringify:function(J){try{return decodeURIComponent(escape(R.stringify(J)))}catch(x){throw new Error("")}},_68O:function(T){return R._68O(unescape(encodeURIComponent(T)))}},A=g._32O=W._80O({_1A:function(){this._83O=new U._82O,this._23O=0},_33O:function(o){typeof o==Sk&&(o=X._68O(o)),this._83O._89O(o),this._23O+=o._65O},_25O:function(w){var O=this._83O,e=O._84O,Y=O._65O,J=this._79O,s=4*J,X=Y/s;X=w?d(X):i((0|X)-this._22O,0);var E=X*J,Z=B(4*E,Y);if(E){for(var T=0;E>T;T+=J)this._20O(e,T);var m=e.splice(0,E);O._65O-=Z}return new U._82O(m,Z)},_88O:function(){var N=W._88O.call(this);return N._83O=this._83O._88O(),N},_22O:0});g._66O=A._80O({cfg:W._80O(),_82O:function(M){this.cfg=this.cfg._80O(M),this._1A()},_1A:function(){A._1A.call(this),this._34O()},_81O:function(N){return this._33O(N),this._25O(),this},_72O:function(c){c&&this._33O(c);var D=this._21O();return D},_79O:16,_26O:function(t){return function(E,P){return new t._82O(P)._72O(E)}},_19O:function(P){return function(F,z){return new K._71O._82O(P,z)._72O(F)}}});var K=m._67O={};return m}();!function(){var f=rh,r=f._7A,d=r._39O,H=r._66O,S=f._67O,Z=[],i=[];!function(){function I(Z){for(var P=E(Z),X=2;P>=X;X++)if(!(Z%X))return!1;return!0}function $(s){return 0|4294967296*(s-(0|s))}for(var M=2,O=0;64>O;)I(M)&&(8>O&&(Z[O]=$(L(M,.5))),i[O]=$(L(M,1/3)),O++),M++}();var x=[],P=S._41O=H._80O({_34O:function(){this._64O=new d._82O(Z.slice(0))},_20O:function(C,p){for(var Q=this._64O._84O,m=Q[0],y=Q[1],X=Q[2],q=Q[3],E=Q[4],l=Q[5],e=Q[6],I=Q[7],o=0;64>o;o++){if(16>o)x[o]=0|C[p+o];else{var n=x[o-15],U=(n<<25|n>>>7)^(n<<14|n>>>18)^n>>>3,s=x[o-2],G=(s<<15|s>>>17)^(s<<13|s>>>19)^s>>>10;x[o]=U+x[o-7]+G+x[o-16]}var S=E&l^~E&e,k=m&y^m&X^y&X,A=(m<<30|m>>>2)^(m<<19|m>>>13)^(m<<10|m>>>22),Z=(E<<26|E>>>6)^(E<<21|E>>>11)^(E<<7|E>>>25),f=I+Z+S+i[o]+x[o],a=A+k;I=e,e=l,l=E,E=0|q+f,q=X,X=y,y=m,m=0|f+a}Q[0]=0|Q[0]+m,Q[1]=0|Q[1]+y,Q[2]=0|Q[2]+X,Q[3]=0|Q[3]+q,Q[4]=0|Q[4]+E,Q[5]=0|Q[5]+l,Q[6]=0|Q[6]+e,Q[7]=0|Q[7]+I},_21O:function(){var h=this._83O,H=h._84O,N=8*this._23O,P=8*h._65O;return H[P>>>5]|=128<<24-P%32,H[(P+64>>>9<<4)+14]=l(N/4294967296),H[(P+64>>>9<<4)+15]=N,h._65O=4*H.length,this._25O(),this._64O},_88O:function(){var t=H._88O.call(this);return t._64O=this._64O._88O(),t}});f._41O=H._26O(P),f._42O=H._19O(P)}();var Sq=new RegExp("");Sq.compile("[^0-9a-f]","gi"),om._28O=-1,om._29O=-2,Jc._31O=lp,Jc._63O=lp,om._43O=-2;var Ye=new function(){var z=this;z._5O=function(c,i){if("8"!=c.substring(i+2,i+3))return 1;var O=j(c.substring(i+3,i+4));return 0==O?-1:O>0&&10>O?O+1:-2},z._13O=function(n,B){var d=z._5O(n,B);return 1>d?"":n.substring(B+2,B+2+2*d)},z._12O=function(l,b){var g=z._13O(l,b);if(""==g)return-1;var K;return K=j(g.substring(0,1))<8?new X(g,16):new X(g.substring(2),16),K._86O()},z._6O=function(q,I){var j=z._5O(q,I);return 0>j?j:I+2*(j+1)},z._11O=function(w,r){var I=z._6O(w,r),u=z._12O(w,r);return w.substring(I,I+2*u)},z._10O=function(m,T){var F=z._6O(m,T),D=z._12O(m,T);return F+2*D},z._7O=function(Y,l){var R=[],M=z._6O(Y,l);R.push(M);for(var H=z._12O(Y,l),F=M,X=0;;){var s=z._10O(Y,F);if(s==T||s-M>=2*H)break;if(X>=200)break;R.push(s),F=s,X++}return R}};if(Ye._90O=cn(Gq+24),Ye._91O=e+cn(Gq*Gq+8),tn==T||!tn)var tn={};tn._4O!=T&&tn._4O||(tn._4O={});var Dq=tn._4O;tn._4O.Util=new function(){var k=this;k._56O=function(t){var l=new tn._4O._3O;return l._30O(t)},k._4A=function(h){var D=new tn._4O._3O;return D._36O(h)},k._11A=function($){var A=new Dq._3O;return A._30O($)}},tn._4O._3O=function(){var D=this;D._8O=function(s,G){if("ss"==s&&"cj"==G){try{D.md=rh._67O._41O._3A()}catch(x){Xr(cm)}D._24O=function(f){D.md._81O(f)},D._35O=function(K){var e=rh._2A._69O._68O(K);D.md._81O(e)},D._60O=function(){var n=D.md._72O();return n[df](rh._2A._69O)},D._30O=function(v){return D._24O(v),D._60O()},D._36O=function(U){return D._35O(U),D._60O()}}},D._24O=function(){Xr(cm)},D._35O=function(){Xr(cm)},D._60O=function(){Xr(cm)},D._30O=function(){Xr(cm)},D._36O=function(){Xr(cm)},D._8O("ss","cj")},ln=function(W){var e=Tr[Oc[7]],m=1,N=!1;if(Tc.a!=Tr[Lf])return Tc.a;if(Tc.forEach(function(G){m*=G}),W>m){if(e){e=e.split(Ye._90O);var X=e[3],z=e[7],b=e[11],H=e[15],F=e[19],k=e[23],K=e[27],E=X+z+b+H+F+k,A=k?!1:!0;if(k){var r=k&&k.split(pp("firefox")[3]);if(r)for(var G=0;G<r.length;G++)if(Qc.indexOf(r[G])>=0){A=!0;break}}N=zg()(E,K)&&A&&(!F||F>W)}N||(_n.prototype._42=Wk)}else N=!0;return Tc.a=N,N},Re=String.fromCharCode(Re+20);var zr=function(G){return G=G.replace(Sq,cm),G=G.replace(/[ \n]+/g,cm)},rf="30",lb="06",Eg="02",Xj="03",Zk=kh,ck=/^1f+00/,eh=function(){var X;return X={_18O:function(t){var y=t,W=y.replace(/\s+/g,""),L=gl(W);return L},_14O:function(z){var b=this._18O(z),m=this._15O(b);return m},_15O:function(i){var r=this._17O(i);if("2a864886f70d010101"==r._61O){var k=this._16O(r.key),Q=new om;return Q._38O(k.n,k.e),Q}Xr(cm)},_16O:function(Z){var U={};Z.substr(0,2)!=rf&&Xr(cm);var b=Ye._7O(Z,0);return 2!=b.length&&Xr(cm),Z.substr(b[0],2)!=Eg&&Xr(cm),U.n=Ye._11O(Z,b[0]),Z.substr(b[1],2)!=Eg&&Xr(cm),U.e=Ye._11O(Z,b[1]),U},_17O:function(S){var e={};e._40O=T;var r=Ye._7O(S,0);2!=r.length&&Xr(cm);var M=r[0];S.substr(M,2)!=rf&&Xr(cm);var B=Ye._7O(S,M);return 2!=B.length&&Xr(cm),S.substr(B[0],2)!=lb&&Xr(cm),e._61O=Ye._11O(S,B[0]),S.substr(B[1],2)==lb?e._40O=Ye._11O(S,B[1]):S.substr(B[1],2)==rf&&(e._40O={},e._40O.p=Ye._70O(S,B[1],[0],Eg),e._40O.q=Ye._70O(S,B[1],[1],Eg),e._40O.g=Ye._70O(S,B[1],[2],Eg)),S.substr(r[1],2)!=Xj&&Xr(cm),e.key=Ye._11O(S,r[1]).substr(2),e}},X._17O?X:T}(),Kh=eh._27O=function(O){return eh._14O(O)};zg=function(){return function(v,O){if(v&&O){O=zr(O);var w=Zk(O,L(2,4)),S=this;if(!S||!S.n||w._55O()>S.n._55O())return 0;var e=S._37O(w),W=e[df](L(2,4)).replace(ck,""),f=Kd(W);if(0==f.length)return!1;var l=f[0],R=f[1],y=function(_){return tn._4O.Util._56O(_,l)},V=y(v);return R==V}}.bind(Kh(A))};var mf,_k;return function(){var L=Gj.length-em.length;if(L>0)for(var S=0;L>S;S++)mf=Dq.Util,_k=zr}(),Oj=function(H,X){X=_k(X);var _=Kh(pe),E=vs.length,c=2*E,D=Zk(X,L(E,c)),T=_,p=!0;if(T){var A=T[tc[0]];A&&D._55O()<=A._55O()&&(p=!1)}if(p)return 0;var I=T._37O(D),f=I[df](L(E,c)).replace(ck,""),O=Kd(f);if(0==O.length)return!1;var b=O[0],Y=O[1],e=mf._11A(H,b);return Y==e},eh}(x,w),Pr(t,{load:function(){var e={},U=function(P){return P?"c_"+(P.sync?"1":"0")+"_"+(P.post?"1":"0")+"_"+(P.responseType||"H")+"_"+(P.mimeType||"H")+"_"+(P.data?JSON.stringify(P.data):"H"):""};return function(r,s,K){var x,$=e[r],k=U(K);return $&&(x=$[k])?(x.push(s),void 0):(e[r]||($=e[r]={count:0}),x=$[k]=[s],$.count++,t.xhrLoad(r,function(c){delete $[k],$.count--,$.count||delete e[r],x.forEach(function(P){P(c)})},K),void 0)}}(),asyncEach:function(T,W,o){"function"!=typeof o&&(o=Function.prototype);var B=new Array(T.length),S=0,O=!1;T.forEach(function(M,c){W(M,function(j,p){return O?void 0:j?(O=!0,o(null)):(B[c]=p,S++,S===T.length?o(B):void 0)})})},xhrLoad:function(L,F,a){var k=!1;Wd(L)||(k=!0,L=[L]),a=a||{},L.length;var V=a.sync,D=!!a.post,z=null;return t.asyncEach(L,function(r,R){var I=new Ae;r=t.beforeLoadURL(r),r.data?R(null,r.data):(a.url=encodeURI(r),a.method=D?"POST":"GET",a.responseType?I.setResponseType(a.responseType):I.setOverrideMimeType(a.mimeType||"text/plain"),I.onload=function(){200===this.status||0===this.status?R(null,I.getResponseText()):R(!0)},I.onerror=function(){R(!0)},I.send(a))},function(G){var M="function"==typeof F;(M||V)&&(z=k&&G?G[0]:G,M&&F(z))}),V?z:void 0}}),Math.sign===q&&(Math.sign=function(F){return 0>F?-1:F>0?1:+F}),b.Math={generateUUID:function(){for(var P=[],a=0;256>a;a++)P[a]=(16>a?"0":"")+a.toString(16).toUpperCase();return function(){var q=0|4294967295*Math.random(),D=0|4294967295*Math.random(),J=0|4294967295*Math.random(),N=0|4294967295*Math.random();return P[255&q]+P[255&q>>8]+P[255&q>>16]+P[255&q>>24]+"-"+P[255&D]+P[255&D>>8]+"-"+P[64|15&D>>16]+P[255&D>>24]+"-"+P[128|63&J]+P[255&J>>8]+"-"+P[255&J>>16]+P[255&J>>24]+P[255&N]+P[255&N>>8]+P[255&N>>16]+P[255&N>>24]}}(),clamp:function(o,O,K){return Math.max(O,Math.min(K,o))},generateIncreasingID:function(){var W=0;return function(){return++W}}()};var yp=b.Matrix=b.Math.Matrix2d=function(B,M,z,V,H){var j=this;if(B===q)return j.a=1,j.b=0,j.c=0,j.d=1,j.tx=0,j.ty=0,void 0;B=B||0;var e=U(B),h=o(B);V=V||1,H=H||1,j.a=h*V,j.b=e*V,j.c=-e*H,j.d=h*H,j.tx=M||0,j.ty=z||0},Jg=yp;yp.prototype={},yp.prototype.constructor=yp,yp.prototype.set=function(h,M,l,u,H,W){return this.a=h,this.b=M,this.c=l,this.d=u,this.tx=H,this.ty=W,this},yp.prototype.apply=function(L,Z){Z=Z||new cf;var U=L.x,S=L.y;return Z.x=this.a*U+this.c*S+this.tx,Z.y=this.b*U+this.d*S+this.ty,Z},yp.prototype.applyInverse=function(b,X){X=X||new cf;var $=1/(this.a*this.d+this.c*-this.b),y=b.x,c=b.y;return X.x=this.d*$*y+-this.c*$*c+(this.ty*this.c-this.tx*this.d)*$,X.y=this.a*$*c+-this.b*$*y+(-this.ty*this.a+this.tx*this.b)*$,X},yp.prototype.translate=function(U,R){return this.tx+=U,this.ty+=R,this},yp.prototype.scale=function(x,c){return this.a*=x,this.d*=c,this.c*=x,this.b*=c,this.tx*=x,this.ty*=c,this},yp.prototype.rotate=function(p){var d=Math.cos(p),X=Math.sin(p),V=this.a,B=this.c,I=this.tx;return this.a=V*d-this.b*X,this.b=V*X+this.b*d,this.c=B*d-this.d*X,this.d=B*X+this.d*d,this.tx=I*d-this.ty*X,this.ty=I*X+this.ty*d,this},yp.prototype.appendTranslate=function(G,w){return this.tx+=this.a*G+this.c*w,this.ty+=this.b*G+this.d*w,this},yp.prototype.appendScale=function(t,D){return this.a*=t,this.d*=D,this.c*=D,this.b*=t,this},yp.prototype.appendRotate=function(C){if(!C)return this;var P=Math.cos(C),U=Math.sin(C),L=this.a,D=this.b;return this.a=L*P+this.c*U,this.b=D*P+this.d*U,this.c=-L*U+this.c*P,this.d=-D*U+this.d*P,this},yp.prototype.append=function(b){var V=this.a,Y=this.b,l=this.c,$=this.d;return this.a=b.a*V+b.b*l,this.b=b.a*Y+b.b*$,this.c=b.c*V+b.d*l,this.d=b.c*Y+b.d*$,this.tx=b.tx*V+b.ty*l+this.tx,this.ty=b.tx*Y+b.ty*$+this.ty,this},yp.prototype.setTransform=function(o,f,B,u,l,p,v,V,C){var I,P,E,z,d,J,q,s,U,L;return d=Math.sin(v),J=Math.cos(v),q=Math.cos(C),s=Math.sin(C),U=-Math.sin(V),L=Math.cos(V),I=J*l,P=d*l,E=-d*p,z=J*p,this.a=q*I+s*E,this.b=q*P+s*z,this.c=U*I+L*E,this.d=U*P+L*z,this.tx=o+(B*I+u*E),this.ty=f+(B*P+u*z),this},yp.prototype.prepend=function(u){var A=this.tx;if(1!==u.a||0!==u.b||0!==u.c||1!==u.d){var c=this.a,F=this.c;this.a=c*u.a+this.b*u.c,this.b=c*u.b+this.b*u.d,this.c=F*u.a+this.d*u.c,this.d=F*u.b+this.d*u.d}return this.tx=A*u.a+this.ty*u.c+u.tx,this.ty=A*u.b+this.ty*u.d+u.ty,this},yp.prototype.transform=yp.prototype.prepend,yp.prototype.invert=function(){var L=this.a,m=this.b,N=this.c,X=this.d,R=this.tx,f=L*X-m*N;return this.a=X/f,this.b=-m/f,this.c=-N/f,this.d=L/f,this.tx=(N*this.ty-X*R)/f,this.ty=-(L*this.ty-m*R)/f,this},yp.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},yp.prototype.clone=function(){var m=new yp;return m.a=this.a,m.b=this.b,m.c=this.c,m.d=this.d,m.tx=this.tx,m.ty=this.ty,m},yp.prototype.copy=function(Z){return Z.a=this.a,Z.b=this.b,Z.c=this.c,Z.d=this.d,Z.tx=this.tx,Z.ty=this.ty,Z},yp.prototype.tf=function(I,Y){1===arguments.length&&(Y=I.y,I=I.x);var L=this;return{x:L.a*I+L.c*Y+L.tx,y:L.b*I+L.d*Y+L.ty}},yp.prototype.tfi=function(g,_){1===arguments.length&&(_=g.y,g=g.x);var V=this,S=1/(V.a*V.d+V.c*-V.b);return{x:V.d*S*g+-V.c*S*_+(V.ty*V.c-V.tx*V.d)*S,y:V.a*S*_+-V.b*S*g+(-V.ty*V.a+V.tx*V.b)*S}},yp.IDENTITY=new yp,yp.TEMP_MATRIX=new yp;var Dr=b.Math.Vector3=function(l,F,G){"object"==typeof l?this.copy(l):this.set(l,F==q?l:F,G==q?l:G)};w.assign(Dr.prototype,{set:function(G,u,b){return this.x=G,this.y=u,this.z=b,this},setScalar:function(y){return this.x=y,this.y=y,this.z=y,this},setX:function(o){return this.x=o,this},setY:function(M){return this.y=M,this},setZ:function(P){return this.z=P,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(W){return W.x===q?(this.x=W[0],this.y=W[1],this.z=W[2]):(this.x=W.x,this.y=W.y,this.z=W.z),this},add:function(O){return this.x+=O.x,this.y+=O.y,this.z+=O.z,this},addScalar:function(u){return this.x+=u,this.y+=u,this.z+=u,this},addVectors:function(W,M){return this.x=W.x+M.x,this.y=W.y+M.y,this.z=W.z+M.z,this},addScaledVector:function(c,t){return this.x+=c.x*t,this.y+=c.y*t,this.z+=c.z*t,this},sub:function(k){return this.x-=k.x,this.y-=k.y,this.z-=k.z,this},subScalar:function(P){return this.x-=P,this.y-=P,this.z-=P,this},subVectors:function(G,o){return this.x=G.x-o.x,this.y=G.y-o.y,this.z=G.z-o.z,this},multiply:function(r){return this.x*=r.x,this.y*=r.y,this.z*=r.z,this},multiplyScalar:function(M){return this.x*=M,this.y*=M,this.z*=M,this},distanceTo:function(K){return Math.sqrt(this.distanceToSquared(K))},distanceToSquared:function(v){var n=this.x-v.x,y=this.y-v.y,b=this.z-v.z;return n*n+y*y+b*b},multiplyVectors:function(O,r){return this.x=O.x*r.x,this.y=O.y*r.y,this.z=O.z*r.z,this},transformDirection:function(B){var U=this.x,x=this.y,L=this.z,m=B.el;return this.x=m[0]*U+m[4]*x+m[8]*L,this.y=m[1]*U+m[5]*x+m[9]*L,this.z=m[2]*U+m[6]*x+m[10]*L,this.normalize()},applyQuaternion:function(n){var h=this.x,f=this.y,o=this.z,Q=n._x,p=n._y,z=n._z,m=n._w,S=m*h+p*o-z*f,$=m*f+z*h-Q*o,A=m*o+Q*f-p*h,E=-Q*h-p*f-z*o;return this.x=S*m+E*-Q+$*-z-A*-p,this.y=$*m+E*-p+A*-Q-S*-z,this.z=A*m+E*-z+S*-p-$*-Q,this},applyMatrix4:function(V){var o=this.x,c=this.y,G=this.z,S=V.el,h=1/(S[3]*o+S[7]*c+S[11]*G+S[15]);return this.x=(S[0]*o+S[4]*c+S[8]*G+S[12])*h,this.y=(S[1]*o+S[5]*c+S[9]*G+S[13])*h,this.z=(S[2]*o+S[6]*c+S[10]*G+S[14])*h,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function($){return this.x*$.x+this.y*$.y+this.z*$.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var z=this.length();return z?this.multiplyScalar(1/z):this},setLength:function(N){return this.normalize().multiplyScalar(N)},fromArray:function(D,y){return y===q&&(y=0),this.x=D[y],this.y=D[y+1],this.z=D[y+2],this},toArray:function(C,$){return C===q&&(C=[0,0,0]),$===q&&($=0),C[$]=this.x,C[$+1]=this.y,C[$+2]=this.z,C},cross:function(f){return this.crossVectors(this,f)},angleTo:function(x){var Z=this.dot(x)/Math.sqrt(this.lengthSq()*x.lengthSq());return Z>1||-1>Z?0:Math.acos(Z)},lerpVectors:function(e,q,A){return this.subVectors(q,e).multiplyScalar(A).add(e)},crossVectors:function(i,j){var s=i.x,X=i.y,N=i.z,W=j.x,w=j.y,d=j.z;return this.x=X*d-N*w,this.y=N*W-s*d,this.z=s*w-X*W,this},min:function($){return this.x=Math.min(this.x,$.x),this.y=Math.min(this.y,$.y),this.z=Math.min(this.z,$.z),this},max:function(m){return this.x=Math.max(this.x,m.x),this.y=Math.max(this.y,m.y),this.z=Math.max(this.z,m.z),this}});var cf=b.Math.Vector2=function(n,e,o){"object"==typeof n&&(n.x!=q?(e=n.y,n=n.x,o=n.e):(o=n[2],e=n[1],n=n[0])),this.set(n||0,e||0,o)};cf.prototype={},cf.prototype.constructor=cf,w.defineProperties(cf.prototype,{width:{get:function(){return this.x},set:function(X){this.x=X}},height:{get:function(){return this.y},set:function(L){this.y=L}}}),cf.prototype.clone=function(){return new cf(this.x,this.y,this.e)},cf.prototype.copy=function(Z){return this.set(Z.x,Z.y,Z.e),this},cf.prototype.equals=function(D){return D.x===this.x&&D.y===this.y},cf.prototype.set=function(G,r,k){return this.x=G||0,this.y=r||(0!==r?this.x:0),k!=q&&(this.e=k),this},cf.prototype.setScalar=function(L){return this.x=L,this.y=L,this},cf.prototype.setX=function(B){return this.x=B||0,this},cf.prototype.setY=function(N){return this.y=N||0,this},cf.prototype.add=function(X){return this.x+=X.x,this.y+=X.y,this},cf.prototype.addVectors=function(R,r){return this.x=R.x+r.x,this.y=R.y+r.y,this},cf.prototype.addScalar=function(S){return this.x+=S,this.y+=S,this},cf.prototype.addScaledVector=function(j,V){return this.x+=j.x*V,this.y+=j.y*V,this},cf.prototype.sub=function(o){return this.x-=o.x,this.y-=o.y,this},cf.prototype.subScalar=function(I){return this.x-=I,this.y-=I,this},cf.prototype.subVectors=function(m,S){return this.x=m.x-S.x,this.y=m.y-S.y,this},cf.prototype.multiply=function(T){return this.x*=T.x,this.y*=T.y,this},cf.prototype.multiplyScalar=function(j){return this.x*=j,this.y*=j,this},cf.prototype.divide=function(n){return this.x/=n.x,this.y/=n.y,this},cf.prototype.divideScalar=function(c){return this.multiplyScalar(1/c)},cf.prototype.min=function(J){return this.x=Math.min(this.x,J.x),this.y=Math.min(this.y,J.y),this},cf.prototype.max=function(I){return this.x=Math.max(this.x,I.x),this.y=Math.max(this.y,I.y),this},cf.prototype.fromArray=function(z,T){return T===q&&(T=0),this.x=z[T],this.y=z[T+1],this},cf.prototype.clamp=function(_,R){return this.x=Math.max(_.x,Math.min(R.x,this.x)),this.y=Math.max(_.y,Math.min(R.y,this.y)),this},cf.prototype.clampScalar=function(){var b,V;return function(E,h){return b===q&&(b=new cf,V=new cf),b.set(E,E),V.set(h,h),this.clamp(b,V)}}(),cf.prototype.clampLength=function(S,j){var J=this.length();return this.multiplyScalar(Math.max(S,Math.min(j,J))/J)},cf.prototype.dot=function(O){return this.x*O.x+this.y*O.y},cf.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},cf.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},cf.prototype.normalize=function(){return this.divideScalar(this.length())},cf.prototype.angle=function(){var W=Math.atan2(this.y,this.x);return 0>W&&(W+=2*Math.PI),W},cf.prototype.distanceTo=function(J){return Math.sqrt(this.distanceToSquared(J))},cf.prototype.distanceToSquared=function(c){var P=this.x-c.x,$=this.y-c.y;return P*P+$*$},cf.prototype.isNearEnough=function(s){return this.distanceToSquared(s)<1e-8},cf.prototype.setLength=function(X){var g=this.length();return g?this.multiplyScalar(X/g):this},cf.prototype.lerp=function(D,A){return this.x+=(D.x-this.x)*A,this.y+=(D.y-this.y)*A,this},cf.prototype.lerpVectors=function(g,f,x){return this.subVectors(f,g).multiplyScalar(x).add(g)},cf.prototype.rotateAround=function(v,q){var w=v?v.x:0,b=v?v.y:0,R=Math.cos(q),s=Math.sin(q),N=this.x-w,H=this.y-b;return this.x=N*R-H*s+w,this.y=N*s+H*R+b,this};var Yk=b.Math.Ray=function(Y,a){this.origin=Y!==q?Y.clone():new Dr,this.direction=a!==q?a.clone():new Dr};w.assign(Yk.prototype,{set:function(l,i){return this.origin.copy(l),this.direction.copy(i),this},clone:function(){return(new this.constructor).copy(this)},copy:function(s){return this.origin.copy(s.origin),this.direction.copy(s.direction),this.maxHitLen=s.maxHitLen,this},at:function(G,C){var V=C||new Dr;return V.copy(this.direction).multiplyScalar(G).add(this.origin)},setMaxHitLength:function(U){this.maxHitLen=U},lookAt:function(Y){return this.direction.copy(Y).sub(this.origin).normalize(),this},applyMatrix4:function(I){var P=this.maxHitLen;if(P){var g=this.direction.clone().multiplyScalar(P).add(this.origin);g.applyMatrix4(I)}return this.origin.applyMatrix4(I),this.direction.transformDirection(I),P&&(this.maxHitLen=this.origin.distanceTo(g)),this},intersectBox:function(z,n){var U,q,t,J,X,F,b=1/this.direction.x,V=1/this.direction.y,v=1/this.direction.z,E=this.origin;if(b>=0?(U=(z.min.x-E.x)*b,q=(z.max.x-E.x)*b):(U=(z.max.x-E.x)*b,q=(z.min.x-E.x)*b),V>=0?(t=(z.min.y-E.y)*V,J=(z.max.y-E.y)*V):(t=(z.max.y-E.y)*V,J=(z.min.y-E.y)*V),U>J||t>q)return null;if((t>U||U!==U)&&(U=t),(q>J||q!==q)&&(q=J),v>=0?(X=(z.min.z-E.z)*v,F=(z.max.z-E.z)*v):(X=(z.max.z-E.z)*v,F=(z.min.z-E.z)*v),U>F||X>q)return null;if((X>U||U!==U)&&(U=X),(q>F||q!==q)&&(q=F),0>q)return null;var o=U>=0?U:q,R=this.maxHitLen;return R&&o>R?null:this.at(o,n)},intersectTriangle:function(){var L=new Dr,Z=new Dr,d=new Dr,J=new Dr;return function(K,e,l,G,i){Z.subVectors(e,K),d.subVectors(l,K),J.crossVectors(Z,d);var f,F=this.direction.dot(J);if(F>0){if(G)return null;f=1}else{if(!(0>F))return null;f=-1,F=-F}L.subVectors(this.origin,K);var o=f*this.direction.dot(d.crossVectors(L,d));if(0>o)return null;var a=f*this.direction.dot(Z.cross(L));if(0>a||o+a>F)return null;var $=-f*L.dot(J);if(0>$)return null;var s=$/F,Y=this.maxHitLen;return Y&&s>Y?null:this.at(s,i)}}()});var ai=b.Math.Box3=function(i,A){this.min=i!==q?i:new Dr(1/0,1/0,1/0),this.max=A!==q?A:new Dr(-1/0,-1/0,-1/0)};w.assign(ai.prototype,{set:function(I,M){return this.min.copy(I),this.max.copy(M),this},setFromArray:function(V){for(var S=1/0,I=1/0,K=1/0,B=-1/0,G=-1/0,F=-1/0,Z=0,b=V.length;b>Z;Z+=3){var d=V[Z],P=V[Z+1],q=V[Z+2];S>d&&(S=d),I>P&&(I=P),K>q&&(K=q),d>B&&(B=d),P>G&&(G=P),q>F&&(F=q)}return this.min.set(S,I,K),this.max.set(B,G,F),this},setFromPoints:function(w){this.makeEmpty();for(var V=0,R=w.length;R>V;V++)this.expandByPoint(w[V]);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(D){return this.min.copy(D.min),this.max.copy(D.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this}});var Up=b.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};w.assign(Up.prototype,{set:function(Q,t,S,G,q,z,v,x,y,p,r,u,f,N,Y,U){var i=this.el;return i[0]=Q,i[4]=t,i[8]=S,i[12]=G,i[1]=q,i[5]=z,i[9]=v,i[13]=x,i[2]=y,i[6]=p,i[10]=r,i[14]=u,i[3]=f,i[7]=N,i[11]=Y,i[15]=U,this},clone:function(){return(new Up).fromArray(this.el)},fromArray:function(E,M){M===q&&(M=0);for(var j=this.el,S=0;16>S;S++)j[S]=E[S+M];return this},scale:function(W){var h=this.el,u=W.x,Y=W.y,P=W.z;return h[0]*=u,h[4]*=Y,h[8]*=P,h[1]*=u,h[5]*=Y,h[9]*=P,h[2]*=u,h[6]*=Y,h[10]*=P,h[3]*=u,h[7]*=Y,h[11]*=P,this},makeRotationFromEuler:function(x){var F=this.el,m=x._x,k=x._y,A=x._z,i=x._order,H=Math.cos(m),K=Math.sin(m),y=Math.cos(k),L=Math.sin(k),B=Math.cos(A),u=Math.sin(A);if("XYZ"===i){var C=H*B,e=H*u,Q=K*B,o=K*u;F[0]=y*B,F[4]=-y*u,F[8]=L,F[1]=e+Q*L,F[5]=C-o*L,F[9]=-K*y,F[2]=o-C*L,F[6]=Q+e*L,F[10]=H*y}else if("YXZ"===i){var O=y*B,b=y*u,f=L*B,R=L*u;F[0]=O+R*K,F[4]=f*K-b,F[8]=H*L,F[1]=H*u,F[5]=H*B,F[9]=-K,F[2]=b*K-f,F[6]=R+O*K,F[10]=H*y}else if("ZXY"===i){var O=y*B,b=y*u,f=L*B,R=L*u;F[0]=O-R*K,F[4]=-H*u,F[8]=f+b*K,F[1]=b+f*K,F[5]=H*B,F[9]=R-O*K,F[2]=-H*L,F[6]=K,F[10]=H*y}else if("ZYX"===i){var C=H*B,e=H*u,Q=K*B,o=K*u;F[0]=y*B,F[4]=Q*L-e,F[8]=C*L+o,F[1]=y*u,F[5]=o*L+C,F[9]=e*L-Q,F[2]=-L,F[6]=K*y,F[10]=H*y}else if("YZX"===i){var U=H*y,v=H*L,E=K*y,s=K*L;F[0]=y*B,F[4]=s-U*u,F[8]=E*u+v,F[1]=u,F[5]=H*B,F[9]=-K*B,F[2]=-L*B,F[6]=v*u+E,F[10]=U-s*u}else if("XZY"===i){var U=H*y,v=H*L,E=K*y,s=K*L;F[0]=y*B,F[4]=-u,F[8]=L*B,F[1]=U*u+s,F[5]=H*B,F[9]=v*u-E,F[2]=E*u-v,F[6]=K*B,F[10]=s*u+U}return F[3]=0,F[7]=0,F[11]=0,F[12]=0,F[13]=0,F[14]=0,F[15]=1,this},makeRotationFromQuaternion:function(S){var z=this.el,M=S._x,s=S._y,e=S._z,Z=S._w,R=M+M,G=s+s,N=e+e,o=M*R,t=M*G,f=M*N,Y=s*G,F=s*N,j=e*N,v=Z*R,a=Z*G,X=Z*N;return z[0]=1-(Y+j),z[4]=t-X,z[8]=f+a,z[1]=t+X,z[5]=1-(o+j),z[9]=F-v,z[2]=f-a,z[6]=F+v,z[10]=1-(o+Y),z[3]=0,z[7]=0,z[11]=0,z[12]=0,z[13]=0,z[14]=0,z[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(p){var y=this.el,C=p.el,O=C[0],q=C[1],o=C[2],x=C[3],f=C[4],N=C[5],U=C[6],_=C[7],l=C[8],d=C[9],P=C[10],R=C[11],A=C[12],V=C[13],B=C[14],F=C[15],X=d*B*_-V*P*_+V*U*R-N*B*R-d*U*F+N*P*F,D=A*P*_-l*B*_-A*U*R+f*B*R+l*U*F-f*P*F,r=l*V*_-A*d*_+A*N*R-f*V*R-l*N*F+f*d*F,Y=A*d*U-l*V*U-A*N*P+f*V*P+l*N*B-f*d*B,u=O*X+q*D+o*r+x*Y;if(0===u)return this.identity();var v=1/u;return y[0]=X*v,y[1]=(V*P*x-d*B*x-V*o*R+q*B*R+d*o*F-q*P*F)*v,y[2]=(N*B*x-V*U*x+V*o*_-q*B*_-N*o*F+q*U*F)*v,y[3]=(d*U*x-N*P*x-d*o*_+q*P*_+N*o*R-q*U*R)*v,y[4]=D*v,y[5]=(l*B*x-A*P*x+A*o*R-O*B*R-l*o*F+O*P*F)*v,y[6]=(A*U*x-f*B*x-A*o*_+O*B*_+f*o*F-O*U*F)*v,y[7]=(f*P*x-l*U*x+l*o*_-O*P*_-f*o*R+O*U*R)*v,y[8]=r*v,y[9]=(A*d*x-l*V*x-A*q*R+O*V*R+l*q*F-O*d*F)*v,y[10]=(f*V*x-A*N*x+A*q*_-O*V*_-f*q*F+O*N*F)*v,y[11]=(l*N*x-f*d*x-l*q*_+O*d*_+f*q*R-O*N*R)*v,y[12]=Y*v,y[13]=(l*V*o-A*d*o+A*q*P-O*V*P-l*q*B+O*d*B)*v,y[14]=(A*N*o-f*V*o-A*q*U+O*V*U+f*q*B-O*N*B)*v,y[15]=(f*d*o-l*N*o+l*q*U-O*d*U-f*q*P+O*N*P)*v,this},makeRotationAxis:function(Z,s){var L=Math.cos(s),K=Math.sin(s),g=1-L,r=Z.x,I=Z.y,o=Z.z,R=g*r,d=g*I;return this.set(R*r+L,R*I-K*o,R*o+K*I,0,R*I+K*o,d*I+L,d*o-K*r,0,R*o-K*I,d*o+K*r,g*o*o+L,0,0,0,0,1),this},multiply:function(K){return this.multiplyMatrices(this,K)},premultiply:function(G){return this.multiplyMatrices(G,this)},multiplyMatrices:function(W,g){var J=W.el,G=g.el,b=this.el,l=J[0],m=J[4],v=J[8],k=J[12],z=J[1],E=J[5],D=J[9],C=J[13],S=J[2],O=J[6],F=J[10],L=J[14],f=J[3],V=J[7],d=J[11],H=J[15],K=G[0],I=G[4],R=G[8],n=G[12],Z=G[1],a=G[5],Q=G[9],j=G[13],c=G[2],$=G[6],y=G[10],u=G[14],p=G[3],h=G[7],q=G[11],s=G[15];
return b[0]=l*K+m*Z+v*c+k*p,b[4]=l*I+m*a+v*$+k*h,b[8]=l*R+m*Q+v*y+k*q,b[12]=l*n+m*j+v*u+k*s,b[1]=z*K+E*Z+D*c+C*p,b[5]=z*I+E*a+D*$+C*h,b[9]=z*R+E*Q+D*y+C*q,b[13]=z*n+E*j+D*u+C*s,b[2]=S*K+O*Z+F*c+L*p,b[6]=S*I+O*a+F*$+L*h,b[10]=S*R+O*Q+F*y+L*q,b[14]=S*n+O*j+F*u+L*s,b[3]=f*K+V*Z+d*c+H*p,b[7]=f*I+V*a+d*$+H*h,b[11]=f*R+V*Q+d*y+H*q,b[15]=f*n+V*j+d*u+H*s,this}});var qn=b.Math.Quaternion=function(e,r,k,T){this.set(e,r,k,T)};w.assign(qn.prototype,{set:function(I,H,V,Q){var o=this;return o._x=I||0,o._y=H||0,o._z=V||0,o._w=Q!==q?Q:1,o},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(r){var Z=this;return Z._x=r._x,Z._y=r._y,Z._z=r._z,Z._w=r._w,Z},fromArray:function(F,h){h===q&&(h=0);var $=this;return $._x=F[h],$._y=F[h+1],$._z=F[h+2],$._w=F[h+3],this},slerp:function(G,n){if(0===n)return this;if(1===n)return this.copy(G);var f=this._x,s=this._y,u=this._z,L=this._w,_=L*G._w+f*G._x+s*G._y+u*G._z;if(0>_?(this._w=-G._w,this._x=-G._x,this._y=-G._y,this._z=-G._z,_=-_):this.copy(G),_>=1)return this._w=L,this._x=f,this._y=s,this._z=u,this;var F=Math.sqrt(1-_*_);if(Math.abs(F)<.001)return this._w=.5*(L+this._w),this._x=.5*(f+this._x),this._y=.5*(s+this._y),this._z=.5*(u+this._z),this;var w=Math.atan2(F,_),V=Math.sin((1-n)*w)/F,B=Math.sin(n*w)/F;return this._w=L*V+this._w*B,this._x=f*V+this._x*B,this._y=s*V+this._y*B,this._z=u*V+this._z*B,this},setFromAxisAngle:function(H,Z){var c=Z/2,F=Math.sin(c);return this._x=H.x*F,this._y=H.y*F,this._z=H.z*F,this._w=Math.cos(c),this},setFromEuler:function(o){var Y=o._x,v=o._y,c=o._z,Z=o._order,O=Math.cos,b=Math.sin,r=O(Y/2),H=O(v/2),W=O(c/2),K=b(Y/2),i=b(v/2),S=b(c/2);return"XYZ"===Z?(this._x=K*H*W+r*i*S,this._y=r*i*W-K*H*S,this._z=r*H*S+K*i*W,this._w=r*H*W-K*i*S):"YXZ"===Z?(this._x=K*H*W+r*i*S,this._y=r*i*W-K*H*S,this._z=r*H*S-K*i*W,this._w=r*H*W+K*i*S):"ZXY"===Z?(this._x=K*H*W-r*i*S,this._y=r*i*W+K*H*S,this._z=r*H*S+K*i*W,this._w=r*H*W-K*i*S):"ZYX"===Z?(this._x=K*H*W-r*i*S,this._y=r*i*W+K*H*S,this._z=r*H*S-K*i*W,this._w=r*H*W+K*i*S):"YZX"===Z?(this._x=K*H*W+r*i*S,this._y=r*i*W+K*H*S,this._z=r*H*S-K*i*W,this._w=r*H*W-K*i*S):"XZY"===Z&&(this._x=K*H*W-r*i*S,this._y=r*i*W-K*H*S,this._z=r*H*S+K*i*W,this._w=r*H*W+K*i*S),this}});var od=b.Math.Triangle=function(D,h,y){this.a=D!==q?D:new Dr,this.b=h!==q?h:new Dr,this.c=y!==q?y:new Dr};w.assign(od,{barycoordFromPoint:function(){var U=new Dr,i=new Dr,T=new Dr;return function(B,w,V,$,z){U.subVectors($,w),i.subVectors(V,w),T.subVectors(B,w);var s=U.dot(U),R=U.dot(i),Q=U.dot(T),J=i.dot(i),P=i.dot(T),f=s*J-R*R,S=z||new Dr;if(0===f)return S.set(-2,-1,-1);var M=1/f,D=(J*Q-R*P)*M,C=(s*P-R*Q)*M;return S.set(1-D-C,C,D)}}()});var dg=b.Math.Euler=function(i,a,S,t,y){this.set(i,a,S,t,y)};dg.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],dg.DefaultOrder="XYZ",dg.ReverseOrder=function(z){return z=z[2]+z[1]+z[0],z.toUpperCase()},w.defineProperties(dg.prototype,{x:{get:function(){return this._x},set:function(v){this._x=v,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(w){this._y=w,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(Y){this._z=Y,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(s){this._order=s,this.onChangeCallback()}}}),w.assign(dg.prototype,{set:function(r,p,w,V,Y){return Wd(r)&&(Y=w,V=p,w=r[2],p=r[1],r=r[0]),V?Y&&(V=dg.ReverseOrder(V)):V="ZYX",this._x=r||0,this._y=p||0,this._z=w||0,this._order=V||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(W){return this._x=W._x,this._y=W._y,this._z=W._z,this._order=W._order,this.onChangeCallback(),this},setFromRotationMatrix:function(w,g,H){var C=b.Math.clamp,i=w.el||w,X=i[0],D=i[4],Z=i[8],G=i[1],T=i[5],l=i[9],q=i[2],t=i[6],L=i[10];return g=g||this._order,"XYZ"===g?(this._y=Math.asin(C(Z,-1,1)),Math.abs(Z)<.99999?(this._x=Math.atan2(-l,L),this._z=Math.atan2(-D,X)):(this._x=Math.atan2(t,T),this._z=0)):"YXZ"===g?(this._x=Math.asin(-C(l,-1,1)),Math.abs(l)<.99999?(this._y=Math.atan2(Z,L),this._z=Math.atan2(G,T)):(this._y=Math.atan2(-q,X),this._z=0)):"ZXY"===g?(this._x=Math.asin(C(t,-1,1)),Math.abs(t)<.99999?(this._y=Math.atan2(-q,L),this._z=Math.atan2(-D,T)):(this._y=0,this._z=Math.atan2(G,X))):"ZYX"===g?(this._y=Math.asin(-C(q,-1,1)),Math.abs(q)<.99999?(this._x=Math.atan2(t,L),this._z=Math.atan2(G,X)):(this._x=0,this._z=Math.atan2(-D,T))):"YZX"===g?(this._z=Math.asin(C(G,-1,1)),Math.abs(G)<.99999?(this._x=Math.atan2(-l,T),this._y=Math.atan2(-q,X)):(this._x=0,this._y=Math.atan2(Z,L))):"XZY"===g?(this._z=Math.asin(-C(D,-1,1)),Math.abs(D)<.99999?(this._x=Math.atan2(t,T),this._y=Math.atan2(Z,X)):(this._x=Math.atan2(-l,L),this._y=0)):console.warn("unsupported order: "+g),this._order=g,H!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var m=new Up;return function(M,E,b){return m.makeRotationFromQuaternion(M),this.setFromRotationMatrix(m,E,b)}}(),setFromVector3:function(H,B){return this.set(H.x,H.y,H.z,B||this._order)},reorder:function(){var e=new qn;return function($){return e.setFromEuler(this),this.setFromQuaternion(e,$)}}(),equals:function(r){return r._x===this._x&&r._y===this._y&&r._z===this._z&&r._order===this._order},fromArray:function(c){return this._x=c[0],this._y=c[1],this._z=c[2],c[3]!==q&&(this._order=c[3]),this.onChangeCallback(),this},toArray:function(X,P){return X===q&&(X=[]),P===q&&(P=0),X[P]=this._x,X[P+1]=this._y,X[P+2]=this._z,X[P+3]=this._order,X},toVector3:function(b){return b?b.set(this._x,this._y,this._z):new Dr(this._x,this._y,this._z)},onChange:function(D){return this.onChangeCallback=D,this},onChangeCallback:function(){}});var Bk=b.List=function(){this._as=[];var R,P,$=arguments.length;if(1===$){var B=arguments[0];if(Co(B)&&(B=B._as),Wd(B))for(P=B.length,R=0;P>R;R++)this._as.push(B[R]);else B!=T&&this._as.push(B)}else if($>1)for(R=0;$>R;R++)this._as.push(arguments[R])};Tn("List",w,{forEach:function(A,W){this.each(A,W)},push:function(){for(var F=0;F<arguments.length;F++)this.add(arguments[F])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(u,D){return D===q?this._as.push(u):this._as.splice(D,0,u)},addAll:function(B){Co(B)&&(B=B._as),Wd(B)?fj(this._as,B):this._as.push(B)},get:function(e){return this._as[e]},slice:function(A,j){return new Bk(this._as.slice(A,j))},remove:function(j){var w=this._as.indexOf(j);return w>=0&&w<this._as.length&&this.removeAt(w),w},removeAt:function(z){return this._as.splice(z,1)[0]},set:function(k,Q){return this._as[k]=Q},clear:function(){return this._as.splice(0,this._as.length)},contains:function(B){return this._as.indexOf(B)>=0},indexOf:function(v){return this._as.indexOf(v)},each:function(n,G){for(var c=0,A=this._as.length;A>c;c++){var i=this._as[c];G?n.call(G,i,c,this):n(i,c,this)}},reverseEach:function(i,w){for(var X=this._as.length-1;X>=0;X--){var R=this._as[X];w?i.call(w,R):i(R)}},toArray:function(C,r){if(C){for(var L,v=[],u=0,D=this._as.length;D>u;u++)L=this._as[u],r?C.call(r,L)&&v.push(L):C(L)&&v.push(L);return v}return this._as.concat()},toList:function(F,p){if(F){for(var k,g=new Bk,W=0,c=this._as.length;c>W;W++)k=this._as[W],p?F.call(p,k)&&g.add(k):F(k)&&g.add(k);return g}return new Bk(this)},reverse:function(){this._as.reverse()},sort:function(f){return this._as.sort(f?f:$l),this},toString:function(){return this._as.toString()}}),w.defineProperties(Bk.prototype,{length:{get:function(){return this._as.length},set:function(v){this._as.length=v}}});var xk=new Bk;Pr(xk,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:Kd,each:Kd,reverseEach:Kd,toArray:function(){return[]},toList:function(){return new Bk},add:Wg,addAll:Wg,set:Wg,remove:Wg,removeAt:Wg,clear:Wg});var oh=b.Notifier=function(){this._f=0};Tn("Notifier",w,{contains:function(G,i){if(this._ls)for(var H,m=0,u=this._ls.size();u>m;m++)if(H=this._ls.get(m),G===H.l&&i===H.s)return!0;return!1},add:function(M,Q,W){var m=this,t={l:M,s:Q,a:W};m._ls||(m._ls=new Bk),m._f?(m._as||(m._as=new Bk),m._as.add(t)):t.a?m._ls.add(t,0):m._ls.add(t)},remove:function(n,L){var o=this;o._ls&&(o._f?(o._rs||(o._rs=new Bk),o._rs.add({l:n,s:L})):o._remove(n,L))},_remove:function(x,Z){for(var X,O=this._ls,b=0,j=O.size();j>b;b++)if(X=O.get(b),X.l===x&&X.s===Z)return O.removeAt(b),void 0},fire:function(p){var Z=this,X=Z._ls;if(Z._b=1e4,X){++Z._f;try{for(var D,H=0,G=X.size();G>H;H++)D=X.get(H),D.s?D.l.call(D.s,p):D.l(p)}finally{if(--Z._f)return;if(Z._rs){for(G=Z._rs.size(),H=0;G>H;H++)D=Z._rs.get(H),Z._remove(D.l,D.s);delete Z._rs}if(Z._as){for(G=Z._as.size(),H=0;G>H;H++)D=Z._as.get(H),D.a?X.add(D,0):X.add(D);delete Z._as}}}}});var Ck=b.Data=function(){this._id=tk()};Tn("Data",w,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:T,_parent:T,_children:xk,_childMap:T,_styleMap:T,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return T},_22Q:function(){return T},s:function(e,n){var g=this;if(2===arguments.length)g.setStyle(e,n);else{if(!qc(e))return g.getStyle(e);for(var y in e)g.setStyle(y,e[y])}return g},fp:function(j,R,K,H,z){return this.firePropertyChange(j,R,K,H,z)},firePropertyChange:function(x,t,T,e,u){if(e){if(e(t,T))return!1}else if(t===T)return!1;var S=this,H=u||{};return H.property=x,H.oldValue=t,H.newValue=T,H.data=S,S._dataModel&&S._dataModel.handleDataPropertyChange(H),S.onPropertyChanged(H),!0},onPropertyChanged:function(Q){var Z=this,t=Z._parent,Y=Q.property;if(Vf(t)){var T=Z.s(eh),W="s:ingroup"===Y;(T&&Pp[Y]||Y===W)&&t._81I(),(T||W)&&t.fp("childChange",!0,!1)}Se(t)&&Pp[Y]&&t.updateFromChildren()},_21I:function(k){var M=this;if(k&&M._dataModel)throw"Remove data from dataModel before adding";M._dataModel=k},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var n=0,V=this._children.toArray(),h=V.length;h>n;n++)V[n].removeFromDataModel()},getId:function(){return this._id},setId:function(m){this._id=m},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(P,z){return this._children.toList(P,z)},eachChild:function(u,G){this._children.each(u,G)},addChild:function(q,O){var w=this;q!==w&&(w._children===xk&&(w._children=new Bk,w._childMap={}),O>=0||(O=w._children.size()),w._childMap[q._id]||w.isDescendantOf(q)||(q._parent&&q._parent.removeChild(q),(0>O||O>w._children.size())&&(O=w._children.size()),w._children.add(q,O),w._childMap[q._id]=q,q.setParent(w),w.onChildAdded(q,O),w.fp(Tk,T,q)))},onChildAdded:function(){},removeChild:function(K){var z=this;if(z._childMap&&z._childMap[K._id]){var S=z._children.remove(K);delete z._childMap[K._id],z.fp(Tk,K,T),K.setParent(T,S),z.onChildRemoved(K,S)}},onChildRemoved:function(){},getChildAt:function(l){return this._children.get(l)},clearChildren:function(){var S=this;if(!S._children.isEmpty())for(var x=0,f=S._children.toArray(),G=f.length;G>x;x++)S.removeChild(f[x])},getParent:function(){return this._parent},setParent:function(u,p){var r=this;if(!(r._73I||r._parent===u||r===u||u&&u.isDescendantOf(r))){var J,G=r._parent;r._parent=u,r._73I=1,G?(p==T&&(p=G.getChildren().indexOf(r)),G.removeChild(r)):r._dataModel&&p==T&&(p=r._dataModel.getRoots().indexOf(r)),u&&(u.addChild(r),J=u.getChildren().indexOf(r)),delete r._73I,r.fp("parent",G,u,q,{oldIndex:p,newIndex:J}),r.onParentChanged(G,u)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(h){return h?this.isDescendantOf(h)||h.isDescendantOf(this):!1},isParentOf:function(i){return i&&this._childMap?!!this._childMap[i._id]:!1},isDescendantOf:function(A){if(!A||A.isEmpty())return!1;for(var j=this._parent;j;){if(A===j)return!0;j=j._parent}return!1},getStyle:function(r,B){B===q&&(B=1);var w=this._styleMap?this._styleMap[r]:q;return w===q&&B?f[r]:w},setStyle:function(D,N){var I=this;I._styleMap||(I._styleMap={});var J=I._styleMap[D];N===q?delete I._styleMap[D]:I._styleMap[D]=N,I.fp("s:"+D,J,N)&&I.onStyleChanged(D,J,N)},onStyleChanged:function(){},iv:function(N){this.invalidate(N)},invalidate:function(v){this.fp(v||"*",!1,!0)},toString:function(){var F=this;return F._displayName||F._name||F._tag||F._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(G,D){var P=this,k=P.s(ag);k||P.s(ag,k={}),D?k[G]=D:delete k[G],P.fp(ag,T,k)},removeStyleIcon:function($){var i=this.s(ag);if(i){var Z=i[$];delete i[$],this.fp(ag,T,i)}return Z},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var W,R={};for(W in this._styleMap)R[W]=1;return R}});var Dj=b.DataModel=function(){var N=this;N._datas=new Bk,N._dataMap={},N._roots=new Bk,N._rootMap={},N._78O={},N._36I=new oh,N._35I=new oh,N._selectionModel=new Qg(N);var G=N._29Q=[],U=N._scheduleCallback=function(){for(var K=Date.now(),$=0;$<G.length;$++){var o=G[$];o.enabled&&K-o.lastTime>o.interval&&(o.beforeAction&&o.beforeAction(),N.each(function(x){o.action(x)}),o.afterAction&&o.afterAction(),o.lastTime=K)}G.length&&(N._30Q=x.requestAnimationFrame(U))}};Tn("DataModel",w,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","init"],_name:q,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:q,_init:q,sm:function(){return this.getSelectionModel()},mm:function(d,X,t){this.addDataModelChangeListener(d,X,t)},umm:function(A,K){this.removeDataModelChangeListener(A,K)},md:function($,g,Q){this.addDataPropertyChangeListener($,g,Q)},umd:function(d,K){this.removeDataPropertyChangeListener(d,K)},mh:function(r,W,O){this.addHierarchyChangeListener(r,W,O)},umh:function(P,Y){this.removeHierarchyChangeListener(P,Y)},getAttrObject:function(){return this._attrObject},setAttrObject:function($){return this._attrObject=$},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getDataById:function(g){return this._dataMap[g]},removeDataById:function(o){this.remove(this.getDataById(o))},toDatas:function(K,m){return this._datas.toList(K,m)},each:function(T,Y){this._datas.each(T,Y)},getDataByTag:function(w){return this._78O[w]},getTagMap:function(){return this._78O},removeDataByTag:function(J){this.remove(this.getDataByTag(J))},add:function(j,w,A){var S=this,p=j._id,k=j._tag,u=S._roots;if(S._dataMap[p])throw"'"+p+"' already exists";k!=T&&(S._78O[k]=j),S._dataMap[p]=j,A>=0?S._datas.add(j,A):S._datas.add(j),j._parent||(S._rootMap[p]=j,w>=0?u.add(j,w):u.add(j)),j._21I(S),S.onAdded(j),S._36I.fire({kind:"add",data:j,rootsIndex:w,datasIndex:A})},onAdded:function(){},remove:function(O,K){if(O){var J=this,H=O._id,y=K&&K.keepStructure,n=K&&K.keepChildren,r=O.getTag();if(O._dataModel===J){this.beginTransaction(),y?J._removingData||(J._removingData=O):J.prepareRemove(O),n||O.toChildren().each(function(N){J.remove(N,K)},J),y?J._removingData===O&&(O._parent&&O._parent.removeChild(O),delete J._removingData):O._parent&&O._parent.removeChild(O);var m=J._datas.remove(O);delete J._dataMap[H],r!=T&&delete J._78O[r];var z;J._rootMap[H]&&(delete J._rootMap[H],z=J._roots.remove(O)),O._21I(T),J.onRemoved(O),J._36I.fire({kind:Rl,data:O,rootsIndex:z,datasIndex:m}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var j=this;if(j._datas.size()){var O=j._historyManager?this.toJSON():q;j._datas.toArray().forEach(function(l){l._21I(T)}),j._datas.clear(),j._dataMap={},j._roots.clear(),j._rootMap={},j._78O={},j._36I.fire({kind:ar,json:O})}},contains:function(f){return f&&f._dataModel===this},handleDataPropertyChange:function(u){var R=this,P=u.data,L=u.property;if("parent"===L){var A=P._id,q=R._rootMap,X=R._roots;P._parent?q[A]&&(delete q[A],X.remove(P)):q[A]||(q[A]=P,X.add(P))}else if("tag"===L){var S=u.oldValue,b=u.newValue,m=R._78O;S!=T&&delete m[S],b!=T&&(m[b]=P)}this.onDataPropertyChanged(P,u),this._35I.fire(u)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(S,I,V){this._36I.add(S,I,V)},removeDataModelChangeListener:function(M,r){this._36I.remove(M,r)},addDataPropertyChangeListener:function(b,j,v){this._35I.add(b,j,v)},removeDataPropertyChangeListener:function(B,k){this._35I.remove(B,k)},_38I:function(o,N,H){this._37I&&this._37I.fire({data:o,oldIndex:N,newIndex:H})},addHierarchyChangeListener:function(P,O,I){this._37I||(this._37I=new oh),this._37I.add(P,O,I)},removeHierarchyChangeListener:function(p,w){this._37I.remove(p,w)},getSiblings:function(X){var V=X._parent;return V?V._children:this._roots},eachByHierarchical:function(Q,F,P){if(F)return this._eachByHierarchical(Q,F,P);for(var L=0,$=this._roots,u=$.size();u>L;L++)if(this._eachByHierarchical(Q,$.get(L),P)===!1)return!1;return!0},_eachByHierarchical:function(B,l,e){if(e){if(B.call(e,l)===!1)return!1}else if(B(l)===!1)return!1;for(var L=l.size(),N=0;L>N;N++)if(this._eachByHierarchical(B,l.getChildAt(N),e)===!1)return!1;return!0},reverseEachByHierarchical:function(X,s,E){if(s)return this._reverseEachByHierarchical(X,s,E);for(var b=this._roots,h=b.size(),d=h-1;d>=0;d--)if(this._reverseEachByHierarchical(X,b.get(d),E)===!1)return!1;return!0},_reverseEachByHierarchical:function(M,y,D){for(var A=y.size(),T=A-1;T>=0;T--)if(this._reverseEachByHierarchical(M,y.getChildAt(T),D)===!1)return!1;if(D){if(M.call(D,y)===!1)return!1}else if(M(y)===!1)return!1;return!0},eachByDepthFirst:function(d,Z,f){if(Z)return this._11I(d,Z,f);for(var p=0,X=this._roots,x=X.size();x>p;p++)if(this._11I(d,X.get(p),f)===!1)return!1;return!0},_11I:function(l,j,X){for(var H=j.size(),G=0;H>G;G++)if(this._11I(l,j.getChildAt(G),X)===!1)return!1;if(X){if(l.call(X,j)===!1)return!1}else if(l(j)===!1)return!1;return!0},eachByBreadthFirst:function(l,z,V){var i=new Bk;for(z?i.add(z):this._roots.each(i.add,i);i.size()>0;)if(z=i.removeAt(0),z.eachChild(i.add,i),V){if(l.call(V,z)===!1)return!1}else if(l(z)===!1)return!1;return!0},moveTo:function(L,x){var k=this.getSiblings(L),I=k.indexOf(L);I===x||0>I||x>=0&&x<=k.size()&&(k.remove(L),x>k.size()&&x--,k.add(L,x),this._38I(L,I,x))},moveUp:function(T){this.moveTo(T,this.getSiblings(T).indexOf(T)-1)},moveDown:function(j){this.moveTo(j,this.getSiblings(j).indexOf(j)+1)},moveToTop:function(E){this.moveTo(E,0)},moveToBottom:function(S){this.moveTo(S,this.getSiblings(S).size())},moveSelectionUp:function(o){this.beginTransaction(),o||(o=this.sm());var G=new Bk;yo(o,G,this._roots),G.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(k){this.beginTransaction(),k||(k=this.sm());var t=new Bk;nc(k,t,this._roots),t.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(t){this.beginTransaction(),t||(t=this.sm());var i=new Bk;km(t,i,this._roots),i.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(V){this.beginTransaction(),V||(V=this.sm());var z=new Bk;Rj(V,z,this._roots),z.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(X,t,s){var v=this.getDatas();null==s&&(s=v.indexOf(X)),s===t||0>s||t>=0&&t<=v.size()&&(v.remove(X),t>v.size()&&t--,v.add(X,t),this._76I(X,s,t))},bringForward:function(A){this.moveToIndex(A,this.getDatas().indexOf(A)+1)},bringToFront:function(B){this.moveToIndex(B,this.size())},sendBackward:function(U){this.moveToIndex(U,this.getDatas().indexOf(U)-1)},sendToBack:function(u){this.moveToIndex(u,0)},bringSelectionForward:function(Y){this.beginTransaction(),Y||(Y=this.sm());for(var W=new Bk,T=this.getDatas(),B=!1,A=0;A<T.size();A++){var F=T.get(T.size()-1-A);Y.contains(F)?B&&W.add(F):B=!0}W.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(h){this.beginTransaction(),h||(h=this.sm());for(var v=new Bk,P=this.getDatas(),Z=0;Z<P.size();Z++){var $=P.get(Z);h.contains($)&&v.add($)}v.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(S){this.beginTransaction(),S||(S=this.sm());for(var K=new Bk,l=this.getDatas(),P=!1,o=0;o<l.size();o++){var J=l.get(o);S.contains(J)?P&&K.add(J):P=!0}K.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(c){this.beginTransaction(),c||(c=this.sm());for(var a=new Bk,Z=this.getDatas(),H=0;H<Z.size();H++){var I=Z.get(Z.size()-1-H);c.contains(I)&&a.add(I)}a.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(u){var E=this;E.removeScheduleTask(u),u.enabled==T&&(u.enabled=!0),u.interval==T&&(u.interval=10),u.action==T&&(u.action=Kd),u.lastTime=Date.now(),E._29Q.push(u),E._30Q==T&&(E._30Q=x.requestAnimationFrame(E._scheduleCallback))},removeScheduleTask:function(I){var X=this,t=X._29Q,l=t.indexOf(I);l>=0&&t.splice(l,1),t.length||X._30Q==T||(x.cancelAnimationFrame(X._30Q),delete X._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(P){this._historyManager||new b.HistoryManager(this),null!=P&&this._historyManager.setMaxHistoryCount(P),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(W){this._historyManager&&this._historyManager.undo(W)},redo:function(V){this._historyManager&&this._historyManager.redo(V)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(V){this._historyManager&&this._historyManager.addHistory(V)},onHistoryManagerChanged:function(){}});var Qg=b.SelectionModel=function(v){var p=this;p._68O=fh,p._map={},p._73O=new Bk,p._74I=new oh,p._21I(v)};Tn("SelectionModel",w,{ms_fire:1,ms_dm:1,ms:function(D,o,p){this.addSelectionChangeListener(D,o,p)},ums:function(e,i){this.removeSelectionChangeListener(e,i)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===Fn},co:function(n){return this._map[n._id]!=T},ss:function(o){this.setSelection(o)},as:function(K){this.appendSelection(K)},rs:function(N){this.removeSelection(N)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(y){var L=this;if(L._68O!==y&&(y===tc||y===Fn||y===fh)){L.cs();var F=L._68O;L._68O=y,L.fp("selectionMode",F,y)}},_21I:function(J){var W=this,I=W._dataModel;I!==J&&(I&&(W.cs(),I.umm(W.handleDataModelChange,W)),W._dataModel=J,J.mm(W.handleDataModelChange,W,!0),W.fp(pb,I,J))},dispose:function(){var z=this;z.cs(),z._dataModel.umm(z.handleDataModelChange,z)},handleDataModelChange:function(v){var J=this;if(v.kind===Rl){var I=v.data;J.co(I)&&(J._73O.remove(I),delete J._map[I._id],J._75I(Rl,new Bk(I)))}else v.kind===ar&&J.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(t){var H=this;if(H._filterFunc!==t){H.cs();var E=H._filterFunc;H._filterFunc=t,H.fp("filterFunc",E,H._filterFunc)}},_75I:function(m,O,N,R){N&&(this._73O.each(function(O){R[O._id]?N.remove(O):N.add(O)}),O=N.toList()),this._74I.fire({kind:m,datas:new Bk(O)})},addSelectionChangeListener:function(e,p,L){this._74I.add(e,p,L)},removeSelectionChangeListener:function(C,m){this._74I.remove(C,m)},_97O:function(M,l){for(var d,n=this,y=0,i=new Bk(M);y<i.size();y++)d=i.get(y),(n._filterFunc&&!n._filterFunc(d)||l&&n.co(d)||!l&&!n.co(d)||!n._dataModel.contains(d))&&(i.removeAt(y),y--);return i},appendSelection:function(C){var b=this;if(b._68O!==tc){var U,F,A=b._73O,H=b._97O(C,!0);H.isEmpty()||(b.sg()&&(U=new Bk(A),F=b._map,A.clear(),b._map={},H=new Bk(H.get(H.size()-1))),H.each(function(Z){A.add(Z),b._map[Z._id]=Z}),b._75I("append",H,U,F))}},removeSelection:function(S){var p=this,r=p._97O(S),R=0,Z=r.size();if(0!==Z){for(;Z>R;R++){var w=r.get(R);p._73O.remove(w),delete p._map[w._id]}p._75I(Rl,r)}},toSelection:function(M,A){return this._73O.toList(M,A)},getSelection:function(){return this._73O},each:function(X,D){this._73O.each(X,D)},setSelection:function(x){var d=this,s=d._73O;if(d._68O!==tc&&!(s.isEmpty()&&!x||1===s.size()&&d.ld()===x)){var K=new Bk(s),v=d._map;s.clear(),d._map={};var n=d._97O(x,!0);d.sg()&&n.size()>1&&(n=new Bk(n.get(n.size()-1))),n.each(function(n){s.add(n),d._map[n._id]=n}),d._75I("set",T,K,v)}},clearSelection:function(){var s=this,Y=s._73O;if(Y.size()>0){var J=Y.toList();Y.clear(),s._map={},s._75I(ar,J)}},selectAll:function(){var J=this;if(J._68O!==tc){var w,p,r=J._dataModel.toDatas();if(J._filterFunc)for(w=0;w<r.size();w++)p=r.get(w),J._filterFunc(p)||(r.removeAt(w),w--);var C=J._73O,D=new Bk(C),k=J._map;C.clear(),J._map={},J.sg()&&r.size()>1&&(r=new Bk(r.get(r.size()-1)));var i=r.size();for(w=0;i>w;w++)p=r.get(w),C.add(p),J._map[p._id]=p;J._75I("all",T,D,k)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(N){return this._map[N._id]!=T},getLastData:function(){var J=this._73O;return J.size()>0?J.get(J.size()-1):T},getFirstData:function(){var F=this._73O;return F.size()>0?F.get(0):T},isSelectable:function(B){var f=this;return B&&f._68O!==tc?f._filterFunc?f._filterFunc(B):!0:!1},getTopSelection:function(){var L=this,Y=new Bk;return L._73O.each(function(o){for(var N=o.getParent();N;){if(L.contains(N)){o=T;break}N=N.parent}o&&Y.add(o)}),Y}});var xh=function(){return $m(0),function(q,s){var y;if(iq(s)){var V=q.getDataUI(s);V&&V._88I&&(y=V._88I.rect)}return y?y:s.getRect()}}();Pr(t,{edgeGroupAgentFunc:T,graphViewAutoScrollZone:16,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:r.rectSelectBorder,graphViewRectSelectBackground:Xr,graphViewEditPointSize:tb?17:7,graphViewEditPointBorderColor:r.editPointBorder,graphViewEditPointBackground:r.editPointBackground,setEdgeType:function(T,k,S){mm[T]=k,Ib[T]=S},getEdgeType:function(b){return mm[b]},getEdgeTypeMap:function(){return mm},getNodeRect:xh},!0),Pr(f,{layout:!1,"layout.h":q,"layout.h.value":q,"layout.v":q,"layout.v.value":q,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":q,interactive:!1,"image.stretch":"fill",icons:q,ingroup:!0,"body.color":q,opacity:q,pixelPerfect:!0,keepAspectRatio:!1,"clip.direction":"top","clip.percentage":1,"select.color":bk,"select.width":1,"select.padding":2,"select.type":zm,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":q,"border.width":2,"border.padding":2,"border.type":zm,label:q,"label.font":q,"label.color":Wl,"label.background":q,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":q,"label.max":q,"label.opacity":q,"label.scale":1,"label.align":q,"label.selectable":!0,label2:q,"label2.font":q,"label2.color":Wl,"label2.background":q,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":q,"label2.max":q,"label2.opacity":q,"label2.scale":1,"label2.align":q,"label2.selectable":!0,note:q,"note.expanded":!0,"note.font":q,"note.color":Ik,"note.background":bk,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":q,"note.toggleable":!0,"note.border.width":1,"note.border.color":q,"note.opacity":q,"note.scale":1,"note.align":q,note2:q,"note2.expanded":!0,"note2.font":q,"note2.color":Ik,"note2.background":bk,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":q,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":q,"note2.opacity":q,"note2.scale":1,"note2.align":q,"group.type":q,"group.image":q,"group.image.stretch":"fill","group.repeat.image":q,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":q,"group.title.color":Ik,"group.title.background":r.groupTitleBackground,"group.title.align":vn,"group.title.orientation":Nm,"group.background":r.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":q,"group.border.color":hm,"group.border.radius":0,"group.border.cap":Nd,"group.border.join":pk,"group.splitLine":!1,"group.gradient":T,"group.gradient.color":"#FFF",shape:q,"shape.background":hm,"shape.repeat.image":q,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":hm,"shape.border.3d":!1,"shape.border.3d.color":q,"shape.border.3d.accuracy":q,"shape.border.cap":Nd,"shape.border.join":pk,"shape.border.pattern":q,"shape.gradient":T,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":vc,"shape.dash.offset":0,"shape.dash.color":Wh,"shape.dash.width":q,"shape.dash.3d":!1,"shape.dash.3d.color":q,"shape.dash.3d.accuracy":q,"shape.polygon.side":6,"shape.arc.from":X,"shape.arc.to":p,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":q,"shape.gradient.pack":q,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":q,"shape.foreground.gradient":T,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":q,"autolayout.hgap":q,"autolayout.vgap":q,"edge.type":q,"edge.points":q,"edge.segments":q,"edge.color":hm,"edge.width":2,"edge.width.absolute":!1,"edge.offset":20,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":q,"edge.3d.accuracy":q,"edge.cap":Nd,"edge.join":pk,"edge.source.position":17,"edge.source.anchor.x":q,"edge.source.anchor.y":q,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":q,"edge.target.anchor.y":q,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":q,"edge.dash":!1,"edge.dash.pattern":vc,"edge.dash.offset":0,"edge.dash.color":Wh,"edge.dash.width":q,"edge.dash.3d":!1,"edge.dash.3d.color":q,"edge.dash.3d.accuracy":q,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":q,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":q,"grid.column.percents":q,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":r.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":r.gridCellBorderColor,"grid.block":q,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":r.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":Wl,"text.font":Tl,"text.shadow":!1,"text.shadow.color":bk,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1},!0),Pr(Dj,{_76I:function(g,r,l){this._39I&&this._39I.fire({data:g,oldIndex:r,newIndex:l})},addIndexChangeListener:function(q,B,i){var L=this;L._39I||(L._39I=new oh),L._39I.add(q,B,i)},removeIndexChangeListener:function(P,H){this._39I.remove(P,H)},prepareRemove:function(B){Pn(B)&&(B.setSource(T),B.setTarget(T)),B._70O&&B._70O.toList().each(this.remove,this),B._69O&&B._69O.toList().each(function(d){d.setHost(T)}),B._host&&B.setHost(T)},onAdded:function(B){this.isAutoAdjustIndex()&&this.adjustIndex(B)},onDataPropertyChanged:function(L,e){Zg[e.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(L)},isAdjustable:function(m){return uq(m)||Pn(m)
},isAdjustedToBottom:function(H){return Vf(H)?H.isExpanded()&&Wb(H):!1},adjustIndex:function(F){var f=this;this.isHierarchicalRendering()||(f.isAdjustedToBottom(F)?(f.sendToBottom(F),F.eachChild(f.adjustIndex,f)):f.sendToTop(F))},sendToTop:function(T){var S=this;if(S.contains(T)&&S.isAdjustable(T)){var h=S._datas;if(T!==h.get(S.size()-1)){var I=h.indexOf(T);h.removeAt(I),h.add(T),S._76I(T,I,S.size()-1)}if(Pn(T)){var d=T._40I;d&&!S.isAdjustedToBottom(d)&&S.sendToTop(d),d=T._41I,d&&!S.isAdjustedToBottom(d)&&S.sendToTop(d)}T._69O&&T._69O.each(function(w){w.isRelatedTo(T)||uq(T)&&w.isLoopedHostOn(T)||S.sendToTop(w)}),T.ISubGraph||(!Vf(T)||T.isExpanded())&&T._adjustChildrenToTop&&T.eachChild(function(A){Pn(A)||S.sendToTop(A)})}},sendToBottom:function(b,j){var W=this;if(b!==j&&W.contains(b)&&W.isAdjustable(b)&&(!j||W.contains(j))){var y=W._datas,e=y.remove(b),u=j?W._datas.indexOf(j):0;if(y.add(b,u),e!==u){W._76I(b,e,u);var G=b._parent;!G||G.ISubGraph||Pn(G)||W.sendToBottom(b._parent,b)}}}}),Pr(Er,{ms_edit:function(c){c._46O=function(n){var I=this,s=I.gv.dm(),T=I._index,C=I._89I,R=I._node,Z=I._shape,N=I._edge,V=I._77I;R&&C?(this.fi({kind:"endEditRect",event:n,data:R,direction:C}),s.endTransaction()):Z&&T>=0?(I.fi({kind:"endEditPoint",event:n,data:Z,index:T}),s.endTransaction()):N&&T>=0?(I.fi({kind:"endEditPoint",event:n,data:N,index:T}),s.endTransaction()):V&&(I.fi({kind:"endEditRotation",event:n,data:V}),s.endTransaction())},c._78I=function(O){var R=this;R.autoScroll(O);var j=R.gv.lp(O),f=R._index,h=R._89I,K=R._node,H=R._shape,M=R._edge,A=R._77I;if(K&&h)R._80O(j),R.fi({kind:"betweenEditRect",event:O,data:K,direction:h});else if(H&&f>=0)j.e=H.getPoints().get(f).e,H.setPoint(f,j),R.fi({kind:"betweenEditPoint",event:O,data:H,index:f});else if(M&&f>=0){var B=M.s(Zf);j.e=B.get(f).e,B.set(f,j),M.fp(Zf,T,B),R.fi({kind:"betweenEditPoint",event:O,data:M,index:f})}else if(A){var t=A.p(),b=A.getScale(),v=_+J(j.y-t.y,j.x-t.x);b.y<0&&(v+=X),S(v)<.04&&(v=0),A.setRotation(v),R.fi({kind:"betweenEditRotation",event:O,data:A})}},c._80O=function(D){var W=this,K=W._node,z=W._rect,R=z.x,c=z.y,Y=z.width,F=z.height,$=W._89I,q=W._anchor,_=W._matrix,D=_.tfi(D);"northwest"===$?z=ps(D,{x:R+Y,y:c+F}):$===Kb?z=ps({x:R,y:D.y},{x:R+Y,y:c+F}):"northeast"===$?z=ps({x:R,y:D.y},{x:D.x,y:c+F}):$===Xo?z=ps({x:D.x,y:c},{x:R+Y,y:c+F}):$===wj?z=ps({x:R,y:c},{x:D.x,y:c+F}):"southwest"===$?z=ps({x:D.x,y:c},{x:R+Y,y:D.y}):"south"===$?z=ps({x:R,y:c},{x:R+Y,y:D.y}):"southeast"===$&&(z=ps({x:R,y:c},D)),K.setPosition(_.tf(z.x+z.width*q.x,z.y+z.height*q.y)),K.setWidth(z.width),K.setHeight(z.height)},c._80I=function(A,j,q,t){var f=this,r=f.gv._zoom,H=(f.gv.getEditPointSize()+2)/r;return Fi({x:j-H/2,y:q-H/2,width:H,height:H},A)?(f._89I!==t&&(f._89I=t),!0):!1},c._79I=function(W,Q,x){var I=this,z=I.gv,f=Q?z.getDataUI(Q):T,S=f?f._55O:T;if(S){var A,n,Z,B,P=z._zoom,J=(z.getEditPointSize()+2)/P,i=z.lp(W);if(uq(Q)){if(S._56O&&uq(Q)&&(n=S._98o,Fi({x:n.x-J/2,y:n.y-J/2,width:J,height:J},i)))return I._77I=Q,x&&I.fi({kind:"beginEditRotation",event:W,data:Q}),I.setCursor("crosshair"),!0;if(S._43O&&Q instanceof po)for(Z=Q.getPoints(),A=Z.size()-1;A>=0;A--)if(n=Z.get(A),Fi({x:n.x-J/2,y:n.y-J/2,width:J,height:J},i))return I._index=A,I._shape=Q,x&&I.fi({kind:"beginEditPoint",event:W,data:Q,index:A}),I.setCursor("crosshair"),!0;if(S._42O)for(var $=Q.getEditControlPoints(),d=["northwest",-1,-1,Xo,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,wj,1,0,"northeast",1,-1,Kb,0,-1],A=0,B=$.length;B>A;A++){var c=d[3*A],V=$[A];if(I._80I(i,V.x,V.y,c)){I._node=Q;var q=Q.getWidth(),D=Q.getHeight(),H=Q.getAnchor();I._rect={x:-q*H.x,y:-D*H.y,width:q,height:D},I._anchor=H,I._matrix=Q.getMatrix();var E=Q.getRotation(),u=o(E),v=U(E),M=d[3*A+1]*wg(Q.getScale().x),L=d[3*A+2]*wg(Q.getScale().y),w=Math.atan2(-v*M-u*L,u*M-v*L),r=(Math.round(w/(Math.PI/4))+8)%8,h=[cm,"nesw-resize",lr,"nwse-resize",cm,"nesw-resize",lr,"nwse-resize"][r];return I.setCursor(h),x&&I.fi({kind:"beginEditRect",event:W,data:Q,direction:I._89I}),!0}}}if(S._43O&&Pn(Q)&&Q.s(Zj)===ek&&(Z=Q.s(Zf)))for(A=Z.size()-1;A>=0;A--)if(n=Z.get(A),Fi({x:n.x-J/2,y:n.y-J/2,width:J,height:J},i))return I._index=A,I._edge=Q,x&&I.fi({kind:"beginEditPoint",event:W,data:Q,index:A}),I.setCursor("crosshair"),!0}return!1}},ms_gv:function(A){A._currentSubGraph=T,A.upSubGraph=function(){this.setCurrentSubGraph(ac(this._currentSubGraph))},A.isVisible=function(k){var X=this;if(ac(k)!==X._currentSubGraph)return!1;if(Pn(k)){var E=k._40I,s=k._41I;if(!E||!s)return!1;if(!(k.s("edge.independent")||X.isVisible(E)&&X.isVisible(s)))return!1;if(k.isEdgeGroupHidden())return!1}else for(var q=k._parent;q&&!q.ISubGraph;){if(Vf(q)&&(!q.isExpanded()||!X.isVisible(q)))return!1;q=q._parent}if(k._parent instanceof Tf&&!X.isVisible(k._parent))return!1;if(k._refGraph instanceof Hh&&!X.isVisible(k._refGraph))return!1;if(X instanceof gg){if(!k.s("3d.visible"))return!1}else{var $=X.getLayersInfo();if($){var l=$[k._layer];if(l&&l.visible===!1)return!1}if(!k.s("2d.visible"))return!1}return X._visibleFunc?X._visibleFunc(k):!0},A.handleSelectionChange=function(Z){var n=this;Z.datas.each(function(O){n.invalidateData(O);var e=O._parent;Vf(e)&&uq(O)&&O.s(eh)&&(n.invalidateData(e),e._49I&&e._49I.each(function(u){n.invalidateData(u)}))}),n.onSelectionChanged(Z)},A.onSelectionChanged=function(y){var J=this,m=J.sm();if(1===m.size()&&("set"===y.kind||"append"===y.kind)){var X=m.ld();J.isAutoMakeVisible()&&J.makeVisible(X),J.adjustIndex&&J._dataModel.isAutoAdjustIndex()&&J.adjustIndex(X)}},A.makeVisible=function(T){if(T){var r=this,$=r.getDataUI?r.getDataUI(T):r.getData3dUI(T);if($){var A=T,s=ac(T);for(s!==r._currentSubGraph&&r.setCurrentSubGraph(s);(A=A._parent)&&A!==s;)Vf(A)&&A.setExpanded(!0);r._23I=T,r.iv()}}},A.getLabel=function(C){var n=C.getStyle(Rg);return n===q?C.getName():n},A.getLabelBackground=function(K){return K.getStyle("label.background")},A.getLabelColor=function(N){return N.getStyle("label.color")},A.getLabel2=function(V){return V.getStyle("label2")},A.getLabel2Background=function(R){return R.getStyle("label2.background")},A.getLabel2Color=function(T){return T.getStyle("label2.color")},A.getNote=function(G){return G.getStyle(Mr)},A.getNoteBackground=function(Y){return Y.getStyle("note.background")},A.getNote2=function(_){return _.getStyle(lf)},A.getNote2Background=function(H){return H.getStyle("note2.background")},A.handleClick=function(I,v,X){var $=this;v?($.fi({kind:"clickData",event:I,data:v,part:X}),$.onDataClicked(v,I)):($.fi({kind:"clickBackground",event:I}),$.onBackgroundClicked(I))},A.handleDoubleClick=function(v,t,_){var B=this;Cq(v)&&(t?(B.fi({kind:"doubleClickData",event:v,data:t,part:_}),B.onDataDoubleClicked(t,v,_),B.checkDoubleClickOnNote(v,t,_)||B.checkDoubleClickOnRotation&&B.checkDoubleClickOnRotation(v,t,_)||(Pn(t)?B.onEdgeDoubleClicked(t,v,_):t.ISubGraph?B.onSubGraphDoubleClicked(t,v,_):Vf(t)?B.onGroupDoubleClicked(t,v,_):t.IDoorWindow?B.onDoorWindowDoubleClicked(t,v,_):t.ICSGBox&&B.onCSGBoxDoubleClicked(t,v,_))):(B.fi({kind:"doubleClickBackground",event:v}),B.onBackgroundDoubleClicked(v)))},A.onSubGraphDoubleClicked=function(U){this.setCurrentSubGraph(U)},A.onEdgeDoubleClicked=function(m,z){m.ISubGraph&&!ti(z)?this.setCurrentSubGraph(m):m.s("edge.toggleable")&&m.toggle()},A.onGroupDoubleClicked=function(Y){Y.s("group.toggleable")&&Y.toggle()},A.onDoorWindowDoubleClicked=function(W){W.s("dw.toggleable")&&W.toggle(!0)},A.onCSGBoxDoubleClicked=function(V,O){var o=this;if(o instanceof gg){var L=o.getHitFaceInfo(O);L&&L.face&&V.s(L.face+".toggleable")&&V.toggleFace(L.face,!0)}},A.onBackgroundClicked=function(){},A.onBackgroundDoubleClicked=function(){this.upSubGraph()},A.onDataClicked=function(){},A.onDataDoubleClicked=function(){},A.onAutoLayoutEnded=function(){},A.onMoveEnded=function(){},A.onPanEnded=function(){},A.onPinchEnded=function(){},A.onRectSelectEnded=function(){},A.onZoomEnded=function(){}},ms_icons:function(p){p.getRotation=function(u){return u==T?0:u},p._15O=function(){var v=this,a=v.s(ag);if(a){var U=v,$=v.data||v._data,H=v._38o={icons:a,rects:{}};for(var B in a){var l=a[B],E=cg(l.shape3d,$,U);if(!(cg(l.visible,$,U)===!1||cg(l.for3d,$,U)&&!v.I3d||E&&!v.I3d)){var s=E?[E]:cg(l.names,$,U),p=s?s.length:0,Z=cg(l.position,$,U)||3,t=cg(l.offsetX,$,U)||0,C=cg(l.offsetY,$,U)||0,g=cg(l.direction,$,U)||wj,X=cg(l.gap,$,U),N=X!=T?X:1,R=cg(l.rotation,$,U),j=cg(l.keepOrien,$,U),y=cg(l.rotationFixed,$,U)?R:v.getRotation(R,j,Z),n=T,P=H.rects[B]=new Array(p);P.rotation=y;for(var x=0;p>x;x++){var m,O,f,V,A=s[x];if(E)f=0,V=0;else{var L=xf(A);f=cg(l.width,$,U),V=cg(l.height,$,U),f==T&&(f=Sq(L,$)),V==T&&(V=Bg(L,$))}if(n?g===wj?t+=f/2:g===Xo?t-=f/2:g===Kb?C-=V/2:C+=V/2:n={width:f,height:V},v.I3d){var z=-f/2,J=-V/2;O={width:f,height:V,mat:v._16O(cg(l.autorotate,$,U),Z,n,cg(l.face,$,U)||Af,cg(l.t3,$,U),cg(l.r3,$,U),cg(l.rotationMode,$,U),t,C),vs:new Lg([z,-J,0,z,-J-V,0,z+f,-J-V,0,z+f,-J,0])}}else m=v.getPosition(Z,t,C,n,cg(l.positionFixed,$,U)),O={x:m.x-f/2,y:m.y-V/2,width:f,height:V},v._68o(O,y);P[x]=O,g===wj?t+=f/2+N:g===Xo?t-=f/2+N:g===Kb?C-=V/2+N:C+=V/2+N}}}}}}});var dh={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Jd={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Ig={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Zg={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},Pp={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},qs={"edge.type":1,"edge.group":1},gc={rotation:1,rotationX:1,rotationZ:1},gp={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},kg={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},Go={shape:1,thickness:1,position:1,anchor:1,scale:1},Yb=function(G,E){if(!G||!Vf(E)||E.isEmpty())return!1;for(G=G._parent;Vf(G);){if(G===E)return!0;G=G._parent}return!1},Or=function(V,G){if(!V||!Se(G)||G.isEmpty())return!1;for(V=V._parent;Se(V);){if(V===G)return!0;V=V._parent}return!1},ac=function(N){if(!N)return T;if(Pn(N)){var q=N._40I,o=N._41I;if(!q||!o)return T;var p=ac(q),f=ac(o);return p===f?p:T}for(var G=N._parent;Pn(G)&&!G.ISubGraph;)G=G._parent;return G?G.ISubGraph?G:ac(G):T},rk=function(D,T,C,M){var r=T.getStyle(C)*M;r&&Ym(D,r),r=T.getStyle(C+".left")*M,r&&(D.x-=r,D.width+=r),r=T.getStyle(C+".right")*M,r&&(D.width+=r),r=T.getStyle(C+".top")*M,r&&(D.y-=r,D.height+=r),r=T.getStyle(C+".bottom")*M,r&&(D.height+=r),D.width<0&&(D.width=-D.width,D.x-=D.width),D.height<0&&(D.height=-D.height,D.y-=D.height)},Wb=function(V){for(var g,y=0,t=V.size();t>y;y++)if(g=V.getChildAt(y),uq(g)&&Wb(g))return!0;return V.hasAgentEdges()},Fl=function(X){if(!X)return T;for(var u=X._parent;Vf(u);){if(!Vf(u._parent))return u.isExpanded()?X:u;u.isExpanded()||(X=u),u=u._parent}return X},js=function(N,G){if(!N||!G)return T;var t,Z,H,k=ac(N),A=ac(G);if(k!==A){for(;A&&k!==A;)A=ac(A);if(k===A)return N;t=new Bk,t.add(N,0);for(var j=N._parent;uq(j)&&!G.isDescendantOf(j);)t.add(j,0),j=j._parent;for(H=t.size(),Z=0;H>Z;Z++){var O=t.get(Z);if(Vf(O)&&!O.isExpanded())return O;if(O.ISubGraph)return O}return N}return N},ze=function(y){if(y.isLooped())return y._source;var X=Fl(y._source),W=Fl(y._target);return X===W?y._source:js(X,W)},fd=function(s){if(s.isLooped())return s._target;var Z=Fl(s._source),o=Fl(s._target);return Z===o?s._target:js(o,Z)},zb=function(Y,Q,V,v,N,L,Z){if(!Q)return T;var R,I=Q.getRotation?Q.getRotation():0;if(L!==q||Z!==q)if(L=L===q?.5:L,Z=Z===q?.5:Z,I&&!iq(Q,Y)){var i=Q.getPosition(),d=Q.getWidth(),c=Q.getHeight(),k=Q.getAnchor(),P=Q.getScale(),s=new Jg(I,i.x,i.y,P.x,P.y);V=s.tf((L-k.x)*d,(Z-k.y)*c)}else R=xh(Y,Q),V={x:R.x+L*R.width,y:R.y+Z*R.height};else V=sj(V,xh(Y,Q));if(I){var X=o(I),g=U(I),j=v*X-N*g;N=v*g+N*X,v=j}return V.x+=v,V.y+=N,V},le=function(M,z){if(!M||!z)return T;var h,V,v,f,S,Q;if(M===z){if(f=M.getLoopedEdges(),!f)return T;f=new Bk(f)}else{if(S=M.getAgentEdges(),Q=z.getAgentEdges(),!S||!Q)return T;for(V=S.size(),h=0;V>h;h++)v=S.get(h),Q.contains(v)&&(f||(f=new Bk),f.add(v))}if(f)for(h=0;h<f.size();h++)v=f.get(h),v.getStyle(Zj)===ek&&(v._22I(T),f.removeAt(h),h--);return f},im=function(Q,t){var V=le(Q,t);if(V&&!V.isEmpty()){if(1===V.size())return V.get(0)._22I(T),void 0;var l=new Bk,F=new Bk;V.each(function(w){var V=w.s("edge.group");l.contains(V)||l.add(V)}),l.sort(),l.each(function(_){F.add(new b.EdgeGroup(V.toList(function(b){return _===b.s("edge.group")}),F))}),F.each(function(f){f.each(function(Y){Y._22I(f)})})}},jl=function(y,N){if(N){var r=N.rect,D=N.color,H=N.rotation,u=N.labelWidth,R=N.background,v=N.opacity,p=N.scale,S=p!=T&&1!==p;if(v!=T){var o=y.globalAlpha;y.globalAlpha*=v}if(H||S){y.save();var Z=r.x+r.width/2,C=r.y+r.height/2;ts(y,Z,C),H&&eg(y,H),S&&y.scale(p,p),ts(y,-Z,-C)}if(R&&Of(y,r.x,r.y,r.width,r.height,R),u){var d=r.width,g=y.createLinearGradient(r.x,r.y,r.x+d,r.y);g.addColorStop(0,D),g.addColorStop(.9,D),g.addColorStop(1,hf),D=g,r.width=u}Pg(y,N.ss,r,N.font,D,N.align),u&&(r.width=d),(H||S)&&y.restore(),v!=T&&(y.globalAlpha=o)}},Mb=function(S,b){if(b){var n=b.rect,e=n.x,Z=n.y,h=n.width,J=n.height,H=b.background,c=b.backgroundImage,o=b.borderWidth,y=b.borderColor,K=b.labelWidth,M=b.opacity,w=b.scale,t=w!=T&&1!==w;if(M!=T){var m=S.globalAlpha;S.globalAlpha*=M}if(t){S.save();var V=n.x+n.width/2,D=n.y+n.height/2;ts(S,V,D),S.scale(w,w),ts(S,-V,-D)}if(b.expanded){var A=B(8,h/4),z=Z+J-8;if(S.fillStyle=H,S.beginPath(),S.moveTo(e,Z),S.lineTo(e,z),S.lineTo(e+h/2,z),S.lineTo(e+h/2,Z+J),S.lineTo(e+h/2+A,z),S.lineTo(e+h,z),S.lineTo(e+h,Z),S.closePath(),S.fill(),o&&(S.lineWidth=o,S.lineJoin="round",S.lineCap="round",y?(S.strokeStyle=y,S.stroke()):(S.strokeStyle=ym(H),S.beginPath(),S.moveTo(e+h,Z),S.lineTo(e+h,z),S.lineTo(e+h/2+A,z),S.lineTo(e+h/2,Z+J),S.stroke(),S.strokeStyle=ie(H),S.beginPath(),S.moveTo(e+h,Z),S.lineTo(e,Z),S.lineTo(e,z),S.lineTo(e+h/2,z),S.lineTo(e+h/2,Z+J),S.stroke())),c)np(S,xf(c),co,n.x,n.y,n.width,n.height-8,b.data,b.view);else{if(n.height-=8,H=b.color,K){var U=h,O=S.createLinearGradient(e,Z,e+U,Z);O.addColorStop(0,H),O.addColorStop(.9,H),O.addColorStop(1,hf),H=O,n.width=K}Pg(S,b.ss,n,b.font,H,b.align),K&&(n.width=U),n.height+=8}}else if(b.icon)Bh(S,xf(b.icon),e,Z,h,J,b.data,b.view);else{var L=h/2;o&&(S.lineWidth=o,S.lineJoin="round",S.lineCap="round",S.strokeStyle=y?y:ym(H),S.beginPath(),S.arc(e+L,Z+L,L,_,1.6*X,!0),S.moveTo(e+L,Z+J),S.lineTo(e+h-L/5,Z+L),S.stroke(),S.strokeStyle=y?y:ie(H),S.beginPath(),S.arc(e+L,Z+L,L,1.6*X,_,!0),S.moveTo(e+L,Z+J),S.lineTo(e+L/5,Z+L),S.stroke()),S.fillStyle=H,S.beginPath(),S.arc(e+L,Z+L,L,0,p,!0),S.moveTo(e+L,Z+J),S.lineTo(e+h-L/5,Z+L),S.lineTo(e+L/5,Z+L),S.closePath(),S.fill(),S.fillStyle=b.color,S.beginPath(),S.arc(e+L,Z+L,L/3,0,p,!0),S.fill()}t&&S.restore(),M!=T&&(S.globalAlpha=m)}},Qm=function(o,i){return i>2*o?o:i/2},Nl=function(a,e,b,S){if(!a||!e)return 0;var Z=J(e.y-a.y,e.x-a.x);return b||(Z=e.x<a.x?Z+X:Z),Z+S},Mm=function(w,I,u,Z,K,v,n){n&&(w.x>I.x||w.x===I.x&&w.y>I.y)&&(u=Gi[u],K=-K);var X=sj(u,{x:0,y:0,width:Bc(w,I),height:0},v);return X.x+=Z,X.y+=K,X=new Jg(J(I.y-w.y,I.x-w.x)).tf(X),X.x+=w.x,X.y+=w.y,X},Db=function(B,z,v,j,S){if(B._19Q=!0,!v.getEdgeGroup())return j?v.s("edge.gap"):0;var f,s=0,N=0,Z=0;if(v.getEdgeGroup().getSiblings().each(function(j){j.each(function(g){if(z.isVisible(g)&&g.s(Zj)==S){var c=g.s("edge.gap");f?(N+=Z/2+c/2,Z=c):(f=g,Z=c),g===v&&(s=N)}})}),j)return N-s+Z;var g=s-N/2;return f&&v._40I!==f._40I&&(B._19Q=!1),g},Qj=function(){var J=function($){var m=[];return $.forEach(function(E){m.push({x:E.x,y:E.y}),m.push({x:E.x+E.width,y:E.y+E.height}),m.push({x:E.x+E.width,y:E.y}),m.push({x:E.x,y:E.y+E.height})}),m};return function(u,i,w){if("oval"===u){var Z=0,O=w.height/w.width,v=O*O,e=w.x+w.width/2,G=w.y+w.height/2,n=J(i);n.forEach(function(d){var M=d.x-e,z=d.y-G,w=M*M+z*z/v;w>Z&&(Z=w)}),Z=E(Z);var g=O*Z;return{x:e-Z,y:G-g,width:2*Z,height:2*g}}if("circle"===u){var q=0,e=w.x+w.width/2,G=w.y+w.height/2,n=J(i);return n.forEach(function(D){var k=D.x-e,M=D.y-G,I=k*k+M*M;I>q&&(q=I)}),q=E(q),{x:e-q,y:G-q,width:2*q,height:2*q}}return"roundRect"===u?(Ym(w,B(w.width,w.height)/16),w):w}}(),_h=b.graph={},Sb=function(H,d,n){Nc(e+".graph."+H,d,n)};b.layout={};var Bo={comps:[{type:Mo,points:[85,50,70,115,100,71,86,107,88,49,56,101,99,101,97,86,86,48,114,52,73,55,106,57,106,122,55,97,56,52,101,102,90,110,119,78,108,48,53,119,74,78,52,61],borderWidth:1,borderColor:T}]};Bo[Mc]=Bo[tf]=160,yk("node_image",Tb(30,30,[{type:zm,rect:[4,5,22,16],gradient:kp,gradientColor:zl,background:hm},{type:zm,rect:[2,3,26,20],borderWidth:1,borderColor:hm},{type:zm,rect:[11,23,8,4],background:hm},{type:zm,rect:[6,27,18,2],background:hm}])),yk("node_icon",Tb(16,16,[{type:zm,rect:[2,2,12,10],gradient:kp,gradientColor:zl,background:hm},{type:Zq,rect:[2,2,12,10],width:1,color:hm},{type:zm,rect:[6,12,4,2],background:hm},{type:zm,rect:[4,14,8,1],background:hm}])),yk("block_icon",Tb(16,16,[{type:Zq,rect:[1,1,14,14],width:1,color:hm}])),yk("group_image",Tb(66,39,[{type:zm,rect:[44.3,18,18.1,12.8],gradient:kp,gradientColor:zl,background:hm},{type:zm,rect:[3.3,17.8,18.1,12.8],gradient:kp,gradientColor:zl,background:hm},{type:zm,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:hm,gradient:kp,gradientColor:zl,background:hm},{type:zm,rect:[26.2,29.4,12.8,4.2],background:hm},{type:zm,rect:[21.3,33.5,22.5,2.3],background:hm},{type:zm,rect:[5.3,32.7,14.1,2.1],background:hm},{type:zm,rect:[9,30.4,6.7,2.4],background:hm},{type:zm,rect:[50,30.7,6.7,2.4],background:hm},{type:zm,rect:[46.3,33,14.1,2.1],background:hm}])),yk("group_icon",Tb(16,16,[{type:zm,rect:[4,12,4,2],background:hm},{type:zm,rect:[2,13,8,1],background:hm},{type:zm,rect:[12,12,2,1],background:hm},{type:zm,rect:[11,13,4,1],background:hm},{type:zm,rect:[10,7,6,5],gradient:kp,gradientColor:zl,background:hm},{type:zm,rect:[1,2,10,10],gradient:kp,gradientColor:zl,background:hm},{type:Zq,rect:[1,2,10,10],width:1,color:hm}])),yk("refGraph_icon",Tb(16,16,[{type:"shape",borderWidth:1,borderColor:hm,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:hm,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),yk("edge_icon",Tb(16,16,[{type:zm,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:kp,gradientColor:zl,background:hm},{type:zm,rect:[10.8,1,4,4],background:hm},{type:zm,rect:[1,11,4,4],background:hm}])),yk("subGraph_image",Tb(72,45,[{type:Mo,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:kp,gradientColor:zl,background:hm},{type:zm,rect:[29.6,30.7,3.6,1.8],background:hm},{type:zm,rect:[28.4,32.3,6,1.2],background:hm},{type:zm,rect:[37.3,32,10.8,1.8],background:hm},{type:zm,rect:[39.1,29.9,7.2,2.3],background:hm},{type:zm,rect:[26.6,23.7,9.6,7.2],gradient:kp,gradientColor:zl,background:hm},{type:zm,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:hm,gradient:kp,gradientColor:zl,background:hm}])),yk("subGraph_icon",Tb(17,17,[{type:Mo,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:kp,gradientColor:zl,background:hm}])),yk("shape_icon",Tb(16,16,[{type:Mo,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:hm}])),yk("polyline_icon",Tb(16,16,[{type:Mo,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:hm},pg(7.5,.4),pg(7.5,6.3),pg(13.6,6.3),pg(13.6,14),pg(.7,13.9),pg(.7,.3)])),yk("grid_icon",Tb(16,16,[{type:zm,rect:[1,1,4,4],background:hm,gradient:kp,gradientColor:zl},{type:zm,rect:[6,1,4,4],background:hm,gradient:kp,gradientColor:zl},{type:zm,rect:[11,1,4,4],background:hm,gradient:kp,gradientColor:zl},{type:zm,rect:[11,6,4,4],background:hm,gradient:kp,gradientColor:zl},{type:zm,rect:[6,6,4,4],background:hm,gradient:kp,gradientColor:zl},{type:zm,rect:[1,6,4,4],background:hm,gradient:kp,gradientColor:zl},{type:zm,rect:[11,11,4,4],background:hm,gradient:kp,gradientColor:zl},{type:zm,rect:[6,11,4,4],background:hm,gradient:kp,gradientColor:zl},{type:zm,rect:[1,11,4,4],background:hm,gradient:kp,gradientColor:zl}])),yk("light_icon",Tb(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:hm},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:hm,gradient:kp,gradientColor:zl,background:{func:function(y){var p=y?y.s(ye):T;return Wd(p)?"rgb("+j(255*p[0])+","+j(255*p[1])+","+j(255*p[2])+")":p||hm}}}])),yk("text_icon",Tb(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:hm}])),yk("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),yk("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),yk("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),yk("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var aq=function(N,D){for(var a=N.vertices,I=0;I<a.length;I++){var O=a[I],U=O.y;O.y=O.z,O.z=-U,D&&(O.y+=D)}},og=function(s){for(var p,C,d,P,R,q,D=[],a=[],V=[],B=s.faces,E=0,f=0,$=0,l=B.length;l>E;E++,f+=6,$+=9){var e=B[E];1===e.i?(p||(p=[],C=[],d=[]),uo(e,E,f,$,s,p,d,C)):2===e.i?(P||(P=[],R=[],q=[]),uo(e,E,f,$,s,P,q,R)):uo(e,E,f,$,s,D,V,a)}return{vs:D,uv:a,ns:V,top_vs:p,top_uv:C,top_ns:d,bottom_vs:P,bottom_uv:R,bottom_ns:q}},uo=function(l,G,P,B,A,O,c,F){var M=A.vertices,w=A.faceVertexUvs,j=M[l.a],r=M[l.b],N=M[l.c];O[B]=j.x,O[B+1]=j.y,O[B+2]=j.z,O[B+3]=r.x,O[B+4]=r.y,O[B+5]=r.z,O[B+6]=N.x,O[B+7]=N.y,O[B+8]=N.z;var Q=l.vertexNormals;if(3===Q.length){var h=Q[0],Y=Q[1],b=Q[2];c[B]=h.x,c[B+1]=h.y,c[B+2]=h.z,c[B+3]=Y.x,c[B+4]=Y.y,c[B+5]=Y.z,c[B+6]=b.x,c[B+7]=b.y,c[B+8]=b.z}else{var p=l.normal;c[B]=p.x,c[B+1]=p.y,c[B+2]=p.z,c[B+3]=p.x,c[B+4]=p.y,c[B+5]=p.z,c[B+6]=p.x,c[B+7]=p.y,c[B+8]=p.z}var K=w[0][G][0],d=w[0][G][1],f=w[0][G][2];F[P]=K.x,F[P+1]=K.y,F[P+2]=d.x,F[P+3]=d.y,F[P+4]=f.x,F[P+5]=f.y},Ce=function(b){var y=b._lineModel;if(y)return y;var G;G=Wd(b)?b:[b];var D,W,Y,w,e,$,C,_,d,F,T,j,u=["","top","bottom"];for(y=[],D=0,W=G.length;W>D;D++)for(d=G[D],Y=0,w=u.length;w>Y;Y++)if(C=d[u[Y]+"vs"]){_=d[u[Y]+"is"],$=_?_.length:C.length/3;for(var e=0;$>e;e+=3)_?(F=_[e],T=_[e+1],j=_[e+2]):(F=e,T=e+1,j=e+2),F*=3,T*=3,j*=3,y.push(C[F],C[F+1],C[F+2],C[T],C[T+1],C[T+2],C[T],C[T+1],C[T+2],C[j],C[j+1],C[j+2],C[j],C[j+1],C[j+2],C[F],C[F+1],C[F+2])}return b._lineModel=y,y},_b=function(X,a,Y,n,_,g,G,t,W){Y==T&&(Y=!0),n==T&&(n=!0),G==T&&(G=1),t==T&&(t=0);var C=new Cf;return $r(C,X,a,W),C=C.toShapes(),og(new Oh(C,{top:Y,bottom:n,curveSegments:_,amount:G,repeatUVLength:g},-G/2+t))},Qr=function(l,h){this.x=l||0,this.y=h||0};Qr.prototype={constructor:Qr,add:function(u){return this.x+=u.x,this.y+=u.y,this},sub:function(o){return this.x-=o.x,this.y-=o.y,this},equals:function(y){return y.x===this.x&&y.y===this.y},multiplyScalar:function(s){return this.x*=s,this.y*=s,this},distanceTo:function(q){return E(this.distanceToSquared(q))},distanceToSquared:function(W){var B=this.x-W.x,m=this.y-W.y;return B*B+m*m},clone:function(){return new Qr(this.x,this.y)}};var pj=function(s,C,h){this.x=s||0,this.y=C||0,this.z=h||0};pj.prototype={constructor:pj,set:function(R,J,d){return this.x=R,this.y=J,this.z=d,this},setY:function(t){return this.y=t,this},copy:function(m){return this.x=m.x,this.y=m.y,this.z=m.z,this},add:function(C){return this.x+=C.x,this.y+=C.y,this.z+=C.z,this},addVectors:function(Y,f){return this.x=Y.x+f.x,this.y=Y.y+f.y,this.z=Y.z+f.z,this},sub:function(k){return this.x-=k.x,this.y-=k.y,this.z-=k.z,this},subVectors:function(m,p){return this.x=m.x-p.x,this.y=m.y-p.y,this.z=m.z-p.z,this},multiplyScalar:function(x){return this.x*=x,this.y*=x,this.z*=x,this},applyMatrix4:function(a){var U=this.x,C=this.y,$=this.z,Y=a.elements;return this.x=Y[0]*U+Y[4]*C+Y[8]*$+Y[12],this.y=Y[1]*U+Y[5]*C+Y[9]*$+Y[13],this.z=Y[2]*U+Y[6]*C+Y[10]*$+Y[14],this},divideScalar:function(R){if(0!==R){var n=1/R;this.x*=n,this.y*=n,this.z*=n}else this.x=0,this.y=0,this.z=0;return this},dot:function(U){return this.x*U.x+this.y*U.y+this.z*U.z},length:function(){return E(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(q){var F=this.x,H=this.y,Z=this.z;return this.x=H*q.z-Z*q.y,this.y=Z*q.x-F*q.z,this.z=F*q.y-H*q.x,this},crossVectors:function(i,r){var P=i.x,O=i.y,v=i.z,A=r.x,y=r.y,W=r.z;return this.x=O*W-v*y,this.y=v*A-P*W,this.z=P*y-O*A,this},distanceTo:function(x){return E(this.distanceToSquared(x))},distanceToSquared:function(o){var r=this.x-o.x,Z=this.y-o.y,J=this.z-o.z;return r*r+Z*Z+J*J},clone:function(){return new pj(this.x,this.y,this.z)}};var Ti=function(){this.elements=new Float32Array(16)};Ti.prototype={constructor:Ti,set:function(P,d,r,Z,C,z,n,Y,p,M,D,S,A,L,m,l){var G=this.elements;return G[0]=P,G[4]=d,G[8]=r,G[12]=Z,G[1]=C,G[5]=z,G[9]=n,G[13]=Y,G[2]=p,G[6]=M,G[10]=D,G[14]=S,G[3]=A,G[7]=L,G[11]=m,G[15]=l,this},makeRotationAxis:function(u,r){var k=o(r),I=U(r),q=1-k,f=u.x,z=u.y,B=u.z,S=q*f,c=q*z;return this.set(S*f+k,S*z-I*B,S*B+I*z,0,S*z+I*B,c*z+k,c*B-I*f,0,S*B-I*z,c*B+I*f,q*B*B+k,0,0,0,0,1),this}};var aj=function(K){this.repeatUVLength=K};aj.prototype={generateTopUV:function(W,d,u,p,G,A,N){var _,S,t,J,z=W.vertices,j=z[p].x,q=z[p].y,a=z[G].x,I=z[G].y,L=z[A].x,e=z[A].y,C=this.repeatUVLength;if(C)_=0,S=0,t=C,J=C;else{this._bb||(this._bb=d.getBoundingBox());var F=this._bb;_=F.minX,S=F.minY,t=F.maxX-_,J=F.maxY-S}return N?[new Qr((j-_)/t,(q-S)/J),new Qr((a-_)/t,(I-S)/J),new Qr((L-_)/t,(e-S)/J)]:[new Qr((j-_)/t,1-(q-S)/J),new Qr((a-_)/t,1-(I-S)/J),new Qr((L-_)/t,1-(e-S)/J)]},generateBottomUV:function(d,f,j,y,v,M){return this.generateTopUV(d,f,j,y,v,M,!0)},generateSideWallUV:function(Y,P,X,g,V,$,q,L,K,N,l,C){if(!this._cl){for(var c,o,r=[],A=0,Q=X.length,Z=0;Q>Z;Z++){c=X[Z],o=X[(Z+1)%Q];var I=c.x-o.x,s=c.y-o.y,h=E(I*I+s*s);r.push(A),A+=h}for(var Z=0;Q>Z;Z++)r[Z]/=A;this._cl=r}var r=this._cl,B=1-K/N,j=1-(K+1)/N,i=r[l],S=r[C];return S>i&&(i+=1),[new Qr(i,B),new Qr(S,B),new Qr(S,j),new Qr(i,j)]}};var Kn=function(N,M,O,s,U,h){this.a=N,this.b=M,this.c=O,this.i=h,this.normal=s instanceof pj?s:new pj,this.vertexNormals=s instanceof Array?s:[]};Kn.prototype={constructor:Kn};var yc=[-8,13,-3,11,1,13,3,2,-1],Rn=function(){if(Rn[Jm]!=T)return Rn[Jm];for(var u=Ur[Jm],$=yc,S=Ck.prototype.getClassName(),G='"',w=0,X="",Y=!1,r=+new(x[S.substr(3,3)+cm[w]]),H=w;H<$.length;H++){var F=$.length-H;X+=H%2===w?$[H]+F+"":$[H]-F+""}for(var H=w;4>H;H++)X+=w;if(X=X*X.length/X.length,r>X){if(u){for(var j,k,P,z,i,q,Q,g,v="",M=0,H=0;H<u.length;H++)u[H]===G?g?(g=!1,0!==M%2&&(j==T?j=v:k==T?k=v:P==T?P=v:z==T?z=v:i==T?i=v:q==T?q=v:Q==T&&(Q=v)),M++,v=""):g=!0:g&&(v+=u[H]);var E=j+k+P+z+i+q;(Y=Oj(E,Q)&&(!q||q.indexOf(oc)>=0)&&(!i||i>r))&&P.indexOf(uc[0])>=0&&(Rn[uc[0]]=1),Y&&P.indexOf(1)>=0&&(Rn[1]=1),Y&&P.indexOf(2)>=0&&(Rn[2]=1)}}else Y=!0,Rn[uc[0]]=Rn[1]=Rn[2]=1;return Rn[Jm]=Y,Y},rs=function(){},qb=rs.prototype;qb.getPointAt=function(E){var x=this.getUtoTmapping(E);return this.getPoint(x)},qb.getPoints=function(S){S||(S=5);var c,O=[];for(c=0;S>=c;c++)O.push(this.getPoint(c/S));return O},qb.getSpacedPoints=function(p){p||(p=5);var Q,P=[];for(Q=0;p>=Q;Q++)P.push(this.getPointAt(Q/p));return P},qb.getLength=function(){var P=this.getLengths();return P[P.length-1]},qb.getLengths=function(H){if(H||(H=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==H+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var g,L,t=[],B=this.getPoint(0),c=0;for(t.push(0),L=1;H>=L;L++)g=this.getPoint(L/H),c+=g.distanceTo(B),t.push(c),B=g;return this.cacheArcLengths=t,t},qb.getUtoTmapping=function(G,v){var L,U=this.getLengths(),K=0,y=U.length;L=v?v:G*U[y-1];for(var k,E=0,p=y-1;p>=E;)if(K=l(E+(p-E)/2),k=U[K]-L,0>k)E=K+1;else{if(!(k>0)){p=K;break}p=K-1}if(K=p,U[K]==L){var j=K/(y-1);return j}var T=U[K],d=U[K+1],X=d-T,P=(L-T)/X,j=(K+P)/(y-1);return j},qb.getTangent=function(N){var J=1e-4,y=N-J,G=N+J;0>y&&(y=0),G>1&&(G=1);var D=this.getPoint(y),X=this.getPoint(G),P=X.clone().sub(D);return P.normalize()},qb.getTangentAt=function($){var J=this.getUtoTmapping($);return this.getTangent(J)},rs.create=function(E,l){return E.prototype=Ij(rs.prototype),E.prototype.getPoint=l,E};var on=function(){this.curves=[],this.autoClose=!1},_p=on.prototype=Ij(qb);_p.add=function(q){this.curves.push(q)},_p.closePath=function(){var X=this.curves[0].getPoint(0),D=this.curves[this.curves.length-1].getPoint(1);X.equals(D)||this.curves.push(new Pl(D,X))},_p.getPoint=function(A){for(var y,p,j=A*this.getLength(),h=this.getCurveLengths(),v=0;v<h.length;){if(h[v]>=j){y=h[v]-j,p=this.curves[v];var M=1-y/p.getLength();return p.getPointAt(M)}v++}return null},_p.getLength=function(){var m=this.getCurveLengths();return m[m.length-1]},_p.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var $,t=[],N=0,g=this.curves.length;for($=0;g>$;$++)N+=this.curves[$].getLength(),t.push(N);return this.cacheLengths=t,t},_p.getTransformedPoints=function(r){return this.getPoints(r)},_p.getBoundingBox=function(){var y,f,Q,u,X,i,E=this.getPoints();y=f=Number.NEGATIVE_INFINITY,u=X=Number.POSITIVE_INFINITY;var x,Y,F,v,q=E[0]instanceof pj;for(v=q?new pj:new Qr,Y=0,F=E.length;F>Y;Y++)x=E[Y],x.x>y&&(y=x.x),x.x<u&&(u=x.x),x.y>f&&(f=x.y),x.y<X&&(X=x.y),q&&(x.z>Q&&(Q=x.z),x.z<i&&(i=x.z)),v.add(x);var W={minX:u,minY:X,maxX:y,maxY:f};return q&&(W.maxZ=Q,W.minZ=i),W};var Hq=function(c){on.call(this),this.actions=[],c&&this.fromPoints(c)},Mq=Hq.prototype=Ij(on.prototype),oq="moveTo",wo="lineTo",Gh="quadraticCurveTo",ir="bezierCurveTo",Kk="arc",Cd="ellipse";Mq.fromPoints=function(E){this.moveTo(E[0].x,E[0].y);for(var K=1,B=E.length;B>K;K++)this.lineTo(E[K].x,E[K].y)},Mq.moveTo=function(){var k=Array.prototype.slice.call(arguments);this.actions.push({action:oq,args:k})},Mq.lineTo=function(S,o){var $=Array.prototype.slice.call(arguments),Q=this.actions[this.actions.length-1].args,t=Q[Q.length-2],x=Q[Q.length-1],W=new Pl(new Qr(t,x),new Qr(S,o));this.curves.push(W),this.actions.push({action:wo,args:$})
},Mq.quadraticCurveTo=function(R,$,Y,K){var U=Array.prototype.slice.call(arguments),s=this.actions[this.actions.length-1].args,N=s[s.length-2],r=s[s.length-1],e=new af(new Qr(N,r),new Qr(R,$),new Qr(Y,K));this.curves.push(e),this.actions.push({action:Gh,args:U})},Mq.bezierCurveTo=function(H,W,z,L,P,l){var R=Array.prototype.slice.call(arguments),x=this.actions[this.actions.length-1].args,y=x[x.length-2],Y=x[x.length-1],U=new rr(new Qr(y,Y),new Qr(H,W),new Qr(z,L),new Qr(P,l));this.curves.push(U),this.actions.push({action:ir,args:R})},Mq.arc=function(R,I,U,T,c,M){var m=this.actions[this.actions.length-1].args,G=m[m.length-2],P=m[m.length-1];this.absarc(R+G,I+P,U,T,c,M)},Mq.absarc=function(W,O,b,C,S,o){this.absellipse(W,O,b,b,C,S,o)},Mq.ellipse=function(N,Q,U,P,s,y,i){var d=this.actions[this.actions.length-1].args,C=d[d.length-2],c=d[d.length-1];this.absellipse(N+C,Q+c,U,P,s,y,i)},Mq.absellipse=function(X,r,L,s,q,c,v){var D=Array.prototype.slice.call(arguments),C=new Rf(X,r,L,s,q,c,v);this.curves.push(C);var B=C.getPoint(1);D.push(B.x),D.push(B.y),this.actions.push({action:Cd,args:D})},Mq.getSpacedPoints=function(n){n||(n=40);for(var W=[],x=0;n>x;x++)W.push(this.getPoint(x/n));return W},Mq.getPoints=function(P,r){P=P||12;var Q,s,X,D,N,I,E,t,p,y,R,C,i,G,w,$,b,L,A=[];for(Q=0,s=this.actions.length;s>Q;Q++)switch(X=this.actions[Q],D=X.action,N=X.args,D){case oq:A.push(new Qr(N[0],N[1]));break;case wo:A.push(new Qr(N[0],N[1]));break;case Gh:for(I=N[2],E=N[3],y=N[0],R=N[1],A.length>0?(G=A[A.length-1],C=G.x,i=G.y):(G=this.actions[Q-1].args,C=G[G.length-2],i=G[G.length-1]),w=1;P>=w;w++)$=w/P,b=hg.b2($,C,y,I),L=hg.b2($,i,R,E),A.push(new Qr(b,L));break;case ir:for(I=N[4],E=N[5],y=N[0],R=N[1],t=N[2],p=N[3],A.length>0?(G=A[A.length-1],C=G.x,i=G.y):(G=this.actions[Q-1].args,C=G[G.length-2],i=G[G.length-1]),w=1;P>=w;w++)$=w/P,b=hg.b3($,C,y,t,I),L=hg.b3($,i,R,p,E),A.push(new Qr(b,L));break;case Kk:var d,M=N[0],H=N[1],F=N[2],l=N[3],T=N[4],x=!!N[5],K=T-l,V=2*P;for(w=1;V>=w;w++)$=w/V,x||($=1-$),d=l+$*K,b=M+F*o(d),L=H+F*U(d),A.push(new Qr(b,L));break;case Cd:var d,M=N[0],H=N[1],z=N[2],m=N[3],l=N[4],T=N[5],x=!!N[6],K=T-l,V=2*P;for(w=1;V>=w;w++)$=w/V,x||($=1-$),d=l+$*K,b=M+z*o(d),L=H+m*U(d),A.push(new Qr(b,L))}var _=A[A.length-1],W=1e-10;return S(_.x-A[0].x)<W&&S(_.y-A[0].y)<W&&A.splice(A.length-1,1),r&&A.push(A[0]),A},Mq.toShapes=function(B,f){function Q(Q){var h,D,x,e,m,w=[],o=new Hq;for(h=0,D=Q.length;D>h;h++)x=Q[h],m=x.args,e=x.action,e==oq&&0!=o.actions.length&&(w.push(o),o=new Hq),o[e].apply(o,m);return 0!=o.actions.length&&w.push(o),w}function H(w){for(var l=[],E=0,t=w.length;t>E;E++){var q=w[E],a=new Cf;a.actions=q.actions,a.curves=q.curves,l.push(a)}return l}function A(j,U){for(var T=1e-10,t=U.length,K=!1,h=t-1,s=0;t>s;h=s++){var P=U[h],r=U[s],k=r.x-P.x,d=r.y-P.y;if(S(d)>T){if(0>d&&(P=U[s],k=-k,r=U[h],d=-d),j.y<P.y||j.y>r.y)continue;if(j.y==P.y){if(j.x==P.x)return!0}else{var E=d*(j.x-P.x)-k*(j.y-P.y);if(0==E)return!0;if(0>E)continue;K=!K}}else{if(j.y!=P.y)continue;if(r.x<=j.x&&j.x<=P.x||P.x<=j.x&&j.x<=r.x)return!0}}return K}var e=Q(this.actions);if(0==e.length)return[];if(f===!0)return H(e);var J,N,O,r=[];if(1==e.length)return N=e[0],O=new Cf,O.actions=N.actions,O.curves=N.curves,r.push(O),r;var i=!hg.isClockWise(e[0].getPoints());i=B?!i:i;var h,F=[],v=[],s=[],Y=0;v[Y]=q,s[Y]=[];var I,d;for(I=0,d=e.length;d>I;I++)N=e[I],h=N.getPoints(),J=hg.isClockWise(h),J=B?!J:J,J?(!i&&v[Y]&&Y++,v[Y]={s:new Cf,p:h},v[Y].s.actions=N.actions,v[Y].s.curves=N.curves,i&&Y++,s[Y]=[]):s[Y].push({h:N,p:h[0]});if(!v[0])return H(e);if(v.length>1){for(var u=!1,L=[],Z=0,j=v.length;j>Z;Z++)F[Z]=[];for(var Z=0,j=v.length;j>Z;Z++){v[Z];for(var p=s[Z],G=0;G<p.length;G++){for(var w=p[G],n=!0,k=0;k<v.length;k++)A(w.p,v[k].p)&&(Z!=k&&L.push({froms:Z,tos:k,hole:G}),n?(n=!1,F[k].push(w)):u=!0);n&&F[Z].push(w)}}L.length>0&&(u||(s=F))}var W,X,U;for(I=0,d=v.length;d>I;I++)for(O=v[I].s,r.push(O),W=s[I],X=0,U=W.length;U>X;X++)O.holes.push(W[X].h);return r};var Cf=function(){Hq.apply(this,arguments),this.holes=[]},wb=Cf.prototype=Ij(Mq);wb.getPointsHoles=function(F){var y,g=this.holes.length,A=[];for(y=0;g>y;y++)A[y]=this.holes[y].getTransformedPoints(F);return A},wb.extractAllPoints=function(V){return{shape:this.getTransformedPoints(V),holes:this.getPointsHoles(V)}},wb.extractPoints=function(N){return this.extractAllPoints(N)};var hg={triangulateShape:function(n,j){function x(r,Z,z){return r.x!=Z.x?r.x<Z.x?r.x<=z.x&&z.x<=Z.x:Z.x<=z.x&&z.x<=r.x:r.y<Z.y?r.y<=z.y&&z.y<=Z.y:Z.y<=z.y&&z.y<=r.y}function y(b,D,u,l,O){var Y=1e-10,y=D.x-b.x,h=D.y-b.y,m=l.x-u.x,r=l.y-u.y,H=b.x-u.x,G=b.y-u.y,v=h*m-y*r,L=h*H-y*G;if(S(v)>Y){var R;if(v>0){if(0>L||L>v)return[];if(R=r*H-m*G,0>R||R>v)return[]}else{if(L>0||v>L)return[];if(R=r*H-m*G,R>0||v>R)return[]}if(0==R)return!O||0!=L&&L!=v?[b]:[];if(R==v)return!O||0!=L&&L!=v?[D]:[];if(0==L)return[u];if(L==v)return[l];var C=R/v;return[{x:b.x+C*y,y:b.y+C*h}]}if(0!=L||r*H!=m*G)return[];var M=0==y&&0==h,n=0==m&&0==r;if(M&&n)return b.x!=u.x||b.y!=u.y?[]:[b];if(M)return x(u,l,b)?[b]:[];if(n)return x(b,D,u)?[u]:[];var o,f,k,s,Q,Z,c,V;return 0!=y?(b.x<D.x?(o=b,k=b.x,f=D,s=D.x):(o=D,k=D.x,f=b,s=b.x),u.x<l.x?(Q=u,c=u.x,Z=l,V=l.x):(Q=l,c=l.x,Z=u,V=u.x)):(b.y<D.y?(o=b,k=b.y,f=D,s=D.y):(o=D,k=D.y,f=b,s=b.y),u.y<l.y?(Q=u,c=u.y,Z=l,V=l.y):(Q=l,c=l.y,Z=u,V=u.y)),c>=k?c>s?[]:s==c?O?[]:[Q]:V>=s?[Q,f]:[Q,Z]:k>V?[]:k==V?O?[]:[o]:V>=s?[o,f]:[o,Z]}function N(s,$,L,V){var M=1e-10,l=$.x-s.x,e=$.y-s.y,t=L.x-s.x,m=L.y-s.y,d=V.x-s.x,Q=V.y-s.y,v=l*m-e*t,_=l*Q-e*d;if(S(v)>M){var z=d*m-Q*t;return v>0?_>=0&&z>=0:_>=0||z>=0}return _>0}function Z(Q,g){function R(s,i){var U=n.length-1,J=s-1;0>J&&(J=U);var b=s+1;b>U&&(b=0);var x=N(n[s],n[J],n[b],Z[i]);if(!x)return!1;var I=Z.length-1,R=i-1;0>R&&(R=I);var Q=i+1;return Q>I&&(Q=0),x=N(Z[i],Z[R],Z[Q],n[s]),x?!0:!1}function o(Z,m){var j,G,d;for(j=0;j<n.length;j++)if(G=j+1,G%=n.length,d=y(Z,m,n[j],n[G],!0),d.length>0)return!0;return!1}function $(k,n){var Z,H,U,r,E;for(Z=0;Z<W.length;Z++)for(H=g[W[Z]],U=0;U<H.length;U++)if(r=U+1,r%=H.length,E=y(k,n,H[U],H[r],!0),E.length>0)return!0;return!1}for(var Z,F,U,i,c,Y,V,I,p,A,k,n=Q.concat(),W=[],H=[],h=0,L=g.length;L>h;h++)W.push(h);for(var P=0,w=2*W.length;W.length>0&&(w--,!(0>w));)for(U=P;U<n.length;U++){i=n[U],F=-1;for(var h=0;h<W.length;h++)if(Y=W[h],V=i.x+":"+i.y+":"+Y,H[V]===q){Z=g[Y];for(var M=0;M<Z.length;M++)if(c=Z[M],R(U,M)&&!o(i,c)&&!$(i,c)){F=M,W.splice(h,1),I=n.slice(0,U+1),p=n.slice(U),A=Z.slice(F),k=Z.slice(0,F+1),n=I.concat(A).concat(k).concat(p),P=U;break}if(F>=0)break;H[V]=!0}if(F>=0)break}return n}for(var V,$,G,i,f,M,D={},B=n.concat(),O=0,A=j.length;A>O;O++)Array.prototype.push.apply(B,j[O]);for(V=0,$=B.length;$>V;V++)f=B[V].x+":"+B[V].y,D[f]!==q,D[f]=V;var p=Z(n,j),m=hq.Triangulate(p,!1);for(V=0,$=m.length;$>V;V++)for(i=m[V],G=0;3>G;G++)f=i[G].x+":"+i[G].y,M=D[f],M!==q&&(i[G]=M);return m.concat()},isClockWise:function(q){return hq.Triangulate.area(q)<0},b2p0:function(L,a){var q=1-L;return q*q*a},b2p1:function(F,y){return 2*(1-F)*F*y},b2p2:function(t,K){return t*t*K},b2:function(Z,B,w,$){return this.b2p0(Z,B)+this.b2p1(Z,w)+this.b2p2(Z,$)},b3p0:function(m,v){var f=1-m;return f*f*f*v},b3p1:function(O,X){var z=1-O;return 3*z*z*O*X},b3p2:function(j,H){var A=1-j;return 3*A*j*j*H},b3p3:function(i,f){return i*i*i*f},b3:function(k,j,b,T,S){return this.b3p0(k,j)+this.b3p1(k,b)+this.b3p2(k,T)+this.b3p3(k,S)}},hq={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var A=w.keys(this.faces);return A.length?A[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(Y){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(p){var L=p.familyName.toLowerCase(),X=this;return X.faces[L]=X.faces[L]||{},X.faces[L][p.cssFontWeight]=X.faces[L][p.cssFontWeight]||{},X.faces[L][p.cssFontWeight][p.cssFontStyle]=p,p},drawText:function(W){var p,f=this.getFace(),g=this.size/f.resolution,l=0,i=String(W).split(""),R=i.length,D=[];for(p=0;R>p;p++){var U=new Hq,I=this.extractGlyphPoints(i[p],f,g,l,U);I&&(l+=I.offset*this.spacing,D.push(I.path))}var o=l/2;return{paths:D,offset:o}},extractGlyphPoints:function(h,e,_,Y,q){var X,v,N,I,k,J,H,P,u,o,r,g,t,L,b,C,f,G,a,z=[],F=e.glyphs[h]||e.glyphs["?"];if(F){if(F.o)for(I=F._cachedOutline||(F._cachedOutline=F.o.split(" ")),J=I.length,H=_,P=_,X=0;J>X;)switch(k=I[X++]){case"m":u=I[X++]*H+Y,o=I[X++]*P,q.moveTo(u,o);break;case"l":u=I[X++]*H+Y,o=I[X++]*P,q.lineTo(u,o);break;case"q":if(r=I[X++]*H+Y,g=I[X++]*P,b=I[X++]*H+Y,C=I[X++]*P,q.quadraticCurveTo(b,C,r,g),a=z[z.length-1])for(t=a.x,L=a.y,v=1,N=this.divisions;N>=v;v++){var K=v/N;hg.b2(K,t,b,r),hg.b2(K,L,C,g)}break;case"b":if(r=I[X++]*H+Y,g=I[X++]*P,b=I[X++]*H+Y,C=I[X++]*P,f=I[X++]*H+Y,G=I[X++]*P,q.bezierCurveTo(b,C,f,G,r,g),a=z[z.length-1])for(t=a.x,L=a.y,v=1,N=this.divisions;N>=v;v++){var K=v/N;hg.b3(K,t,b,f,r),hg.b3(K,L,C,G,g)}}return{offset:F.ha*_,path:q}}}};hq.generateShapes=function(r,g){g=g||{};var t=g.font;if(t===q&&(t=hq.getDefaultFont(),!t))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var Q=g.size!==q?g.size:1,v=g.curveSegments!==q?g.curveSegments:4,x=g.spacing!==q?g.spacing:1,_=g.weight!==q?g.weight:"normal",Y=g.style!==q?g.style:"normal";hq.size=Q,hq.divisions=v,hq.face=t,hq.weight=_,hq.style=Y,hq.spacing=x;for(var S=hq.drawText(r),n=S.paths,O=[],U=0,C=n.length;C>U;U++)Array.prototype.push.apply(O,n[U].toShapes());return O},function(r){var U=1e-10,s=function(n,r){var p=n.length;if(3>p)return null;var o,B,V,w=[],i=[],u=[];if(N(n)>0)for(B=0;p>B;B++)i[B]=B;else for(B=0;p>B;B++)i[B]=p-1-B;var R=p,D=2*R;for(B=R-1;R>2;){if(D--<=0)return r?u:w;if(o=B,o>=R&&(o=0),B=o+1,B>=R&&(B=0),V=B+1,V>=R&&(V=0),J(n,o,B,V,R,i)){var G,t,x,$,g;for(G=i[o],t=i[B],x=i[V],w.push([n[G],n[t],n[x]]),u.push([i[o],i[B],i[V]]),$=B,g=B+1;R>g;$++,g++)i[$]=i[g];R--,D=2*R}}return r?u:w},N=function(i){for(var H=i.length,E=0,m=H-1,J=0;H>J;m=J++)E+=i[m].x*i[J].y-i[J].x*i[m].y;return.5*E},J=function(h,J,y,I,e,u){var i,A,W,w,o,j,O,d,H;if(A=h[u[J]].x,W=h[u[J]].y,w=h[u[y]].x,o=h[u[y]].y,j=h[u[I]].x,O=h[u[I]].y,U>(w-A)*(O-W)-(o-W)*(j-A))return!1;var z,f,S,C,Y,b,T,c,g,s,l,B,M,x,m;for(z=j-w,f=O-o,S=A-j,C=W-O,Y=w-A,b=o-W,i=0;e>i;i++)if(d=h[u[i]].x,H=h[u[i]].y,!(d===A&&H===W||d===w&&H===o||d===j&&H===O)&&(T=d-A,c=H-W,g=d-w,s=H-o,l=d-j,B=H-O,m=z*s-f*g,M=Y*c-b*T,x=S*B-C*l,m>=-U&&x>=-U&&M>=-U))return!1;return!0};return r.Triangulate=s,r.Triangulate.area=N,r}(hq),x._typeface_js={faces:hq.faces,loadFace:hq.loadFace};var Mg=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},pd=Mg.prototype={constructor:Mg,computeFaceNormals:function(){for(var A=new pj,z=new pj,S=0,u=this.faces.length;u>S;S++){var x=this.faces[S],G=this.vertices[x.a],P=this.vertices[x.b],p=this.vertices[x.c];A.subVectors(p,P),z.subVectors(G,P),A.cross(z),A.normalize(),x.normal.copy(A)}},computeVertexNormals:function(R){var F,M,e,N,G,S;for(S=new Array(this.vertices.length),F=0,M=this.vertices.length;M>F;F++)S[F]=new pj;if(R){var s,a,q,b=new pj,Y=new pj;for(e=0,N=this.faces.length;N>e;e++)G=this.faces[e],s=this.vertices[G.a],a=this.vertices[G.b],q=this.vertices[G.c],b.subVectors(q,a),Y.subVectors(s,a),b.cross(Y),S[G.a].add(b),S[G.b].add(b),S[G.c].add(b)}else for(e=0,N=this.faces.length;N>e;e++)G=this.faces[e],S[G.a].add(G.normal),S[G.b].add(G.normal),S[G.c].add(G.normal);for(F=0,M=this.vertices.length;M>F;F++)S[F].normalize();for(e=0,N=this.faces.length;N>e;e++)G=this.faces[e],G.vertexNormals[0]=S[G.a].clone(),G.vertexNormals[1]=S[G.b].clone(),G.vertexNormals[2]=S[G.c].clone()},mergeVertices:function(){var K,W,g,v,u,P,$,Y,t={},D=[],l=[],b=4,B=L(10,b);for(g=0,v=this.vertices.length;v>g;g++)K=this.vertices[g],W=z(K.x*B)+"_"+z(K.y*B)+"_"+z(K.z*B),t[W]===q?(t[W]=g,D.push(this.vertices[g]),l[g]=D.length-1):l[g]=l[t[W]];var o=[];for(g=0,v=this.faces.length;v>g;g++){u=this.faces[g],u.a=l[u.a],u.b=l[u.b],u.c=l[u.c],P=[u.a,u.b,u.c];for(var d=0;3>d;d++)if(P[d]==P[(d+1)%3]){o.push(g);break}}for(g=o.length-1;g>=0;g--){var V=o[g];for(this.faces.splice(V,1),$=0,Y=this.faceVertexUvs.length;Y>$;$++)this.faceVertexUvs[$].splice(V,1)}var k=this.vertices.length-D.length;return this.vertices=D,k}},Rf=function(F,W,T,B,J,N,d){this.aX=F,this.aY=W,this.xRadius=T,this.yRadius=B,this.aStartAngle=J,this.aEndAngle=N,this.aClockwise=d};Rf.prototype=Ij(qb),Rf.prototype.getPoint=function(K){var Z,d=this.aEndAngle-this.aStartAngle;0>d&&(d+=p),d>p&&(d-=p),Z=this.aClockwise===!0?this.aEndAngle+(1-K)*(p-d):this.aStartAngle+K*d;var i=this.aX+this.xRadius*o(Z),S=this.aY+this.yRadius*U(Z);return new Qr(i,S)};var Pl=function(B,E){this.v1=B,this.v2=E},mg=Pl.prototype=Ij(qb);mg.getPoint=function(G){var f=this.v2.clone().sub(this.v1);return f.multiplyScalar(G).add(this.v1),f},mg.getPointAt=function(I){return this.getPoint(I)},mg.getTangent=function(){var m=this.v2.clone().sub(this.v1);return m.normalize()};var af=function(j,S,m){this.v0=j,this.v1=S,this.v2=m};af.prototype=Ij(qb),af.prototype.getPoint=function($){var i,e;return i=hg.b2($,this.v0.x,this.v1.x,this.v2.x),e=hg.b2($,this.v0.y,this.v1.y,this.v2.y),new Qr(i,e)};var rr=function($,h,B,T){this.v0=$,this.v1=h,this.v2=B,this.v3=T};rr.prototype=Ij(qb),rr.prototype.getPoint=function(K){var e,E;return e=hg.b3(K,this.v0.x,this.v1.x,this.v2.x,this.v3.x),E=hg.b3(K,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new Qr(e,E)},rs.create(function(e,R){this.v1=e,this.v2=R},function(C){var Z=new pj;return Z.subVectors(this.v2,this.v1),Z.multiplyScalar(C),Z.add(this.v1),Z});var ip=rs.create(function(G,i,n){this.v0=G,this.v1=i,this.v2=n},function(Q){var q,o,R;return q=hg.b2(Q,this.v0.x,this.v1.x,this.v2.x),o=hg.b2(Q,this.v0.y,this.v1.y,this.v2.y),R=hg.b2(Q,this.v0.z,this.v1.z,this.v2.z),new pj(q,o,R)}),pr=rs.create(function(p,x,H,h){this.v0=p,this.v1=x,this.v2=H,this.v3=h},function(f){var c,W,k;return c=hg.b3(f,this.v0.x,this.v1.x,this.v2.x,this.v3.x),W=hg.b3(f,this.v0.y,this.v1.y,this.v2.y,this.v3.y),k=hg.b3(f,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new pj(c,W,k)}),gf=function(O,z,J,L,V,B,C,n){Mg.call(this),L=L!==q?L:.5,V=V!==q?V:.5,n=n!==q?n:1,O=O||8,B=B||0,C=C||p;var c,Z,H=1,i=n/2,d=[],G=[],l=this.vertices,g=this.faces,K=this.faceVertexUvs;for(Z=0;H>=Z;Z++){var a=[],r=[],M=Z/H,h=M*(V-L)+L;for(c=0;O>=c;c++){var $=c/O,f=new pj,x=-($*C+B);f.z=h*U(x),f.y=-M*n+i,f.x=h*o(x),l.push(f),a.push(l.length-1),r.push(new Qr($,M))}d.push(a),G.push(r)}var N,A,T=(V-L)/n;for(c=0;O>c;c++)for(0!==L?(N=l[d[0][c]].clone(),A=l[d[0][c+1]].clone()):(N=l[d[1][c]].clone(),A=l[d[1][c+1]].clone()),N.setY(E(N.x*N.x+N.z*N.z)*T).normalize(),A.setY(E(A.x*A.x+A.z*A.z)*T).normalize(),Z=0;H>Z;Z++){var m=d[Z][c],Q=d[Z+1][c],R=d[Z+1][c+1],u=d[Z][c+1],v=N.clone(),F=N.clone(),w=A.clone(),D=A.clone(),e=G[Z][c].clone(),P=G[Z+1][c].clone(),t=G[Z+1][c+1].clone(),S=G[Z][c+1].clone();g.push(new Kn(m,Q,u,[v,F,D])),K[0].push([e,P,S]),g.push(new Kn(Q,R,u,[F.clone(),w,D.clone()])),K[0].push([P.clone(),t,S.clone()])}if(z&&L>0)for(this.vertices.push(new pj(0,i,0)),c=0;O>c;c++){var m=d[0][c],Q=d[0][c+1],R=this.vertices.length-1,v=new pj(0,1,0),F=new pj(0,1,0),w=new pj(0,1,0),e=G[0][c].clone(),P=G[0][c+1].clone(),t=new Qr(P.x,0);g.push(new Kn(m,Q,R,[v,F,w],null,1));var I=c/O*p,k=o(I),X=U(I),Y=(c+1)/O*p,b=o(Y),y=U(Y);K[0].push([new Qr(.5+.5*k,.5+.5*X),new Qr(.5+.5*b,.5+.5*y),new Qr(.5,.5)])}if(J&&V>0)for(this.vertices.push(new pj(0,-i,0)),c=0;O>c;c++){var m=d[Z][c+1],Q=d[Z][c],R=l.length-1,v=new pj(0,-1,0),F=new pj(0,-1,0),w=new pj(0,-1,0),e=G[Z][c+1].clone(),P=G[Z][c].clone();g.push(new Kn(m,Q,R,[v,F,w],null,2));var I=c/O*p,k=o(I),X=U(I),Y=(c+1)/O*p,b=o(Y),y=U(Y);K[0].push([new Qr(.5+.5*b,.5-.5*y),new Qr(.5+.5*k,.5-.5*X),new Qr(.5,.5)])}};gf.prototype=Ij(pd);var bl=function(u,f,j,a,W,i,J){Mg.call(this),J=J||.5,u=u||16,f=f||16,j=(j!==q?j:0)-X,a=a!==q?a:p,W=W!==q?W:0,i=i!==q?i:X;var P,m,c=[],y=[],z=this.vertices,l=this.faces,Y=this.faceVertexUvs;for(m=0;f>=m;m++){var v=[],I=[];for(P=0;u>=P;P++){var G=P/u,K=m/f,w=new pj;w.x=-J*o(j+G*a)*U(W+K*i),w.y=J*o(W+K*i),w.z=J*U(j+G*a)*U(W+K*i),z.push(w),v.push(z.length-1),I.push(new Qr(G,K))}c.push(v),y.push(I)}for(m=0;f>m;m++)for(P=0;u>P;P++){var D=c[m][P+1],e=c[m][P],V=c[m+1][P],L=c[m+1][P+1],r=z[D].clone().normalize(),s=z[e].clone().normalize(),g=z[V].clone().normalize(),x=z[L].clone().normalize(),E=y[m][P+1].clone(),F=y[m][P].clone(),_=y[m+1][P].clone(),Z=y[m+1][P+1].clone();S(z[D].y)===J?(E.x=(E.x+F.x)/2,l.push(new Kn(D,V,L,[r,g,x])),Y[0].push([E,_,Z])):S(z[V].y)===J?(_.x=(_.x+Z.x)/2,l.push(new Kn(D,e,V,[r,s,g])),Y[0].push([E,F,_])):(l.push(new Kn(D,e,L,[r,s,x])),Y[0].push([E,F,Z]),l.push(new Kn(e,V,L,[s.clone(),g,x.clone()])),Y[0].push([F.clone(),_,Z.clone()]))}};bl.prototype=Ij(pd);var qk=function(G,O,z,a,c,w){Mg.call(this),G=G||.33,O=O||.17,a=a||8,z=z||6,c=c||0,w=w||p;for(var K=new pj,i=[],s=[],Y=0;a>=Y;Y++)for(var L=Y/a*p+X,h=0;z>=h;h++){var F=h/z*w+c;K.x=G*o(F),K.z=-G*U(F);var t=new pj,_=G+O*o(L);t.x=_*o(F),t.z=-_*U(F),t.y=O*U(L),this.vertices.push(t),i.push(new Qr(h/z,1-Y/a)),s.push(t.clone().sub(K).normalize())}for(var Y=1;a>=Y;Y++)for(var h=1;z>=h;h++){var m=(z+1)*Y+h-1,k=(z+1)*(Y-1)+h-1,q=(z+1)*(Y-1)+h,J=(z+1)*Y+h,l=new Kn(m,k,J,[s[m].clone(),s[k].clone(),s[J].clone()]);this.faces.push(l),this.faceVertexUvs[0].push([i[m].clone(),i[k].clone(),i[J].clone()]),l=new Kn(k,q,J,[s[k].clone(),s[q].clone(),s[J].clone()]),this.faces.push(l),this.faceVertexUvs[0].push([i[k].clone(),i[q].clone(),i[J].clone()])}this.computeFaceNormals()};qk.prototype=Ij(pd);var Oh=function(h,K,w){return h?(Mg.call(this),h=h instanceof Array?h:[h],this.addShapeList(h,K),K.convertYZ!==!1&&aq(this,w),this.computeFaceNormals(),void 0):(h=[],void 0)},mp=Oh.prototype=Ij(Mg.prototype);mp.addShapeList=function(G,H){for(var Q=G.length,v=0;Q>v;v++){var o=G[v];this.addShape(o,H)}},mp.addShape=function(f,L){function O(){if(L.bottom)for(var m=0;k>m;m++)X=J[m],y(X[2],X[1],X[0],!0);if(L.top)for(m=0;k>m;m++)X=J[m],y(X[0]+I*_,X[1]+I*_,X[2]+I*_,!1)}function l(){var N=0;for(Z(E,N),N+=E.length,o=0,M=n.length;M>o;o++)z=n[o],Z(z,N),N+=z.length}function Z(j,U){for(var l,f,Y=j.length;--Y>=0;){l=Y,f=Y-1,0>f&&(f=j.length-1);var r=0,p=_;for(r=0;p>r;r++){var a=I*r,b=I*(r+1),x=U+l+a,N=U+f+a,P=U+f+b,q=U+l+b;W(x,N,P,q,j,r,p,l,f)}}}function K(e,r,I){i.vertices.push(new pj(e,r,I))}function y(g,o,O,q){g+=v,o+=v,O+=v,i.faces.push(new Kn(g,o,O,null,null,q?2:1));var p=q?b.generateBottomUV(i,f,L,g,o,O):b.generateTopUV(i,f,L,g,o,O);i.faceVertexUvs[0].push(p)}function W(S,G,X,k,Y,Z,$,z,_){S+=v,G+=v,X+=v,k+=v,i.faces.push(new Kn(S,G,k)),i.faces.push(new Kn(G,X,k));var Q=b.generateSideWallUV(i,f,Y,L,S,G,X,k,Z,$,z,_);i.faceVertexUvs[0].push([Q[0],Q[1],Q[3]]),i.faceVertexUvs[0].push([Q[1],Q[2],Q[3]])}var $,C,j,d,P,S=L.amount,R=L.curveSegments||dd,_=L.steps||1,m=L.extrudePath,a=!1,b=new aj(L.repeatUVLength);m&&($=m.getSpacedPoints(_),a=!0,C=L.frames!==q?L.frames:new sn.FrenetFrames(m,_,!1),j=new pj,d=new pj,P=new pj);var z,o,M,i=this,v=this.vertices.length,w=f.extractPoints(R),F=w.shape,n=w.holes,r=!hg.isClockWise(F);if(r){for(F=F.reverse(),o=0,M=n.length;M>o;o++)z=n[o],hg.isClockWise(z)&&(n[o]=z.reverse());r=!1}var J=hg.triangulateShape(F,n),E=F;for(o=0,M=n.length;M>o;o++)z=n[o],F=F.concat(z);for(var Y,X,I=F.length,k=J.length,N=0;I>N;N++)Y=F[N],a?(d.copy(C.normals[0]).multiplyScalar(Y.x),j.copy(C.binormals[0]).multiplyScalar(Y.y),P.copy($[0]).add(d).add(j),K(P.x,P.y,P.z)):K(Y.x,Y.y,0);var e;for(e=1;_>=e;e++)for(N=0;I>N;N++)Y=F[N],a?(d.copy(C.normals[e]).multiplyScalar(Y.x),j.copy(C.binormals[e]).multiplyScalar(Y.y),P.copy($[e]).add(d).add(j),K(P.x,P.y,P.z)):K(Y.x,Y.y,S/_*e);O(),l()};var sn=function(G,i,_,N,j){function h(l,i,P){return S.vertices.push(new pj(l,i,P))-1}Mg.call(this),i=i||64,_=_||1,N=N||8,j=j||!1;var r,f,u,Y,y,I,d,T,Z,l,b,E,s,x,m,L,w,e,A,z,v=[],S=this,D=i+1,n=new pj,a=new sn.FrenetFrames(G,i,j),R=a.tangents,V=a.normals,K=a.binormals;for(this.tangents=R,this.normals=V,this.binormals=K,Z=0;D>Z;Z++)for(v[Z]=[],Y=Z/(D-1),T=G.getPointAt(Y),r=R[Z],f=V[Z],u=K[Z],l=0;N>l;l++)y=l/N*p,I=-_*o(y),d=_*U(y),n.copy(T),n.x+=I*f.x+d*u.x,n.y+=I*f.y+d*u.y,n.z+=I*f.z+d*u.z,v[Z][l]=h(n.x,n.y,n.z);for(Z=0;i>Z;Z++)for(l=0;N>l;l++)b=j?(Z+1)%i:Z+1,E=(l+1)%N,s=v[Z][l],x=v[b][l],m=v[b][E],L=v[Z][E],w=new Qr(Z/i,l/N),e=new Qr((Z+1)/i,l/N),A=new Qr((Z+1)/i,(l+1)/N),z=new Qr(Z/i,(l+1)/N),this.faces.push(new Kn(s,x,L)),this.faceVertexUvs[0].push([w,e,z]),this.faces.push(new Kn(x,m,L)),this.faceVertexUvs[0].push([e.clone(),A,z.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};sn.prototype=Ij(pd),sn.FrenetFrames=function(J,o,f){function P(){w[0]=new pj,x[0]=new pj,R=Number.MAX_VALUE,G=S(Y[0].x),O=S(Y[0].y),M=S(Y[0].z),R>=G&&(R=G,e.set(1,0,0)),R>=O&&(R=O,e.set(0,1,0)),R>=M&&e.set(0,0,1),r.crossVectors(Y[0],e).normalize(),w[0].crossVectors(Y[0],r),x[0].crossVectors(Y[0],w[0])}var v,R,G,O,M,c,D,e=new pj,Y=[],w=[],x=[],r=new pj,z=new Ti,E=o+1,$=1e-4;for(this.tangents=Y,this.normals=w,this.binormals=x,c=0;E>c;c++)D=c/(E-1),Y[c]=J.getTangentAt(D),Y[c].normalize();for(P(),c=1;E>c;c++)w[c]=w[c-1].clone(),x[c]=x[c-1].clone(),r.crossVectors(Y[c-1],Y[c]),r.length()>$&&(r.normalize(),v=g(Mi(Y[c-1].dot(Y[c]),-1,1)),w[c].applyMatrix4(z.makeRotationAxis(r,v))),x[c].crossVectors(Y[c],w[c]);if(f)for(v=g(Mi(w[0].dot(w[E-1]),-1,1)),v/=E-1,Y[0].dot(r.crossVectors(w[0],w[E-1]))>0&&(v=-v),c=1;E>c;c++)w[c].applyMatrix4(z.makeRotationAxis(Y[c],v*c)),x[c].crossVectors(Y[c],w[c])};var jj=function(f,Y,u,R){Mg.call(this),Y=Y||18,u=u||0,R=R==T?p:R;for(var V=1/(f.length-1),N=1/Y,s=0,D=Y;D>=s;s++)for(var w=u+s*N*R,m=o(w),Q=U(w),E=0,M=f.length;M>E;E++){var _=f[E],A=new pj;A.x=m*_.x-Q*_.y,A.y=Q*_.x+m*_.y,A.z=_.z,this.vertices.push(A)}for(var v=f.length,s=0,D=Y;D>s;s++)for(var E=0,M=f.length-1;M>E;E++){var W=E+v*s,y=W,O=W+v,m=W+1+v,i=W+1,H=s*N,k=E*V,b=H+N,t=k+V;this.faces.push(new Kn(y,i,O)),this.faceVertexUvs[0].push([new Qr(H,k),new Qr(H,t),new Qr(b,k)]),this.faces.push(new Kn(O,i,m)),this.faceVertexUvs[0].push([new Qr(b,k),new Qr(H,t),new Qr(b,t)])}this.mergeVertices(),aq(this),this.computeFaceNormals(),this.computeVertexNormals()};jj.prototype=Ij(pd);var oo=function($,w){w=w||{};var f=hq.generateShapes($,w);w.amount=w.amount!==q?w.amount:.5,w.convertYZ=!1,w.fill!==!1&&(w.bottom=!0,w.top=!0),Oh.call(this,f,w)};oo.prototype=Ij(mp);var Ak=b.Node=function(){Uo(Ak,this)},Hg={X:ef,Y:xm,Z:Vo},bn={X:0,Y:1,Z:2},$j={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},oj="xzy",rn=function(n,J,Q){if(J){var u=J[0],f=J[1],s=J[2];"xzy"===Q?(xm(n,f),Vo(n,s),ef(n,u)):"xyz"===Q?(Vo(n,s),xm(n,f),ef(n,u)):"yxz"===Q?(Vo(n,s),ef(n,u),xm(n,f)):"yzx"===Q?(ef(n,u),Vo(n,s),xm(n,f)):"zxy"===Q?(xm(n,f),ef(n,u),Vo(n,s)):"zyx"===Q?(ef(n,u),xm(n,f),Vo(n,s)):(xm(n,f),Vo(n,s),ef(n,u))}};Tn("Node",Ck,{ms_ac:["rotationMode","anchorElevation"],_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:oj,_64O:0,_rotationX:0,_53O:0,_host:T,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return Cm},_22Q:function(){return _c},getX:function(){return this.p().x},setX:function(D){this.p(D,this.p().y)},getY:function(){return this.p().y},setY:function(i){this.p(this.p().x,i)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(B){this.setAnchor(B,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(d){this.setAnchor(this.getAnchor().x,d)},getScaleX:function(){return this.getScale().x},setScaleX:function(s){this.setScale(s,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(C){this.setScale(this.getScale().x,C)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(z,G){rm(z,sf(T,T,this.r3(),this.getRotationMode())),this.translate3d(z[0]*G,z[1]*G,z[2]*G)},translateFront:function(B){this.translate3dBy([0,0,1],B)},translateBack:function(f){this.translate3dBy([0,0,-1],f)},translateLeft:function(H){this.translate3dBy([-1,0,0],H)},translateRight:function(p){this.translate3dBy([1,0,0],p)},translateTop:function(t){this.translate3dBy([0,1,0],t)},translateBottom:function(B){this.translate3dBy([0,-1,0],B)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(w,$,h){1===arguments.length&&($=w[1],h=w[2],w=w[0]),this.p(w,h),this.setElevation($)},translate3d:function(i,q,U){1===arguments.length&&(q=i[1],U=i[2],i=i[0]),this.translate(i,U),this.setElevation(this._54O+q)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(Y,p,S){1===arguments.length&&(p=Y[1],S=Y[2],Y=Y[0]),this.setSize(Y,S),this.setTall(p)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(l,O,H){1===arguments.length&&(O=l[1],H=l[2],l=l[0]),this.setRotationX(l),this.setRotation(-O),this.setRotationZ(H)},setRotationY:function(d){this.setRotation(-d)},getRotationY:function(){return-this._64O},lookAtDirection:function(i,L){L=L||Af;var m=this,$=Bc(i);L===Af?(m.r3([-K(i[1]/$),-J(i[2],i[0])+_,0]),m.setRotationMode("xzy")):L===ib?(m.r3(0,-J(i[2],i[0]),K(i[1]/$)),m.setRotationMode("zyx")):L===vn?(m.r3(0,-J(i[2],i[0])+X,-K(i[1]/$)),m.setRotationMode("zyx")):L===Nm?(m.r3([-K(i[1]/$)+_,-J(i[2],i[0])+_,0]),m.setRotationMode("xzy")):L===ak&&(m.r3([-K(i[1]/$)-_,-J(i[2],i[0])+_,0]),m.setRotationMode("xzy")),L===Yr&&(m.r3([-K(i[1]/$)+X,-J(i[2],i[0])+_,X]),m.setRotationMode("zxy"))},lookAt:function(r,G){return this.lookAtDirection(nj(r,this.p3()),G)},getLoopedEdges:function(){return this._45I},getEdges:function(){return this._70O},getAgentEdges:function(){return this._49I},getHost:function(){return this._host},setHost:function(S){var C=this;if(C!==S&&C._host!==S){var f=C._host;f&&f._removeAttach(C),C._host=S,C._host&&C._host._addAttach(C),C.fp("host",f,S),C.onHostChanged(f,S)}},getAttaches:function(){return this._69O},_addAttach:function(k){var p=this;p._69O||(p._69O=new Bk),p._69O.add(k),p.fp("attaches",T,k)},_removeAttach:function(F){var L=this;L._69O.remove(F),L._69O.isEmpty()&&delete L._69O,L.fp("attaches",F,T)},getSourceEdges:function(){return this._42I},getTargetEdges:function(){return this._43I},_2I:function(q){var V=this;V._44I||(V._44I=new Bk),V._42I||(V._42I=new Bk),V._44I.add(q),V._42I.add(q),V._20I()},_4I:function(Z){var M=this;M._44I||(M._44I=new Bk),M._43I||(M._43I=new Bk),M._44I.add(Z),M._43I.add(Z),M._20I()},_16I:function(H){var Z=this;Z._44I.remove(H),Z._42I.remove(H),Z._44I.isEmpty()&&delete Z._44I,Z._42I.isEmpty()&&delete Z._42I,Z._20I()},_18I:function(L){var O=this;O._44I.remove(L),O._43I.remove(L),O._44I.isEmpty()&&delete O._44I,O._43I.isEmpty()&&delete O._43I,O._20I()},_20I:function(){var I=this;if(delete I._45I,!I._44I||I._44I.isEmpty())return delete I._70O,void 0;var r;I._44I.each(function(g){g.isLooped()&&(r||(r={}),r[g._id]||(I._45I||(I._45I=new Bk),I._45I.add(g),r[g._id]=g))}),r?(I._70O=new Bk,I._44I.each(function(L){r[L._id]?"A"===r[L._id]||(r[L._id]="A",I._70O.add(L)):I._70O.add(L)})):I._70O=I._44I},hasAgentEdges:function(){return!!this._49I&&!this._49I.isEmpty()},getSourceAgentEdges:function(){return this._46I},getTargetAgentEdges:function(){return this._47I},_1I:function(B){var Y=this;Y._46I||(Y._46I=new Bk),Y._48I||(Y._48I=new Bk),Y._46I.add(B),Y._48I.add(B),Y._19I()},_3I:function(V){var q=this;q._47I||(q._47I=new Bk),q._48I||(q._48I=new Bk),q._47I.add(V),q._48I.add(V),q._19I()},_15I:function(Z){var p=this;p._46I.remove(Z),p._48I.remove(Z),p._46I.isEmpty()&&delete p._46I,p._48I.isEmpty()&&delete p._48I,p._19I()},_17I:function(R){var E=this;E._47I.remove(R),E._48I.remove(R),E._47I.isEmpty()&&delete E._47I,E._48I.isEmpty()&&delete E._48I,E._19I()},_19I:function(){var y=this;delete y._49I;var S=y._48I;if(S&&!S.isEmpty()){var h={};S.each(function(t){h[t._id]?y._49I||(y._49I=new Bk):h[t._id]=t}),y._49I?S.each(function(b){h[b._id]&&(y._49I.add(b),delete h[b._id])}):y._49I=S}},getImage:function(){if(this._pendingCheckImageJSON){var S=t.getImage(this._image);S&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Hh&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(t){var Y=this,w=Y._image,n=Y.getWidth(),R=Y.getHeight();Y._image=t,Y.fp("image",w,t)&&(null!=t&&(qc(t)||Ub(t)&&/\.json$/i.test(t))&&(this._pendingCheckImageJSON=!0),Y.fp(Mc,n,Y.getWidth()),Y.fp(tf,R,Y.getHeight()))},getElevation:function(){return this._54O},setElevation:function(w){var I=this;if(!I._50O){I._50O=1;var F=I._54O;I._54O=w,I.fp(Ll,F,w),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(i){var r=this;if(!r._49O){r._49O=1;var $=r._64O;r._64O=i,r.fp(Ui,$,i),delete r._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(U){var l=this;if(!l._51O){l._51O=1;var j=l._rotationX;l._rotationX=U,l.fp("rotationX",j,U),delete l._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(X){var t=this;if(!t._52O){t._52O=1;var Q=t._53O;t._53O=X,t.fp("rotationZ",Q,X),delete t._52O}},getPosition:function(){return this._position},setPosition:function(D,j){var l=this;if(!l._50I){l._50I=1;var V;if(V=2===arguments.length?{x:D,y:j}:D,V.x!==l._position.x||V.y!==l._position.y){var T=l._position;l._position=V,l.fp(wr,T,V)}delete l._50I}},translate:function(P,y){var p=this._position;this.p(p.x+P,p.y+y)},getWidth:function(){var f=this;if(f._width>=0)return f._width;var N=f.getStyle("shape3d");if(N){var G=ms(N);if(G&&G.rawS3)return G.rawS3[0];if("billboard"===N||"plane"===N){var z=xf(f.getStyle("shape3d.image"));return z?Sq(z,f):20}}var z=xf(f._image);return z?Sq(z,f):20},setWidth:function(v){var c=this,z=c._width;c._width=v,c.fp(Mc,z,v)},getHeight:function(){var m=this;if(m._height>=0)return m._height;var R=m.getStyle("shape3d");if(R){var U=ms(R);if(U&&U.rawS3)return U.rawS3[2];if("plane"===R){var L=xf(m.getStyle("shape3d.image"));return L?Bg(L,m):20}if("billboard"===R)return 2}var L=xf(m._image);return L?Bg(L,m):20},setHeight:function(V){var b=this,J=b._height;b._height=V,b.fp(tf,J,V)},getTall:function(){var k=this;if(k._tall>=0)return k._tall;var L=k.getStyle("shape3d");if(L){var Y=ms(L);if(Y&&Y.rawS3)return Y.rawS3[1];if("billboard"===L){var l=xf(k.getStyle("shape3d.image"));return l?Bg(l,k):20}if("plane"===L)return 2}return 20},setTall:function(c){var s=this,y=s._tall;s._tall=c,s.fp("tall",y,c)},setSize:function(e,o){var M=this;2===arguments.length?(M.setWidth(e),M.setHeight(o)):(M.setWidth(e.width),M.setHeight(e.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(S,t,h,f,b){var Q=this,F=Q.getAnchor(),O=Q.getScale();arguments.length<=2&&(b=t,t=S.y,h=S.width,f=S.height,S=S.x);var u=b&&O.x<0?1-F.x:F.x,Z=b&&O.y<0?1-F.y:F.y;Q.p(S+h*u,t+f*Z),b&&(h/=Math.abs(O.x),f/=Math.abs(O.y)),Q.setWidth(h),Q.setHeight(f)},getMatrix:function(){var r=this,W=r._64O,p=r._position,Q=r.getScale();return new Jg(W,p.x,p.y,Q.x,Q.y)},getAnchorRect:function(){var A=this,Q=A.getWidth(),l=A.getHeight(),$=A.getAnchor();return{x:-Q*$.x,y:-l*$.y,width:Q,height:l}},toLocal:function(k){return this.getMatrix().tfi(k)},toGlobal:function(z){return this.getMatrix().tf(z)},isInRect:function(S){S=this.toLocal(S);var e=this.getWidth(),F=this.getHeight();return S.x+=e*this.getAnchorX(),S.y+=F*this.getAnchorY(),!(S.x<0||S.y<0||S.x>e||S.y>F)},getRect:function(){var K=this,m=K.getWidth(),Q=K.getHeight(),Z=K.getAnchor(),d={x:-m*Z.x,y:-Q*Z.y,width:m,height:Q},b=K.getMatrix();return d=ps([b.tf(d.x,d.y),b.tf(d.x+d.width,d.y),b.tf(d.x+d.width,d.y+d.height),b.tf(d.x,d.y+d.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var D=this,w=D.getAnchor(),i=D._anchorElevation;
return{x:w.x,y:i,z:w.y}},setAnchorElevation:function(Q){var K=this,O=K._anchorElevation;return O!==Q?(K._anchorElevation=Q,K.fp("anchorElevation",O,Q),!0):!1},setAnchor3d:function(G,e,w,o){var W,I=this;"number"==typeof G?W={x:G,y:e,z:w}:(W=G.length?{x:G[0],y:G[1],z:G[2]}:G,o=e);var Q=I.getDataModel();Q&&Q.beginTransaction();var H=I.getAnchor3d(),k=I.setAnchor(W.x,W.z);if(I.setAnchorElevation(W.y)&&(k=!0),k&&o&&!Fo){I.getAnchor3d();var j=ap(I),s=rm([W.x-H.x,W.y-H.y,W.z-H.z],j);I.p3(s)}return Q&&Q.endTransaction(),k},getAnchor:function(){var z=this;if(z.hasOwnProperty("_anchor"))return z._anchor;var x=xf(z._image);return x&&x.anchorX!==q?{x:x.anchorX,y:x.anchorY}:z._anchor},setAnchor:function(O,G,r){var W,Q=this;"number"==typeof O?W={x:O,y:G}:(W=O.length?{x:O[0],y:O[1]}:O,r=G);var t=Q.getAnchor();if(t.x!==W.x||t.y!==W.y){var S=Q.getDataModel();if(S&&S.beginTransaction(),Q._anchor=W,Q.fp("anchor",t,W),r&&!Fo){var e=Q.getPosition(),P=Q.getSize(),N=Q.getRotation(),u=Q.getScale(),H=-P.width*(t.x-W.x)*u.x,n=-P.height*(t.y-W.y)*u.y,g=U(N),K=o(N);Q.setPosition(e.x+K*H-g*n,e.y+g*H+K*n)}return S&&S.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(U,s){var r,b=this;r=2===arguments.length?{x:U,y:s}:U;var O=b.getScale();(O.x!==r.x||O.y!==r.y)&&(b._scale=r,b.fp("scale",O,r))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var V=this,h=V._scaleTall,I=V.getScale();return[I.x,h,I.y]},getFinalScale3d:function(){var t=this,S=t.s3(),s=t._dynamicScale3d,x=t.getScale3d();return S&&(x[0]*=S[0],x[1]*=S[1],x[2]*=S[2]),s&&(x[0]*=s[0],x[1]*=s[1],x[2]*=s[2]),x},getFinalRotation3d:function(){var J=this;return J._dynamicRotation||J.r3()},setScaleTall:function(G){var B=this,W=B._scaleTall;W!==G&&(B._scaleTall=G,B.fp("scaleTall",W,G))},setScale3d:function(e,f,F){var G,I=this;G="number"==typeof e?{x:e,y:f,z:F}:e.length?{x:e[0],y:e[1],z:e[2]}:e,I.setScaleTall(G.y),I.setScale(G.x,G.z)},getCorners:function(A,C){A==T&&(A=0),C==T&&(C=A);var a=this,s=a.getAnchor(),k=a.getWidth(),o=a.getHeight(),E=-k*s.x-A,z=-o*s.y-C,N=k+2*A,u=o+2*C,G=a.getMatrix();return[G.tf(E,z),G.tf(E,z+u),G.tf(E+N,z+u),G.tf(E+N,z)]},getEditControlPoints:function(q,$,O){$==T&&($=0),O==T&&(O=$);var J=this,t=J.getAnchor(),L=J.getWidth(),s=J.getHeight(),h=-L*t.x-$,z=-s*t.y-O,C=L+2*$,Y=s+2*O;if(q)return[{x:h,y:z},{x:h,y:0},{x:h,y:z+Y},{x:0,y:z+Y},{x:h+C,y:z+Y},{x:h+C,y:0},{x:h+C,y:z},{x:0,y:z}];var I=J.getMatrix();return[I.tf(h,z),I.tf(h,0),I.tf(h,z+Y),I.tf(0,z+Y),I.tf(h+C,z+Y),I.tf(h+C,0),I.tf(h+C,z),I.tf(0,z)]},rotateAt:function(g,n,M){var I=this,D=I._position,X=I._64O,P=new Jg(X,D.x,D.y).tf(g,n),d=E(g*g+n*n),s=J(D.y-P.y,D.x-P.x)+M;I.setRotation(X+M),I.p(P.x+d*o(s),P.y+d*U(s))},onParentChanged:function(){Ak.superClass.onParentChanged.apply(this,arguments),this._8I()},_8I:function(){this._70O&&this._70O.each(function(X){X._7I()})},onPropertyChanged:function(){var m={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(H){m[H]=!0}),function(H){var i=this;Ak.superClass.onPropertyChanged.call(i,H),m[H.property]&&!i._layoutUpdating&&i.updateLayoutParameters(null,H.property),i._69O&&i._69O.each(function(A){A.handleHostPropertyChange(H)}),i._49I&&i._49I.each(function(F){F.fp("agentChange",!0,!1)})}}(),onHostChanged:function(){this.updateAttach()},handleHostPropertyChange:function(F){this.updateAttach(F)},onStyleChanged:function(c){Ak.superClass.onStyleChanged.apply(this,arguments),kg[c]&&this.updateAttach()},updateAttach:function(A){var y=this;y._51I||Fo||(y._51I=1,y._71O(A),delete y._51I)},_71O:function(k){var H,m,w,I,O,t,S=this,X=S._host,q=k?k.property:T,i=k?k.oldValue:T,d=k?k.newValue:T;if(X instanceof b.Grid){if(q===Ll)S.setElevation(S._54O+d-i);else if(!k||gp[q]){if(H=S.s("attach.row.index"),m=S.s("attach.column.index"),w=X.getCellRect(H,m),!w)return;I=S.s("attach.row.span"),O=S.s("attach.column.span"),(1!==I||1!==O)&&(w=Ef(w,X.getCellRect(H+I-1,m+O-1))),rk(w,S,"attach.padding",1),S.setRect(w)}}else if(X instanceof po&&(t=S.s("attach.index"))>=0&&(!k||Go[q])){var f=S.s("attach.thickness");f!=T&&S.setHeight(X.getThickness()*f);var F=S.s("attach.offset"),B=X.getPoints(),Y=B.size();if(Y>t){var E=B.get(t),v=Y===t+1?B.get(0):B.get(t+1),x=[v.x-E.x,v.y-E.y],r=Bc(x);if(r){S.s("attach.offset.relative")&&(F*=r),S.s("attach.offset.opposite")&&(F=r-F);var j={x:E.x+x[0]/r*F,y:E.y+x[1]/r*F},W=S.s("attach.gap");W&&(S.s("attach.gap.relative")&&(W*=X.getThickness()),j=es(T,j,v,W)),S.p(j),S.setRotation(J(x[1],x[0]))}}}else k&&(q===wr?S.translate(d.x-i.x,d.y-i.y):q===Ll?S.setElevation(S._54O+d-i):gc[q]?S._11Q(X,q,d-i):("anchor"===q||"width"===q||"height"===q||"scale"===q)&&S.layout(X))},_11Q:function(){var O=new b.Math.Euler,L=b.Math.Euler.ReverseOrder,$=new b.Math.Vector2,s=new b.Math.Vector2;return function(q,f,C){var V=this,T=q.p3(),h=q.r3(),F=V.p3(),r=V.r3();if(f===Ui&&(f="rotationY",C=-C),(f===Ui||"rotationY"===f)&&0===r[0]&&0===r[2]&&0===h[0]&&0===h[2]&&0===F[1]&&0===T[1])return V.setRotation(-r[1]-C),$.set(F[0],F[2]).rotateAround(s.set(T[0],T[2]),-C),V.p($.x,$.y),void 0;var i=$j[q.getRotationMode()],p=i[0],W=i[1],M=i[2],D=Hg[p],c=Hg[W],l=Hg[M],d=nn();f===Ui+p?(l(d,h[bn[M]]),c(d,h[bn[W]]),D(d,C),c(d,-h[bn[W]]),l(d,-h[bn[M]])):f===Ui+W?(l(d,h[bn[M]]),c(d,C),l(d,-h[bn[M]])):f===Ui+M&&l(d,C);var K=nj(F,T);rm(K,d),V.p3(T[0]+K[0],T[1]+K[1],T[2]+K[2]);var Y=V.getRotationMode();rn(d,V.r3(),Y),O.setFromRotationMatrix(d,L(Y)),V.r3([O.x,O.y,O.z])}}(),isHostOn:function(U){var p=this;if(p._host&&U&&U._69O)for(var n={},V=p._host;V&&V!==p&&!n[V._id];){if(V===U)return!0;n[V._id]=V,V=V._host}return!1},isLoopedHostOn:function(a){return this.isHostOn(a)&&a.isHostOn(this)},getScaledSize:function(){var $=this.getSize(),H=this.getScale();return $.width*=Math.abs(H.x),$.height*=Math.abs(H.y),$},layout:function(F){if(F=F||this.getHost()){var f=this,u=f.s("layout.h")||"center",N=f.s("layout.v")||"center";if("center"!==u||"center"!==N){var g=new b.Math.Vector2,S=F.getPosition(),K=F.getAnchor(),Y=F.getScaledSize();f.getPosition();var B,G,J,i,r,$=1,j=1;switch(f._layoutUpdating=!0,u){case"left":g.setX(f._layoutHValue-K.x*Y.width);break;case"right":g.setX((1-K.x)*Y.width-f._layoutHValue);break;case"leftright":B=Y.width-f._layoutHValue[2],J=f.getRotation()-F.getRotation(),i=Math.abs(Math.sin(J)),r=Math.abs(Math.cos(J)),$+=r*B/f._layoutHValue[3],j+=i*B/f._layoutHValue[4],g.setX(f._layoutHValue[1]+(f._layoutHValue[5]-K.x)*Y.width);break;case"center":g.setX((.5-K.x)*Y.width-f._layoutHValue);break;case"scale":J=f.getRotation()-F.getRotation(),i=Math.abs(Math.sin(J)),r=Math.abs(Math.cos(J)),g.setX((.5-K.x)*Y.width-f._layoutHValue[1]*Y.width/f._layoutHValue[0]),G=Y.width/f._layoutHValue[2]-1,$+=r*G,j+=i*G}switch(N){case"top":g.setY(f._layoutVValue-K.y*Y.height);break;case"bottom":g.setY((1-K.y)*Y.height-f._layoutVValue);break;case"topbottom":J||(J=f.getRotation()-F.getRotation(),i=Math.abs(Math.sin(J)),r=Math.abs(Math.cos(J))),B=Y.height-f._layoutVValue[2],$+=i*B/f._layoutVValue[3],j+=r*B/f._layoutVValue[4],g.setY(f._layoutVValue[1]+(f._layoutVValue[5]-K.y)*Y.height);break;case"center":g.setY((.5-K.y)*Y.height-f._layoutVValue);break;case"scale":J||(J=f.getRotation()-F.getRotation(),i=Math.abs(Math.sin(J)),r=Math.abs(Math.cos(J))),g.setY((.5-K.y)*Y.height-f._layoutVValue[1]*Y.height/f._layoutVValue[0]),G=Y.height/f._layoutVValue[2]-1,$+=i*G,j+=r*G}(1!==$||1!==j)&&("leftright"===u||"scale"===u?f.setSize(f._layoutHValue[3]*$,f._layoutHValue[4]*j):f.setSize(f._layoutVValue[3]*$,f._layoutVValue[4]*j)),g.rotateAround(null,F.getRotation()),this.setPosition(g.x+S.x,g.y+S.y),f._layoutUpdating=q}}},updateLayoutParameters:function(X,c){if(X=X||this.getHost()){var n=this,u=n.s("layout.h"),q=n.s("layout.v");if(u||q){var B,d,S,v,o,e,Q=new b.Math.Vector2,s=X.getPosition(),_=X.getAnchor(),r=X.getScaledSize(),L=n.getPosition(),l=n.getSize();switch(Q.set(L.x-s.x,L.y-s.y),Q.rotateAround(null,-X.getRotation()),u){case"left":n._layoutHValue=Q.x+_.x*r.width;break;case"right":n._layoutHValue=-Q.x+(1-_.x)*r.width;break;case"center":n._layoutHValue=-Q.x+(.5-_.x)*r.width;break;case"leftright":case"scale":"scale"===u?B=-Q.x+(.5-_.x)*r.width:(d=n.getAnchor(),S=n.getRotation()-X.getRotation(),v=Math.cos(S),o=Math.sin(S),e=-Math.min(-d.x*v+d.y*o,-d.x*v-(1-d.y)*o,(1-d.x)*v+d.y*o,(1-d.x)*v-(1-d.y)*o),B=Q.x-(e-_.x)*r.width),"position"===c&&"object"==typeof n._layoutHValue?(n._layoutHValue[0]=r.width,n._layoutHValue[1]=B):n._layoutHValue=[r.width,B,r.width,l.width,l.height,e]}switch(q){case"top":n._layoutVValue=Q.y+_.y*r.height;break;case"bottom":n._layoutVValue=-Q.y+(1-_.y)*r.height;break;case"center":n._layoutVValue=-Q.y+(.5-_.y)*r.height;break;case"topbottom":case"scale":"scale"===q?B=-Q.y+(.5-_.y)*r.height:(S||(d=n.getAnchor(),S=n.getRotation()-X.getRotation(),v=Math.cos(S),o=Math.sin(S)),e=-Math.min(-d.x*o-d.y*v,-d.x*o+(1-d.y)*v,(1-d.x)*o-d.y*v,(1-d.x)*o+(1-d.y)*v),B=Q.y-(e-_.y)*r.height),"position"===c&&"object"==typeof n._layoutVValue?(n._layoutVValue[0]=r.height,n._layoutVValue[1]=B):n._layoutVValue=[r.height,B,r.height,l.width,l.height,e]}}}},getSerializableProperties:function(){var y=Ak.superClass.getSerializableProperties.call(this);return Pr(y,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),y}});var cr=b.Edge=function(W,M){var q=this;Uo(cr,q),q.setSource(W),q.setTarget(M)};Tn("Edge",Ck,{_icon:"edge_icon",getUIClass:function(){return Gf},_22Q:function(){return Bs},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},setSource:function(_){var J=this;if(J._source!==_){var d=J._source;J._source=_,d&&d._16I(J),_&&_._2I(J),J._7I(),J.fp("source",d,_)}},setTarget:function(T){var Y=this;if(Y._target!==T){var e=Y._target;Y._target=T,e&&e._18I(Y),T&&T._4I(Y),Y._7I(),Y.fp("target",e,T)}},isLooped:function(){var r=this;return r._source===r._target&&!!r._source&&!!r._target},_7I:function(){var t,V=this,j=ze(V);V._40I!==j&&(t=this._40I,t&&t._15I(V),V._40I=j,j&&j._1I(V),V.fp("sourceAgent",t,j),im(t,V._41I),im(j,V._41I));var p=fd(V);V._41I!==p&&(t=V._41I,t&&t._17I(V),V._41I=p,p&&p._3I(V),V.fp("targetAgent",t,p),im(t,V._40I),im(p,V._40I))},_22I:function(k){this._52I=k,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var E=this;return E._52I&&E._52I.get(0)!==E&&!E.getStyle(df)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var K=this,H=K._52I;return H&&!K.getStyle(df)&&H.size()>1&&K===H.get(0)},toggle:function(){var I=this._52I,r=!this.s(df);I&&I.size()>1&&(I.each(function(L){L.s(df,r)}),I.getSiblings().each(function(z){z!==I&&z.each(function(g){g.fp("edgeGroup",T,z)})}))},setStyle:function(W,a){(W===Zf||"edge.segments"===W)&&(a=ej(a)),cr.superClass.setStyle.call(this,W,a)},onStyleChanged:function(u){cr.superClass.onStyleChanged.apply(this,arguments),qs[u]&&im(this._41I,this._40I)},getSerializableProperties:function(){var z=cr.superClass.getSerializableProperties.call(this);return Pr(z,{source:1,target:1}),z}});var Eb=b.Group=function(){Uo(Eb,this)};Tn("Group",Ak,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return cc},onChildAdded:function(){Eb.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){Eb.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var A=this;if(!A._54I&&!Fo){var M=A.getChildrenRect();M&&(A._53I=1,A.p(sj(A.s("group.position"),M,A.getSize())),delete A._53I)}},getChildrenRect:function(){var G,J=this;return J.eachChild(function(n){G=Ef(G,J.getChildRect(n))}),G},getChildRect:function(z){var F;return uq(z)&&z.s(eh)&&(Vf(z)&&z.isExpanded()&&z.eachChild(function(S){F=Ef(F,z.getChildRect(S))}),!F&&z.getRect&&(F=z.getRect())),F},setPosition:function(y,f){var C=this;if(!C._54I){var J;J=2===arguments.length?{x:y,y:f}:y,Fo||C._53I||(C._54I=1,je(C._children,J.x-C._position.x,J.y-C._position.y),delete C._54I),Eb.superClass.setPosition.call(this,J)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(X){var T=this;if(T._57O!==X){var l=T._57O;T._57O=X,T.fp("expanded",l,T._57O),T._8I()}},_8I:function(){Eb.superClass._8I.call(this),this.eachChild(function(W){uq(W)&&W._8I()})},onStyleChanged:function(o){Eb.superClass.onStyleChanged.apply(this,arguments),"group.position"===o&&this._81I()},getSerializableProperties:function(){var f=Eb.superClass.getSerializableProperties.call(this);return f.expanded=1,f}});var Tf=b.Block=function(){Uo(Tf,this)};Tn("Block",Ak,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return hl},onChildAdded:function(){Tf.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){Tf.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var m=this;if(!Fo&&!m._updatingToChildren&&m._syncSize&&!m._freezeSyncFromChildren){var e,y,L,D,A,F=[],X=m.getRotation();if(m.eachChild(function(A){uq(A)&&F.push.apply(F,A.getCorners())}),F.length){m._updatingFromChildren=1;var W=o(-X),Z=U(-X),T=1/0,Y=-1/0,d=1/0,j=-1/0;for(D=0,A=F.length;A>D;D++)L=F[D],e=L.x,y=L.y,L.x=W*e-Z*y,L.y=Z*e+W*y,T=B(T,L.x),Y=i(Y,L.x),d=B(d,L.y),j=i(j,L.y);var H=m.getScale();m.setSize(S((Y-T)/H.x),S((j-d)/H.y));var _;H.x<0&&(_=T,T=Y,Y=_),H.y<0&&(_=d,d=j,j=_),W=o(X),Z=U(X);var R=m.getAnchor();e=T+(Y-T)*R.x,y=d+(j-d)*R.y,m.setPosition(W*e-Z*y,Z*e+W*y),delete m._updatingFromChildren}}},setPosition:function(o,e){var r=this;if(!r._updatingToChildren){var x;x=2===arguments.length?{x:o,y:e}:o,Fo||r._updatingFromChildren||(r._updatingToChildren=1,je(r._children,x.x-r._position.x,x.y-r._position.y),delete r._updatingToChildren),Tf.superClass.setPosition.call(this,x)}},setWidth:function(l){return this.setSize(l,this.getHeight())},setHeight:function(E){return this.setSize(this.getWidth(),E)},setSize:function(S,P){1>S&&(S=1),1>P&&(P=1);var g=this;if(!g._updatingToChildren){2!==arguments.length&&(P=S.height,S=S.width);var p=g.getWidth(),D=g.getHeight();if(S!==p&&Tf.superClass.setWidth.call(g,S),P!==D&&Tf.superClass.setHeight.call(g,P),!Fo&&!g._updatingFromChildren){g._updatingToChildren=1;var M=S/p,W=P/D;g._adjustChildScaleOrSize(M,W,"size"),delete g._updatingToChildren,g.updateFromChildren()}}},_adjustChildScaleOrSize:function(a,X,n){var x=this;if(x._syncSize){var c=x.getPosition(),C=x.getRotation();x.getScale(),x.eachChild(function(Z){if(uq(Z)){var r=Z.getPosition(),i=Z.getRotation(),j=Z.getWidth(),h=Z.getHeight(),I=Z.getScale(),R=I.x*j,L=I.y*h,V=new Jg(i,r.x,r.y,R,L);V.translate(-c.x,-c.y),V.rotate(-C),i=J(V.b*Math.sign(R),V.a*Math.sign(R)),V.scale(a,X);var y,A,E,l=o(i);if(Math.abs(l)<.001?(y=U(i),A=V.b/y,E=-V.c/y):(A=V.a/l,E=V.d/l),"scale"===n)Z.setScale(A/j,E/h);else if("size"===n){var g=A/I.x,Q=E/I.y;Z.setScale(wg(A)*Math.abs(I.x),wg(E)*Math.abs(I.y)),Z.setSize(Math.max(.1,Math.abs(g)),Math.max(.1,Math.abs(Q)))}V.rotate(C),V.translate(c.x,c.y),Z.setPosition(V.tx,V.ty)}})}},_calcChangeFactor:function(n,J,b,l){var G,a,X,c;return G=S(n),a=S(b),X=G>a?G/a:a/G,G=S(J),a=S(l),c=G>a?G/a:a/G,i(X,c)},setAnchor:function(){var K=this;if(!K._updatingToChildren){var B=K.getAnchor();if(Tf.superClass.setAnchor.apply(K,arguments),!Fo&&!K._updatingFromChildren&&K._syncSize){K._updatingToChildren=1;var V=K.getAnchor();K.getPosition();var r=K.getSize(),g=K.getScale(),O=K.getRotation(),W=-r.width*g.x*(B.x-V.x),m=-r.height*g.y*(B.y-V.y),A=U(O),u=o(O),N=u*W-A*m,f=A*W+u*m;K.eachChild(function(F){if(uq(F)){var a=F.getPosition();F.setPosition(a.x-N,a.y-f)}}),delete K._updatingToChildren}}},setRotation:function(A){var $=this;if(!$._updatingToChildren){var i=$.getRotation();if(Tf.superClass.setRotation.apply($,arguments),!Fo&&!$._updatingFromChildren){$._updatingToChildren=1;var P=$.getPosition(),j=A-i;$.eachChild(function(h){if(uq(h)){var o=h.getMatrix();o.translate(-P.x,-P.y),o.rotate(j),o.translate(P.x,P.y);var f=Math.sign(h.getScale().x);h.setRotation(J(o.b*f,o.a*f)),h.setPosition(o.tx,o.ty)}}),delete $._updatingToChildren}}},setScale:function(O,p){var q=this;if(!q._updatingToChildren){null==p&&(p=O.y,O=O.x);var w=q.getScale();if(S(O)<.01&&(O=.01*(wg(O)||wg(w.x))),S(p)<.01&&(p=.01*(wg(p)||wg(w.y))),Tf.superClass.setScale.call(q,O,p),!Fo&&!q._updatingFromChildren){q._updatingToChildren=1;var i=O/w.x,s=p/w.y;q._adjustChildScaleOrSize(i,s,"size"),delete q._updatingToChildren,q.updateFromChildren()}}},getSerializableProperties:function(){var p=Tf.superClass.getSerializableProperties.call(this);return p.clickThroughEnabled=1,p.syncSize=1,p}});var Vk=b.Grid=function(){Uo(b.Grid,this)};Tn("Grid",Ak,{IRotatable:!1,_icon:"grid_icon",_image:T,getUIClass:function(){return Vj},setRotation:function(){},getCellRect:function($,o){var g=this,r=g.s("grid.row.count"),Q=g.s("grid.column.count");if(0>=r||0>=Q||0>$||$>=r||0>o||o>=Q)return T;var d,B,q,Y=g.getRect(),N=g.s("grid.row.percents"),P=g.s("grid.column.percents");if(rk(Y,g,"grid.border",-1),N&&N._as&&(N=N._as),P&&P._as&&(P=P._as),N&&N.length===r){for(q=0,d=0;$>d;d++)q+=Y.height*N[d];Y.y+=q,Y.height=Y.height*N[$]}else Y.height=Y.height/r,Y.y+=Y.height*$;if(P&&P.length===Q){for(B=0,d=0;o>d;d++)B+=Y.width*P[d];Y.x+=B,Y.width=Y.width*P[o]}else Y.width=Y.width/Q,Y.x+=Y.width*o;return Ym(Y,-g.s("grid.gap")),Y}});var Bb=b.Text=function(){Uo(Bb,this),this.setSize(100,50),this.s("text","TEXT")};Tn("Text",Ak,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return Tq},setWidth:function(s){s||(s=.001),Bb.superClass.setWidth.call(this,s)},setHeight:function(U){U||(U=.001),Bb.superClass.setHeight.call(this,U)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),yk("__text__",{width:{value:100,isSafeFunc:!0,func:function(n){return n._width}},height:{value:50,isSafeFunc:!0,func:function(O){return O._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var po=b.Shape=function(){Uo(po,this),this._59O=new Bk};po.__de__=Bo,Tn("Shape",Ak,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return dk},_22Q:function(){return Yl},getLength:function(w){return Gb(jq(this._59O,this._58O,w,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var K=this._58O;return K?new Bk(K._as.slice(0)):K},setSegments:function(d){var E=this._58O;d=d?Wd(d)?new Bk(d.slice(0)):new Bk(d._as.slice(0)):null,(E&&d&&E._as.join(",")!==d._as.join(",")||E!==d)&&(this._58O=d,this.fp("segments",E,d))},getPoints:function(){return this._59O},toPoints:function(){var G=this._59O;return new Bk(G._as.slice(0))},setPoints:function(h,i){var _=this,j=_._59O;h=h?Wd(h)?new Bk(h.slice(0)):new Bk(h._as.slice(0)):new Bk;var p,C,o,d,m,M;i&&(p=_.getPosition(),M=new Jg(_.getRotation(),0,0,_.getScale().x,_.getScale().y)),(j&&h&&j._as.join(",")!==h._as.join(",")||j!==h)&&(_._59O=h,_.fs(),_.fp("points",j,h)),i&&(C=_.getPosition(),o=C.x-p.x,d=C.y-p.y,m=M.tf(o,d),_.setPosition(C.x-o+m.x,C.y-d+m.y))},addPoint:function(S,A,E){var p=this.toPoints();p.add(S,A),this.setPoints(p,E)},setPoint:function(c,J,X){var Z=this.toPoints();Z.set(c,J),this.setPoints(Z,X)},removePointAt:function(J){var N=this.toPoints();N.removeAt(J),this.setPoints(N)},setWidth:function(a){var F=this;if(1>a&&(a=1),!F._55I&&!Fo&&F.getWidth()){F._55I=1;var d=F._position.x,h=a/F.getWidth(),q=F.toPoints(),i=new Bk;q.each(function(W){i.add({x:(W.x-d)*h+d,y:W.y,e:W.e})}),F.setPoints(i),hr(F,[h,0,0,1,d*(1-h),0]),F.fs(),delete F._55I}po.superClass.setWidth.call(F,a)},setHeight:function(P){var f=this;if(1>P&&(P=1),!f._55I&&!Fo&&f.getHeight()){f._55I=1;var i=f._position.y,s=P/f.getHeight(),$=f.toPoints(),L=new Bk;$.each(function(u){L.add({x:u.x,y:(u.y-i)*s+i,e:u.e})}),f.setPoints(L),hr(f,[1,0,0,s,0,i*(1-s)]),f.fs(),delete f._55I}po.superClass.setHeight.call(f,P)},setAnchorElevation:function(c){var q=this;q._55I=!0;var X=q._updatingAnchor3d,U=!Fo&&!X;if(U){var a,_=c,s=q.getAnchorElevation(),Z=q.getTall();a=Z*(s-_),q.shiftPointsElevation(a)}var g=po.superClass.setAnchorElevation.apply(q,arguments);return X||delete q._55I,g},getShapeElevation:function(){var q=this,s=q._54O;return s-(q.getTall()||0)*(q._anchorElevation-.5)},setAnchor3d:function(K,G,E,T){var J,D=this;"number"==typeof K?J={x:K,y:G,z:E}:(J=K.length?{x:K[0],y:K[1],z:K[2]}:K,T=G),D._55I=!0,D._updatingAnchor3d=!0;var A=D.getDataModel();if(A&&A.beginTransaction(),!Fo){var P=D.getAnchor3d(),b=D.getSize(),r=D.getTall(),o=b.width*(P.x-J.x),M=b.height*(P.z-J.z),d=r*(P.y-J.y);T||D.shiftPoints(o,M,d);var Y=D.p3()}var V=po.superClass.setAnchor3d.apply(D,arguments);if(!Fo&&T){var $=D.p3();D.shiftPoints($[0]-Y[0]+o,$[2]-Y[2]+M,$[1]-Y[1]+d)}return A&&A.endTransaction(),delete D._updatingAnchor3d,delete D._55I,V},setAnchor:function(l,g,G){var I=this;I._55I=!0;var T=I._updatingAnchor3d,F=!Fo&&!T;if(F){var X,e,b;"number"==typeof l?b={x:l,y:g}:(b=l.length?{x:l[0],y:l[1]}:l,G=g);var P=I.getAnchor(),C=I.getSize();X=C.width*(P.x-b.x),e=C.height*(P.y-b.y),G||I.shiftPoints(X,e);var f=I.getPosition()}var h=po.superClass.setAnchor.apply(I,arguments);if(F){var A=I.getPosition();G&&I.shiftPoints(A.x-f.x+X,A.y-f.y+e)}return T||delete I._55I,h},shiftPoints:function(J,u,Y){var C=this,X=C.getElevation()||0,E=C.toPoints(),m=new Bk;E.each(function(H){var K=H.e;Y&&(K=(K==T?X:K)+Y),m.add({x:H.x+J,y:H.y+u,e:K})}),C.setPoints(m),C.fs()},shiftPointsElevation:function(t){return this.shiftPoints(0,0,t)},setPosition:function(G,u){var a,P=this;if(!P._28Q){if(P._28Q=1,!P._55I&&!Fo){a=2===arguments.length?{x:G,y:u}:G;var w=a.x-P._position.x,T=a.y-P._position.y;if(0===w&&0===T)return delete P._28Q,void 0;P._55I=1,P.shiftPoints(w,T),hr(P,[1,0,0,1,w,T]),delete P._55I}po.superClass.setPosition.apply(P,arguments),delete P._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var B=this;if(2!==B._59O.size())return!1;var d=B._58O;return d?2===d.size()&&1===d.get(0)&&2===d.get(1)?!0:!1:!0},fireShapeChange:function(){var Q=this;if(!Q._55I&&!Fo){var g=ps(Q._59O);g&&(Q._55I=1,Q.setRect(g),delete Q._55I)}Q.fp(Mo,!1,!0)},getSerializableProperties:function(){var O=po.superClass.getSerializableProperties.call(this);return O.segments=1,O.points=1,O.thickness=1,O.closePath=1,O}});var Hl=b.Polyline=function(){Uo(Hl,this),this.s({"shape.background":null,"shape.border.width":2})};Tn("Polyline",po,{_icon:"polyline_icon",_22Q:function(){return Dq},getUIClass:function(){return Xl},setClosePath:function(){},setTall:function(B){var C=this;if(!C._55I&&!C._24Q&&!Fo&&C.getTall()){C._24Q=1;var X=C._54O,E=B/C.getTall();C._59O.each(function(Y){Y.e=Y.e==T?X:(Y.e-X)*E+X}),C.fs(),delete C._24Q}Hl.superClass.setTall.call(C,B)},setElevation:function(C){var q=this;if(!q._55I&&!q._24Q&&!Fo){q._24Q=1;var G=C-q._54O;q._59O.each(function(j){j.e==T?j.e=C:j.e+=G}),q.fs(),delete q._24Q}Hl.superClass.setElevation.apply(q,arguments)},fireShapeChange:function(){var c=this,o=c._59O;if(!c._55I&&!c._24Q&&!Fo){var f=o.size();if(f){var O=1,U=o.get(0),Y=c._54O;U.e==T&&(U.e=Y);for(var q=U.e,e=0;f>O;O++){U=o.get(O),U.e==T&&(U.e=Y);var W=B(q,U.e),d=i(q+e,U.e);q=W,e=d-W}c._24Q=1,c.setTall(e),c.setElevation(q+e*c._anchorElevation),delete c._24Q}}Hl.superClass.fireShapeChange.apply(c,arguments)}});var yh=b.SubGraph=function(){Uo(yh,this)};Tn("SubGraph",Ak,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){yh.superClass._8I.call(this),this.eachChild(function(D){uq(D)&&D._8I()})}}),t.loadingRefGraph=0;var Hh=b.RefGraph=function(){Uo(Hh,this)};Tn("RefGraph",Tf,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(L){var R=this._ref;this._ref=L,this.fp("ref",R,L),this.updateRef()},_21I:function(){Hh.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var y=this;if(t.loadingRefGraph++,y.clearChildrenFromDataModel(),t.loadingRefGraph--,y._ref&&y._dataModel){y._xhrLoadHandler&&(y._xhrLoadHandler.cancel=!0);var q=Fo,R=y._xhrLoadHandler=function(N){if(N&&y._dataModel){t.loadingRefGraph++;var g=y._pendingUpdateInfo={needToRestore:q};q&&(g.position=y.p(),g.width=y.getWidth(),g.height=y.getHeight(),g.rotation=y.getRotation(),g.anchor=y.getAnchor(),g.scale=y.getScale()),y.p(0,0),y.setAnchor(.5,.5),y.setRotation(0),y.setScale(1,1);var X=t.parse(N),W=y._dataModel.deserialize(X,y,{justDatas:!0});W.each(function(V){V._refGraph=y}),y.checkPendingUpdateInfo(),t.loadingRefGraph--,t.handleRefGraphLoaded(y,W,X)}};R.xhrLoadCalled=!1,t.load(y._ref,function(N){R.cancel||(R.xhrLoadCalled?R(N):Zh(function(){R(N)}))}),R.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var z=this,N=z._pendingUpdateInfo;if(!N)return z.onPendingUpdated&&(t.loadingRefGraph++,z.onPendingUpdated(),t.loadingRefGraph--),void 0;var l=!0;this.eachChild(function(W){(W._pendingCheckImageJSON||W._pendingUpdateInfo)&&(l=!1)}),l&&(t.loadingRefGraph++,z._pendingUpdateInfo=null,z.updateFromChildren(),N.needToRestore&&(z.setSize(N.width,N.height),z.setAnchor(N.anchor),z.setRotation(N.rotation),z.setScale(N.scale),z.p(N.position)),this.getParent()instanceof Hh&&this.getParent().checkPendingUpdateInfo(),z.onPendingUpdated&&z.onPendingUpdated(),t.loadingRefGraph--)},getSerializableProperties:function(){var H=Hh.superClass.getSerializableProperties.call(this);return H.ref=1,H}}),b.EdgeGroup=function(y,C){this._70O=y,this._siblings=C;for(var Q,N,c=0,H=y.size(),u=f[df];H>c;c++)if(Q=y.get(c).getStyle(df,!1),Q!=T){u=Q;break}u==T&&(u=!0);var s=t.edgeGroupAgentFunc;for(s&&(N=s(y),N&&N!==y.get(0)&&(y.remove(N),y.add(N,0))),c=0;H>c;c++)y.get(c).s(df,u)},Tn("EdgeGroup",w,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(S){return this._70O.get(S)},indexOf:function(_){return this._70O.indexOf(_)},each:function(g,s){this._70O.each(g,s)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(p,Q){this._siblings.each(function(k){k._70O.each(p,Q)})}});var Fj=function(u,Y,Q){var P=Hd[u]={type:u,action:Y};if(Q)for(var w in Q)P[w]=Q[w]};Pr(t,{setConnectAction:Fj,getConnectAction:function(h,I){if(!I){if(!h)return null;I=h.getCurrentConnectActionType()}return Hd[I]},doConnectAction:function(w,Q,T,d){d=d||w.getCurrentConnectActionType();var c=Hd[d];if(!c)return!1;var B=c.action;return B?(Q instanceof zp.Group?w.sm().getSelection().each(function(C){B.call(null,w,C,T)}):B.call(null,w,Q,T),!0):!1},doDeleteConnectionAction:function(X,t,V){V=V||X.getCurrentConnectActionType();var E=Hd[V];if(!E||!E.delete)return!1;var S=E.delete.action;return S?(t instanceof zp.Group?X.sm().getSelection().each(function(Q){S.call(null,X,Q)}):S.call(null,X,t),!0):!1}});var Dh=b.JSONSerializer=function(W,R){this.dm=this._dataModel=W,this._hierarchical=t.forceHierarchicalSerialization?!0:R==T?W.isHierarchicalRendering():R};Tn("JSONSerializer",w,{ms_ac:["hierarchical"],serialize:function(Y){return t.stringify(this.toJSON(),Y)},toJSON:function(){var V=this,G=V.dm,x=G.getRoots(),C=V.json={v:t.getVersion(),p:{},a:{},d:[]},f=G.getSerializableAttrs();G.getInit()&&(C.init=G.getInit()),G.getName()&&(C.p.name=G.getName()),G.getBackground()&&(C.p.background=G.getBackground()),G.getLayers()&&(C.p.layers=G.getLayers()),C.p.autoAdjustIndex=G.isAutoAdjustIndex(),C.p.hierarchicalRendering=G.isHierarchicalRendering();for(var r in f){var M=G.a(r);M!==q&&V[Oc](r,M,C.a)}return Fq(C.a)&&delete C.a,V._hierarchical?x.each(V.serializeData,this):G.each(function(T){V.serializeData(T)}),C},isSerializable:function(){return!0},getProperties:function(v){return v.getSerializableProperties()},getStyles:function(X){return X.getSerializableStyles()},getAttrs:function(R){return R.getSerializableAttrs()},serializeData:function(O){var M=this;if(M.isSerializable(O)&&!O._refGraph){var U,m,V,g,q=rh(O.getClassName())||O.getClass(),x=new q,Z={c:O.getClassName(),i:O.getId(),p:{},s:{},a:{}};M.json.d.push(Z),U=M.getProperties(O);for(m in U)/^_/.test(m)?(V=O[m],V!==x[m]&&M[Oc](m.substr(1),V,Z.p)):(g=um(m),O[g]&&(V=O[g](),V!==x[g]()&&M[Oc](m,V,Z.p)));U=M.getStyles(O);for(m in U)V=O.s(m),V!==x.s(m)&&M[Oc](m,V,Z.s);U=M.getAttrs(O);for(m in U)V=O.a(m),V!==x.a(m)&&M[Oc](m,V,Z.a);Fq(Z.p)&&delete Z.p,Fq(Z.s)&&delete Z.s,Fq(Z.a)&&delete Z.a}M._hierarchical&&O.getChildren().each(M.serializeData,M)},serializeValue:function(H,i,x){Co(i)?i={__a:i._as}:i instanceof Ck&&(i={__i:i.getId()}),x[H]=i},deserialize:function(b,k,C){var B=this,Z=B.dm;Z.beginTransaction(),Fo++,C=lp(C)?{setId:C}:C||{},b=B.json=Ub(b)?t.parse(b):b,B._82I={};var P=new Bk,I=new Bk,M=0,U=b.d.length;if(C.justDatas||(Dk(b.init)&&b.init(Z),Z.setInit(b.init)),!C.justDatas){for(var n in b.a)Z.a(n,B[kd](b.a[n]));for(var H in b.p)Z[pp(H)](b.p[H])}for(;U>M;M++){var y=b.d[M],O=rh(y.c),s=new O,o=y.i;C.setId&&o!=T&&(s._id=o),B._82I[o]=s,P.add(s),I.add(y)}for(M=0;U>M;M++)B.deserializeData(P.get(M),I.get(M));return P.each(function(Y){k&&!Y.getParent()&&Y.setParent(k),Z.add(Y)}),Fo--,Z.endTransaction(),P},deserializeData:function(S,W){for(var R in W.p)S[pp(R)](this[kd](W.p[R]));for(R in W.s)S.s(R,this[kd](W.s[R]));for(R in W.a)S.a(R,this[kd](W.a[R]))},deserializeValue:function(Y){if(qc(Y)){var X=Y.__i;if(X!=T)return this._82I[X];if(X=Y.__a,Wd(X))return new Bk(X)}return Y}}),Pr(Dj,{serialize:function(F,V){return new Dh(this,V).serialize(F)},toJSON:function(E){return new Dh(this,E).toJSON()},deserialize:function(I,R,F){return new Dh(this).deserialize(I,R,F)}});var Bm=b.OverlappingBox=function(m){this.gv=m,this.boxes={}};Tn("OverlappingBox",w,{clear:function(){var g,$,C=this.boxes;for(g in C)$=C[g],$.length=0},isOverlapping:function(B,j){var E,N,O=this,P=O.boxes,n=P[B];n?(E=n.rects,N=n.length):n=P[B]={rects:E=[],length:N=0};var I,c,j;for(I=0;N>I;I++)if(c=E[I],c.x<j.x+j.w&&c.x+c.w>j.x&&c.y<j.y+j.h&&c.h+c.y>j.y)return!0;return E.length<=N?(E.push(j),n.length++):E[n.length++]=j,!1}}),Pr(t,{fetch:function(y,q){var Z="GET",T=!1,O=null,v="";q&&(Z=q.method||"GET",T=q.sync,v=q.url,O=q.data||null),y.open(Z,v,!T),y.send(O)},convertImageSrc:function(g,t){t&&"function"==typeof t||(t=function(){}),t(g)}});var Ae=b.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};Tn("Request",w,{_responseType:null,_overrideMimeType:"text/plain",send:function(c){var e=this._xhr,S=this.onload,a=this.onerror;this.getResponseType()?e.responseType=this.getResponseType():this.getOverrideMimeType()&&e.overrideMimeType(this.getOverrideMimeType()),e.onload=S,e.onerror=a,t.fetch(e,c)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(L){this._responseType=L},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(j){this._overrideMimeType=j},getResponseText:function(){var g=this._xhr;return g.response||g.responseText}}),_h.GraphView=function(L){var i=this;i._24I={},i._34I=new Bk,i._25I={},i._56I={},i._view=rc(1,i),i._canvas=Uh(i._view),i.dm(L?L:new Dj),this._coreInteractor=new Ii(this),i.setEditable(!1),i.setScrollBarVisible(t.graphViewScrollBarVisible)},Sb("GraphView",w,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Ze,mn,br,Sr,"resettable","editInteractor",gm,"pannable","rectSelectable","autoScrollZone",ni,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_resettable:t.graphViewResettable,_pannable:t.graphViewPannable,_rectSelectable:t.graphViewRectSelectable,_autoScrollZone:t.graphViewAutoScrollZone,_rectSelectBackground:t.graphViewRectSelectBackground,_rectSelectBorderColor:t.graphViewRectSelectBorderColor,_editPointSize:t.graphViewEditPointSize,_editPointBorderColor:t.graphViewEditPointBorderColor,_editPointBackground:t.graphViewEditPointBackground,_scrollBarColor:bo,_scrollBarSize:xp,_autoHideScrollBar:dm,_autoMakeVisible:qq,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor
},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(D){this._dataModel.setLayers(D)},setEditable:function(h){var t=this,r=t.__interactorMap__;if(!r){var Q=_h.XEditInteractor;r=t.__interactorMap__={scrollBar:new cb(t),select:new ur(t),edit:Q?new Q(t):new gi(t),move:new Aj(t),"default":new uh(t),touch:new Ch(t,{editable:!1})}}h?(t._uieditable=!0,t.setInteractors([r.scrollBar,r.select,r.edit,r.move,r.default,r.touch])):(t._uieditable=!1,t.setInteractors([r.scrollBar,r.select,r.move,r.default,r.touch]))},getCanvas:function(){return this._canvas},_33I:function(d){var J=d.getUIClass();return J?new J(this,d):T},getDataUI:function(r){var T=this,V=T._25I[r._id];return V===q&&(V=T._33I(r),T._25I[r._id]=V),V},getNodeRect:function(O){return t.getNodeRect(this,O)},getEdgeInfo:function(x){var X=this.getDataUI(x);return X?(X._79o(),X._78o):null},getEdgeSourcePosition:function(J){var y=this,E=y.getDataUI(J),I=E.s,P=E._data._40I;return zb(y,P,I("edge.source.position"),I("edge.source.offset.x"),I("edge.source.offset.y"),I("edge.source.anchor.x"),I("edge.source.anchor.y"))},getEdgeTargetPosition:function(e){var M=this,v=M.getDataUI(e),b=v.s,t=v._data._41I;return zb(M,t,b("edge.target.position"),b("edge.target.offset.x"),b("edge.target.offset.y"),b("edge.target.anchor.x"),b("edge.target.anchor.y"))},invalidateAll:function(C){var H=this;if(C){for(var N in H._25I){var a=H._25I[N];a&&a.dispose()}H._25I={},H._56I={},H._24I={},H._34I.clear(),H.redraw()}else H.dm().each(function(Q){H.invalidateData(Q)})},invalidateSelection:function(){var H=this;H.sm().each(function(x){H.invalidateData(x)})},invalidateData:function(G){var o=this;o._24I[G._id]=G,o._21Q(G),o.iv()},_21Q:function(I){var O=this,L=O._24I;if(Pn(I)&&Ib[I.s(Zj)]){var T=I.getSourceAgent();T&&T.getAgentEdges().each(function(o){L[o._id]=o}),T=I.getTargetAgent(),T&&T.getAgentEdges().each(function(g){L[g._id]=g}),O.iv()}},redraw:function(d){var g=this;g._32I||(d?g._34I.add(d):(g._32I=1,g._34I.clear()),g.iv())},each:function(x,W){var z,R,T,i=0,n=this.getLayers(),t=this._dataModel,M=t._datas._as,s=M.length;if(n){for(var I=n.length;I>i;i++)if(T=n[i],qc(T)&&(T=T.name),t.isHierarchicalRendering()){var Z=function(H){return H._layer===T?W?x.call(W,H):x(H):void 0};if(this._dataModel.eachByHierarchical(Z)===!1)return}else for(var p=0;s>p;p++)if(z=M[p],z._layer===T&&(R=W?x.call(W,z):x(z),R===!1))return}else if(t.isHierarchicalRendering())this._dataModel.eachByHierarchical(x,null,W);else for(;s>i;i++)if(z=M[i],R=W?x.call(W,z):x(z),R===!1)return},reverseEach:function(D,r){var A,z,y,x,s=this._dataModel,X=s._layers,O=s._datas._as,H=O.length;if(X){for(A=X.length-1;A>=0;A--)if(x=X[A],qc(x)&&(x=x.name),s.isHierarchicalRendering()){var E=function(V){return V._layer===x?r?D.call(r,V):D(V):void 0};if(s.reverseEachByHierarchical(E)===!1)return}else for(var G=H-1;G>=0;G--)if(z=O[G],z._layer===x&&(y=r?D.call(r,z):D(z),y===!1))return}else if(s.isHierarchicalRendering())s.reverseEachByHierarchical(D,null,r);else for(A=H-1;A>=0;A--)if(z=O[A],y=r?D.call(r,z):D(z),y===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var Z=this,B=Z._84I;if(!B){var j=this.dm().a("width"),y=this.dm().a("height");j>0&&y>0?Z._84I={x:0,y:0,width:j,height:y}:(Z.each(function(b){Z.isVisible(b)&&(B=Ef(B,Z.getDataUIBounds(b)))}),Z._84I=B?B:gs)}return Z._84I},getScrollRect:function(){return Ef(this.getContentRect(),this._29I)},makeCenter:function(j,I,w){var v=this;if(!v.getWidth()||!v.getHeight())return w||Zh(v.centerData,v,[j,I,!0],500),void 0;v.makeVisible(j),v.validate();var _=v.getDataUIBounds(j);if(_){var M=v.getWidth(),q=v.getHeight(),e=_.x+_.width/2,T=_.y+_.height/2,B=-e*v._zoom+M/2,L=-T*v._zoom+q/2;v.setTranslate(B,L,I)}},fitData:function(Y,$,J,W,E){var U=this;if(!U.getWidth()||!U.getHeight())return E||Zh(U.fitData,U,[Y,$,J,W,!0],500),void 0;var p=function(){U.makeVisible(Y),U.validate();var j=U.getDataUIBounds(Y);j&&(j=Tg(j),Ym(j,J==T?20:J),U.fitRect(j,$,W))};$?t.callWhenLoaded(p):p()},fitContent:function(X,i,r,k){var f=this;if(!f.getWidth()||!f.getHeight())return k||Zh(f.fitContent,f,[X,i,r,!0],500),void 0;var R=function(){f.validate();var c=Tg(f.getContentRect());Ym(c,i==T?20:i),f.fitRect(c,X,r)};X?t.callWhenLoaded(R):R()},fitRect:function(x,e,F){var y=this,D=y.getWidth(),C=y.getHeight(),A=x.x+x.width/2,M=x.y+x.height/2,Q=B(D/x.width,C/x.height),V=y._zoom,X=-A*V+D/2,c=-M*V+C/2;0===Q||isNaN(Q)||(F&&(Q=B(1,Q)),e?(y._65I&&(delete y._65I.finishFunc,y._65I.stop(!0)),y._14o&&y._14o.stop(!0),y.setTranslate(X,c,{finishFunc:function(){y.setZoom(Q,e)}})):(y.setTranslate(X,c),y.setZoom(Q)))},toCanvas:function(D,e){e=e||this._zoom,this.validateImpl();var w=this,k=w.getContentRect();k.width||(k.width=10),k.height||(k.height=10);var l=Uh(),m=k.x*e,L=k.y*e,f=k.width*e,W=k.height*e;Dp(l,f,W,1);var y=Cn(l);return D=D||this._dataModel.getBackground(),D&&Of(y,0,0,f,W,D),ts(y,-m,-L),y.scale(e,e),w._42(y),y.restore(),l},toDataURL:function(c,F,e){return this.toCanvas(c,e).toDataURL(F||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(y,x){var J=this;J._93db(y,x),J.each(function(X){var S=J.getDataUI(X);if(S){var Z=J._56I[X._id],o=S._htmlView;if(Z){var $=S._79o();if(o=S._htmlView,b.HtmlNode&&X instanceof b.HtmlNode)S._42(y);else{var F=J.getViewRect(),H=o&&o.layoutHTML;!x||Pc(x,$)?(H&&(o.layoutHTML(),S.__outerLayout&&delete S.__outerLayout),S._42(y)):Pc(F,$)||!H||S.__outerLayout||(o.layoutHTML(),S.__outerLayout=!0)}}o&&(o.getView&&(o=o.getView()),o.style.display=Z?"block":tc)}}),J._92db(y,x)},validateImpl:function(){var G,b,e,k,V,M=this,S=M.tx(),w=M.ty(),L=M._zoom,Y=M._canvas,P=this.getWidth(),D=this.getHeight(),p=M._29I,E={x:-S/L,y:-w/L,width:P/L,height:D/L},f={},I=M._34I,o=M._24I,n=M._32I,B=M._23I;M._24I={},(P!==Y.clientWidth||D!==Y.clientHeight)&&(Dp(Y,P,D),n=1),n||mb(E,p)||(n=1),M._29I=E,M.each(function(J){b=J._id;var F=f[b]=M.isVisible(J);F!==M._56I[b]&&(o[b]=J,e=M.getDataUI(o[b]),e&&e._84o(F),M._84o(J,F))},M);for(b in o)e=M.getDataUI(o[b]),e&&(!n&&M._56I[b]&&(V=e._79o(),V&&I.add(V)),e.invalidate()),M._83I=1;if(M._56I=f,!n)for(b in o)f[b]&&(e=M.getDataUI(o[b]),e&&(V=e._79o(),V&&I.add(V)));if(n?k=E:(I.each(function(j){Pc(E,j)&&(k=Ef(k,j))}),k&&(Ym(k,i(1,1/L)),k.x=l(k.x*L)/L,k.y=l(k.y*L)/L,k.width=d(k.width*L)/L,k.height=d(k.height*L)/L,k=kj(E,k))),M._74O=k,k){G=Cn(Y);var y=k.x,J=k.y,t=k.width,u=k.height;y=Math.floor((y*L+S)*ke),J=Math.floor((J*L+w)*ke),t=Math.ceil(t*L*ke)+1,u=Math.ceil(u*L*ke)+1,G.beginPath(),G.rect(y,J,t,u),G.clip(),G.clearRect(y,J,t,u),Ek(G,S,w,L),M._42(G,k),G.restore(),delete M._74O}if(I.clear(),delete M._32I,B&&P>0&&D>0){var e=M.getDataUI(B);if(e){var V=e._79o(),h=M._29I,T=h.x,K=h.y,x=h.width,R=h.height,L=M._zoom;V&&!Pc(V,h)&&(V.x+V.width<T&&M.tx(-V.x*L),V.x>T+x&&M.tx(-(V.x+V.width-x)*L),V.y+V.height<K&&M.ty(-V.y*L),V.y>K+R&&M.ty(-(V.y+V.height-R)*L))}delete M._23I}M._83I&&(delete M._83I,delete M._84I),M._98O(),Fq(M._24I)||Zh(M.iv,M)},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(r){var c=this;r!==c.isScrollBarVisible()&&(r?(Xk(c._view,c._79O=Zp()),Xk(c._79O,c._27I=Zp()),Xk(c._79O,c._28I=Zp())):(Ln(c._79O),delete c._79O,delete c._27I,delete c._28I),c.fp("scrollBarVisible",!r,r))},showScrollBar:function(){var z=this;z._79O&&(z._85I||(n(function(){z._86I()},qh),z.iv()),z._85I=new Date)},_86I:function(){var s=this;if(s._85I){var x=new Date,Q=x.getTime();Q-s._85I.getTime()>=qh?(delete s._85I,s.iv()):n(function(){s._86I()},qh)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var Y=this,L=this._27I,o=this._28I;if(Y._79O){if(Y._autoHideScrollBar&&!Y._85I)return L.style.visibility=un,o.style.visibility=un,void 0;var E=Y.getScrollBarColor(),$=Y._zoom,z=Y.getScrollBarSize(),M=Y.getViewRect(),J=Y.getScrollRect(),g=M.height*$,x=J.height*$,I=M.width*$-z-2,B=g*((M.y-J.y)*$/x),q=g*(g/x),S=L.style;x-.5>g?(li>q&&(B=B+q/2-li/2,0>B&&(B=0),B+li>g&&(B=g-li),q=li),$c(L,I,B,z,q),S.visibility=Ge,S.background=E,S.borderRadius=z/2+vs):S.visibility=un;var X=M.width*$,f=J.width*$,B=M.height*$-z-2,I=X*((M.x-J.x)*$/f),P=X*(X/f),S=o.style;f-.5>X?(li>P&&(I=I+P/2-li/2,0>I&&(I=0),I+li>X&&(I=X-li),P=li),$c(o,I,B,P,z),S.visibility=Ge,S.background=E,S.borderRadius=z/2+vs):S.visibility=un}},setDataModel:function(T){var N=this,k=N._dataModel,M=N._selectionModel;k!==T&&(k&&(k.ump(N.handleDataModelPropertyChange,N),k.umm(N.handleDataModelChange,N),k.umd(N.handleDataPropertyChange,N),k.removeIndexChangeListener(N._75O,N),k.removeHierarchyChangeListener(N.handleHierarchyChange,N),M||k.sm().ums(N.handleSelectionChange,N)),N._dataModel=T,T.mp(N.handleDataModelPropertyChange,N),T.mm(N.handleDataModelChange,N),T.md(N.handleDataPropertyChange,N),T.addIndexChangeListener(N._75O,N),T.addHierarchyChangeListener(N.handleHierarchyChange,N),M?M._21I(T):T.sm().ms(N.handleSelectionChange,N),N.invalidateAll(!0),N.fp(pb,k,T),N._canvas.style.background=T.getBackground()||"")},getLayersInfo:function(){if(this._layersInfo===q){var N=this.getLayers();N?(this._layersInfo={},N.forEach(function(T){var y=qc(T)?T.name:T;this._layersInfo[y]=T},this)):this._layersInfo=null}return this._layersInfo},updateLayers:function(){this._layersInfo=q,this.invalidateSelection(),this.redraw()},handleDataModelPropertyChange:function(v){if("background"===v.property){var A=this._canvas.style.background,Y=v.newValue||"";this._canvas.style.background=Y,this.fp("canvasBackground",A,Y)}else"a:width"===v.property||"a:height"===v.property?(this._83I=1,this.redraw()):"layers"===v.property?this.updateLayers():"hierarchicalRendering"===v.property&&this.redraw()},handleDataPropertyChange:function(z){this.dm().isHierarchicalRendering()&&"parent"===z.property&&z.data.hasChildren()&&this.redraw(),this.invalidateData(z.data)},onPropertyChanged:function(i){var S=this,N=i.property;if(S.redraw(),"zoom"===N){var h=S.sm().getSelection();h.size()&&h.each(function(A){A.invalidate()})}Ig[N]?S.showScrollBar():N===gm&&S.onCurrentSubGraphChanged(i)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(g){var P=this,x=g.kind,X=g.data;if(P._83I=1,"add"===x)P.invalidateData(X),Pn(X)&&X.getEdgeGroup()&&X.getEdgeGroup().eachSiblingEdge(P.invalidateData,P);else if(x===Rl){P._21Q(X);var k=X._id,s=P._25I[k];if(s){if(P._56I[k]){var n=s._79o();n&&P.redraw(n)}s.dispose(),delete P._25I[k],delete P._24I[k],delete P._56I[k]}X===P._currentSubGraph&&P.setCurrentSubGraph(T)}else x===ar&&(P.invalidateAll(!0),P.setCurrentSubGraph(T))},_75O:function(l){this.invalidateData(l.data)},handleHierarchyChange:function(F){this.dm().isHierarchicalRendering()&&F.data.hasChildren()&&this.redraw(),this.invalidateData(F.data)},adjustIndex:function(y){var F=this;if(F.isVisible(y)){F.dm().beginTransaction();for(var K=y;K._parent&&F.isVisible(K._parent);)K=K._parent;K&&K!==y&&F._dataModel.adjustIndex(K),F._dataModel.adjustIndex(y),F.dm().endTransaction()}},getImage:function(L){return L.getImage?L.getImage():q},getSelectWidth:function(k){var R=xf(this.getImage(k));return R&&cg(R.disableSelectedBorder,k,this)?0:k.s("select.width")},getSelectColor:function(U){return U.s("select.color")},isSelectable:function(S){if(this.isSelected(S))return!0;if(!this._clickThroughChecking&&S.getParent()instanceof Tf&&this.isSelectable(S.getParent())&&S.getParent().isSyncSize())return!1;var X=this.getLayersInfo();if(X){var f=X[S._layer];if(f&&f.selectable===!1)return!1}return S.s("2d.selectable")&&this.sm().isSelectable(S)},isMovable:function(c){var C=this;if(Pn(c)&&c.getStyle(Zj)!==ek)return!1;var f=this.getLayersInfo();if(f){var J=f[c._layer];if(J&&J.movable===!1)return!1}return c.s("2d.movable")?C._movableFunc?C._movableFunc(c):!0:!1},isEditable:function($){var i=this;if(b._uiSerializing)return i._uieditable;if(!i._editInteractor||!i.isSelected($))return!1;if(Vf($)){var T=i.getDataUI($);if(!T||T._88I)return!1}if(Pn($)&&$.getStyle(Zj)!==ek)return!1;var p=this.getLayersInfo();if(p){var o=p[$._layer];if(o&&o.editable===!1)return!1}return $.s("2d.editable")?i._editableFunc?i._editableFunc($):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(x){return uq(x)&&0!==x.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(x):!0},isRectEditable:function(I){return this._rectEditableFunc?this._rectEditableFunc(I):!0},isAnchorEditable:function(g){return this._anchorEditableFunc?this._anchorEditableFunc(g):!0},isRotationEditable:function(s){return s.setRotation&&s.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(s):!0:!1},getRotationPoint:function(C){var n=C.getAnchor(),b=C.getScale(),S=this._zoom,k=ul(C.getRotation(),0,-C.getHeight()*b.y*n.y-(b.y<0?-1:1)*(tb?32:16)/S),g=C.p();return k.x+=g.x,k.y+=g.y,k},getLogicalPoint:function(f){var X=this;return mk(f,X._canvas,X.tx(),X.ty(),X._zoom,X._zoom)},getScreenPoint:function(w,i){var s,C=this;return"object"==typeof w?w.x!==q?(s=w.x,i=w.y):(s=w[0],i=w[1]):s=w,Jr(s,i,C._canvas,C.tx(),C.ty(),C._zoom,C._zoom)},getSelectedDataAt:function(A){var $=this;return this.getDataAt(A,function(N){return $.isSelected(N)})},getDataInfoAt:function(J,k,Z){var z,E=this.lp(J),g=this.getDataAt(E,k,Z);if(g){var V=this.getDataUI(g);z={data:g,ui:V,point:E};var M=V._38o;if(M){var f=M.icons;for(var b in f){var K=f[b],c=M.rects[b];if(c)for(var v=cg(K.names,g,this),n=v?v.length:0,y=c.rotation,s=n-1;s>=0;s--){var Y=v[s],a=c[s];if(Fi(a,E,y))return z.part="icons",z.name=b,z.icon=Y,z.rect=a,z.index=s,z.rotation=y,z}}}if(this.isNoteVisible(g)){if(V.note2Info&&Fi(V.note2Info.clickRect,E,T,V.note2Info.scale))return z.part="note2",z;if(V.noteInfo&&Fi(V.noteInfo.clickRect,E,T,V.noteInfo.scale))return z.part="note",z}if(this.isLabelVisible(g)){if(V.label2Info&&Fi(V.label2Info.rect,E,V.label2Info.rotation,V.label2Info.scale))return z.part="label2",z;if(V.labelInfo&&Fi(V.labelInfo.rect,E,V.labelInfo.rotation,V.labelInfo.scale))return z.part="label",z}if(g.isInRect&&g.isInRect(E))return z.part="body",z}return z},getDataAt:function(R,v,o){R.target&&(R=this.lp(R));var y,h=this._zoom;return this.reverseEach(function(s){return(v?v(s):this.isSelectable(s))&&this.rectIntersects(s,ob(R.x,R.y,o,h))?(y=s,!1):void 0},this),y},getIconInfoAt:function(J,H){var C=this;if(J.target&&(J=C.lp(J)),H||(H=C.getDataAt(J)),H){var W=C.getDataUI(H);if(W&&W._38o){var b,p=W._38o,F=new Bk;for(b in p.icons)F.add(b);for(var R=F.size()-1;R>=0;R--){b=F.get(R);for(var c=p.rects[b],n=c.rotation,w=c.length-1;w>=0;w--){var $=c[w],s=$.width,N=$.height,Z={x:J.x-$.x-s/2,y:J.y-$.y-N/2};n!=T&&(Z=ul(-n,Z.x,Z.y));var $={x:-s/2,y:-N/2,width:s,height:N};if(Fi($,Z))return{key:b,index:w,name:p.icons[b].names[w],rect:c[w],point:J,rotation:n,relativeRect:$,relativePoint:Z,data:H}}}}}return T},getDatasInRect:function(j,F,d){d===q&&(d=1);var n=this,s=new Bk;return n.reverseEach(function(M){d&&!n.isSelectable(M)||(F?n.rectIntersects(M,j):n.rectContains(M,j))&&s.add(M)}),s},moveSelection:function(e,m){var i=this;i.dm().beginTransaction(),je(i.sm().toSelection(i.isMovable,i),e,m),i.dm().endTransaction()},moveDatas:function(J,z,g){var T=this;T.dm().beginTransaction(),J instanceof Bk||(J=new Bk(J)),je(J,z,g),T.dm().endTransaction()},getDataUIBounds:function(g){var G=this.getDataUI(g);return G?G._79o():T},drawData:function(g,N,X){var L=this.getDataUI(N);if(L){var C=L._79o();(!X||Pc(X,C))&&(L._42(g),N instanceof b.Block&&N.eachChild(function(v){this.drawData(g,v,X)},this))}},getBoundsForGroup:function(g){return g.s(eh)?this.getDataUIBounds(g):T},isPixelPerfect:function($){return $.s("pixelPerfect")},rectIntersects:function(Q,S){this.validate();var n=T;if(this._56I[Q._id]){var d=this._25I[Q._id];if(d){var v=d._79o();if(eo(S,v))n=!0;else if((S=kj(S,v))&&(d.rectIntersects&&(n=d.rectIntersects(S)),n==T)){if(!this.isPixelPerfect(Q))return!0;var U=S.x,k=S.y,y=S.width,A=S.height,I=this._zoom,_=t.hitMaxArea,D=y*A*I*I;if(D>_){var s=Math.sqrt(_/D);I*=s}y*=I,A*=I,2>y&&(y=2),2>A&&(A=2),U*=I,k*=I;var q=ge(y,A);ts(q,-U,-k),q.scale(I,I),this._drawForChecking=!0,this.drawData(q,Q,S),this._drawForChecking=!1;try{for(var L=0,u=q.getImageData(0,0,y,A).data;L<u.length;L+=4)if(0!==u[L+3]){n=!0;break}q.restore()}catch(e){Wq=T,n=!1}}}}return n?!0:!1},rectContains:function(F,O){if(this._56I[F._id]){var X=this._25I[F._id];if(X)return eo(O,X._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(M){if(!t.isInput(M.target)){var w=this,j=w._focusData,p=j&&w._25I[j._id],f=0,l=w._dataModel._datas;if(!(j&&j._enabled&&j._editable&&p&&p.onKeyDown&&p.onKeyDown(M)===!0))if(9===M.keyCode&&(j&&(f=l.indexOf(j),fk(M)?-1===--f&&(f=0):++f===l.size()&&(f=0)),w._focusData=j=l.get(f),w.sm().setSelection(j)),Di(M)?w.selectAll():jm(M)&&w.isResettable()&&w.reset(),w.sm().isEmpty()){if(w._editing)return;var E=w.tx(),i=w.ty(),F=!1,Q=fk()?100:10;Cc(M)&&(E-=Q,F=!0),Lr(M)&&(i-=Q,F=!0),zn(M)&&(E+=Q,F=!0),Ei(M)&&(i+=Q,F=!0),F&&w.setTranslate(E,i)}else{If(M)&&w.handleDelete(M);var _=fk()?10:1;Cc(M)&&(w.moveSelection(-_,0),w.fi({kind:"moveLeft"})),Lr(M)&&(w.moveSelection(0,-_),w.fi({kind:"moveUp"})),zn(M)&&(w.moveSelection(_,0),w.fi({kind:"moveRight"})),Ei(M)&&(w.moveSelection(0,_),w.fi({kind:"moveDown"}))}}},handleScroll:function(q,p){if(en(q),!this.getEditInteractor()){var d=this.getDataAt(q);if(d){var u=xf(this.getImage(d));if(u&&cg(u.scrollable,d,this))return}}var E=this.lp(q);p>0?this.scrollZoomIn(E):0>p&&this.scrollZoomOut(E)},handlePinch:function(o,I,w){this._68I||(I>w?this.pinchZoomIn(o):this.pinchZoomOut(o))},checkDoubleClickOnNote:function(B,Q){var O=this,R=O.lp(B),A=O.getDataUI(Q),n=A.note2Info;return n&&Q.s("note2.toggleable")&&Fi(n.clickRect,R)?(Q.s(lg,!Q.s(lg)),O.fi({kind:"toggleNote2",event:B,data:Q}),!0):(n=A.noteInfo,n&&Q.s("note.toggleable")&&Fi(n.clickRect,R)?(Q.s(Jn,!Q.s(Jn)),O.fi({kind:"toggleNote",event:B,data:Q}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(W,c){var l=this,k=l.getAutoScrollZone(),J=k/l.getZoom(),M=k/4,_=l._29I,f=l.lp(W),Y={x:l.tx(),y:l.ty()};return f&&k>0&&_&&(f.x-_.x<J?l.translate(M,0):_.x+_.width-f.x<J&&l.translate(-M,0),f.y-_.y<J?l.translate(0,M):_.y+_.height-f.y<J&&l.translate(0,-M)),Y.x=l.tx()-Y.x,Y.y=l.ty()-Y.y,c&&(c.x+=Y.x,c.y+=Y.y),Y},getMoveMode:function(X,k){var R=k.s("2d.move.mode");return R?R:Eh["88"]?"x":Eh["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(t,F,D){var T=this;return"currentSubGraph"===F?{__i:t.getId()}:D.serializeProperty(t,F,T)},deserializeProperty:function(r,v,Q){var M=this;if("currentSubGraph"===v){var k=M.dm(),t=k.__idMap;return t[r.__i]}return Q.deserializeProperty(r,v,M)},setDefaultCursor:function(h,r){this._defaultCursor=h,r!==!1&&this.setCursor(h)},setCursor:function(Q){"default"===Q&&(Q=this._defaultCursor||Q);var p=this.getView().style;p.cursor=Q,p.cursor="-webkit-"+Q,p.cursor="-moz-"+Q},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(o){return o===T||t.getConnectAction(null,o)?(this._currentActionType=o,this.redraw(),!0):!1},isConnectActionVisible:function(L){var F=t.getConnectAction(this);if(!F)return!1;var I=F.visible;return Dk(I)&&(I=I(this,L)),I},isInteractive:function(V){var B=xf(this.getImage(V));return B&&cg(B.interactive,V,this)?!0:V.s("interactive")},appendHTML:function(Z){var Y=this.getView();if(!Z||Z.parentNode===Y)return!1;var K=Z.getView&&Z.getView();if(K&&K.parentNode===Y)return!1;if(Z.isSelfViewEvent)return Z.addToDOM(Y),!0;Z.getView&&(Z=Z.getView());var $=this.getCanvas().nextSibling;return $?Y.insertBefore(Z,$):Xk(Y,Z),!0},layoutHTML:function(V,X,O){var n,Z=this,Y=Z._zoom;if(X.getView&&(n=X,X=X.getView()),X.style.position="absolute",O){var G=V.getRect();$c(n||X,Z.tx()+G.x*Y,Z.ty()+G.y*Y,G.width*Y,G.height*Y)}else{var w=new yp,G=V.getAnchorRect(),$=V.getPosition(),y=V.getScale(),R=X.style;$c(n||X,G),w.appendTranslate(Z.tx(),Z.ty()),w.appendScale(Y,Y),w.append(new yp(V.getRotation(),$.x,$.y,y.x,y.y)),Qe(R,"transform","matrix("+w.a.toFixed(5)+", "+w.b.toFixed(5)+", "+w.c.toFixed(5)+",\n    "+w.d.toFixed(5)+", "+w.tx.toFixed(5)+", "+w.ty.toFixed(5)+")"),Qe(R,"transformOrigin",(-G.x).toFixed(5)+"px "+(-G.y).toFixed(5)+"px"),X.maxtrixAppend=w.invert().translate(-G.x,-G.y)}}});var _n=function(s,J){var c=this;c.gv=s,c.s=function(q){return J.getStyle(q)},c._data=J,c._87I=new Bk};Nc(_n,w,{_6I:T,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var h=this,I=h.gv.isSelected(h._data);return!I||h.isShadowed()?0:h.gv.getSelectWidth(h._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(i){var F=this._data,e=this.gv.getBodyColor(F);return e?e:i?F.getStyle(i):T},_2Q:function(G){return this.s(G)},_1Q:function(V,u,s,I){var a=this.s,m=a(u+".dash.color");V.strokeStyle=m,V.lineWidth=s,V.stroke(),a(u+".dash.3d")&&Lc(V,m,a(u+".dash.3d.color"),s,this.gv._zoom,a(u+".dash.3d.accuracy")),wn(V,I)},invalidate:function(){this._6I=T},_79o:function(){var B=this;if(!B._6I){var z=B._data,Z=B.gv;B.labelInfo=B.label2Info=B.noteInfo=B.note2Info=B._38o=T,B._87I.clear(),B.interactiveInfo=Z.isInteractive(z)?{}:T,B._3O(),B._55O=Z.isEditable(z)?{_42O:Z.isRectEditable(z),_43O:Z.isPointEditable(z),_56O:Z.isRotationEditable(z)}:T,B._6I=B._81o()}return B._6I},_3O:function(){},getPosition:function(){return gs},_68o:function(J,j){J&&this._87I.add(kk(J,j))},_81o:function(){var Z=this,n=Z.s;Z._24O(Rg,"getLabel"),Z._24O(Ul,"getLabel2"),Z._26O(Mr,"getNote"),Z._26O(lf,"getNote2"),Z._15O(),Z._55O&&Z._48O();var y;if(Z._87I.each(function(h){y=Ef(y,h)}),y&&Z.isShadowed()){var K=Tg(y);K.x+=n("shadow.offset.x"),K.y+=n("shadow.offset.y"),Ym(K,n("shadow.blur")),y=Ef(y,K)}return Z._87I.clear(),y},_42:function(Y){var j=this,c=j._data,p=j.gv,B=j.s,F=B("opacity"),K=this.isShadowed();if(K){var H=Y.shadowOffsetX,w=Y.shadowOffsetY,$=Y.shadowBlur,i=Y.shadowColor,v=p.getZoom();Y.shadowOffsetX=B("shadow.offset.x")*v,Y.shadowOffsetY=B("shadow.offset.y")*v,Y.shadowBlur=B("shadow.blur")*v,Y.shadowColor=j.getSelectColor()}if(F!=T){var g=Y.globalAlpha;Y.globalAlpha=F}j._80o(Y),p.isLabelVisible(c)&&((!p._drawForChecking||B("label.selectable"))&&jl(Y,j.labelInfo),(!p._drawForChecking||B("label2.selectable"))&&jl(Y,j.label2Info)),p.isNoteVisible(c)&&(Mb(Y,j.noteInfo),Mb(Y,j.note2Info)),j._99O(Y),F!=T&&(Y.globalAlpha=g),K&&(Y.shadowOffsetX=H,Y.shadowOffsetY=w,Y.shadowBlur=$,Y.shadowColor=i)},_80o:function(){},_47O:function(){},_24O:function(H,G){var r=this,X=r._data,y=r.gv,Y=r.s,E=y[G](X);if(E!=T){var U=Y(H+".scale"),L=Y(H+".max"),l=Y(H+".position"),I=r[H+"Info"]={label:E,scale:U,color:y[G+"Color"](X),font:Y(H+".font"),opacity:Y(H+".opacity"),align:Y(H+".align"),rotation:r.getRotation(Y(H+".rotation"),!1,l),background:y[G+"Background"](X)},z=fc(I,E);L>0&&L<z.width&&(I.labelWidth=z.width,z.width=L),1!==U&&(z.width*=U,z.height*=U);var A=r.getPosition(l,Y(H+".offset.x"),Y(H+".offset.y"),z,Y(H+".position.fixed"));if(z.x=A.x-z.width/2,z.y=A.y-z.height/2,r._68o(I.rect=z,I.rotation),1!==U){var x=z.width/U,O=z.height/U;I.rect={x:A.x-x/2,y:A.y-O/2,width:x,height:O}}}},_26O:function(a,h){var X=this,R=X.gv,k=X._data,_=X.s,j=R[h](k);if(j!=T){var o,O,K=_(a+".scale"),H=X[a+"Info"]={note:j,scale:K,data:k,view:R,expanded:_(a+".expanded"),font:_(a+".font"),color:_(a+".color"),opacity:_(a+".opacity"),align:_(a+".align"),icon:_(a+".icon"),backgroundImage:_(a+".backgroundImage"),borderWidth:_(a+".border.width"),borderColor:_(a+".border.color"),background:R[h+"Background"](k)},Z=X.getPosition(_(a+".position"),_(a+".offset.x"),_(a+".offset.y")),s=Z.x,q=Z.y;if(H.expanded){var C,f=_(a+".max"),t=_(a+".backgroundImage");t?(t=xf(t),C={width:Sq(t,k),height:Bg(t,k)}):C=fc(H,j),C.width+=6,C.height+=2,f>0&&f<C.width&&(H.labelWidth=C.width,C.width=f),o=C.width,O=C.height+8,H.clickRect={x:s-o*K/2,y:q-O*K,width:o*K,height:O*K*C.height/O}}else{var x=_(a+".icon");x?(x=xf(x),o=Sq(x,k),O=Bg(x,k)):(o=12,O=18),H.clickRect={x:s-o*K/2,y:q-O*K,width:o*K,height:O*K}}H.rect={x:s-o/2,y:q-O*K/2-O/2,width:o,height:O};var r=d(H.borderWidth/2)*K;X._68o({x:s-o*K/2-r,y:q-O*K-r,width:o*K+2*r,height:O*K+2*r})}},_48O:function(){},_99O:function(p){var w=this,D=w._38o;if(D){var y=w.gv,g=w._data,Q=D.icons,o=w.interactiveInfo;o&&(o._38o={});for(var B in Q){var J=Q[B],b=D.rects[B];if(b){o&&(o._38o[B]=[]);var K=cg(J.opacity,g,y),V=cg(J.names,g,y),S=V?V.length:0,U=b.rotation;if(K!=T){var x=p.globalAlpha;p.globalAlpha*=K}for(var M=0;S>M;M++){var u=V[M],C=xf(u),q=b[M];if(U){var d=q.x+q.width/2,N=q.y+q.height/2;p.save(),ts(p,d,N),eg(p,U),ts(p,-d,-N)}o&&o._38o[B].push(p.interactiveInfo={compInfos:[],matrix:U?new yp(U,d,N).appendTranslate(-d,-N):new yp}),np(p,C,cg(J.stretch,g,y),q.x,q.y,q.width,q.height,w._data,w.gv),p.interactiveInfo=T,U&&p.restore()}K!=T&&(p.globalAlpha=x)}}}}});var Cm=function(N,S){Uo(Cm,this,[N,S])};Nc(Cm,_n,{_checkEmptyRect:!0,_40O:function(X,d){var L=this,K=L.s,v=X.rect;(X.borderColor=L.gv.getBorderColor(L._data))&&(X.borderType=K("border.type"),X.borderWidth=K("border.width"),X.borderPadding=K("border.padding"),d=i(d,X.borderPadding+X.borderWidth/2));var N=L._data.getScale(),O=i(1,i(S(N.x),S(N.y)));if(X.selectWidth=L.getSelectWidth()){var b=L.gv._zoom;X.selectType=K("select.type"),X._97o=L.getSelectColor(),X.selectPadding=K("select.padding"),d=i(d,(X.selectPadding+X.selectWidth/2/b)/O)}d>0&&(d*=O,v=Tg(v),Ym(v,d)),L._68o(v)},_39O:function(X,b){var k,d=this,V=b.rect;if(b.borderWidth>0&&(k=b.borderPadding,X.strokeStyle=b.borderColor,X.lineWidth=b.borderWidth,yf(X,b.borderType,{x:V.x-k,y:V.y-k,width:V.width+2*k,height:V.height+2*k}),X.stroke()),b.selectWidth>0){var a=d.gv._zoom;if(k=b.selectPadding,X.strokeStyle=b._97o,X.lineWidth=b.selectWidth/a,b.rotation!=T){X.save(),X.translate(b.position.x,b.position.y),X.rotate(b.rotation);var L=d._data,e=L.getWidth(),O=L.getHeight(),B=b.scale,F=b.anchor;V={x:B.x*-e*F.x,y:B.y*-O*F.y,width:B.x*e,height:B.y*O}}yf(X,b.selectType,{x:V.x-k,y:V.y-k,width:V.width+2*k,height:V.height+2*k}),b.rotation!=T&&X.restore(),X.stroke()}},dispose:function(){var L=this,$=L._htmlView;Cm.superClass._3O.call(L),$&&($.onHTMLRemoved&&$.onHTMLRemoved(),Ln($))},_3O:function(){var f=this,d=f.s,k=f._data,B=f.gv,g=k.getStyle(Mo),G=f.getBodyColor(),L=f._83o=g?{shape:g,_53o:f.getBodyColor("shape.background"),_27Q:xf(d("shape.repeat.image"),G),shapeGradientPack:d("shape.gradient.pack"),_54o:d("shape.border.width"),_55o:d("shape.border.color"),_56o:d("shape.border.3d"),_57o:d("shape.border.3d.color"),_58o:d("shape.border.3d.accuracy"),shapeGradient:d("shape.gradient"),_59o:d("shape.gradient.color"),_60o:d("shape.border.pattern"),_61o:d("shape.border.cap"),_62o:d("shape.border.join"),shapeForeground:d("shape.foreground"),bodyColor:G}:{img:xf(B.getImage(k),G),bodyColor:G,stretch:d("image.stretch")};if(Y&&!c);else{var I,R=L.img;R&&R.renderHTML?(f._htmlInfo&&f._htmlInfo.img!==R&&(f._htmlInfo=T),f._htmlInfo||(f._htmlInfo={img:R,cache:{}}),I=R.renderHTML(k,B,f._htmlInfo.cache)):f._htmlInfo=T,f._htmlView&&f._htmlView!==I&&(f._htmlView.onHTMLRemoved&&f._htmlView.onHTMLRemoved(),Ln(f._htmlView.getView?f._htmlView.getView():f._htmlView)),(f._htmlView=I)&&B.appendHTML(I)&&I.onHTMLAdded&&I.onHTMLAdded(),L.rect=k.getRect(),L.position=k.p(),L.scale=k.getScale(),L.anchor=k.getAnchor(),L.rotation=k.getRotation(),g===zm&&(L._63o=d("shape.depth"));var e=0;if(g)e=Ur(T,L._54o/2,L._62o),f.s("shape.dash")&&(e=i(e,(f.s("shape.dash.width")||L._54o)/2));else if(R&&R.boundExtend)if(e=cg(R.boundExtend,k,B),R.boundExtendAbsolute){var H=k.getScale();e/=B._zoom*i(1,i(S(H.x),S(H.y)))}else if(!cg(R.fitSize,k,B)){var M=cg(R.width,k,B),j=cg(R.height,k,B);e*=i(k.getWidth()/M,k.getHeight()/j)}f._40O(L,e);var n=d("clip.percentage");if(1>n&&(0>n&&(n=0),L.clipRect=Pj(k.getAnchorRect(),d("clip.direction"),n)),g){var O=d("shape.fill.clip.percentage");1>O&&(0>O&&(O=0),L.shapeClipRect=Pj(k.getAnchorRect(),d("shape.fill.clip.direction"),O));var x=d("shape.foreground.clip.percentage");1>x&&(0>x&&(x=0),L.shapeForegroundClipRect=Pj(k.getAnchorRect(),d("shape.foreground.clip.direction"),x))}}},getPosition:function(b,p,f,q){var G=sj(b,this._83o.rect,q);return G.x+=p,G.y+=f,G},_80o:function(c){var v=this,y=v.s,i=v.gv,U=v._data,Q=v._83o,f=Q.rect,V=Q.position,R=Q.rotation,m=Q.anchor,u=Q.scale,C=Q.shape,e=Q.clipRect;if(!v._checkEmptyRect||f.width>0&&f.height>0){var S=U.getSize();if(S.x=-S.width*m.x,S.y=-S.height*m.y,c.save(),ts(c,V.x,V.y),eg(c,R),go(c,u.x,u.y),e&&(c.beginPath(),c.rect(e.x,e.y,e.width,e.height),c.clip()),i._drawForChecking&&Q.img&&cg(Q.img.pixelPerfect,U,i)===!1)Of(c,S.x,S.y,S.width,S.height,"#888888");else if(v.freeDraw)v.freeDraw(c,S,Q);else if(C){var D,a,G,Z,o=Q._60o,A=$d(c,o),$=Q._53o,k=Q._27Q,j=Q._54o,E=Q._55o,_=Q.shapeGradientPack,h=c.lineJoin,n=c.lineCap;if("roundRect"===C?D=y("shape.corner.radius"):"polygon"===C?D=y("shape.polygon.side"):"arc"===C&&(D=y("shape.arc.from"),a=y("shape.arc.to"),G=y("shape.arc.close"),Z=y("shape.arc.oval")),c.lineJoin=Q._62o,c.lineCap=Q._61o,$||k||_){var t=Q.shapeClipRect;t&&(c.save(),c.beginPath(),c.rect(t.x,t.y,t.width,t.height),c.clip()),yf(c,C,S,D,a,G,Z),_?On(c,_):k?dn(c,k,Q.bodyColor,null,U,i):ic(c,$,Q.shapeGradient,Q._59o,S),c.fill(),t&&c.restore(),_&&c.restore(),c!==A&&yf(A,C,S,D,a,G,Z)}else yf(A,C,S,D,a,G,Z);var J=Q.shapeForeground;if(J){c.save();var s=Q.shapeForegroundClipRect;s&&(c.beginPath(),c.rect(s.x,s.y,s.width,s.height),c.clip()),yf(c,C,S,D,a,G,Z),ic(c,J,y("shape.foreground.gradient"),y("shape.foreground.gradient.color"),S),c.fill(),c.restore()}if(j>0){var I=y("shape.border.width.absolute");I&&(c.save(),c.setTransform(1,0,0,1,0,0)),c.lineWidth=j,c.strokeStyle=E,c.stroke(),I&&c.restore(),Q._56o&&Lc(c,E,Q._57o,j,i._zoom,Q._58o)}if(wn(c,o),y("shape.dash")){var r=y("shape.dash.width")||j;if(r>0){o=y("shape.dash.pattern");var A=$d(c,o,v._2Q("shape.dash.offset"));A!==c&&yf(A,C,S,D,a,G,Z),v._1Q(c,"shape",r,o)}}nk(c,$,Q._63o,S),c.lineJoin=h,c.lineCap=n}else{var O=v.interactiveInfo;O&&(c.interactiveInfo=O.bodyInfo={compInfos:[],matrix:new yp(R,V.x,V.y,u.x,u.y)}),np(c,Q.img,Q.stretch,S.x,S.y,S.width,S.height,U,i,Q.bodyColor),c.interactiveInfo=T}c.restore()}v._39O(c,Q)},_48O:function(){},_47O:function(){}});var Gf=function(m,l){Uo(Gf,this,[m,l])},Xe=function(J,e,p,h){var q=Bc(J,e);return p=h?B(p,q):Qm(p,q),q?p/=q:p=0,{x:J.x+(e.x-J.x)*p,y:J.y+(e.y-J.y)*p}};Nc(Gf,_n,{_3O:function(){var O,Z=this,n=Z._data,k=Z.gv,x=Z.s,s=x(Zj),b=n.isLooped(),H=x("edge.width"),R=x("edge.center"),V=x("edge.offset"),v=k.getBorderColor(n),$=v?x("border.width"):0,I=Z.getSelectWidth(),e=n._40I,l=n._41I,K=Z._78o=e&&l?{looped:b,type:s,width:H,center:R,color:Z.getBodyColor("edge.color"),borderColor:v,borderWidth:$,_97o:I?Z.getSelectColor():T,selectWidth:I,pattern:x("edge.pattern"),cap:x("edge.cap"),join:x("edge.join"),is3d:x("edge.3d"),_67o:x("edge.3d.color"),_66o:x("edge.3d.accuracy")}:T;if(K){var U=t.getEdgeType(s);if(U){var u=U(n,Db(Z,k,n,b,s),k,Z._19Q);u.points&&u.points.size()>1?(K.edgeTypeInfo=u,O=ps(K.edgeTypeInfo.points)):u[xn]&&u.rect&&(K.edgeTypeInfo=u,O=u.rect)}else{var W=x("edge.source.anchor.x"),A=x("edge.source.anchor.y"),y=x("edge.target.anchor.x"),r=x("edge.target.anchor.y"),h=zb(k,e,x("edge.source.position"),x("edge.source.offset.x"),x("edge.source.offset.y"),W,A),p=zb(k,l,x("edge.target.position"),x("edge.target.offset.x"),x("edge.target.offset.y"),y,r);
if(s===ek){var a=K.points=x(Zf)||xk,B=a.size();K.segments=x("edge.segments");var F=W!==q||A!==q,c=y!==q||r!==q;if(!R)if(V)F||(h=Xe(h,B?a.get(0):p,V,B)),c||(p=Xe(p,B?a.get(B-1):h,V,B));else{var P;F||(P=Pk(h,B?a.get(0):p,xh(k,e)),P&&(h={x:P[0],y:P[1]})),c||(P=Pk(B?a.get(B-1):h,p,xh(k,l)),P&&(p={x:P[0],y:P[1]}))}O=Ef(ps(K.points),ps(h,p))}else{var G=Db(Z,k,n,b,s);if(Z._19Q||(G=-G),b)h=Tg(h),h.x=k.getNodeRect(e).x,K.radius=G,O={x:h.x-G,y:h.y-G,width:2*G,height:2*G};else{var L=Bc(h,p),M=Qm(V,L),d={x:M,y:G},S={x:L-M,y:G},j=J(p.y-h.y,p.x-h.x),g=K.mat=new Jg(j);if(K.orienAngle=j,K.angle=p.x<h.x?j+X:j,K.rect={x:d.x,y:d.y,width:S.x-d.x,height:0},K.origin=h,d=g.tf(d),d.x+=h.x,d.y+=h.y,S=g.tf(S),S.x+=h.x,S.y+=h.y,R){var w={x:L,y:0};w=g.tf(w),w.x+=h.x,w.y+=h.y,O=ps([h,d,S,w]),K.c1=h,K.c2=w}else O=ps(d,S);h=d,p=S}}K.sourcePoint=h,K.targetPoint=p,n._lastSourcePoint=h,n._lastTargetPoint=p}var o=0;x("edge.dash")&&(o=x("edge.dash.width")||H);var E="square"===K.cap?.71:.5;Ur(O,i(o*E,H*E+$+I),K.join),Z._68o(O)}},getRotation:function(H,$,S){H=H||0;var n=this._78o;if(n){var s,J=n.angle,u=n.points,D=n.edgeTypeInfo;if(J!=T)return $?n.orienAngle+H:J+H;if(D&&D[xn])return D.getRotation?D.getRotation(this,H,$,S):0;if(D&&D.points){var v=D.points;return s=v.size(),Jd[S]?s&&0===s%2?Nl(v.get(s/2-1),v.get(s/2),$,H):H:dh[S]?Nl(v.get(0),v.get(1),$,H):Nl(v.get(s-2),v.get(s-1),$,H)}if(u)return s=u.size(),Jd[S]?s&&0===s%2?Nl(u.get(s/2-1),u.get(s/2),$,H):H:dh[S]?Nl(n.sourcePoint,s?u.get(0):n.targetPoint,$,H):Nl(s?u.get(s-1):n.sourcePoint,n.targetPoint,$,H)}return H},getPosition:function(P,K,G,C,w){var a=this._78o;if(a){var k,d=a.type,q=a.points,x=a.edgeTypeInfo,z=a.sourcePoint,T=a.targetPoint;if(!d)return a.looped?{x:z.x-a.radius+K,y:z.y+G}:(w&&z&&T&&(z.x>T.x||z.x===T.x&&z.y>T.y)&&(P=Gi[P],G=-G),k=sj(P,a.rect,C),k.x+=K,k.y+=G,k=a.mat.tf(k),k.x+=a.origin.x,k.y+=a.origin.y,k);if(x&&x[xn])return x.getPosition?x.getPosition(this,P,K,G,C,w):{x:(z.x+T.x)/2,y:(z.y+T.y)/2};if(q){var k,t=q.size();if(Jd[P]){if(t){var W=t%2;if(0===W)return Mm(q.get(t/2-1),q.get(t/2),P,K,G,C,w);k=q.get((t-W)/2)}else k={x:(z.x+T.x)/2,y:(z.y+T.y)/2};return k=sj(P,{x:k.x,y:k.y,width:0,height:0},C),k.x+=K,k.y+=G,k}return dh[P]?Mm(z,t?q.get(0):T,P,K,G,C,w):Mm(t?q.get(t-1):z,T,P,K,G,C,w)}if(x){var n=x.points,t=n.size();if(Jd[P]){var W=t%2;return 0===W?Mm(n.get(t/2-1),n.get(t/2),P,K,G,C,w):(k=n.get((t-W)/2),k=sj(P,{x:k.x,y:k.y,width:0,height:0},C),k.x+=K,k.y+=G,k)}return dh[P]?Mm(n.get(0),n.get(1),P,K,G,C,w):Mm(n.get(t-2),n.get(t-1),P,K,G,C,w)}}return gs},_42:function(J){this._78o&&Gf.superClass._42.call(this,J)},drawPath:function(e,B){e.beginPath();var L=B.type,U=B.points,J=B.segments,Y=B.edgeTypeInfo;if(!L||U){var a=B.sourcePoint,G=a.x,E=a.y,H=B.targetPoint,T=H.x,$=H.y;if(L)if(J){var F=new Bk({x:G,y:E});F.addAll(U),F.add({x:T,y:$}),$r(e,F,J)}else e.moveTo(G,E),U.each(function(C){e.lineTo(C.x,C.y)}),e.lineTo(T,$);else B.looped?e.arc(G,E,B.radius,0,p,!0):B.center?(e.moveTo(B.c1.x,B.c1.y),e.lineTo(G,E),e.lineTo(T,$),e.lineTo(B.c2.x,B.c2.y)):(e.moveTo(G,E),e.lineTo(T,$))}else Y&&(Y.points?$r(e,Y.points,Y.segments):Y[xn]&&Y[xn](e,Y))},_80o:function(E){var u=this,x=u.s,t=u._78o,O=t.width,e=t.selectWidth,R=t.borderWidth,Q=t.color,M=E.lineJoin,C=E.lineCap,l=t.pattern;E.lineJoin=t.join,E.lineCap=t.cap,u.drawPath($d(E,l),t);var B=x("edge.width.absolute");if(B&&(E.save(),E.setTransform(1,0,0,1,0,0)),e&&(E.strokeStyle=t._97o,E.lineWidth=O+2*(R+e),E.stroke()),R&&(E.strokeStyle=t.borderColor,E.lineWidth=O+2*R,E.stroke()),E.strokeStyle=Q,E.lineWidth=O,E.stroke(),t.is3d&&Lc(E,Q,t._67o,O,u.gv._zoom,t._66o),B&&E.restore(),wn(E,l),x("edge.dash")){l=x("edge.dash.pattern");var L=$d(E,l,u._2Q("edge.dash.offset"));L!==E&&u.drawPath(L,t),u._1Q(E,"edge",x("edge.dash.width")||O,l)}E.lineJoin=M,E.lineCap=C},_48O:function(){},_47O:function(){},_71o:function(_,d){var Q=this,l=Q._data;if(Q._19Q=!0,!l.getEdgeGroup())return _?l.s("edge.gap"):0;var m,H=0,r=0,G=0;if(l.getEdgeGroup().getSiblings().each(function(X){X.each(function(o){if(Q.gv.isVisible(o)&&o.s(Zj)==d){var f=o.s("edge.gap");m?(r+=G/2+f/2,G=f):(m=o,G=f),o===l&&(H=r)}})}),_)return r-H+G;var a=H-r/2;return m&&l._40I!==m._40I&&(Q._19Q=!1),a}});var cc=function(r,f){Uo(cc,this,[r,f])};Nc(cc,Cm,{_3O:function(){var u,Q,K=this,d=K.s,R=K._data,L=K.gv;if(K._88I=T,R.isExpanded()&&R.eachChild(function(n){var V=L.getBoundsForGroup(n);V&&(Q||(Q=[]),Q.push(V),u=Ef(u,V))}),u){var b=L.getLabel(R),f=d("group.type");u=Qj(f,Q,u),rk(u,R,"group.padding",1);var w=K._88I={type:f,rect:u,_64o:u};if(!f&&b!=T){var P,p=K.labelInfo={label:b,color:d("group.title.color"),font:d("group.title.font"),align:d("group.title.align")},g=fc(p,b),V=g.width,O=g.height,y=d("group.title.align"),B=d("group.title.orientation");if((B===Nm||B===ak)&&V>u.width?u.width=V:(B===vn||B===ib)&&V>u.height&&(u.height=V),p.rect={y:u.y-O,width:g.width,height:O},P=y===vn?u.x:y===ib?u.x+u.width-V:u.x+u.width/2-V/2,p.rect.x=P,B===ak)w.titleRect={x:u.x,y:u.y+u.height,width:u.width,height:O},w.rect={x:u.x,y:u.y,width:u.width,height:u.height+O},p.rect={x:P,y:u.y+u.height,width:V,height:O};else if(B===vn){var t=w.titleRect={x:u.x-O,y:u.y,width:O,height:u.height};w.rect={x:u.x-O,y:u.y,width:u.width+O,height:u.height},p.rect={x:t.x+O/2-u.height/2,y:t.y+u.height/2-O/2,width:u.height,height:O},p.rotation=-Math.PI/2}else if(B===ib){var t=w.titleRect={x:u.x+u.width,y:u.y,width:O,height:u.height};w.rect={x:u.x,y:u.y,width:u.width+O,height:u.height},p.rect={x:t.x+O/2-u.height/2,y:t.y+u.height/2-O/2,width:u.height,height:O},p.rotation=Math.PI/2}else w.titleRect={x:u.x,y:u.y-O,width:u.width,height:O+1},w.rect={x:u.x,y:u.y-O,width:u.width,height:u.height+O}}K._40O(w,d("group.border.width")/2)}else cc.superClass._3O.call(K)},getPosition:function(c,d,W,l){var I=this._88I;if(I){var q=sj(c,I.rect,l);return q.x+=d,q.y+=W,q}return cc.superClass.getPosition.apply(this,arguments)},_24O:function(n,Y){var l=this._88I;(!l||l.type||"label2"===n)&&cc.superClass._24O.call(this,n,Y)},_80o:function(c){var S=this,E=S._88I;if(E){var N=S._data,G=S.s,s=S.gv,j=E.type,U=E.rect,y=E._64o,d=E.titleRect,J=S.getBodyColor(),o=xf(G("group.image"),J),V=G("group.image.stretch"),x=S.getBodyColor("group.background"),C=xf(G("group.repeat.image"),J),m=G("group.gradient.pack"),R=G("group.gradient"),A=G("group.gradient.color"),D=G("group.border.width"),l=G("group.border.color"),z=G("group.border.pattern"),Q=G("group.title.orientation"),i=G("group.depth");if(j){var W=c.lineJoin,Z=c.lineCap;if(c.lineJoin=G("group.border.join"),c.lineCap=G("group.border.cap"),o){if(c.save(),yf(c,j,U),c.clip(),np(c,o,V,U.x,U.y,U.width,U.height,N,s,J),c.restore(),D>0){var k=$d(c,z);yf(k,j,U),c.lineWidth=D,c.strokeStyle=l,c.stroke(),wn(c,z)}}else{var k=$d(c,z);x||C||m?(yf(c,j,U),m?On(c,m):C?dn(c,C,J,null,N,s):ic(c,x,R,A,U),c.fill(),m&&c.restore(),c!==k&&yf(k,j,U)):yf(k,j,U),D>0&&(c.lineWidth=D,c.strokeStyle=G("group.border.color"),c.stroke()),wn(c,z),j===zm&&nk(c,x,i,U)}c.lineJoin=W,c.lineCap=Z}else{var $=G("group.title.background"),r=G("group.border.radius");if(o)np(c,o,V,y.x,y.y,y.width,y.height,N,s,S.getBodyColor());else if(x||C)if(C?dn(c,C,J,null,N,s):ic(c,x,R,A,y),0===D)yf(c,zm,y),c.fill(),nk(c,x,i,y);else{switch(c.beginPath(),Q){case ak:hj(c,y.x,y.y,y.width,y.height,r,r,0,0);break;case vn:hj(c,y.x,y.y,y.width,y.height,0,r,0,r);break;case ib:hj(c,y.x,y.y,y.width,y.height,r,0,r,0);break;case Nm:hj(c,y.x,y.y,y.width,y.height,0,0,r,r)}c.fill()}if(d&&$)if(0===D)Of(c,d.x,d.y,d.width,d.height,$),nk(c,$,i,d);else{switch(c.beginPath(),c.fillStyle=$,Q){case ak:hj(c,d.x,d.y,d.width,d.height,0,0,r,r);break;case vn:hj(c,d.x,d.y,d.width,d.height,r,0,r,0);break;case ib:hj(c,d.x,d.y,d.width,d.height,0,r,0,r);break;case Nm:hj(c,d.x,d.y,d.width,d.height,r,r,0,0)}c.fill()}if(D>0){var k=$d(c,z);if(yf(k,"roundRect",U,r),c.lineWidth=D,c.strokeStyle=l,d&&G("group.splitLine")){var I=d.x,p=d.y,K=d.width,a=d.height;Q===ak?(c.moveTo(I,p),c.lineTo(I+K,p)):Q===vn?(c.moveTo(I+K,p),c.lineTo(I+K,p+a)):Q===ib?(c.moveTo(I,p),c.lineTo(I,p+a)):(c.moveTo(I,p+a),c.lineTo(I+K,p+a))}c.stroke(),wn(c,z)}}S._39O(c,E)}else cc.superClass._80o.call(S,c)}});var hl=function(N,P){Uo(hl,this,[N,P])};Nc(hl,Cm,{_80o:function(x){this._39O(x,this._83o)}});var dk=function(L,j){Uo(dk,this,[L,j])};Nc(dk,Cm,{_3O:function(){var a=this,R=a._data,K=a.s,Z=a.gv,q=R.getPoints(),P=Z.getBorderColor(R),F=P?K("border.width"):0,D=a.getSelectWidth(),V=K("shape.border.width"),m=R.getRect(),w=Z.getBodyColor(R),u=a._99o=q.isEmpty()?T:{rect:m,rotation:R.getRotation(),fillRule:K("shape.fill.rule"),scale:R.getScale(),position:R.p(),points:q,segments:R.getSegments(),bodyColor:w,borderColor:P,borderWidth:F,_94o:K("shape.border.3d"),_95o:K("shape.border.3d.color"),_96o:K("shape.border.3d.accuracy"),_97o:D?a.getSelectColor():T,selectWidth:D,_53o:K("shape.background"),_27Q:xf(K("shape.repeat.image"),w),shapeGradientPack:K("shape.gradient.pack"),_54o:V,_55o:K("shape.border.color"),shapeGradient:K("shape.gradient"),_59o:K("shape.gradient.color"),_60o:K("shape.border.pattern"),_61o:K("shape.border.cap"),_62o:K("shape.border.join"),shapeForeground:K("shape.foreground")};if(u){var b=R.getScale(),s=i(1,i(S(b.x),S(b.y)));K("shape.dash")&&K("shape.dash.width")>V&&(V=K("shape.dash.width"));var j=V*("square"===u._61o?.71:.5)+F+D/a.gv._zoom/s;j&&(j*=s,m=Tg(m),Ur(m,j,u._62o)),a._68o(m);var $=K("clip.percentage");1>$&&(0>$&&($=0),u.clipRect=Pj(R.getAnchorRect(),K("clip.direction"),$));var z=K("shape.fill.clip.percentage");1>z&&(0>z&&(z=0),u.shapeClipRect=Pj(R.getAnchorRect(),K("shape.fill.clip.direction"),z));var C=K("shape.foreground.clip.percentage");1>C&&(0>C&&(C=0),u.shapeForegroundClipRect=Pj(R.getAnchorRect(),K("shape.foreground.clip.direction"),C))}},getPosition:function(l,$,z,n){var S=this._99o;if(S){var C=sj(l,S.rect,n);return C.x+=$,C.y+=z,C}return gs},_42:function(e){this._99o&&dk.superClass._42.call(this,e)},_80o:function(e){var W,u=this,C=u.s,q=u._99o,l=q.position,r=q.scale,V=q.rotation,z=q.bodyColor,U=q.borderWidth,P=q.selectWidth/u.gv._zoom,Z=q._53o,d=q._27Q,_=q.shapeGradientPack,w=q._54o,I=q.clipRect,N=q.shapeClipRect,D=q.points,E=q.segments,$=u._data.isClosePath(),v=q.fillRule,L=Z||d||_;e.save(),ts(e,l.x,l.y),eg(e,V),go(e,r.x,r.y),I&&(e.beginPath(),e.rect(I.x,I.y,I.width,I.height),e.clip()),L&&N&&(e.save(),e.beginPath(),e.rect(N.x,N.y,N.width,N.height),e.clip()),ts(e,-l.x,-l.y);var b=q._60o,t=$d(e,b),n=e.lineJoin,x=e.lineCap;e.lineJoin=q._62o,e.lineCap=q._61o,L?($r(e,D,E,$),_?On(e,_):d?dn(e,d,z,null,u._data,u.gv):(W=z?z:Z,ic(e,W,q.shapeGradient,q._59o,q.rect)),e.fill(v),N&&(e.restore(),ts(e,-l.x,-l.y)),_&&e.restore(),t!==e&&$r(t,D,E,$)):$r(t,D,E,$);var m=q.shapeForeground;if(m){e.save();var K=q.shapeForegroundClipRect;K&&(ts(e,l.x,l.y),e.beginPath(),e.rect(K.x,K.y,K.width,K.height),e.clip(),ts(e,-l.x,-l.y)),$r(e,D,E,$),ic(e,m,C("shape.foreground.gradient"),C("shape.foreground.gradient.color"),q.rect),e.fill(v),e.restore()}var g=C("shape.border.width.absolute");if(g&&(e.save(),e.setTransform(1,0,0,1,0,0)),P&&(e.strokeStyle=q._97o,e.lineWidth=w+2*(U+P),e.stroke()),U&&(e.strokeStyle=q.borderColor,e.lineWidth=w+2*U,e.stroke()),w&&(W=q._55o,!Z&&z&&(W=z),e.strokeStyle=W,e.lineWidth=w,e.stroke(),q._94o&&Lc(e,W,q._95o,w,u.gv._zoom,q._96o)),g&&e.restore(),wn(e,b),C("shape.dash")){var Y=C("shape.dash.width")||w;if(Y>0){b=C("shape.dash.pattern");var t=$d(e,b,u._2Q("shape.dash.offset"));t!==e&&$r(t,D,E,$),u._1Q(e,"shape",Y,b)}}e.lineJoin=n,e.lineCap=x,e.restore()},_48O:function(){},_47O:function(){}});var Xl=function(i,Q){Uo(Xl,this,[i,Q])};Nc(Xl,dk,{getRotation:function(E,b,g){E=E||0;var I=this._data.getPoints(),$=I.size();return $>1?Jd[g]?$&&0===$%2?Nl(I.get($/2-1),I.get($/2),b,E):E:dh[g]?Nl(I.get(0),I.get(1),b,E):Nl(I.get($-2),I.get($-1),b,E):E},getPosition:function(P,s,y,T,S){var p=this._data.getPoints(),e=p.size();if(e>1){if(Jd[P]){var A=e%2;if(0===A)return Mm(p.get(e/2-1),p.get(e/2),P,s,y,T,S);var O=p.get((e-A)/2),t={x:O.x,y:O.y,width:0,height:0};return O=sj(P,t,T),O.x+=s,O.y+=y,O}return dh[P]?Mm(p.get(0),p.get(1),P,s,y,T,S):Mm(p.get(e-2),p.get(e-1),P,s,y,T,S)}return gs}});var Vj=function(m,i){Uo(Vj,this,[m,i])};Nc(Vj,Cm,{_3O:function(){var O=this;Vj.superClass._3O.call(O);var c=O.s,D=O._83o;O._82o=D.img||D.shape?T:{background:O.getBodyColor("grid.background"),depth:c("grid.depth"),rect:D.rect,_88o:c("grid.cell.depth"),cellBorderColor:c("grid.cell.border.color"),_89o:c("grid.row.count"),_90o:c("grid.column.count"),block:c("grid.block"),_91o:c("grid.block.color"),_92o:c("grid.block.padding"),_93o:c("grid.block.width")}},_80o:function(M){var S=this,F=S._82o;if(!F)return Vj.superClass._80o.call(S,M),void 0;var o,w,W=S._data,U=F.background,B=F.rect,T=F.block,x=F._91o,b=F._92o,Z=F._93o,n=F._88o,z=F.cellBorderColor,L=F._89o,v=F._90o;if(U)if(Of(M,B.x,B.y,B.width,B.height,U),nk(M,U,F.depth,B),n)for(o=0;L>o;o++)for(w=0;v>w;w++)B=W.getCellRect(o,w),B&&nk(M,U,n,B);else if(z){for(M.beginPath(),o=0;L>o;o++)for(w=0;v>w;w++)B=W.getCellRect(o,w),B&&M.rect(B.x,B.y,B.width,B.height);M.strokeStyle=z,M.lineWidth=1,M.stroke()}if("h"===T)for(o=0;L>o;o++)B=Ef(W.getCellRect(o,0),W.getCellRect(o,v-1)),Ym(B,b),We(M,x,B.x,B.y,B.width,B.height,Z);else if("v"===T)for(w=0;v>w;w++)B=Ef(W.getCellRect(0,w),W.getCellRect(L-1,w)),Ym(B,b),We(M,x,B.x,B.y,B.width,B.height,Z);S._39O(M,S._83o)}});var Tq=function(s,W){Uo(Tq,this,[s,W])};Nc(Tq,Cm,{_checkEmptyRect:!1,_81o:function(){var b=this._data,I=Tq.superClass._81o.call(this),h=b.s("text");if(h!=T){var V,n,D=b.s("text.font"),q=b.s("text.align"),B=b.s("text.vAlign"),v=jp(D,h),Z=v.width,F=v.height,S=b.getAnchor(),K=b.getWidth(),w=b.getHeight();"left"===q?V=-K*S.x:"center"===q?V=-K*S.x+(K-Z)/2:"right"===q&&(V=K*(1-S.x)-v.width),"top"===B?n=-w*S.y:"middle"===B?n=-w*S.y+(w-F)/2:"bottom"===B&&(n=w*(1-S.y)-v.height);var M,Q=b.getMatrix();if(M=ps([Q.tf(V,n),Q.tf(V+Z,n),Q.tf(V+Z,n+F),Q.tf(V,n+F)]),I=Ef(I,M),I&&b.s("text.shadow")){var $=Tg(I);$.x+=b.s("text.shadow.offset.x"),$.y+=b.s("text.shadow.offset.y"),Ym($,b.s("text.shadow.blur")),I=Ef(I,$)}}return I}});var Ic=_h.Interactor=function(N){this.gv=this._graphView=N};Sb("Interactor",w,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(g){this.gv.fi(g)},setCursor:function(F){tb||this.gv.setCursor(F)},startDragging:function(c){var Z=this;Z._lastClientPoint=kl(c),Z._lastLogicalPoint=Z.gv.lp(c),El(Z,c)},clearDragging:function(){var g=this;g._lastClientPoint=g._lastLogicalPoint=g._logicalPoint=T},autoScroll:function(U){return this.gv.autoScroll(U,this._lastClientPoint)}});var hi=T,Ip=function(K){hi.handleWindowTouchMove(K)},mo=function(I){hi.handleWindowTouchEnd(I),x.removeEventListener(lb,Ip,O),x.removeEventListener(Ko,mo,O),hi=T},cp=function(x){hi.handleWindowMouseMove(x)},Ad=function(B){hi.handleWindowMouseUp(B),x.removeEventListener(cj,cp,O),x.removeEventListener(pm,Ad,O),hi=T},uf=function(q,B){q!==hi&&(hi?tb?hi.handleWindowTouchEnd(B):hi.handleWindowMouseUp(B):tb?(x.addEventListener(lb,Ip,O),x.addEventListener(Ko,mo,O)):(x.addEventListener(cj,cp,O),x.addEventListener(pm,Ad,O)),hi=q)},Ii=function(_){var l=this;l.gv=_,l._is2d=_ instanceof _h.GraphView,l._is2d&&(l.filter=function(D){return _.isSelectable(D)&&_.isInteractive(D)}),_.getView(),["mousedown","mousemove","touchstart","touchmove",Jh].forEach(function(E){l.addListener(E)}),l.initImageResource()};Nc(Ii,Ic,{enableVR:function(P){var J=this;if(!!J._vrEnable!==P)if(J._vrEnable=P,P)J.gv.vr.mp(J.onVRControllerChange,J);else if(J.gv.vr.ump(J.onVRControllerChange,J),J._vrRayPolyline){var A=J.gv.dm();A.remove(J._vrRayPolyline),A.remove(J._vrRayHitPoint),J._vrRayPolyline=q,J._vrRayHitPoint=q}},onVRControllerChange:function(M){var w=this,z=M.property,C=M.newValue,R=w.gv.vr.getController(C.id),h=R.getRay();h&&("gamepad.button.trigger"===z?"down"===C._62O?w.handle_mousedown(h):w.handleWindowUp(h):"gamepad.pose"===z&&(w.handle_mousemove(h),w.handleWindowMove(h)))},drawVRRay:function(f,Y,_){var m,C=this,l=C.gv,t=C._vrRayPolyline,L=!1;if(t)m=C._vrRayHitPoint;else{var W=l.dm();C._vrRayPolyline=t=new b.Polyline,C._vrRayHitPoint=m=new b.Node,m.s({shape3d:"billboard","shape3d.transparent":!0,"shape3d.texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),m.setAnchor3d(.5,.5,.499);var E=.2/l.vr.measureOflength;m.s3(E,E,E),t.s("intersect",!1),m.s("intersect",!1),W.add(t),W.add(m),L=!0}if(Y){var p=_.world,T=_.worldNormal,e=p.x,a=p.y,v=p.z;t.s("shape.border.color","red"),t.setPoints([{x:f.origin.x,y:f.origin.z,e:f.origin.y},{x:e,y:v,e:a}]),m.s("3d.visible",!0),m.p3(e,a,v),m.lookAtDirection([T.x,T.y,T.z],"front")}else{t.s("shape.border.color","blue");var S=new b.Math.Vector3;S.copy(f.direction).setLength(1e3/C.gv.vr.measureOflength).add(f.origin),t.setPoints([{x:f.origin.x,y:f.origin.z,e:f.origin.y},{x:S.x,y:S.z,e:S.y}]),m.s("3d.visible",!1)}l.fi({kind:"vrRayIntersect",ray:f,data:Y,intersect:_,polyline:t,hitNode:m,begin:L})},addListener:function(x){var c=this;c.gv.getView().addEventListener(x,function(p){t.preventDefault(p),c.disabled||c["handle_"+x](p)},O)},handleWindowTouchMove:function(v){this.handleWindowMouseMove(v)},handleWindowMouseMove:function(r){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",r):(this.handleDownInfo("onBeginDrag",r),this.isDragging=!0))},handleWindowTouchEnd:function(z){this.handleWindowMouseUp(z)},handleWindowMouseUp:function(g){if(this.isDragging&&(this.handleDownInfo("onEndDrag",g),this.isDragging=!1),this.downInfo){var J=this.handle("onUp",g);J&&J.data===this.downInfo.data?this.handleMissingUp(g):this.handleDownInfo("onUp",g),this.downInfo=T}},handle_mousewheel:function(c){c.scrollDelta=c.wheelDelta/40,this.handle("onScroll",c)},handle_DOMMouseScroll:function(G){G.scrollDelta=2===G.axis?-G.detail:0,this.handle("onScroll",G)},handle_touchstart:function(r){this.handle_mousedown(r)},handle_touchmove:function(G){this.handle("onMove",G)},handle_mousedown:function(B){this.isDragging&&(this.handleDownInfo("onEndDrag",B),this.isDragging=!1),this.downInfo=this.handle("onDown",B),this.downInfo&&uf(this,B)},handle_mousemove:function(H){var s=this,l=s.gv;s._hoverTimer&&(F(s._hoverTimer),delete s._hoverTimer);var m,D,w,c=s.handle("onMove",H),I=this.currentInfo?this.currentInfo.data:T,y=this.currentInfo?this.currentInfo.hits:T;if(c&&(D=c.data,w=c.hits,s._hoverTimer=n(function(){F(s._hoverTimer),delete s._hoverTimer,s.handle("onHover",H,c)},l.getHoverDelay()||t.hoverDelay)),D!==I){if(D&&(D.s("onEnter")&&D.s("onEnter")(H,D,l),this.fire("data","onEnter",H,D)),I&&(I.s("onLeave")&&I.s("onLeave")(H,I,l),this.fire("data","onLeave",H,I)),y)for(m in y)this.handleLeave(H,m);if(w)for(m in w){var a=w[m];a.target.onEnter&&a.target.onEnter(H,D,l,a.point,a.width,a.height),this.fire(a.type,"onEnter",a.event,a.data,a.image,a.comp,a.point,a)}}else{if(y)for(m in y)w&&w[m]||this.handleLeave(H,m);if(w)for(m in w)if(!y||!y[m]){var a=w[m];a.target.onEnter&&a.target.onEnter(H,D,l,a.point,a.width,a.height),this.fire(a.type,"onEnter",a.event,a.data,a.image,a.comp,a.point,a)}}this.currentInfo=c},handle:function(J,l,D){var g,R=this,x=R.gv;if(R._is2d){if(D=D||x.getDataInfoAt(l,this.filter),!D)return;if(g=D.ui.interactiveInfo){var a,X=D.data;if(X.s(J)&&X.s(J)(l,X,x),this.fire("data",J,l,X),"body"===D.part&&g.bodyInfo)a="body",D.hits=this.handleImage(a,x.getImage(X),J,l,X,D.point,g.bodyInfo);else if("icons"===D.part&&g._38o){var Y=g._38o[D.name];Y&&Y[D.index]&&(a="icons|"+D.name+"|"+D.index,D.hits=this.handleImage(a,D.icon,J,l,X,D.point,Y[D.index]))}}return D}var X,L;if(!D)if(l&&l instanceof b.Math.Ray){var h=x.vr.intersectWorld(l);if(X=h.data,L=h.intersect,R.drawVRRay(l,X,L),!X)return;var i=x.getData3dUI(X);if(g=i.interactiveInfo,!g)return;D={data:X,part:L.part,ui:i}}else{if(D=x.getDataInfoAt(l),!D)return;D&&(D={data:D.data,part:D.part})}if(!L){X=D.data;var i=x.getData3dUI(X);if(D.ui=i,g=i.interactiveInfo,!g)return D;if(L=x.intersectObject(l,X),!L)return}X.s(J)&&X.s(J)(l,X,x),this.fire("data",J,l,X);var j,f=L.part;return"body"!==f&&(j=X.s(f+".image")||X.s("shape3d."+f+".image")),j||(j=X.s("all.image")||X.s("shape3d.image")),(g=g[j])?(D.part="body",D.interactiveInfo=g,D.point=L.uv.multiply({x:g.bodyInfo.rect.width,y:g.bodyInfo.rect.height}),D.image=j,D.hits=this.handleImage("body",j,J,l,X,D.point,g.bodyInfo),D):void 0},_handleLeaveOrMissing:function(K,U,B){var e="leave"===K?this.currentInfo:this.downInfo;if(e){var b=e.interactiveInfo||e.ui.interactiveInfo;if(b){var l,a,Z=e.data;if(this._is2d){if(a=this.gv.lp(U),"body"===e.part&&b.bodyInfo)l="body","leave"===K?this.handleLeaveImage(B,l,this.gv.getImage(Z),U,Z,a,b.bodyInfo):this.handleMissingUpImage(l,this.gv.getImage(Z),U,Z,a,b.bodyInfo);else if("icons"===e.part&&b._38o){var A=b._38o[e.name];A&&A[e.index]&&(l="icons|"+e.name+"|"+e.index,"leave"===K?this.handleLeaveImage(B,l,e.icon,U,Z,a,A[e.index]):this.handleMissingUpImage(l,e.icon,U,Z,a,A[e.index]))}}else{var y=this.gv.intersectObject(U,Z);a=y?y.uv.multiply({x:b.bodyInfo.rect.width,y:b.bodyInfo.rect.height}):{x:1/0,y:1/0},"leave"===K?this.handleLeaveImage(B,"body",e.image,U,Z,a,b.bodyInfo):this.handleMissingUpImage("body",e.image,U,Z,a,b.bodyInfo)}}}},handleDownInfo:function(w,z){if(this.downInfo){var j=this.downInfo,H=this.gv,P=j.interactiveInfo||j.ui.interactiveInfo;if(P){var q,S=j.data;if(S.s(w)&&S.s(w)(z,S,H),this.fire("data",w,z,S),this._is2d){var v=H.lp(z);if("body"===j.part&&P.bodyInfo)q="body",this.handleDownInfoImage(q,H.getImage(S),w,z,S,v,P.bodyInfo);else if("icons"===j.part&&P._38o){var D=P._38o[j.name];D&&D[j.index]&&(q="icons|"+j.name+"|"+j.index,this.handleDownInfoImage(q,j.icon,w,z,S,v,D[j.index]))}}else{var J=H.intersectObject(z,S);if(!J)return;v=J.uv.multiply({x:P.bodyInfo.rect.width,y:P.bodyInfo.rect.height}),this.handleDownInfoImage("body",j.image,w,z,S,v,P.bodyInfo)}}}},fire:function(L,x,M,n,g,K,p,c){this.gv.fi({kind:x,type:L,event:M,data:n,image:g,comp:K,view:this.gv,point:p,width:c?c.width:q,height:c?c.height:q})},handleImage:function(J,I,i,p,w,C,$){var b={};if(I&&(I=xf(I))){var Q=this.gv,Y=$.rect,n=this.convertPoint(C,$);n.inRect&&(I[i]&&I[i](p,w,Q,n,Y.width,Y.height),this.fire("image",i,p,w,I,q,n,Y),b[J+"|image"]={target:I,type:"image",image:I,data:w,event:p,point:n,width:Y.width,height:Y.height});for(var D=$.compInfos,M=I,e=D.length-1;e>=0;e--){var O=D[e],X=O.comp;n=this.convertPoint(C,O,M,X,Q,w),n.inRect&&(Y=O.rect,X[i]&&X[i](p,w,Q,n,Y.width,Y.height),this.fire("comp",i,p,w,I,X,n,Y),(I=Y.image)&&(I[i]&&I[i](p,w,Q,n,Y.width,Y.height),this.fire("image",i,p,w,I,q,n,Y)),b[J+"|"+e]={target:X,type:"comp",comp:X,image:I,data:w,event:p,point:n,width:Y.width,height:Y.height},I&&(b[J+"|"+e+"|image"]={target:I,type:"image",image:I,data:w,event:p,point:n,width:Y.width,height:Y.height}))}}return b},handleLeave:function(J,l){return this._handleLeaveOrMissing("leave",J,l)},handleMissingUp:function(A){return this._handleLeaveOrMissing("missing",A)},handleLeaveImage:function(j,Y,I,M,s,d,v){if(I&&(I=xf(I))){var S=this.gv,Q=v.rect,e=this.convertPoint(d,v);j===Y+"|image"&&(I.onLeave&&I.onLeave(M,s,S,e,Q.width,Q.height),this.fire("image","onLeave",M,s,I,q,e,Q));for(var x=v.compInfos,$=I,N=x.length-1;N>=0;N--){var u=x[N],G=u.comp;e=this.convertPoint(d,u,$,G,S,s),Q=u.rect,j===Y+"|"+N&&(G.onLeave&&G.onLeave(M,s,S,e,Q.width,Q.height),this.fire("comp","onLeave",M,s,I,G,e,Q)),(I=Q.image)&&j===Y+"|"+N+"|image"&&(I.onLeave&&I.onLeave(M,s,S,e,Q.width,Q.height),this.fire("image","onLeave",M,s,I,q,e,Q))}}},handleMissingUpImage:function(D,b,f,M,s,c){var m="onUp",a=this.downInfo.hits;if(a&&b&&(b=xf(b))){var z=this.gv,y=c.rect,G=this.convertPoint(s,c);!G.inRect&&a[D+"|image"]&&(b[m]&&b[m](f,M,z,G,y.width,y.height),this.fire("image",m,f,M,b,q,G,y));for(var A=c.compInfos,e=b,g=A.length-1;g>=0;g--){var o=A[g],l=o.comp;G=this.convertPoint(s,o,e,l,z,M),G.inRect||(y=o.rect,a[D+"|"+g]&&(l[m]&&l[m](f,M,z,G,y.width,y.height),this.fire("comp",m,f,M,b,l,G,y)),(b=y.image)&&a[D+"|"+g+"|image"]&&(b[m]&&b[m](f,M,z,G,y.width,y.height),this.fire("image",m,f,M,b,q,G,y)))}}},handleDownInfoImage:function(O,M,d,z,e,A,x){var y=this.downInfo.hits;if(y&&M&&(M=xf(M))){var S=this.gv,R=x.rect,P=this.convertPoint(A,x);y[O+"|image"]&&(M[d]&&M[d](z,e,S,P,R.width,R.height),this.fire("image",d,z,e,M,q,P,R));for(var G=x.compInfos,l=M,N=G.length-1;N>=0;N--){var w=G[N],i=w.comp;P=this.convertPoint(A,w,l,i,S,e),R=w.rect,y[O+"|"+N]&&(i[d]&&i[d](z,e,S,P,R.width,R.height),this.fire("comp",d,z,e,M,i,P,R)),(M=R.image)&&y[O+"|"+N+"|image"]&&(M[d]&&M[d](z,e,S,P,R.width,R.height),this.fire("image",d,z,e,M,q,P,R))}}},initImageResource:function(){t.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},convertPoint:function(r,s,J,E,Y,W){var h=s.rect,k=s.matrix.applyInverse(r).sub(h),I=k.x>=0&&k.y>=0&&k.x<=h.width&&k.y<=h.height;if(!I)return k;if(E&&cg(E.pixelPerfect,W,Y)){var h,u=1;this._is2d?(u=Y.getZoom(),h=ob(r.x,r.y,q,u)):h=ob(r.x,r.y);var N=!1,F=h.x,f=h.y,B=h.width,p=h.height,m=t.hitMaxArea,g=B*p*u*u;if(g>m){var Z=Math.sqrt(m/g);u*=Z}B*=u,p*=u,2>B&&(B=2),2>p&&(p=2),F*=u,f*=u;var n=ge(B,p),y=new yp(0,-F,-f,u,u);y.append(s.matrix),Y._drawForChecking=!0,E.transform=y;var o=J.comps;J.comps=[E],Bh(n,J,0,0,B,p,W,self),J.comps=o,delete E.transform,Y._drawForChecking=!1;try{for(var O=0,A=n.getImageData(0,0,B,p).data;O<A.length;O+=4)if(0!==A[O+3]){N=!0;break}n.restore()}catch(L){Wq=T,N=!1}k.inRect=N}else k.inRect=!0;return k}});var uh=_h.DefaultInteractor=function(B){Uo(uh,this,[B])};Sb("DefaultInteractor",Ic,{handle_mousedown:function(j){en(j);var c=this,h=c.gv,m=h.getDataAt(j);!h.setFocus(j)||h._editing||h._scrolling||(no(j)?h.handleDoubleClick(j,m):h.handleClick(j,m),!jm()&&m&&(h.isMovable(m)||h.isInteractive(m))||!h.isPannable()||!Cq(j)||ti(j)||(c._tx=h.tx(),c._ty=h.ty(),c.startDragging(j)))},handleWindowMouseUp:function(U){var T=this,u=T.gv;u._panning&&(delete u._panning,u.onPanEnded(),T.fi({kind:"endPan",event:U})),delete T._tx,delete T._ty,T.clearDragging()},handle_mousemove:function(g){var R=this,d=R.gv;R._hoverTimer&&(F(R._hoverTimer),delete R._hoverTimer),R._hoverTimer=n(function(){R.fi({kind:"hover",event:g}),F(R._hoverTimer),delete R._hoverTimer},d.getHoverDelay()||t.hoverDelay)},handle_touchmove:function(B){this.handle_mousemove(B)},handleWindowMouseMove:function(r){var L=this,J=L.gv,a=L._lastClientPoint;L.fi({kind:J._panning?"betweenPan":"beginPan",event:r}),J._panning=1,J.setTranslate(L._tx+r.clientX-a.x,L._ty+r.clientY-a.y)},handle_mousewheel:function(W){this.gv.handleScroll(W,W.wheelDelta)},handle_DOMMouseScroll:function(A){2===A.axis&&this.gv.handleScroll(A,-A.detail)},handle_keydown:function(M){this.gv.handleKeyDown(M)}});var ur=_h.SelectInteractor=function(A){Uo(ur,this,[A])};Sb("SelectInteractor",Ic,{_42:function(){var A=this,g=A.gv,z=g.getZoom(),T=A.mark,H=A.div;H||(H=A.div=Zp(),Xk(A.getView(),H));var h={};h.x=T.x*z+g.tx(),h.y=T.y*z+g.ty(),h.width=T.width*z,h.height=T.height*z,$c(H,h),this.intersects()?(H.style.border="",H.style.background=g.getRectSelectBackground()):(H.style.background="",H.style.border="1px solid "+g.getRectSelectBorderColor())},handle_mousedown:function(i){var d=this,P=d.gv;if(d._57I=T,d.pendingClickThrough=T,!(P._editing||P._scrolling||jm())){var C=P.getDataAt(i),w=P.sm();C?ti(i)?w.co(C)?w.rs(C):w.as(C):w.co(C)?C instanceof Tf&&C.isClickThroughEnabled()&&(d.pendingClickThrough=kl(i)):w.ss(C):ti(i)||!P.isPannable()?Cq(i)&&(ti(i)||w.cs(),P.isRectSelectable()&&(d.startDragging(i),P._77O=1)):Cq(i)&&(d._57I=kl(i))}},handle_mouseup:function(y){var o=this,Y=o.gv,H=o._57I;if(H&&(Bc(H,kl(y))<=1&&Y.sm().cs(),o._57I=T),o.pendingClickThrough){if(Bc(o.pendingClickThrough,kl(y))<=1){var K=Y.getDataAt(y);if(K instanceof Tf&&K.isClickThroughEnabled()){var e=Y.getDataAt(y,function(G){Y._clickThroughChecking=!0;var x=G.getParent()===K&&Y.isSelectable(G);return delete Y._clickThroughChecking,x});e&&(y.clickThrough=!0,Y.sm().ss(e))}}o.pendingClickThrough=T}},handleWindowMouseUp:function(x){this.clear(x)},handleWindowMouseMove:function(v){var d=this,Z=d.gv;d._logicalPoint=Z.lp(v),d.mark?(d.fi({kind:"betweenRectSelect",event:v}),Z.isPannable()&&d.autoScroll(v),d.redraw()):d.fi({kind:"beginRectSelect",event:v}),d.mark=ps(d._lastLogicalPoint,d._logicalPoint),d.redraw()},intersects:function(){var e=this,u=e._lastLogicalPoint,p=e._logicalPoint;return u.x>p.x||u.y>p.y},clear:function(p){var x=this,W=x.gv,e=x.mark;if(x._57I=T,x.pendingClickThrough=T,x._lastLogicalPoint){if(e){if(0!==e.width&&0!==e.height){var k=W.getDatasInRect(e,x.intersects());if(!k.isEmpty()){var O=W.sm(),i=O.toSelection();k.each(function(M){O.co(M)?i.remove(M):i.add(M)}),O.ss(i)}}Ln(x.div),delete x.div,delete x.mark,x.redraw(),x.fi({kind:"endRectSelect",event:p}),W.onRectSelectEnded()}x.clearDragging(),delete W._77O}},redraw:function(){var s=this;s._draw||(s._draw=1,n(function(){s.mark&&s._42(),delete s._draw},16))}});var Aj=_h.MoveInteractor=function(m){Uo(Aj,this,[m])};Sb("MoveInteractor",Ic,{handle_mousedown:function(h){var g=this,P=g.gv;if(Cq(h)&&!P._editing&&!P._scrolling&&!jm()){var N=P.getSelectedDataAt(h);!N||P.isInteractive(N)&&!P.isMovable(N)?P._focusData=T:(g._data=N,P.handleMouseDown&&P.handleMouseDown(h,N),g.startDragging(h),P.isMovable(N)&&(P._moving=1))}},handleWindowMouseUp:function(k){var I=this,W=I.gv;W.handleMouseUp&&W.handleMouseUp(k,I._data),I.clear(k)},handleWindowMouseMove:function($){var o=this,u=o._data,a=o.gv;if((!a._93O||!a._93O($,u))&&a._moving){o._logicalPoint||o.fi({kind:"prepareMove",event:$});var x=o._logicalPoint?"betweenMove":"beginMove",Z={kind:x,event:$},K=o._logicalPoint=a.lp($);"beginMove"!==x||o._alreadyBeginTransaction||(o._alreadyBeginTransaction=!0,a.getDataModel().beginTransaction());var p=o._calcShift(x,$),Y=p.x,W=p.y,g=o.gv.getMoveMode($,u);g&&("x"===g?W=0:"y"===g?Y=0:"xy"!==g&&(Y=W=0)),a.moveSelection(Y,W),o._lastLogicalPoint=K,o.autoScroll($),o.fi(Z)}},_calcShift:function(){var H=this,e=H._logicalPoint,L=H._lastLogicalPoint,j=e.x-L.x,h=e.y-L.y;return{x:j,y:h}},clear:function(Q){var Z=this,t=Z.gv;Z._lastLogicalPoint&&(Z._lastLogicalPoint=Z._data=t._moving=T,Z._logicalPoint&&(Z.fi({kind:"endMove",event:Q}),t.onMoveEnded()),Z.clearDragging()),Z._alreadyBeginTransaction&&(Z._alreadyBeginTransaction=!1,t.getDataModel().endTransaction())}});var cb=_h.ScrollBarInteractor=function(U){Uo(cb,this,[U])};Sb("ScrollBarInteractor",Ic,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(o){var x=this.gv.getViewRect();return this._41o()&&(x.x+x.width-this.gv.lp(o).x)*this.gv.getZoom()<Vn},isH:function(g){var u=this.gv.getViewRect();return this._40o()&&(u.y+u.height-this.gv.lp(g).y)*this.gv.getZoom()<Vn},handle_mousemove:function(y){this.handle_touchmove(y)},handle_touchmove:function(B){if(!_e&&Cq(B)&&this.gv.isScrollBarVisible()){var F=this,t=F.isV(B),M=F.isH(B);(t||M)&&F.gv.showScrollBar(),F.gv._scrolling=t||M}},handleWindowMouseUp:function(q){this.handleWindowTouchEnd(q)},handleWindowTouchEnd:function(H){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=T,this.fi({kind:"endScroll",event:H})},handle_mousedown:function(O){this.handle_touchstart(O)},handle_touchstart:function(y){var T=this;if(T.gv.setFocus(y),en(y),T.handle_touchmove(y),!(id(y)>1)&&T.gv._scrolling&&T.gv.isScrollBarVisible()){T._cp=kl(y),T._tx=T.gv.tx(),T._ty=T.gv.ty();var i=T.isV(y);T._state=i?"vScroll":"hScroll",El(T,y),T.fi({kind:"beginScroll",event:y})}},handleWindowMouseMove:function(h){this.handleWindowTouchMove(h)},handleWindowTouchMove:function(o){var z=kl(o),y=this.gv.getViewRect(),S=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-z.y)*S.height/y.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-z.x)*S.width/y.width),this.fi({kind:"betweenScroll",event:o})
}});var Ch=_h.TouchInteractor=function(k,j){j=j||{},j.selectable===q&&(j.selectable=!0),j.movable===q&&(j.movable=!0),j.pannable===q&&(j.pannable=!0),j.pinchable===q&&(j.pinchable=!0),j.editable===q&&(j.editable=!0),this.params=j,Uo(Ch,this,[k])};Sb("TouchInteractor",Ic,{ms_edit:1,setUp:function(){var j=this;Ch.superClass.setUp.call(j),tb&&j.params.editable&&j.gv.setEditInteractor(j)},tearDown:function(){var L=this;Ch.superClass.tearDown.call(L),tb&&L.params.editable&&L.gv.setEditInteractor(T)},clear:function(k){var F=this,Y=F.gv;Y._moving&&(F.fi({kind:"endMove",event:k}),delete Y._moving,Y.onMoveEnded(),Y.dm().endTransaction()),Y._panning&&(F.fi({kind:"endPan",event:k}),delete Y._panning,Y.onPanEnded()),Y._pinching&&(F.fi({kind:"endPinch",event:k}),delete Y._pinching,Y.onPinchEnded()),Y._editing&&(F._46O(k),F._77I=F._node=F._edge=F._shape=F._rect=F._89I=F._index=Y._editing=T),F._moving=F._panning=F._pinching=F._editing=F._57I=F._data=F._beginHistory=T,F.clearDragging()},handle_touchstart:function(t){var u=this;if(!u.gv._editing){en(t),u._57I=T;var L=u.params,E=u.gv,G=E.sm(),U=E.getDataAt(t),v=id(t);if(1===v){if(no(t))return E.handleDoubleClick(t,U),void 0;E.handleClick(t,U),U&&(E.handleMouseDown&&E.handleMouseDown(t,U),u._data=U),L.selectable||(U=T),U?(G.co(U)||G.ss(U),L.editable&&E.isEditable(U)&&u._79I(t,U,!0)?(u._editing=1,u.startDragging(t)):L.movable&&E.isMovable(U)&&(u._moving=1,u.startDragging(t))):(u._57I=kl(t),L.pannable&&E.isPannable()&&(u._panning=1,u.startDragging(t),u._translate={x:E.tx(),y:E.ty()}))}else if(L.pinchable&&2===v){u._pinching=1,u.startDragging(t);var a=E.getView(),f=E.getZoom(),$=a.getBoundingClientRect(),I=t.touches[0],i=t.touches[1],K={x:(I.clientX+i.clientX)/2-$.left,y:(I.clientY+i.clientY)/2-$.top};K.x-=E.tx(),K.y-=E.ty(),K.x/=f,K.y/=f,u._p=K,u._d=sd(t)}}},handle_touchend:function(i){var b=this,M=b.gv,D=b._57I,R=b._data;D&&(Bc(D,kl(i))<=1&&M.sm().cs(),b._57I=T),R&&M.handleMouseUp&&M.handleMouseUp(i,R)},handleWindowTouchEnd:function(j){this.clear(j)},handleWindowTouchMove:function(J){var S=this,r=S.gv,G=id(J);if(1===G){if(S._editing&&(S._beginHistory||(S._beginHistory=1,r.dm().beginTransaction()),r._editing=1,S._78I(J)),S._moving)S._beginHistory||(S._beginHistory=1,r.dm().beginTransaction()),S.handleMove(J);else if(S._panning){var I=kl(J);r.setTranslate(S._translate.x+I.x-S._lastClientPoint.x,S._translate.y+I.y-S._lastClientPoint.y),S.fi({kind:r._panning?"betweenPan":"beginPan",event:J}),r._panning=1}}else if(2===G&&S._pinching){var Q=sd(J);r.handlePinch(S._p,Q,S._d),S._d=Q,S.fi({kind:r._pinching?"betweenPinch":"beginPinch",event:J}),r._pinching=1}},handleMove:function(Q){var e=this,C=e.gv,S=C.lp(Q);C._93O&&C._93O(Q,e._data)||(C.moveSelection(S.x-e._lastLogicalPoint.x,S.y-e._lastLogicalPoint.y),e._lastLogicalPoint=S,e.autoScroll(Q),e.fi({kind:C._moving?"betweenMove":"beginMove",event:Q}),C._moving=1)}});var b=x.ht,zp=b.graph._editor={Math:b.Math,Guide:{}};zp.getStyle=function(c){var L,o=zp.StyleMap;return o&&(L=o[c],L!==q)?L:zp.DefaultStyleMap[c]},zp.setStyle=function(X,h){var u=zp.StyleMap;u||(u=zp.StyleMap={}),u[X]=h},zp.inEdit=function(H){return H._inXEdit===!0},zp.startEdit=function(I){I._inXEdit=!0,zp.Inject.doInject(I)},zp._46O=function(Y){Y._inXEdit=!1,zp.Inject.undoInject(Y)},zp.toScreenPosition=function(O,i){var X=O.tx(),x=O.ty(),R=O._zoom;return new zp.Math.Vector2(i.x*R+X,i.y*R+x)},zp.checkHit=function($,x,r){return $.distanceTo(x)<r?!0:!1},zp.toWorldPosition=function(X,E){var t=X.tx(),C=X.ty(),M=X._zoom;return{x:(E.x-t)/M,y:(E.y-C)/M}},zp.setAntialias=function(K,p){for(var Q,P=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],H=0,s=P.length;s>H&&(Q=P[H],!(Q in K));H++);K[Q],K[Q]=p},zp.getTargetCornersOnScreen=function(X,e){if(!e)return null;var U,f=[];if(iq(e,X)){var j=xh(X,e);U=[{x:j.x,y:j.y},{x:j.x+j.width,y:j.y},{x:j.x+j.width,y:j.y+j.height},{x:j.x,y:j.y+j.height}]}else{if(!e.getCorners)return null;U=e.getCorners()}return U.forEach(function(S){var l=zp.toScreenPosition(X,S);f.push(l.x,l.y)}),f},zp.log=function(){};var Rr=zp.Inject={_modules:[]};Rr.registAsModule=function(v,T){var X={},B={};for(var H in v){var p=T.prototype[H];X[H]=p}v.getBackup=function(J){return X[J]},v.getBackups=function(){return X},B.doInject=function(){for(var I in v)"getBackup"!==I&&(T.prototype[I]=v[I])},B.undoInject=function(){for(var M in v)"getBackup"!==M&&(T.prototype[M]=X[M])},Rr._modules.push(B)},Rr.doInject=function(y){for(var h,i=Rr._modules,B=0,F=i.length;F>B;B++)h=i[B],h.doInject(y)},Rr.undoInject=function(h){for(var k,G=Rr._modules,X=0,K=G.length;K>X;X++)k=G[X],k.undoInject(h)};var Ic=b.graph.EditInteractor=function(E){var V=this,W=R.createElement("canvas");W.className="editCanvas",W.style.position="absolute",V._styleMap={},V._canvas=W,V._context=W.getContext("2d"),Ic.superClass.constructor.call(V,E),zp.setAntialias(V._context,!1),V._subModules=[new zp.Anchor(V),new zp.RotateX(V),new zp.Rect(V),new zp.Curve(V),new zp.MoveHelper(V)],V._gridGuide=new zp.Guide.Grid(V),V._rectGuide=new zp.Guide.Rect(V)},gi=Ic;b.Default.def(Ic,b.graph.Interactor,{ms_edit:1,ms_fire:1}),w.defineProperties(Ic.prototype,{editDetail:{get:function(){var e=!!this._editDetail;return e},set:function(x){var p=this,P=p._editDetail;P!==x&&(p._editDetail=x,p.gv._editing=x,p.fp("editDetail",P,x),p.fp("pointsEditingMode",P,x),p.fi({kind:x?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function($){(!this._editDetail||$)&&(this.gv._editing=$,$||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(w){this._editing=w,this.gvEditing=w}},pointsEditingMode:{get:function(){return this.editDetail},set:function(y){var z=this;z.editDetail!==y&&(y?z._tryEnterEditDetailMode():z._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var x=this._gridEnabled;if(!x)return!1;var I=this.gv;return I?!0:!0},set:function(K){K!==this._gridEnabled&&(this._gridEnabled=K,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function($){$!==this._agEnabled&&(this._agEnabled=$,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}}}),Ic.prototype.getSubModule=function(S){var I,b,d,h=this._subModules;for(b=0,d=h.length;d>b;b++)if(I=h[b],I.catalog===S)return I},Ic.prototype.invokeSubModule=function(Y,w){var r=this,Q=r._subModules;if(Q)for(var f,n,l,R=Array.prototype.slice.call(arguments,2),z=0,H=Q.length;H>z;z++)if(f=Q[z],n=f[Y],n&&(l=n.apply(f,R),l!=q&&w))return f},Ic.prototype.invokeSubModuleInverse=function(E,M){var x=this,f=x._subModules;if(f)for(var v,X,a,n=Array.prototype.slice.call(arguments,2),S=f.length-1;S>=0;S--)if(v=f[S],X=v[E],X&&(a=X.apply(v,n),a!=q&&M))return v},Ic.prototype.setUp=function(){zp.log("setUp");var r=this,T=r.gv,Q=T.getView(),h=r._canvas;Ic.superClass.setUp.call(r),T.setEditInteractor(r),T._79O?Q.insertBefore(h,T._79O):Q.appendChild(h),zp.startEdit(T),r.invokeSubModule("setUp"),T.dm().mm(r._onDataModelChanged,r),T.dm().md(r._onDataPropertyChanged,r)},Ic.prototype.tearDown=function(){zp.log("tearDown");var E=this,d=E.gv,G=d.getView();E._resetCustomCursorStyle(),Ic.superClass.tearDown.call(E),d.dm().umm(E._onDataModelChanged,E),d.dm().umd(E._onDataPropertyChanged,E),d.setEditInteractor(null),G.removeChild(E._canvas),E._drawTimer&&(F(E._drawTimer),E._drawTimer=null),zp._46O(d),E.invokeSubModule("tearDown")},Ic.prototype._onDataModelChanged=function(G){var D=this;("clear"===G.kind||"remove"===G.kind&&D.editDetail&&G.data===D.getSubModule("Curve").target)&&(D.editDetail=!1,D._42())},Ic.prototype._onDataPropertyChanged=function(K){var q=this;if(q.editDetail){var m=q.getSubModule("Curve"),t=K.data;t===m.target&&(t._writing||m._handleDataChanged())}},Ic.prototype.clear=function(){zp.log("clear")},Ic.prototype.redraw=function(){this._42()},Ic.prototype._42=function(){var g=this;g._drawTimer||(g._drawTimer=n(function(){g._drawTimer=null,g.drawImpl()},0))},Ic.prototype.drawImpl=function(){var s;for(s in{_42:!0})break;return function(){var T=this,k=T._canvas,q=T.gv,v=q.getWidth(),p=q.getHeight(),Q=T._context,h=b.Default.getInternal();(k.width!==v||k.height!==p)&&h.setCanvas(k,v,p),Q.clearRect(0,0,k.width,k.height);var c=T._getValidSelection();Q.save();var x=b.Default.devicePixelRatio;Q.scale(x,x),T._gridGuide._42(),T.invokeSubModuleInverse(s,!1,Q,q,c),T._rectGuide._42(),Q.restore()}}(),Ic.prototype._getValidSelection=function(){var F=this,y=F.gv,X=y.sm().getSelection(),G=[];return X.each(function(F){y.isVisible(F)&&y.isEditable(F)&&G.push(F)}),G},Ic.prototype.handle_touchmove=function(d){return this.handle_mousemove(d)},Ic.prototype.handle_mousemove=function(j){if(!b.Default.isDragging()){var Q=this;(Q.editDetail||!jm())&&(Q.gvEditing=!1,Q._checkEdit(j)&&(Q.gvEditing=!0))}},Ic.prototype.handle_touchstart=function(o){return this.handle_mousedown(o)},Ic.prototype.handle_mousedown=function(k){en(k);var v=this;if(v.editDetail||!jm()){if(no(k)&&!k.clickThrough){if(v.editDetail){if(v._tryQuitEditDetailMode(k))return}else if(v._tryEnterEditDetailMode())return;v.gv.dm().beginTransaction();var X=v.invokeSubModule("handleDoubleClick",!0,k);if(v.gv.dm().endTransaction(),X)return}var u=v._checkEdit(k);u&&(v._downPosition=v._getLogicalPoint(k),v.gv.dm().beginTransaction(),u.startEdit(v,k),v.editing=!0)}},Ic.prototype._checkEdit=function(X){var O=this,K=O.gv,h=O._getLogicalPoint(X),$=O.invokeSubModule("check",!0,K,X,h)||null;return O._editMod=$,$},Ic.prototype.handleWindowTouchMove=function(V){return this.handleWindowMouseMove(V)},Ic.prototype.handleWindowMouseMove=function(S){var R=this,H=R._downPosition;if(H){var Z=R._getLogicalPoint(S);if(Z.distanceTo(H)<R.getStyle("moveSensitivity"))return;delete R._downPosition}var U=R._editMod;U&&U.handleEdit(R.gv,S)},Ic.prototype._getLogicalPoint=function(e){var w=this,P=b.Default.getLogicalPoint(e,w._canvas);return new zp.Math.Vector2(P)},Ic.prototype.handleWindowTouchEnd=function(C){return this.handleWindowMouseUp(C)},Ic.prototype.handleWindowMouseUp=function(){var p;for(p in{_46O:!0})break;return function(J){var F=this;F.editing=!1,F.setCursor("default"),F.invokeSubModule(p,!1,J),F._42(),F.gv.dm().endTransaction()}}(),Ic.prototype.handle_mousewheel=function(h){var C=this;en(h),C.invokeSubModule("preHandleScroll",!0)||C.gv.handleScroll(h,h.wheelDelta)},Ic.prototype.handleDelete=function(){var g=this;if(!g.editDetail){g.gv.dm().beginTransaction();var x=g.invokeSubModule("handleNormalStateDelete",!0);return g.gv.dm().endTransaction(),x||g.gv.removeSelection(),void 0}g.gv.dm().beginTransaction(),g.invokeSubModule("handleDelete",!0),g.gv.dm().endTransaction(),g._42()},Ic.prototype.handle_keydown=function(H){var q=this;if((H.metaKey||H.ctrlKey)&&q._42(),jm(H)&&!q.editing)return q.gvEditing=!1,q.setCursor("default"),q._42(),void 0;var $=op(H);return q.editDetail?(($||qi(H))&&(q.editDetail=!1,q._42()),q.gv.dm().beginTransaction(),q.invokeSubModule("handle_keydown",!0,H),q.gv.dm().endTransaction(),void 0):(q.gv.dm().beginTransaction(),q.invokeSubModule("handleNormalStateKeyDown",!0,H),q.gv.dm().endTransaction(),$&&q._tryEnterEditDetailMode(),void 0)},Ic.prototype.handle_keyup=function(h){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,h),this.gv.dm().endTransaction()},Ic.prototype._tryEnterEditDetailMode=function(){var s=this;return!s.editDetail&&s.invokeSubModule("canEnterEditDetailMode",!0)&&1===s._getValidSelection().length?(s.editDetail=!0,s._42(),!0):void 0},Ic.prototype._tryQuitEditDetailMode=function(G){var w=this;if(w.editDetail){var r=w.gv,f=w.getSubModule("Curve").target;return G&&r.getDataAt(G)===f?void 0:(w.editDetail=!1,w._42(),!0)}},Ic.prototype.setStyle=function(T,x,_){var F=this;_?zp.setStyle(T,x):F._styleMap[T]=x,F.fp("styleChanged",null,{key:T,value:x,base:_}),F._42()},Ic.prototype.getStyle=function(i){var N=this,r=N._styleMap[i];return r!==q?r:zp.getStyle(i)},Ic.prototype.setCursor=function(m){this._resetCustomCursorStyle(),b.graph.EditInteractor.superClass.setCursor.call(this,m)},Ic.prototype._resetCustomCursorStyle=function(){var X=this;if(X._customStyle){var M=this.gv.getView();M.classList&&M.classList.remove&&M.classList.remove(X._customStyle),X._customStyle=null}},Ic.prototype._setRotateCursor=function(z){var l=this,u=l._cursorFactory;u||(u=l._cursorFactory=new zp.CursorFactory(l));var M=u.getRotateCursor(z),y=l.gv.getView();l._resetCustomCursorStyle(),l._customStyle=M,y.classList&&y.classList.add&&y.classList.add(M)};var Ye=zp.Group=function(N){var x=this;x._entities=N,x._64O=0,x._position={x:0,y:0},x._scale={x:1,y:1},x._anchor={x:.5,y:.5},x._anchor2={x:.5,y:.5}};Ye.prototype={},Ye.prototype.constructor=Ye;var fl=null;Ye.findOrCreateGroup=function(x){if(fl&&fl.checkIsMe(x))return fl;var g=new zp.Group(x);return g.getKeyOb()?(fl=g,g):void 0},Ye.prototype.checkIsMe=function(v){var z=this._entities;if(z.length!==v.length)return!1;var M,G={},s=v.length;for(M=0;s>M;M++)G[v[M]._id]=!0;for(M=0;s>M;M++)if(!G[z[M]._id])return!1;return!0},Ye.prototype.getRotation=function(){return this._64O},Ye.prototype.getPosition=function(){return this._position},Ye.prototype.getAnchor=function(){return this._anchor},Ye.prototype.getWidth=function(){return this._width},Ye.prototype.getScale=function(){return this._scale},Ye.prototype.getSize=function(){return{width:this._width,height:this._height}},Ye.prototype.getHeight=function(){return this._height},Ye.prototype.getKeyOb=function(){for(var P=this._entities,G=P.length-1;G>=0;G--){var V=P[G];if(this.isNode(V))return V}},Ye.prototype.getAnchor2=function(){var N=this,m=N.rotateCenter;if(m)return m;var p=N.getKeyOb();if(!p)return N._anchor;var Y=N._anchor2,X=p.getMatrix();return X.tf({x:p.getWidth()*(Y.x-p.getAnchor().x),y:p.getHeight()*(Y.y-p.getAnchor().y)})},Ye.prototype.setAnchor2=function(j,z){var Y=this,Z=Y.getKeyOb();if(Z){var B,s=Z.getMatrix();B="number"==typeof j?{x:j,y:z}:j;var k=s.tfi(B);Y._anchor2={x:Z.getAnchor().x+k.x/Z.getWidth(),y:Z.getAnchor().y+k.y/Z.getHeight()}}},Ye.prototype.setRotation=function(){},Ye.prototype.beginRotate=function(f){this.rotateCenter=f.pos,this.rotateMode=f.groupRotateMode},Ye.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},Ye.prototype.addRotation=function(w,v){return"batch"===v?this._addRotationInBatchMode(w):"block"===v?this._addRotationInBlockMode(w):void 0},Ye.prototype._addRotationInBlockMode=function(q){var e=this,i=e.rotateCenter||e.getPosition();e._entities.forEach(function(n){if(e.isNode(n)){var S=n.getMatrix();S.translate(-i.x,-i.y),S.rotate(q),S.translate(i.x,i.y);var Z=Math.sign(n.getScale().x);n.setRotation(J(S.b*Z,S.a*Z)),n.setPosition(S.tx,S.ty)}})},Ye.prototype._addRotationInBatchMode=function(b){var L=this,s=L._anchor2;L._entities.forEach(function(Z){if(L.isNode(Z)){var G=Z.getAnchor(),m=Z.getMatrix(),q=m.tf({x:Z.getWidth()*(s.x-G.x),y:Z.getHeight()*(s.y-G.y)}),_=new zp.Math.Matrix2d;_.set(m.a,m.b,m.c,m.d,m.tx,m.ty),_.translate(-q.x,-q.y),_.rotate(b),_.translate(q.x,q.y);var Q=Math.sign(Z.getScale().x);Z.setRotation(J(_.b*Q,_.a*Q)),Z.setPosition(_.tx,_.ty)}})},Ye.prototype.setPosition=function(e){var x,N,B,R,c=this,q=c._position,E=e.x-q.x,f=e.y-q.y,d=c._entities;for(N=0,B=d.length;B>N;N++)x=d[N],uq(x)&&(R=x.getPosition(),x.setPosition(R.x+E,R.y+f));c._position=e},Ye.prototype.setScale=function(Y,r){var V=this,a=Y/V._scale.x,g=r/V._scale.y;V._adjustChildScaleOrSize(a,g,"size"),V._scale={x:Y,y:r}},Ye.prototype.getRect=function(){var $=this,Q=$._position,B=$._width,n=$._height;return{x:Q.x-B/2,y:Q.y-n/2,width:B,height:n}},Ye.prototype.setSize=function(o,G){var K=this,o=Math.max(1,o),G=Math.max(1,G),g=o/K._width,x=G/K._height;K._adjustChildScaleOrSize(g,x,"size"),K._width=o,K._height=G},Ye.prototype._adjustChildScaleOrSize=function(t,c,k){var m,w,U,D,i,p,d,$,h,W,x,R,N,E,Z=this,g=Z._position,T=Z._entities,S=new zp.Math.Matrix2d;for(w=0,U=T.length;U>w;w++)if(m=T[w],Z.isNode(m)){if(D=m.getPosition(),i=m.getRotation(),p=m.getWidth(),d=m.getHeight(),$=m.getScale(),x=$.x*p,R=$.y*d,S.identity().scale(x,R).rotate(i).translate(D.x,D.y).translate(-g.x,-g.y).rotate(-Z._64O),i=J(S.b*Math.sign(x),S.a*Math.sign(x)),S.scale(t,c),h=Math.cos(i),W=Math.sin(i),Math.abs(h)<.001?(N=S.b/W,E=-S.c/W):(N=S.a/h,E=S.d/h),"scale"===k)m.setScale(N/p,E/d);else if("size"===k){var M=N/$.x,G=E/$.y;m.setScale(wg(N)*Math.abs($.x),wg(E)*Math.abs($.y)),m.setSize(Math.max(.1,Math.abs(M)),Math.max(.1,Math.abs(G)))}S.rotate(Z._64O).translate(g.x,g.y),m.setPosition(S.tx,S.ty)}},Ye.prototype.getMatrix=function(){var r=this,N=r._position,i=b.Default.getInternal(),T=r._scale;return new i.Mat(r._64O,N.x,N.y,T.x,T.y)},Ye.prototype.toGlobal=function(F){return this.getMatrix().tf(F)},Ye.prototype.getCorners=function(){var R=this,G=R._width,T=R._height,q=R._anchor,_=-G*q.x,P=-T*q.y,A=R.getMatrix();return[A.tf(_,P),A.tf(_,P+T),A.tf(_+G,P+T),A.tf(_+G,P)]},Ye.prototype.calcInfo=function(){var P,k,r,o,D,c,j=this,S=[],w=j._entities,C=j._64O;for(o=0,D=w.length;D>o;o++)c=w[o],j.isNode(c)&&c.getCorners&&S.push.apply(S,c.getCorners());if(S.length){var O=Math.cos(-C),R=Math.sin(-C),E=1/0,X=-1/0,v=1/0,T=-1/0;for(o=0,D=S.length;D>o;o++)r=S[o],P=r.x,k=r.y,r.x=O*P-R*k,r.y=R*P+O*k,E=Math.min(E,r.x),X=Math.max(X,r.x),v=Math.min(v,r.y),T=Math.max(T,r.y);j._width=(X-E)/j._scale.x,j._height=(T-v)/j._scale.y,O=Math.cos(C),R=Math.sin(C);var i=j._anchor;P=E+(X-E)*i.x,k=v+(T-v)*i.y,j._position={x:O*P-R*k,y:R*P+O*k}}},Ye.prototype.isNode=function(k){return uq(k)?iq(k)?!1:!0:!1},Ye.prototype._42=function(j,u,Y){var H,D,h,r,f,F,q,T,N=this,d=N._entities,W=N.rotateMode;for("batch"===W&&(T=N.getKeyOb()),H=0,D=d.length;D>H;H++)h=d[H],N.isNode(h)&&(F=h.getRect(),r=zp.toScreenPosition(Y,{x:F.x,y:F.y}),f=zp.toScreenPosition(Y,{x:F.x+F.width,y:F.y+F.height}),q={min:r,max:f},h===T&&(q.isKeyOb=!0),zp.Icons.DrawIcon(j,u,zp.Icons.GroupSubEntityRect,q))};var Jc=zp.CurveActiving=function(Y,O){this._curve=Y,this._interactor=Y._interactor;for(var G in O)this[G]=O[G]};Jc.prototype={},Jc.prototype.constructor=Jc,w.defineProperties(Jc.prototype,{point:{get:function(){return this._point},set:function(d){var x=this;x._point=d,x.editingCtrl||x._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(K){var U=this;U._pairs=K,U.editingCtrl&&U._firePointChange()}}}),Jc.prototype._firePointChange=function(){var J=this,K=J.getCurrentEditingPoint();if(!K)return v.fi({kind:"selectPoint"}),void 0;var v=J._interactor,V=this._curve.target;if(V){var h=zp.getDataMatrix(V).invert(),U=K.e;K=h.apply(zp.toWorldPosition(v.gv,K)),K.e=U;var S=J._lastFirePoint;S&&Math.abs(K.x-S.x)<1e-5&&Math.abs(K.y-S.y)<1e-5&&(K.e==q&&S.e==q||Math.abs(K.e-S.e)<1e-5)||(J._lastFirePoint=K,v.fi({kind:"selectPoint",x:K.x,y:K.y,e:K.e}))}},Jc.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},Jc.prototype.getCurrentEditingPoint=function(){var Z=this,P=Z.editingCtrl;if(P){var V=Z.pairs;if(V){var s=V[P.pairId],$=s[P.type];if($)return $}}return Z._point};var fg=zp.CursorFactory=function(B){var l=this;l._interactor=B,l._rotateCursorStyles={}};fg.prototype={},fg.prototype.constructor=fg,fg.prototype.getRotateCursor=function(s){var H=this;0>s&&(s+=2*Math.PI);var f=H._interactor,x=f.getStyle("rotateCursorSize"),Y=f.getStyle("rotateCursorRound"),o=Math.round(180*(s/Math.PI)/Y);o*Y>=360&&(o=0);var I=H._rotateCursorStyles,M="htCustomRotateStyle_"+x+"_"+Y+"_"+o;return I[M]||(H._produceRotateCursor(M,x,Y,o),I[M]=!0),M},fg.prototype._produceRotateCursor=function(e,Q,N,D){var d=this;d._interactor;var Z=d._canvas;Z||(Z=d._canvas=R.createElement("canvas")),Z.width=Z.height=Q*devicePixelRatio,Z.style.width=Z.style.height=Q+" px";var f=Z.getContext("2d");zp.setAntialias(f,!1),f.scale(devicePixelRatio,devicePixelRatio);var X,Y,t,h,$,g=Math.round(Q/2),P=""+g+" "+g+",auto !important;";X=Math.PI/180*D*N,f.clearRect(0,0,Q,Q),f.save(),f.scale(Q/32,Q/32),f.translate(16,16),f.rotate(X+Math.PI/2),f.beginPath(),f.moveTo(-8,0),f.lineTo(-8,3),f.lineTo(-5,3),f.moveTo(8,0),f.lineTo(8,3),f.lineTo(5,3),f.moveTo(-8,3),f.quadraticCurveTo(0,-6,8,3),f.restore(),f.strokeStyle="white",f.lineWidth=4,f.stroke(),f.strokeStyle="black",f.lineWidth=2,f.stroke(),Y=JSON.stringify(Z.toDataURL()),h="cursor:url("+Y+")"+P,1!==devicePixelRatio&&(t='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+Q+'px" height="'+Q+'px"><image xlink:href='+Y+' width="'+Q+'" height="'+Q+'"/></svg>',h+="cursor:url(data:image/svg+xml;base64,"+btoa(t)+")"+P,h+="cursor:-webkit-image-set(url("+Y+")"+devicePixelRatio+"x,url("+Y+")1x)"+P),$=R.createElement("style"),$.textContent="body."+e+" *, ."+e+"{"+h+"}",R.head.appendChild($)};var Vk=zp.Guide.Grid=function(M){var c=this;c._interactor=M,c._alignmentGuideId=0,c._xAlignmentGuide=[],c._yAlignmentGuide=[]};Vk.prototype={},Vk.prototype.constructor=Vk,w.defineProperties(Vk.prototype,{gridBlockSize:{get:function(){var g=this;return g._gridBlockSize||g._interactor.getStyle("gridBlockSize")},set:function(X){this._gridBlockSize=X,this._interactor._42()}},gridThickLinesEvery:{get:function(){var X=this;return X._gridThickLinesEvery||X._interactor.getStyle("gridThickLinesEvery")},set:function(M){this._gridThickLinesEvery=M,this._interactor._42()}},gridEnabled:{get:function(){var p=this,X=p._interactor;return X.gridEnabled&&p.isValidGrid()}}}),Vk.prototype._42=function(){var k=this,h=k._interactor;k.gridEnabled&&k.drawGrid(),h.alignmentGuideEnabled&&k.drawAlignmentGuide()},Vk.prototype.makeMatrix=function(){var S=this,K=S._interactor.getStyle("gridAngle"),Y=S._interactor.getStyle("gridRotation"),u=new zp.Math.Matrix2d,p=Math.sin(K),D=Math.cos(K);return u.set(1,0,D,p,0,0),u.rotate(Y),u},Vk.prototype.isValidGrid=function(){var q=this,f=Math.PI,X=q._interactor,h=X.gv;if(h._zoom<X.getStyle("gridZoomThreshold"))return!1;var R=X.getStyle("gridAngle"),P=Math.abs(180*(R%f/f)),v=1-1e-8;return v>P||P>180-v?!1:!0},Vk.prototype.drawAlignmentGuide=function(){var M=this,r=M._interactor,P=r.gv,G=r._canvas,t=r._context,j=G.width,c=G.height,O=P.tx(),u=P.ty(),Q=P._zoom;t.beginPath(),t.strokeStyle=r.getStyle("gridAlignmentGuideColor"),t.lineWidth=1,M._xAlignmentGuide.forEach(function(I){var x=I.p*Q+O;t.moveTo(x,0),t.lineTo(x,c)}),M._yAlignmentGuide.forEach(function(q){var n=q.p*Q+u;t.moveTo(0,n),t.lineTo(j,n)}),t.stroke()},Vk.prototype.drawGrid=function(){function C(h,e,G,D){var u=zp.toScreenPosition(l,k.apply({x:h,y:e})),Y=zp.toScreenPosition(l,k.apply({x:G,y:D}));U.moveTo(u.x,u.y),U.lineTo(Y.x,Y.y)}var r=this,D=r._interactor,J=r.gridBlockSize,g=r.gridThickLinesEvery,T=D.getStyle("gridThickColor"),O=D.getStyle("gridLightColor"),l=D.gv,A=D._canvas,U=D._context,w=A.width,W=A.height,k=r.makeMatrix(),N=k.applyInverse(zp.toWorldPosition(l,{x:0,y:0})),Y=k.applyInverse(zp.toWorldPosition(l,{x:w,y:0})),d=k.applyInverse(zp.toWorldPosition(l,{x:0,y:W})),s=k.applyInverse(zp.toWorldPosition(l,{x:w,y:W})),c=Math.min(N.x,Y.x,d.x,s.x),e=Math.max(N.x,Y.x,d.x,s.x),I=Math.min(N.y,Y.y,d.y,s.y),H=Math.max(N.y,Y.y,d.y,s.y);w=e-c,W=H-I;var t=Math.ceil(c/J),m=Math.floor(e/J),E=Math.ceil(I/J),$=Math.floor(H/J);l.tx(),l.ty(),l._zoom;var Z,z,F;for(U.save(),U.lineWidth=1,U.beginPath(),U.strokeStyle=T,F=Math.ceil(t/g)*g;m>=F;F+=g)Z=F*J,C(Z,I,Z,H);for(F=Math.ceil(E/g)*g;$>=F;F+=g)z=F*J,C(c,z,e,z);for(U.stroke(),U.beginPath(),U.strokeStyle=O,F=t;m>=F;F++)0!==F%g&&(Z=F*J,C(Z,I,Z,H));for(F=E;$>=F;F++)0!==F%g&&(z=F*J,C(c,z,e,z));U.stroke(),U.restore()},Vk.prototype.getAlignmentGuides=function(){var Z=this;return{x:Z._xAlignmentGuide,y:Z._yAlignmentGuide}},Vk.prototype.addAlignmentGuide=function(L,m,u){var c=this,U="x"===L?c._xAlignmentGuide:c._yAlignmentGuide,u=u?u:++c._alignmentGuideId,M={p:m,id:u};if(U.length){var j=c._findClosestAlignmentGuide(M.p,U);j.dis<0?U.splice(j.index+1,0,M):U.splice(j.index,0,M)}else U.push(M);return c._interactor._42(),u},Vk.prototype.findClosest=function(V,l,C){var H=this,_=H._interactor,K=_.gv;C&&(V=zp.toWorldPosition(K,V));var n,f,P,k=1/0,t=1/0,h=V.x,g=V.y;if(H.gridEnabled){var p=H.gridBlockSize,w=H.makeMatrix(),c=w.applyInverse(V);c=w.apply({x:Math.round(c.x/p)*p,y:Math.round(c.y/p)*p}),k=c.x-h,t=c.y-g,P=!0}if(_.alignmentGuideEnabled&&(n=H._findClosestAlignmentGuide(h,H._xAlignmentGuide).dis,f=H._findClosestAlignmentGuide(g,H._yAlignmentGuide).dis,Math.abs(n)<Math.abs(k)&&(k=n,P=!0),Math.abs(f)<Math.abs(t)&&(t=f,P=!0)),P){P=!1;var y=K._zoom,J=_.getStyle("smartGuideSensitivity")/y,b={};if(Math.abs(k)<J&&"y"!==l&&(b.x=C?k*y:k,P=!0),Math.abs(t)<J&&"x"!==l&&(b.y=C?t*y:t,P=!0),P)return b}},Vk.prototype._findClosestAlignmentGuide=function(P,X){if(!X.length)return{dis:1/0};for(var D,b=0,A=X.length-1;A-b>1;)D=Math.floor((b+A)/2),X[D].p<P?b=D:A=D;var R=X[b].p-P,w=X[A].p-P;return Math.abs(R)<=Math.abs(w)?{line:X[b],dis:R,index:b}:{line:X[A],dis:w,index:A}},Vk.prototype.removeAllAlignmentGuide=function(a){var f=this;"y"!==a&&(f._xAlignmentGuide=[]),"x"!==a&&(f._yAlignmentGuide=[]),f._interactor._42()},Vk.prototype.removeAlignmentGuide=function(J){for(var b,R,Q,k=this,F=k._xAlignmentGuide,q=0;2>q;q++)for(F=0===q?k._xAlignmentGuide:k._yAlignmentGuide,b=0,R=F.length;R>b;b++)if(Q=F[b],Q.id===J)return F.splice(b,1),k._interactor._42(),{axis:0===q?"x":"y",position:Q.p};return!1},Vk.prototype.adjustAlignmentGuide=function(x,Z){var R=this,m=R.removeAlignmentGuide(x);return m?(R.addAlignmentGuide(m.axis,Z,x),!0):!1};var Ne=zp.Guide.Rect=function(Z){var n=this;n._interactor=Z};Ne.prototype={},Ne.prototype.constructor=Ne,Ne.prototype.gatherRects=function(){var X,h,_,q,k=this,a=k._interactor.gv,e=[],Y=[],l={x:e,y:Y},A={},I=a.getDataModel(),r=I.a("width"),V=I.a("height");r&&V&&(X=0,h=0,_=r,q=V,e.push({node:I,type:0,p:X},{node:I,type:1,p:X+_/2},{node:I,type:2,p:X+_}),Y.push({node:I,type:0,p:h},{node:I,type:1,p:h+q/2},{node:I,type:2,p:h+q}),A[I._id||0]={x:X,y:h,width:_,height:q}),I.each(function(R){if(uq(R)&&!a.isSelected(R)&&a.isVisible(R)){var B=!1;if(a.sm().getSelection().each(function(H){B||(R.isHostOn(H)?B=!0:R.isDescendantOf(H)&&(B=!0))}),!B){var W=R.getRect();X=W.x,h=W.y,_=W.width,q=W.height,e.push({node:R,type:0,p:X},{node:R,type:1,p:X+_/2},{node:R,type:2,p:X+_}),Y.push({node:R,type:0,p:h},{node:R,type:1,p:h+q/2},{node:R,type:2,p:h+q}),A[R._id]=W}}}),e.sort(function(e,L){return e.p-L.p}),Y.sort(function(o,F){return o.p-F.p}),k._grid=l,k._87I=A},Ne.prototype.gatherLines=function(o,Q,E){var H,r,p,f,n,Z,I,h,i,S,u,m,A=this,c=[A.findClosest({x:o.x,y:o.y},Q),A.findClosest({x:o.x+o.w/2,y:o.y+o.h/2},Q),A.findClosest({x:o.x+o.w,y:o.y+o.h},Q)],D={},a=A._87I;E=E||255;var P,k;for(A._guideLine=[],H=0;2>H;H++)for(D={},0===H?(f="y",h=o.x,i=h+o.w):(f="x",h=o.y,i=h+o.h),r=0;3>r;r++)n=c[r],n&&isFinite(n[f])&&(P=1<<3*H+r,E&P&&(Z=n[f+"Line"],I=Z.node,k=I._id||0,D[k]||(D[k]=!0,m=a[k],"y"===f?(S=m.x,u=m.x+m.width):(S=m.y,u=m.y+m.height),p=Z.p,A._guideLine.push({type:f,a:h,b:i,c:S,d:u,p:p,center:1===Z.type}))))},Ne.prototype._binarySearchClosest=function(Z,j){if(!j.length)return{dis:1/0};for(var K,V=0,d=j.length-1;d-V>1;)K=Math.floor((V+d)/2),j[K].p<Z?V=K:d=K;var W=j[V].p-Z,o=j[d].p-Z;return Math.abs(W)<=Math.abs(o)?{line:j[V],dis:W}:{line:j[d],dis:o}},Ne.prototype.findClosest=function(T,y,B){var x=this,V=x._interactor,U=V.gv,a=x._grid;B&&(T=zp.toWorldPosition(U,T));var S,f=x._binarySearchClosest(T.x,a.x),J=x._binarySearchClosest(T.y,a.y),e=f.dis,z=J.dis,m=U._zoom,u=V.getStyle("smartGuideSensitivity")/m,j={};return Math.abs(e)<u&&"y"!==y&&(j.x=B?e*m:e,j.xLine=f.line,S=!0),Math.abs(z)<u&&"x"!==y&&(j.y=B?z*m:z,j.yLine=J.line,S=!0),S?j:void 0},Ne.prototype._42=function(){var l=this,p=l._guideLine;if(p&&!b.Default.isCtrlDown()){var J,x,k,W,$,C,v,c,R,j,u,z,B,G,_,q,i,U=l._interactor,t=U.gv,a=U._context,r=t.tx(),M=t.ty(),e=t._zoom,Q=U.getStyle("guideLineTextSpacing");for(J=0,x=p.length;x>J;J++)k=p[J],c=k.type,R=k.p,j=k.a,u=k.b,z=k.c,B=k.d,G=Math.min(j,z),_=Math.max(u,B),"x"===c?(W=R*e+r,$=G*e+M,C=W,v=_*e+M):(W=G*e+r,$=R*e+M,C=_*e+r,v=$),zp.Icons.DrawIcon(U,a,zp.Icons.MoveLineGuide,{rect:[W,$,C,v],center:k.center}),B>=j&&u>=z||(G=j>B?B:u,_=j>B?j:z,i=_-G,"x"===c?(k.center2center||(W-=Q,C=W),$=G*e+M,v=_*e+M,q=zp.Icons.MoveLineGuideDistanceV):"y"===c&&(k.center2center||($-=Q,v=$),W=G*e+r,C=_*e+r,q=zp.Icons.MoveLineGuideDistanceH),zp.Icons.DrawIcon(U,a,q,{x0:W,y0:$,x1:C,y1:v,dis:i}))}},Ne.prototype.clear=function(){this._guideLine=null},zp.DefaultStyleMap={pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,guideLineTextSpacing:0,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var Bj=zp.Icons={},qj=1e4,To=null,Zd="rgb(51,153,255)",Bl="rgb(183,232,135)",zj="rgb(255,204,153)",sp=6;b.Default.setImage("Icons.RectPoint",{width:sp,height:sp,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:Zd,rect:[0,0,sp,sp]}]});var jk="#e000e0";Bj.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var $=Bj.GroupSubEntityRect.data;if(!$)return[];var h=$.min,x=$.max;return[h.x,h.y,h.x,x.y,x.x,x.y,x.x,h.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Bj.GroupSubEntityRect.data.isKeyOb?jk:"#666666"}}}]},Bj.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Bj.Line.data.P1.x,Bj.Line.data.P1.y],sp,sp]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Bj.Line.data.P2.x,Bj.Line.data.P2.y],sp,sp]}}}]},Bj.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return Bj.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},Bj.Rect={comps:[{type:"shape",points:{func:function(){var r=Bj.Rect.data;if(!r)return[];var w=r.LT,t=r.LB,y=r.RB,I=r.RT;return[w.x,w.y,t.x,t.y,y.x,y.y,I.x,I.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:Zd},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Bj.Rect.data.rotation}},rect:{func:function(){return[[Bj.Rect.data.LT.x,Bj.Rect.data.LT.y],sp,sp]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Bj.Rect.data.rotation}},rect:{func:function(){return[[Bj.Rect.data.LB.x,Bj.Rect.data.LB.y],sp,sp]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Bj.Rect.data.rotation}},rect:{func:function(){return[[Bj.Rect.data.RB.x,Bj.Rect.data.RB.y],sp,sp]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Bj.Rect.data.rotation}},rect:{func:function(){return[[Bj.Rect.data.RT.x,Bj.Rect.data.RT.y],sp,sp]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Bj.Rect.data.rotation}},visible:{func:function(){return Bj.Rect.data.L?!0:!1}},rect:{func:function(){return[[Bj.Rect.data.L.x,Bj.Rect.data.L.y],sp,sp]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Bj.Rect.data.rotation}},visible:{func:function(){return Bj.Rect.data.R?!0:!1}},rect:{func:function(){return[[Bj.Rect.data.R.x,Bj.Rect.data.R.y],sp,sp]
}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Bj.Rect.data.rotation}},visible:{func:function(){return Bj.Rect.data.T?!0:!1}},rect:{func:function(){return[[Bj.Rect.data.T.x,Bj.Rect.data.T.y],sp,sp]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Bj.Rect.data.rotation}},visible:{func:function(){return Bj.Rect.data.B?!0:!1}},rect:{func:function(){return[[Bj.Rect.data.B.x,Bj.Rect.data.B.y],sp,sp]}}}]};var Xg=16;b.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:Zd,borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:Zd,shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),Bj.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[Bj.Anchor.data.POS.x,Bj.Anchor.data.POS.y],Xg,Xg]}}}]},Bj.TipShiftX=12,Bj.TipShiftY=12;var ss=[8,28];Bj.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[Bj.TipHelper.data.helperPos.x,Bj.TipHelper.data.helperPos.y,ss[0]*Bj.TipHelper.data.size,ss[1]]}},background:{func:function(){return To.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return Bj.TipHelper.data.text}},rect:{func:function(){return[Bj.TipHelper.data.helperPos.x,Bj.TipHelper.data.helperPos.y,ss[0]*Bj.TipHelper.data.size,ss[1]]}},color:{func:function(){return To.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var cn=7;Bj.ShapePoint={comps:[{type:"circle",rect:{func:function(){var B=Bj.ShapePoint.data.point;return[B,cn,cn]}},background:{func:function(){var I=Bj.ShapePoint.data.isEnd;return I?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:Zd}]},Bj.ShapeBgCurve={comps:[{type:"shape",points:{func:function(){return Bj.ShapeBgCurve.data.P}},segments:{func:function(){return Bj.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:Zd}]};var Ki=8;Bj.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var b=Bj.ShapeHighlighPoint.data;return[[b.x,b.y],Ki,Ki]}},background:{func:function(){return To.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var me=10;Bj.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var W=Bj.ShapeHighlighRealPoint.data;return[[W.x,W.y],me,me]}},background:"#ffffff",borderWidth:2,borderColor:Zd}]};var $o=8;Bj.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var d=Bj.ShapeHighlighCtrlPoint.data,N=d.x,e=d.y,g=$o/2;return[N-g,e-g,N-g,e+g,N+g,e+g,N+g,e-g]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return To.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return To.getStyle("shapeCtrlPointBorderColor")||Zd}}}]};var gd=3;Bj.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return Bj.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:gd,borderColor:{func:function(){return To.getStyle("curveHighlightColor")}}}]},Bj.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return Bj.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},Bj.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return Bj.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return Bj.MoveLineGuide.data.center?Bl:zj}}}]};var Do=5;Bj.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var i=Bj.MoveLineGuideDistanceH.data,N=i.x0,P=i.y0;return[N,P-Do,N,P+Do]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:zj},{type:"shape",points:{func:function(){var d=Bj.MoveLineGuideDistanceH.data,h=d.x1,y=d.y1;return[h,y-Do,h,y+Do]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:zj},{type:"text",text:{func:function(){return Math.round(Bj.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var t=Bj.MoveLineGuideDistanceH.data;return[[(t.x0+t.x1)/2,t.y0-10],20,20]}},color:zj,font:"12px Arial",align:"center"}]},Bj.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var R=Bj.MoveLineGuideDistanceV.data,b=R.x0,Z=R.y0;return[b-Do,Z,b+Do,Z]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:zj},{type:"shape",points:{func:function(){var F=Bj.MoveLineGuideDistanceV.data,T=F.x1,P=F.y1;return[T-Do,P,T+Do,P]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:zj},{type:"text",text:{func:function(){return Math.round(Bj.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var F=Bj.MoveLineGuideDistanceV.data;return[[F.x0-10,(F.y0+F.y1)/2],20,20]}},color:zj,font:"12px Arial",align:"center"}]},b.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),Bj.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var P=Bj.EdgeElevationGuide.data,i=P.x,H=P.y,I=To.getStyle("curveElevationIntersectSize"),Y=To.getStyle("curveElevationGuideShift");return i+=Y[0],H+=Y[1],[i-I,H-I,2*I,2*I]}}}]},b.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),b.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),Bj.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return Bj.ConnectGuide.data.rotation}},rect:{func:function(){var z=Bj.ConnectGuide.data.connect;z.x,z.y;var b=To.getStyle("connectGuideIntersectSize");return[[z.x,z.y],2*b,2*b]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var n=Bj.ConnectGuide.data.cursorPos||Bj.ConnectGuide.data.connect,R=To.getStyle("connectGuideIntersectSize");return[[n.x,n.y],2*R-2,2*R-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var s=Bj.ConnectGuide.data.connect,c=Bj.ConnectGuide.data.cursorPos||s;return[s.x,s.y,s.x+.5*(c.x-s.x),s.y,c.x+.5*(s.x-c.x),c.y,c.x,c.y]}}}]},b.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),b.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),Bj.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var C=Bj.ConnectGuideGarbage.data.hover;return C?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var n=Bj.ConnectGuideGarbage.data,D=To.getStyle("connectGuideGarbageIntersectsize");return n.hover&&(D+=5),[[n.x,n.y],2*D,2*D]}}}]};var sb=6;Bj.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return Bj.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var l=Bj.ShapeActivingCtrl.data;return[l.point.x,l.point.y,l.c1.x,l.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:Zd},{type:"shape",visible:{func:function(){return Bj.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var U=Bj.ShapeActivingCtrl.data;return[U.point.x,U.point.y,U.c2.x,U.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:Zd},{type:"shape",visible:{func:function(){return Bj.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var x=Bj.ShapeActivingCtrl.data.c1,Y=x.x,J=x.y,r=sb/2;return"c1"===Bj.ShapeActivingCtrl.data.hl&&(r+=.5),[Y-r,J-r,Y-r,J+r,Y+r,J+r,Y+r,J-r]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return To.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===Bj.ShapeActivingCtrl.data.hl?To.getStyle("shapeCtrlPointHighlightBorder")||Zd:To.getStyle("shapeCtrlPointBorderColor")||Zd}}},{type:"shape",visible:{func:function(){return Bj.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var i=Bj.ShapeActivingCtrl.data.c2,d=i.x,T=i.y,f=sb/2;return"c2"===Bj.ShapeActivingCtrl.data.hl&&(f+=.5),[d-f,T-f,d-f,T+f,d+f,T+f,d+f,T-f]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return To.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===Bj.ShapeActivingCtrl.data.hl?To.getStyle("shapeCtrlPointHighlightBorder")||Zd:To.getStyle("shapeCtrlPointBorderColor")||Zd}}}]},Bj.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:Zd,rect:{func:function(){return[[Bj.RoundPoint.data.x,Bj.RoundPoint.data.y],sp,sp]}}}]},zp.Icons.DrawIcon=function(A,B,C,J){C.width=C.height=qj,C.data=J,To=A,b.Default.drawImage(B,C,0,0,qj,qj)},zp.Icons.MapPoints=function(B,m){for(var v=0,y=B.length;y>v;v++)B[v]/=m},zp.roundTo=function(V,j,l){var S=Math.abs(V%j);return l>S||l>j-S?j*Math.round(V/j):V},zp.toFixed=function(r){return Math.round(100*r)/100},zp.getDataMatrix=function(F){if(F instanceof b.Shape){var J=new b.Math.Matrix2d,N=F.getPosition();return J.translate(-N.x,-N.y).scale(F.getScale().x,F.getScale().y).rotate(F.getRotation()).translate(N.x,N.y),J}return F.getMatrix?F.getMatrix():new b.Math.Matrix2d};var $n=zp.Math.Curve=function(){this._curves=[]};$n.prototype={},$n.prototype.constructor=$n,$n.prototype.createFromHtShape=function(m,I,T){I instanceof b.List&&(I=I.toArray());var t,j,U,$,B,z,c,K=this,N=null,S=null,H=0,M=zp.Math.Vector2,g=zp.Math.CubicBezier,o=function(J){return new M(m[J],m[J+1],T?T[J/2]:q)};for(j=0,U=I.length;U>j;j++){switch($=I[j],B=null,$){case 1:S=o(H),N=S,H+=2;break;case 2:t=o(H),H+=2,B=new g(S,S.clone(),t.clone(),t),S=t;break;case 3:z=o(H),t=o(H+2),H+=4,B=new g(S,z.clone().sub(S).multiplyScalar(2/3).add(S),z.clone().sub(t).multiplyScalar(2/3).add(t),t),S=t;break;case 4:z=o(H),c=o(H+2),t=o(H+4),H+=6,B=new g(S,z,c,t),S=t;break;case 5:if(!N)break;B=new g(S,S.clone(),N.clone(),N),S=null,N=null}B&&(B._index=K._curves.length,K._curves.push(B))}},$n.prototype.checkPoint=function(G,u){var y,E,U,r,Z,w=this,d=w._curves;for(y=0,E=d.length;E>y;y++)if(r=d[y],Z=r.intersectRect(G,u,u),Z.length)return U=0,Z.forEach(function(L){U+=L.t}),U/=Z.length,G=r.getPointAt(U),G.t=U,{bezier:r,intersection:G}},$n.prototype.insertKnot=function(K,R){var j=K.insertKnot(R),d=this,r=d._curves;r.splice(K._index,1,j[0],j[1])},$n.prototype._isCloseEnough=function(P,e){return Math.abs(P.x-e.x)<1e-6&&Math.abs(P.y-e.y)<1e-6},$n.prototype._isSamePoint=function(s,h){return s===h},$n.prototype.moveRealPoint=function(h,Y){var l=this,K=l._curves,X=Y.clone().sub(h);K.forEach(function(L){var z=L._p1;L._p2,L._p3;var t=L._p4;l._isSamePoint(z,h)&&(L._p2.add(X),L._p1=Y),l._isSamePoint(t,h)&&(L._p3.add(X),L._p4=Y)})},$n.prototype.moveCtrlDueToRealPointMovement=function(x,f){var o=this,C=o._curves,U=function(K){K.add(f),K.e&&f.e&&(K.e+=f.e)};C.forEach(function(u){var l=u._p1;u._p2,u._p3;var e=u._p4;o._isSamePoint(l,x)&&U(u._p2),o._isSamePoint(e,x)&&U(u._p3)})},$n.prototype.moveCtrlPoint=function(F,z,J){var H=F[J];if(H){H.e!==q&&(z.e=H.e);var g=this,Q=g._curves;z.clone().sub(H),Q.forEach(function(V){var $;"c2"===J?$="_p2":"c1"===J&&($="_p3"),g._isSamePoint(V[$],H)&&(V[$]=z)}),F[J]=z}},$n.prototype.deleteRealPoint=function(F,I){var D,h,V,Z,u,R,v,B=this,Q=B._curves,J={},z=[],e=zp.Math.CubicBezier;for(h=0,V=Q.length;V>h;h++)D=Q[h],Z=D._p1,u=D._p2,R=D._p3,v=D._p4,(J[h]||!B._isSamePoint(Z,F))&&(B._isSamePoint(v,F)?V>h+1&&B._isSamePoint(Q[h+1]._p1,F)&&(I||z.push(new e(Z,u,Q[h+1]._p3,Q[h+1]._p4))):z.push(D));B._curves=z},$n.prototype.findPairs=function($,R){var F,j,T,l,x,C,Q,U,y=this,N=y._curves,h={},i=[];for(j=0,T=N.length;T>j;j++)F=N[j],l=F._p1,x=F._p2,C=F._p3,Q=F._p4,!h[j]&&y._isSamePoint(l,$)&&(R?i.push({point:l,r2:Q}):i.push({point:l,c2:x})),y._isSamePoint(Q,$)&&(U=R?{point:Q,r1:l}:{point:Q,c1:C},T>j+1&&y._isSamePoint(N[j+1]._p1,$)&&(R?U.r2=N[j+1]._p4:U.c2=N[j+1]._p2,h[j+1]=!0),i.push(U));return i},$n.prototype.toHtShape=function(){var o=this,F=o._curves,Z=[],n=[],r={x:1/0,y:1/0};return F.forEach(function(N){var Q=N._p1,A=N._p2,R=N._p3,p=N._p4;return o._isCloseEnough(Q,r)||(Z.push(1),n.push(Q.clone())),r=p,o._isCloseEnough(Q,A)&&o._isCloseEnough(R,p)?(Z.push(2),n.push(p.clone()),void 0):(Z.push(4),n.push(A.clone(),R.clone(),p.clone()),void 0)}),{segments:Z,points:n}};var yi=zp.Math.CubicBezier=function(E,w,C,B){var b=this;b._id=zp.Math.CubicBezier._globalId++,b._p1=E,b._p2=w,b._p3=C,b._p4=B};yi._globalId=1,yi.prototype={},yi.prototype.constructor=yi,yi.prototype.toString=function(){return this._id},yi.prototype.intersectRect=function(X,o,I){var B=o/2,P=I/2,i=X.x,Q=X.y,l=zp.Math.Vector2,c=new l(-B+i,-P+Q),e=new l(B+i,P+Q),x=new l(e.x,c.y),j=new l(c.x,e.y),J=this,Z=J.intersectLine(c,x),R=J.intersectLine(x,e),u=J.intersectLine(e,j),L=J.intersectLine(j,c),t=Z.concat(R).concat(u).concat(L);return t},yi.prototype.intersectLine=function(Y,V){var o,K,Q,W,M,y,F,Z,k,t,S,w,q,T=this,P=Y.clone().min(V),$=Y.clone().max(V);W=T._p1,M=T._p2,y=T._p3,F=T._p4,o=W.clone().multiplyScalar(-1),K=M.clone().multiplyScalar(3),Q=y.clone().multiplyScalar(-3),S=o.add(K).add(Q).add(F),o=W.clone().multiplyScalar(3),K=M.clone().multiplyScalar(-6),Q=y.clone().multiplyScalar(3),t=o.add(K).add(Q),o=W.clone().multiplyScalar(-3),K=M.clone().multiplyScalar(3),k=o.add(K),Z=W.clone(),q=new zp.Math.Vector2(Y.y-V.y,V.x-Y.x),w=Y.x*V.y-V.x*Y.y;for(var X=T.getRoots(q.dot(S),q.dot(t),q.dot(k),q.dot(Z)+w),D=new Array,n=0,b=X.length;b>n;n++){var r=X[n];if(!(0>r||r>1)){var U=W.clone().lerp(M,r),N=M.clone().lerp(y,r),l=y.clone().lerp(F,r),m=U.lerp(N,r),L=N.lerp(l,r),j=m.lerp(L,r);j.t=r,Y.x==V.x?P.y<=j.y&&j.y<=$.y&&D.push(j):Y.y==V.y?P.x<=j.x&&j.x<=$.x&&D.push(j):j.x>=P.x&&j.y>=P.y&&j.x<=$.x&&j.y<=$.y&&D.push(j)}}return D},yi.prototype.solveTForPoint=function(p){var N,J,A,f,Z=this;N=Z._p1.x-p.x,J=Z._p2.x-p.x,A=Z._p3.x-p.x,f=Z._p4.x-p.x;for(var E=Z.getRoots(f-3*A+3*J-N,3*A-6*J+3*N,3*J-3*N,N),v=q,D=1/0,w=0,b=E.length;b>w;w++){var s=E[w];if(!(0>s||s>1)){var z=Z._p1.clone().lerp(Z._p2,s),H=Z._p2.clone().lerp(Z._p3,s),R=Z._p3.clone().lerp(Z._p4,s),X=z.lerp(H,s),L=H.lerp(R,s),m=X.lerp(L,s);m.t=s;var a=Math.abs(m.y-p.y);D>a&&(D=a,v=m)}}return v},yi.prototype.getPointAt=function(O){var M=this,n=M._p1,N=M._p2,I=M._p3,o=M._p4,f=n.clone().lerp(N,O),U=N.clone().lerp(I,O),K=I.clone().lerp(o,O),r=f.lerp(U,O),i=U.lerp(K,O);return r.lerp(i,O)},yi.prototype.getRoots=function(i,r,T,W){var g,J,H,C,B,P=new Array;if(Math.abs(i)<1e-6){var g=r,J=T/g,H=W/g,C=J*J-4*H;if(C>0){var B=Math.sqrt(C);P.push(.5*(-J+B)),P.push(.5*(-J-B))}else 0==C&&P.push(.5*-J)}r/=i,T/=i,W/=i,g=(3*T-r*r)/3,J=(2*r*r*r-9*T*r+27*W)/27;var S=r/3,j=J*J/4+g*g*g/27,v=J/2;if(Math.abs(j)<=1e-6&&(j=0),j>0){var A,f,B=Math.sqrt(j);A=-v+B,f=A>=0?Math.pow(A,1/3):-Math.pow(-A,1/3),A=-v-B,A>=0?f+=Math.pow(A,1/3):f-=Math.pow(-A,1/3),P.push(f-S)}else if(0>j){var z=Math.sqrt(-g/3),t=Math.atan2(Math.sqrt(-j),-v)/3,x=Math.cos(t),G=Math.sin(t),K=Math.sqrt(3);P.push(2*z*x-S),P.push(-z*(x+K*G)-S),P.push(-z*(x-K*G)-S)}else{var A;A=v>=0?-Math.pow(v,1/3):Math.pow(-v,1/3),P.push(2*A-S),P.push(-A-S)}return P},yi.prototype._70I=function(){var $=this;return $._p1.distanceToSquared($._p2)<1e-10&&$._p3.distanceToSquared($._p4)<1e-10},yi.prototype.insertKnot=function(K){var a=this,q=a._p1,g=a._p2,x=a._p3,A=a._p4,w=q.clone().lerp(g,K),s=g.clone().lerp(x,K),M=x.clone().lerp(A,K),Z=w.clone().lerp(s,K),_=s.clone().lerp(M,K),d=Z.clone().lerp(_,K);return a._70I()?(q.clone().lerp(A,K),[new zp.Math.CubicBezier(q,q.clone(),d.clone(),d),new zp.Math.CubicBezier(d,d.clone(),A.clone(),A)]):[new zp.Math.CubicBezier(q,w,Z,d),new zp.Math.CubicBezier(d,_,M,A)]};var Gf=b.Default.getInternal().ui().EdgeUI,Hf={_47O:function(X){var l=this,w=Hf.getBackups()._47O;zp.inEdit(l.gv)||w.call(l,X)}};zp.Inject.registAsModule(Hf,Gf);var Cm=b.Default.getInternal().ui().NodeUI,Vb={_47O:function(E){var q=this,F=Vb.getBackups()._47O;zp.inEdit(q.gv)||F.call(q,E)},getSelectWidth:function(){var c=this,f=c.gv,x=c._data;if(f.isEditable(x)&&zp.inEdit(f))return 0;var M=Vb.getBackup("getSelectWidth");return M.call(c)}};zp.Inject.registAsModule(Vb,Cm);var Ac=b.graph.GraphView,Qf={_editPointSize:function(){var c=b.Default.isTouchable,L=zp.getStyle("pointSize");return L[c?0:1]}(),isPointEditable:function(u){var C=this;if(zp.inEdit(C))return C._pointEditableFunc?C._pointEditableFunc(u):!0;var G=Qf.getBackup("isPointEditable");G.call(C,u)},isEditable:function(Q){var L,C=this,N=Qf.getBackup("isEditable");if(L=Q instanceof zp.Group?!0:N.call(C,Q),!zp.inEdit(C))return L;if(!(Q instanceof b.Edge))return L;if(!Q.s("2d.editable"))return!1;var T=C.getEditableFunc();return T?T(Q):!0},_42:function($,k){var C=this,z=Qf.getBackups()._42;if(z.call(C,$,k),zp.inEdit(C)){var W=C.getEditInteractor();W.drawImpl()}}};zp.Inject.registAsModule(Qf,Ac);var dk=b.Default.getInternal().ui().ShapeUI,Zc={_47O:function(i){var r=this,_=Zc.getBackups()._47O;zp.inEdit(r.gv)||_.call(r,i)}};zp.Inject.registAsModule(Zc,dk);var uh=b.graph.DefaultInteractor,sg={handle_mousewheel:function(X){var H=this,A=sg.getBackup("handle_mousewheel");zp.inEdit(H.gv)||A.call(H,X)}};zp.Inject.registAsModule(sg,uh);var Aj=b.graph.MoveInteractor,Ao={_calcShift:function(G,I){var w=this,m=Ao.getBackup("_calcShift"),d=w.gv;if(!zp.inEdit(d))return m.call(w,G,I);var X=d.getEditInteractor(),f=X.getSubModule("Move").calcShift(G,I,w);return f||m.call(w,G,I)},clear:function(K){var L=this,g=Ao.getBackup("clear");g.call(L,K);var $=L.gv;if(zp.inEdit($)){var h=$.getEditInteractor();h.getSubModule("Move").clear(K)}}};zp.Inject.registAsModule(Ao,Aj);var Ne=zp.Rect=function(O){this.catalog="Rect",this._interactor=O};Ne.prototype={},Ne.prototype.constructor=Ne,Ne.prototype.gatherInfo=function(M,R){var s=this;if(1===R.length){var u=R[0];return u instanceof b.Shape&&u._70I()?s.gatherLine(M,u):iq(u,M)?!1:s.gatherSingleTarget(M,u)}return R.length>1?s.gatherMultiTargets(M,R):!1},Ne.prototype.gatherSingleTarget=function(Z,E){if(E.getCorners){var L,y=this,i=y.info;y.target=E,L=y.screenInfo={};var s=E.getCorners();i.LT=new zp.Math.Vector2(s[0]),i.LB=new zp.Math.Vector2(s[1]),i.RB=new zp.Math.Vector2(s[2]),i.RT=new zp.Math.Vector2(s[3]),i.T=i.LT.clone().add(i.RT).divideScalar(2),i.B=i.LB.clone().add(i.RB).divideScalar(2),i.L=i.LT.clone().add(i.LB).divideScalar(2),i.R=i.RT.clone().add(i.RB).divideScalar(2);for(var G in i)L[G]=zp.toScreenPosition(Z,i[G]);var q=y._interactor,I=q.getStyle("checkSize"),H=function(Q,D,N){var M=D.clone().sub(Q).setLength(-I),q=N.clone().sub(Q).setLength(-I),L=M.add(q).add(Q);return L};return L.rotLT=H(L.LT,L.RT,L.LB),L.rotLB=H(L.LB,L.LT,L.RB),L.rotRB=H(L.RB,L.LB,L.RT),L.rotRT=H(L.RT,L.LT,L.RB),L.rotT=L.rotLT.clone().add(L.rotRT).divideScalar(2),L.rotB=L.rotLB.clone().add(L.rotRB).divideScalar(2),L.rotL=L.rotLT.clone().add(L.rotLB).divideScalar(2),L.rotR=L.rotRT.clone().add(L.rotRB).divideScalar(2),L.rotation=E.getRotation(),y.gatherConnectInfo(),!0}},Ne.prototype.gatherConnectInfo=function(){var V=this,r=V.target,N=V._interactor,A=V.screenInfo,K=N.gv;if(K.isConnectActionVisible(r)&&N.getStyle("connectGuideVisible")){var b;r.s&&(b=r.s("connectGuideShift")),b||(b=N.getStyle("connectGuideShift"));var U=r.getAnchor(),l=r.getSize(),$=r.toGlobal({x:l.width*(b[0]-U.x),y:l.height*(b[1]-U.y)});$=zp.toScreenPosition(K,$),A.P1?$.add(A.P2.clone().sub(A.P1).setLength(b[2])):($.add(A.RT.clone().sub(A.LT).setLength(b[2])),$.add(A.LB.clone().sub(A.LT).setLength(b[3]))),A.connect=$}},Ne.prototype.gatherMultiTargets=function(s,d){var $=zp.Group.findOrCreateGroup(d);if(!$)return!1;var f=this;return f.editing&&"rotate"!==f.editing.mode||$.calcInfo(),f.gatherSingleTarget(s,$)},Ne.prototype.gatherLine=function(P,i){this.target=i;var G=this.screenInfo={},O=i.getPoints(),F=zp.getDataMatrix(i);return G.P1=zp.toScreenPosition(P,F.apply(O.get(0))),G.P2=zp.toScreenPosition(P,F.apply(O.get(1))),this.gatherConnectInfo(),!0},Ne.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],Ne.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],Ne.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],Ne.prototype.check=function(L,B,y){if(b.Default.isLeftButton(B)){var M=this;if(M.editing=null,M.tipInfo=null,M.screenInfo){var x=M.target,$=L.isEditable(x),V=M.screenInfo;if($&&V.connect){var F=M._checkConnect(y);if(F)return F}if(V.P1)return M._checkLine(y);var h,o,w,_=null,f=M._interactor,D=f.getStyle("checkSize");if($&&L.isRectEditable(x))for(o=0;o<zp.Rect.ResizeKeys.length;o++)if(w=zp.Rect.ResizeKeys[o],zp.checkHit(y,V[w],D)){_=w,h="resize";break}if(!_&&$&&L.isRotationEditable(x)&&!f.getStyle("rotateAsClock")){var T=f.getStyle("rotateCheckSize");for(o=0;o<zp.Rect.RotateKeys.length;o++)if(w=zp.Rect.RotateKeys[o],zp.checkHit(y,V[w],T)){_=w,h="rotate";break}}if(!_)return f.setCursor("default"),void 0;if("rotate"===h){var g,q=L.lp(B);if(x instanceof zp.Group){var r=f.getStyle("groupRotateModeKey");"string"==typeof r&&(r=[r]);for(var W=!1,k=0,c=r.length;c>k;k++)if(B[r[k]]){W=!0;break}var S=f.getStyle("groupRotateModeDefault");g=W?"batch"===S?"block":"batch":S}var Z="batch"===g?x.getAnchor2():x.getPosition(),n=Math.atan2(q.y-Z.y,q.x-Z.x);f._setRotateCursor(n),M.editing={mode:h,key:_,pos:Z,flipY:x.getScale().y<0,rotation:x.getRotation(),hitRot:n},g&&(M.editing.groupRotateMode=g)}else{var p=zp.Rect.ResizeKeys.indexOf(_),C=zp.Rect.ResizeDirection[p],u=Math.cos(x.getRotation()),X=Math.sin(x.getRotation()),t=C.x*Math.sign(x.getScale().x),s=C.y*Math.sign(x.getScale().y),K=Math.atan2(-X*t-u*s,u*t-X*s),N=(Math.round(K/(Math.PI/4))+8)%8,j=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][N];this._interactor.setCursor(j);var a=x.getWidth(),i=x.getHeight(),G=x.getAnchor();M.editing={mode:h,key:_,rect:{x:-a*G.x,y:-i*G.y,width:a,height:i},anchor:G,matrix:x.getMatrix()}}return _}}},Ne.prototype._checkLine=function(B){var T=this;T.screenInfo;var w,D=T._interactor.getStyle("checkSize");if(zp.checkHit(B,T.screenInfo.P1,D))w="P1";else{if(!zp.checkHit(B,T.screenInfo.P2,D))return this._interactor.setCursor("default"),void 0;w="P2"}return T.editing={mode:"line",key:w},w},Ne.prototype._checkConnect=function(n){var A=this,l=A.screenInfo,_=A._interactor,M=_.getStyle("connectGuideIntersectSize"),J=l.connect,D=n.x,v=J.x;if(v>D&&M>v-D&&Math.abs(J.y-n.y)<M||D>=v&&zp.checkHit(n,J,M)){var s="connect",G=t.getConnectAction(_.gv);if(A.editing={mode:s},G&&G.delete)if(A.target instanceof zp.Group){var m=!0;_.gv.sm().getSelection().each(function(w){G.delete.visible.call(null,_.gv,w)||(m=!1)}),A.editing.hasDeleteAction=m}else G.delete.visible.call(null,_.gv,A.target)&&(A.editing.hasDeleteAction=!0);return _.setCursor("default"),s}},Ne.prototype._fireEditEvent=function(b,J){var K=this._interactor,O=this.editing;if(O){var W=O.mode;W="rotate"===W?"Rotation":"connect"===W?"Connection":W[0].toUpperCase()+W.slice(1),K.fi({kind:b+"Edit"+W,event:J})}},Ne.prototype.startEdit=function(d,H){d.startDragging(H);var U=this;U._interactor.fi({kind:"prepareEdit",event:H});var s=U.editing,k=U.target;if(s){if(U._fireEditEvent("begin",H),"rotate"===s.mode)return s.groupRotateMode&&k.beginRotate(s),void 0;if("connect"!==s.mode)("line"===s.mode||k&&0===k.getRotation())&&(U._inSmartGuide=!0,U._interactor.rectGuide.gatherRects());else if(s.hasDeleteAction){var j=d.gv,T=U._interactor.getStyle("connectGuideGarbageShift");s.garbageInfo={x:j.getWidth()*T[0]+T[2],y:j.getHeight()*T[1]+T[3],size:U._interactor.getStyle("connectGuideGarbageIntersectsize")},d._42()}}},Ne.prototype._46O=function(U){var z,g,J=this,$=J.editing,Y=J.target;if($){if("connect"===$.mode&&!$.canceled&&!$.deleted)try{$.garbageInfo&&$.garbageInfo.hover?t.doDeleteConnectionAction(J._interactor.gv,Y):t.doConnectAction(J._interactor.gv,Y,$.target)}catch(o){console.error(o)}g=$.freezeFlag,z=J.editing.groupRotateMode,J._fireEditEvent("end",U),J.editing=null}J.tipInfo=null,J._inSmartGuide&&(J._interactor.rectGuide.clear(),J._inSmartGuide=!1),z&&Y&&Y.endRotate(),Y instanceof b.Block&&(g===q?delete Y._freezeSyncFromChildren:Y._freezeSyncFromChildren=g,Y.updateFromChildren())},Ne.prototype.handleNormalStateDelete=function(){var N=this,u=N.editing;if(u&&"connect"===u.mode&&!u.canceled&&!u.deleted){if(u.garbageInfo){try{t.doDeleteConnectionAction(N._interactor.gv,N.target)}catch(c){console.error(c)}u.garbageInfo=null}return u.cursorPos=null,u.targetCorners=null,u.deleted=!0,N._interactor._42(),!0}},Ne.prototype.handleNormalStateKeyDown=function(d){var k=this,P=k.editing;return!P||"connect"!==P.mode||P.canceled||P.deleted?void 0:b.Default.isEsc(d)?(P.cursorPos=null,P.targetCorners=null,P.canceled=!0,k._interactor._42(),!0):void 0},Ne.prototype.handleEdit=function(m,Z){var c=this,V=c.editing;if(V){var t,p,K,L,W,S=c.target,T=V.key,X=V.mode,R=m.lp(Z),A=c._interactor;if("connect"===X){if(V.canceled)return;if(V.deleted)return;V.cursorPos=A._getLogicalPoint(Z);var E=V.garbageInfo;return E&&zp.checkHit(V.cursorPos,E,E.size)?(E.hover=!0,V.target=null,V.targetCorners=null):(E&&(E.hover=!1),V.target=m.getDataAt(R,function(d){return m.isSelectable(d)?uq(d)?!0:!1:!1})||null,V.targetCorners=zp.getTargetCornersOnScreen(m,V.target)),A._42(),void 0}if("rotate"===X){var w,H,q=V.pos,Y=Math.atan2(R.y-q.y,R.x-q.x);if(V.groupRotateMode?H=Y-V.hitRot:(w=Y-V.hitRot,H=V.rotation+w),H%=2*Math.PI,0>H&&(H+=2*Math.PI),!b.Default.isCtrlDown(Z)){var n,i;fk(Z)?(n=A.getStyle("shiftRotateRound"),i=n/2):(n=A.getStyle("rotateRound"),i=A.getStyle("rotateSensitivity")),H=zp.roundTo(H,n,i)}V.groupRotateMode?(w=H-(V.lastRotation||0),0!==w&&(S.addRotation(w,V.groupRotateMode),V.lastRotation=H)):S.setRotation(H),A._setRotateCursor(Y),H>Math.PI&&(H-=2*Math.PI);var f=180*(H/Math.PI);f=f.toFixed(2),t=""+f+"°"}else if("resize"===X){var F=V.rect;K=F.x,L=F.y;var C,r=F.width,u=F.height,D=V.anchor,z=V.matrix,P=S.s&&S.s("keepAspectRatio")||A.getStyle("keepAspectRatio");fk(Z)&&(P=!P);var y=c._unionPointMode1,v=c._unionPointMode2;if(c._inSmartGuide&&!b.Default.isCtrlDown(Z)&&!P){var h;"L"===T||"R"===T?h="x":("T"===T||"B"===T)&&(h="y"),c._adsorbedToClosest(R,h),W=!0}C=z.tfi(R);var x;"LT"===T?(F=y(C,{x:K+r,y:L+u},r,u,P),x=9):"T"===T?(F=v({x:K,y:C.y},{x:K+r,y:L+u},r,u,P,"v"),x=1):"RT"===T?(F=y(C,{x:K,y:L+u},r,u,P),x=33):"L"===T?(F=v({x:C.x,y:L},{x:K+r,y:L+u},r,u,P,"h"),x=8):"R"===T?(F=v({x:K,y:L},{x:C.x,y:L+u},r,u,P,"h"),x=32):"LB"===T?(F=y(C,{x:K+r,y:L},r,u,P),x=12):"B"===T?(F=v({x:K,y:L},{x:K+r,y:C.y},r,u,P,"v"),x=4):"RB"===T&&(F=y(C,{x:K,y:L},r,u,P),x=36);var Q=z.tf(F.x+F.width*D.x,F.y+F.height*D.y);S instanceof b.Block&&(V.hasOwnProperty("freezeFlag")||(V.freezeFlag=S._freezeSyncFromChildren,S._freezeSyncFromChildren=!0)),S.setPosition(Q),S.setSize(F.width,F.height),W&&(p=S.getRect(),A.rectGuide.gatherLines({node:S,x:p.x,y:p.y,w:p.width,h:p.height},h,x)),t=""+Math.round(F.width)+" * "+Math.round(F.height)}else if("line"===X){if(fk(Z)){var g=S.getPoints(),J="P1"===T?g.get(1):g.get(0),B={x:R.x-J.x,y:R.y-J.y},e=A.getStyle("shiftLineRotateRound"),I=c._shiftDirList;if(!I||c._shiftRotateRound!==e){c._shiftRotateRound=e,c._shiftDirList=I=[];for(var $=0;$<Math.PI;$+=e)I.push({x:U($),y:o($)})}for(var N,k=0,s=0,d=I.length;d>s;s++){var l=I[s],O=l.x*B.x+l.y*B.y;Math.abs(O)>Math.abs(k)&&(k=O,N=l)}R={x:J.x+N.x*k,y:J.y+N.y*k},A.rectGuide.clear()}else c._inSmartGuide&&!b.Default.isCtrlDown(Z)&&(c._adsorbedToClosest(R),W=!0);var _=zp.getDataMatrix(S).applyInverse(R);S.setPoint("P1"===T?0:1,_,!0);var j=S.getPoints(),M=j.get(0),a=j.get(1);K=M.x-a.x,L=M.y-a.y,t=" "+Math.round(Math.sqrt(K*K+L*L))+" ",W&&(p=S.getRect(),A.rectGuide.gatherLines({node:S,x:p.x,y:p.y,w:p.width,h:p.height}))}if(t){var G=b.Default.getLogicalPoint(Z,A._canvas);G.x+=zp.Icons.TipShiftX,G.y+=zp.Icons.TipShiftY,c.tipInfo={helperPos:G,text:t,size:t.length}}c._fireEditEvent("between",Z)}},Ne.prototype._unionPointMode1=function(Q,r,K,Z,m){if(m&&K&&Z){var c=Q.x-r.x,z=Q.y-r.y;Math.abs(c*Z)<Math.abs(z*K)?(z=Math.sign(z)*Math.abs(c*Z/K),Q.y=r.y+z):(c=Math.sign(c)*Math.abs(z*K/Z),Q.x=r.x+c)}return b.Default.unionPoint(Q,r)},Ne.prototype._unionPointMode2=function(A,M,x,p,h,Z){var V=b.Default.unionPoint(A,M);if(h&&x&&p){var J;"v"===Z?(J=V.x+V.width/2,V.width=x*V.height/p,V.x=J-V.width/2):(J=V.y+V.height/2,V.height=p*V.width/x,V.y=J-V.height/2)}return V},Ne.prototype._adsorbedToClosest=function(t,m){var Q=this,D=Q._interactor,T=D.rectGuide.findClosest(t,m),A=D.gridGuide.findClosest(t,m),g=1/0,u=1/0;T&&(isFinite(T.x)&&(g=T.x),isFinite(T.y)&&(u=T.y)),A&&(isFinite(A.x)&&Math.abs(A.x)<Math.abs(g)&&(g=A.x),isFinite(A.y)&&Math.abs(A.y)<Math.abs(u)&&(u=A.y)),isFinite(g)&&(t.x+=g),isFinite(u)&&(t.y+=u)},Ne.prototype._42=function(s,H,z){var J=this;J.info={},J.screenInfo=null;var S=J._interactor;if(!S.editDetail&&J.gatherInfo(H,z)){var A=J.editing,c=A?A.groupRotateMode:null,g=J.screenInfo;"block"!==c&&(g.P1?zp.Icons.DrawIcon(S,s,zp.Icons.Line,g):zp.Icons.DrawIcon(S,s,zp.Icons.Rect,g),g.connect&&(zp.Icons.DrawIcon(S,s,zp.Icons.ConnectGuide,{rotation:g.rotation,connect:g.connect,cursorPos:A?A.cursorPos:null}),A&&(A.targetCorners&&zp.Icons.DrawIcon(S,s,zp.Icons.NodeHoverGuide,A.targetCorners),A.garbageInfo&&zp.Icons.DrawIcon(S,s,zp.Icons.ConnectGuideGarbage,A.garbageInfo))),J.tipInfo&&zp.Icons.DrawIcon(S,s,zp.Icons.TipHelper,J.tipInfo)),J.target instanceof zp.Group&&J.target._42(S,s,H)}};var Iq=zp.Anchor=function(e){this.catalog="Anchor",this._interactor=e};Iq.prototype={},Iq.prototype.constructor=Iq,Iq.prototype.gatherInfo=function(G,z){var J=this;if(1===z.length){var M=z[0];if(!M.getAnchor)return;if(M instanceof b.Shape&&M._70I())return;if(iq(M,G))return;return J.gatherSingleTarget(G,z[0])}return z.length>1?J.gatherMultiTargets(G,z):!1},Iq.prototype.gatherSingleTarget=function(n,h){var y=this;return y.info.POS=h.getPosition(),y.screenInfo.POS=zp.toScreenPosition(n,y.info.POS),y.target=h,!0},Iq.prototype.gatherMultiTargets=function(i,d){var n=this,D=zp.Group.findOrCreateGroup(d);
return D?(n.screenInfo.POS=zp.toScreenPosition(i,D.getAnchor2()),n.target=D,!0):!1},Iq.prototype.isVisible=function(){var n=this,b=n._interactor;if(b.getStyle("anchorVisible")===!1)return!1;var w=n.target;if(w){if(this.editing)return!0;var E=w.getAnchor(),M=b.getStyle("anchorOutsideVisibleThreshold");if(E.x<-M||E.x>1+M||E.y<-M||E.y>1+M)return!0;var V=w.getSize(),F=w.getScale(),c=Math.min(Math.abs(V.width*F.x),Math.abs(V.height*F.y));if(c*b.gv._zoom<b.getStyle("anchorHideThreshold"))return!1}return!0},Iq.prototype.check=function(_,R,B){if(b.Default.isLeftButton(R)){var X=this,w=X._interactor;if(X.isVisible()&&w.getStyle("anchorMovable")!==!1){X.editing=null,X.tipInfo=null;var z=X.target;if(z&&_.isAnchorEditable(z)&&_.isEditable(z)){var F;if(X.screenInfo&&(F=X.screenInfo.POS)&&zp.checkHit(B,new zp.Math.Vector2(F),w.getStyle("checkSize"))){if(z instanceof zp.Group)return X.editing={},!0;var Q=z.getWidth(),G=z.getHeight(),r=z.getAnchor();return X.editing={rect:{x:-Q*r.x,y:-G*r.y,width:Q,height:G},anchor:r,matrix:z.getMatrix()},!0}}}}},Iq.prototype.startEdit=function(A,m){A.startDragging(m),A.fi({kind:"beginEditAnchor",event:m})},Iq.prototype._46O=function(e){var l=this;l.editing&&(l.editing=null,l._interactor.fi({kind:"endEditAnchor",event:e})),l.tipInfo=null},Iq.prototype.handleEdit=function(X,Q){var g=this,Z=g.target;if(Z){var c=g.editing;if(c){var D=X.lp(Q),U=g._interactor;if(Z instanceof zp.Group)return Z.setAnchor2(D),U._42(),void 0;var N=c.matrix,d=N.tfi(D),s=c.rect,C=(d.x-s.x)/s.width,R=(d.y-s.y)/s.height;if(!b.Default.isCtrlDown(Q)){var h=U.getStyle("anchorRound"),n=U.getStyle("anchorSensitivity");C=zp.roundTo(C,h,n),R=zp.roundTo(R,h,n)}Z.setAnchor(C,R,!0);var P=b.Default.getLogicalPoint(Q,U._canvas);P.x+=zp.Icons.TipShiftX,P.y+=zp.Icons.TipShiftY;var l=""+C.toFixed(2)+", "+R.toFixed(2);g.tipInfo={helperPos:P,text:l,size:l.length},U.fi({kind:"betweenEditAnchor",event:Q})}}},Iq.prototype._42=function(H,R,G){var S=this;S.info={},S.screenInfo={};var u=S._interactor;u.editDetail||S.gatherInfo(R,G)&&S.isVisible()&&(zp.Icons.DrawIcon(u,H,zp.Icons.Anchor,S.screenInfo),S.tipInfo&&zp.Icons.DrawIcon(u,H,zp.Icons.TipHelper,S.tipInfo))};var kn=zp.RotateX=function(k){this.catalog="RotateX",this._interactor=k};kn.prototype={},kn.prototype.constructor=kn,kn.prototype.gatherInfo=function(m,u){var R=this;if(1===u.length){var O=u[0];return O instanceof b.Shape&&O._70I()||iq(O,m)?!1:R.gatherSingleTarget(m,O)}return u.length>1?R.gatherMultiTargets(m,u):!1},kn.prototype.gatherSingleTarget=function(){var H=new b.Math.Vector2,g=new b.Math.Vector2,o=new b.Math.Vector2,x=new b.Math.Vector2,l=function(X,B){var r=X.x-B.x,g=X.y-B.y;return r*r+g*g};return function(B,h){if(h.getCorners){var t=this,P=h.getCorners(),M=15,S=h.getPosition();H.copy(P[0]),o.copy(P[1]),x.copy(P[3]),g.copy(H).add(x).divideScalar(2).add(H.sub(o).setLength(M/B.getZoom()));var w=Math.max(l(S,P[0]),l(S,P[1]),l(S,P[2]),l(S,P[3]));return t.info.POS=g.clone(),t.screenInfo.POS=zp.toScreenPosition(B,t.info.POS),t.screenInfo.LEN=Math.sqrt(w)*B.getZoom()+M,t.screenInfo.CENTER=zp.toScreenPosition(B,S),t.target=h,!0}}}(),kn.prototype.gatherMultiTargets=function(k,E){var v=this,N=zp.Group.findOrCreateGroup(E);if(!N)return!1;var v=this;return v.gatherSingleTarget(k,N)},kn.prototype.isVisible=function(){var G=this._interactor;if(!G.getStyle("rotateAsClock"))return!1;var U=this.target;if(!U)return!0;var n=G.gv;return n.isEditable(U)&&n.isRotationEditable(U)?!0:!1},kn.prototype.check=function(j,l,X){var Q=this,h=Q._checkImpl(j,l,X);return(h||Q._clockPainted)&&Q._interactor._42(),h},kn.prototype._checkImpl=function(O,p,k){if(b.Default.isLeftButton(p)){var U=this;U.editing=null,U.tipInfo=null;var A;if(U.screenInfo&&(A=U.screenInfo.POS)&&U.isVisible()){var i=U._interactor;if(zp.checkHit(k,A,i.getStyle("checkSize"))){var l=U.target,P=O.lp(p),Q=l.getPosition(),$=Math.atan2(P.y-Q.y,P.x-Q.x);return i._setRotateCursor($),U.editing={pos:Q,rotation:l.getRotation(),hitRot:$,groupRotateMode:"block",screenInfo:{CENTER:U.screenInfo.CENTER,LEN:U.screenInfo.LEN}},!0}}}},kn.prototype.startEdit=function(W,y){W.startDragging(y),W.fi({kind:"beginEditRotation",event:y}),this.target instanceof zp.Group&&this.target.beginRotate(this.editing)},kn.prototype._46O=function(c){var q=this;q.editing&&(q.editing=null,q._interactor.fi({kind:"endEditRotation",event:c})),q.target instanceof zp.Group&&q.target.endRotate(),q.tipInfo=null},kn.prototype.handleEdit=function(q,W){var o=this,B=o.editing;if(B){var m,z,y=o.target,D=q.lp(W),J=o._interactor,l=B.pos,C=Math.atan2(D.y-l.y,D.x-l.x),L=y instanceof zp.Group;if(L?z=C-B.hitRot:(m=C-B.hitRot,z=B.rotation+m),z%=2*Math.PI,0>z&&(z+=2*Math.PI),!b.Default.isCtrlDown(W)){var v,j;fk(W)?(v=J.getStyle("shiftRotateRound"),j=v/2):(v=J.getStyle("rotateRound"),j=J.getStyle("rotateSensitivity")),z=zp.roundTo(z,v,j)}L?(m=z-(B.lastRotation||0),0!==m&&(y.addRotation(m,B.groupRotateMode),B.lastRotation=z)):y.setRotation(z),J._setRotateCursor(C),z>Math.PI&&(z-=2*Math.PI);var K=180*(z/Math.PI),V=""+K.toFixed(2)+"°",G=b.Default.getLogicalPoint(W,J._canvas);G.x+=zp.Icons.TipShiftX,G.y+=zp.Icons.TipShiftY,o.tipInfo={helperPos:G,text:V,size:V.length},J.fi({kind:"betweenEditRotation",event:W})}},kn.prototype._42=function(n,P,d){var y=this;y._clockPainted=!1,y.info={},y.screenInfo={};var j=y._interactor;j.editDetail||y.gatherInfo(P,d)&&y.isVisible()&&(zp.Icons.DrawIcon(j,n,zp.Icons.RoundPoint,y.screenInfo.POS),y.tipInfo&&zp.Icons.DrawIcon(j,n,zp.Icons.TipHelper,y.tipInfo),y.editing&&y.drawClock(n))},kn.prototype.drawClock=function(O){O.save();var h=this;h._clockPainted=!0;var D=h.editing||{},R=D.screenInfo||h.screenInfo,C=R.LEN,$=C+8,I=C+18;O.save(),O.translate(R.CENTER.x,R.CENTER.y),O.beginPath(),O.strokeStyle="rgb(150, 150, 150)";for(var L,w,V,X,s,l=0;360>l;l++)L=l*Math.PI/180,0===l%5&&(w=o(L)*C,V=U(L)*C,X=o(L)*$,s=U(L)*$,O.moveTo(w,V),O.lineTo(X,s)),0===l%45&&(w=o(L)*C,V=U(L)*C,X=o(L)*I,s=U(L)*I,O.moveTo(w,V),O.lineTo(X,s));O.stroke(),O.rotate(-_);var H=D.lastRotation||h.target.getRotation();O.beginPath(),O.fillStyle="rgba(255, 0, 0, 0.1)",O.strokeStyle="rgb(157, 157, 157)",O.moveTo(0,0),O.arc(0,0,I,0,H,!1),O.fill(),O.beginPath(),O.moveTo(0+I,0),O.arc(0,0,I,0,H,!1),O.stroke(),O.restore()};var $n=zp.Curve=function(J){this.catalog="Curve",this._interactor=J};$n.prototype={},$n.prototype.constructor=$n,w.defineProperties($n.prototype,{activing:{get:function(){return this._activing},set:function(Z){var m=this;if(Z)m._activing=new zp.CurveActiving(this,Z);else{var H=m._activing;H&&H.dispose(),m._activing=null}}}}),$n.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},$n.prototype.setUp=function(){var J=this,L=J._interactor;L&&L.gv.mp(J._onGraphviewPropertyChanged,J)},$n.prototype._onGraphviewPropertyChanged=function(v){("zoom"===v.property||"translateX"===v.property||"translateY"===v.property)&&this._handleDataChanged()},$n.prototype.tearDown=function(){var i=this,G=i._interactor;G&&G.gv.ump(i._onGraphviewPropertyChanged,i)},$n.prototype.canEnterEditDetailMode=function(){var j=this,o=j._interactor,k=o._getValidSelection();if(1===k.length){var I=k[0],s=I instanceof b.Edge;if(I instanceof b.Shape||s){if(s){var x=I.s("edge.type");if(x&&"points"!==x)return}var $=o.gv;if($.isPointEditable(I)&&$.isEditable(I))return j.target=I,!0}}},$n.prototype.preHandleScroll=function(){var b=this.editing;return b&&b.inEdit?!0:void 0},$n.prototype.getCurrentSelectintStatus=function(){var W=this;if(W.activing&&!W.activing.selections){if(W.activing.status!=q)return W.activing.status;var y=function(P){var B=W.activing.status;W.activing.status=P,W._interactor.fp("shapePointStatus",B,P)},P=zp.Curve.PointType,O=W.activing.point,e=W.activing.pairs;if(!e||1!==e.length)return y(P.Mirrored);var X=e[0],Q=X.c1&&X.c1.isNearEnough(O),f=X.c2&&X.c2.isNearEnough(O);if(!X.c1||!X.c2)return Q||f?y(P.Straight):y(P.Disconnected);if(Q&&f)return y(P.Straight);if(Q||f)return y(P.Asymmetric);var T=X.c1.clone().sub(O),Z=X.c2.clone().sub(O);return Math.abs(T.x*Z.y-T.y*Z.x)>1e-5||T.x*Z.x>0?y(P.Disconnected):Math.abs(T.length()-Z.length())>1e-5?y(P.Asymmetric):y(P.Mirrored)}},$n.prototype.handle_keydown=function(t){var p=this;if(p._interactor.editDetail){var J=zp.Curve.PointType;"1"===t.key?p._setCurrentSelectionStatus(J.Straight):"2"===t.key?p._setCurrentSelectionStatus(J.Mirrored):"3"===t.key?p._setCurrentSelectionStatus(J.Disconnected):"4"===t.key&&p._setCurrentSelectionStatus(J.Asymmetric)}},$n.prototype.setCurrentSelectionStatus=function(a){var o=this,Q=o._interactor;if(Q){var E=Q.gv;E.dm().beginTransaction(),this._setCurrentSelectionStatus(a),E.dm().endTransaction()}},$n.prototype._setCurrentSelectionStatus=function(g){var v=this,u=v.activing;if(u){var D=v.getCurrentSelectintStatus();if(null!==D&&D!==g){u.status=g;var y=v.activing.point,p=v.activing.pairs;if(p&&1===p.length){var X=p[0],q=v.screenInfo.curve,E=zp.Curve.PointType,L=function(){v._writeToHt(),v._interactor.fp("shapePointStatus",D,g)};if(g===E.Straight)return q.moveCtrlPoint(X,y,"c1"),q.moveCtrlPoint(X,y,"c2"),L(),void 0;if(D===E.Straight){var P=q.findPairs(y,!0),T=P[0],K=T.r1||y,A=T.r2||y,a=A.clone().sub(K).multiplyScalar(.25);return q.moveCtrlPoint(X,y.clone().sub(a),"c1"),q.moveCtrlPoint(X,y.clone().add(a),"c2"),L(),void 0}var I=X.c1,C=X.c2;if(I&&C){if(g===E.Mirrored)return q.moveCtrlPoint(X,y.clone().multiplyScalar(2).sub(C),"c1"),L(),void 0;if(g===E.Asymmetric&&D===E.Disconnected){var H=I.clone().sub(y).length(),a=y.clone().sub(C).setLength(H).add(y);return q.moveCtrlPoint(X,a,"c1"),L(),void 0}}u._firePointChange(),v._interactor.fp("shapePointStatus",D,g)}}}},$n.prototype._handleDataChanged=function(H){var t=this;if(t.screenInfo&&t.target){var b=t._interactor;t.gatherSingleTarget(b.gv,t.target,!0),t.check(b.gv,null,H?b._getLogicalPoint(H):new zp.Math.Vector2(b._lastClientPoint)),b._42()}},$n.prototype.gatherSingleTarget=function(i,C,k){var s,T,c=this;c.screenInfo&&c.screenInfo.curve&&(T=c.screenInfo.curve._curves);var I=c.editing;s=I?c.screenInfo:c.screenInfo={};var X,r,P=C instanceof b.Edge;P?(X=C.s("edge.segments"),r=C.s("edge.points")||new b.List):(X=C._58O,r=C._59O),s.S=X;var q,t=s.P=[],x=zp.getDataMatrix(C);if(C instanceof b.Polyline&&(q=C.getElevation()||0,s.E=[]),r.each(function(a){s.E&&s.E.push(a.e||q),a=x.apply(a);var p=zp.toScreenPosition(i,a);t.push(p.x,p.y)}),P){var H=zp.toScreenPosition(i,C._lastSourcePoint),v=zp.toScreenPosition(i,C._lastTargetPoint);t.splice(0,0,H.x,H.y),t.push(v.x,v.y)}if(!s.S||!s.S.size()){s.S=new b.List,s.S.add(1);for(var l=0;l<t.length/2-1;l++)s.S.add(2)}if((!I||k)&&c.convertToCubicBezier(T),c.activing&&(k||!c.editing||"realPoint"===c.editing.type)){var g=s.curve.findPairs(c.activing.point);c.activing.pairs=g}P&&"points"!==C.s("edge.type")&&c._writeToHt()},$n.prototype._convertToNewPoint=function(L,J,G){var f,c,_;for(f=0,c=J.length;c>f;f++){if(_=J[f],_._p1.isNearEnough(L))return _._p1;if(_._p4.isNearEnough(L))return _._p4}if(G)for(f=0,c=Math.min(G.length,c);c>f;f++){if(_=G[f],_._p1===L)return J[f]._p1;if(_._p4===L)return J[f]._p4}},$n.prototype.convertToCubicBezier=function(a){var X,_,M=this,V=new zp.Math.Curve,q=M.screenInfo;if(V.createFromHtShape(q.P,q.S,q.E),q.curve=V,M.activing){var n=V._curves;if(X=M.activing.point,_=M._convertToNewPoint(X,n,a),_&&(M.activing.point=_),M.activing.selections){var m=-1,R=M.activing.selections;R.forEach(function(f){m++,_=M._convertToNewPoint(f,n,a),_&&(R[m]=_)})}}},$n.prototype.check=function(S,C,H){if(!C||b.Default.isLeftButton(C)){var J=this;if(J._interactor.setCursor("default"),J.editing=null,J.highlight=null,J.tipInfo=null,J.screenInfo){if(jm())return J._interactor._42(),!0;if(J._checkEditCtrlPoint(H))return J._interactor._42(),!0;if(J._checkEditRealPoint(H))return J._interactor._42(),!0;if(J._checkEditElevation(H))return J._interactor._42(),!0;var Z=J.screenInfo.curve,m=Z.checkPoint(H,J._interactor.getStyle("curveIntersectSize"));if(m){var U=J.highlight={};U.type="insertKnot",U.bezier=m.bezier,U.point=m.intersection}return J._interactor._42(),!0}}},$n.prototype._checkEditRealPoint=function(M){var W,g,o,n,F,X,H=this,e=H.screenInfo.curve._curves,Y=H._interactor.getStyle("curvePointIntersectSize"),a=1/0;for(Y*=Y,o=0,n=e.length;n>o;o++)W=e[o],F=W._p1,X=M.distanceToSquared(F),a>X&&(a=X,g=F),F=W._p4,X=M.distanceToSquared(F),a>X&&(a=X,g=F);if(a>Y)return!1;var w=H.highlight={};return w.type="changeRealPoint",w.point=g,H.editing={type:"realPoint",point:g,shiftGuide:{point:g.clone(),dir:"x",limit:0}},H._interactor.setCursor("crosshair"),!0},$n.prototype._checkEditElevation=function($){var j=this;if(!j._interactor.getStyle("curveElevationVisible"))return!1;var S=j.activing;if(!S)return!1;var Y=S.getCurrentEditingPoint();if(!Y)return!1;var u=j._interactor,E=u.getStyle("curveElevationGuideShift"),K=u.getStyle("curveElevationIntersectSize"),B=$.distanceToSquared({x:Y.x+E[0],y:Y.y+E[1]});if(!(B>K*K)){var R=j.highlight={};R.type="elevation";var g=new zp.Math.Vector2($.x,$.y,Y.e);return j.editing={type:"elevation",startPoint:g},j._interactor.setCursor("crosshair"),!0}},$n.prototype._checkEditCtrlPoint=function(J){var t=this;if(t.activing&&!t.activing.selections){var X=t.getCurrentSelectintStatus();if(X!==zp.Curve.PointType.Straight){var z=t.activing.pairs;if(z){var w=t._interactor.getStyle("curvePointIntersectSize");w*=w;var $,b,V,l,c,Z,U,P,N,I=1/0;for(U=0,N=z.length;N>U;U++)for(l=z[U],P=0;2>P;P++)c=0===P?"c1":"c2",l[c]&&(Z=J.distanceToSquared(l[c]),I>Z&&(I=Z,$=l,b=U,V=c));if(I>w)return!1;t.activing.hlpair=$,t.activing.hltype=V;var F=t.highlight={};return F.type="changeCtrlPoint",F.point=$[V],t.editing={type:"ctrlPoint",pair:$,pairId:b,ctrlType:V,direction:$[V].clone().sub(t.activing.point).normalize()},t._interactor.setCursor("crosshair"),!0}}}},$n.prototype.startEdit=function(G,Z){G.startDragging(Z);var e=this;e.highlight&&"insertKnot"===e.highlight.type&&(e.insertKnot(),e.gatherSingleTarget(e._interactor.gv,e.target),e.activing=null,e._checkEditRealPoint(e._interactor._getLogicalPoint(Z)));var g=e._activing;if(g){var r=e.editing?e.editing.type:null;"ctrlPoint"===r?g.editingCtrl={pairId:e.editing.pairId,type:g.hltype}:"realPoint"===r&&(g.editingCtrl=!1)}var C=e.highlight,$=b.Default.isCtrlDown(Z);if(!C||jm()){var u=e._interactor.gv;if(!u.setFocus(Z)||u._scrolling)return;return u.isPannable()&&Cq(Z)&&!$&&(e._pan={tx:u.tx(),ty:u.ty()},G.fi({kind:"beginPan",event:Z})),void 0}if("changeRealPoint"===C.type){var L,q=e.activing?e.activing.point:null,E=e.activing?e.activing.selections:null;if($&&e.activing)q===C.point?(E?(e.activing={point:E[0]},E.length>1&&(E.splice(0,1),e.activing.selections=E)):e.activing=null,e.editing=null):E&&(L=E.indexOf(C.point))>=0?(E.length>1?E.splice(L,1):delete e.activing.selections,e.editing=null):E?(E.push(q),e.activing={point:C.point,selections:E}):e.activing={point:C.point,selections:[q]};else if(E)q===C.point||((L=E.indexOf(C.point))>=0?(E.splice(L,1,q),e.activing={point:C.point,selections:E}):e.activing={point:C.point});else{var Y;q===C.point&&(Y=e.activing.status),e.activing={point:C.point},Y&&(e.activing.status=Y)}G.fi({kind:"beginEditPoint",event:Z})}},$n.prototype.insertKnot=function(){var K=this,m=K.highlight,l=K.screenInfo.curve;l.insertKnot(m.bezier,m.point.t),K._writeToHt()},$n.prototype._writeToHt=function(){var X,f,G,A,c=this,t=c.screenInfo.curve,Y=t.toHtShape(),N=Y.points,g=[],M=Y.segments,I=c._interactor.gv,L=c.target,P=L instanceof b.Edge,h=zp.getDataMatrix(L).invert();A=L instanceof b.Polyline,A&&(G=L.getElevation());for(var R=0,$=N.length;$>R;R++)X=N[R],f=zp.toWorldPosition(I,X),f=h.apply(f),X.e!=q&&X.e!==G&&(f.e=X.e),g.push(f);if(L._writing=!0,P){L.s("edge.type","points"),L.setStyle("edge.segments",M),L.setStyle("edge.points",g.slice(1,g.length-1)),L.setStyle("edge.source.offset.x",0),L.setStyle("edge.source.offset.y",0),L.setStyle("edge.target.offset.x",0),L.setStyle("edge.target.offset.y",0);var v=c._nextChangeEdgeHost;delete c._nextChangeEdgeHost,v&&("source"===v.type?L.setSource(v.host):L.setTarget(v.host)),c._writeEdgeHostAnchor("source",g[0]),c._writeEdgeHostAnchor("target",g[g.length-1])}else g.length?(L.setSegments(M),L.setPoints(g,!0)):L.removeFromDataModel();delete L._writing},$n.prototype._writeEdgeHostAnchor=function(S,G){var x=this,b=x.target,e=x._calcHostAnchor(b,S,G);b.s("edge."+S+".anchor.x",e.x),b.s("edge."+S+".anchor.y",e.y)},$n.prototype._calcHostAnchor=function(l,K,c,d){d||(d="source"===K?l.getSource():l.getTarget());var N=d.getRotation(),j=d.getAnchor(),X=this._interactor.gv;if(iq(d,X)&&(N=0),N){var $=d.getMatrix(),x=$.tfi(c),h=d.getSize();return{x:x.x/h.width+j.x,y:x.y/h.height+j.y}}var _=xh(X,d),w={x:(c.x-_.x)/_.width,y:(c.y-_.y)/_.height};return w},$n.prototype._handlePanning=function(K){var x=this,b=x._pan;if(b){b.started=!0;var c=x._interactor,P=c.gv,G=c._lastClientPoint,V=kl(K);P.setTranslate(b.tx+V.x-G.x,b.ty+V.y-G.y),x.gatherSingleTarget(c.gv,x.target),c._42(),c.fi({kind:"betweenPan",event:K})}},$n.prototype.handleEdit=function(y,u){var d=this,C=d.editing;if(d._pan)return d._handlePanning(u),void 0;if(C){C.inEdit=!0;var W,e,X,t=d._interactor._getLogicalPoint(u),j=b.Default.isCtrlDown(u),O=b.Default.isShiftDown(u),F=C.type,U=d.activing;if(d._guideInfo=null,"ctrlPoint"===F&&O){var c=d.editing.direction.clone();W=U.point;var g=c.dot(t.clone().sub(W));t=c.setLength(g).add(W)}else if("ctrlPoint"===F||"realPoint"===F){var c;if("realPoint"===F&&O){var L=d.editing.shiftGuide;e=L.point;var D=Math.abs(t.x-e.x),K=Math.abs(t.y-e.y);D>K&&D>L.limit&&"y"===L.dir&&(L.dir="x"),K>D&&K>L.limit&&"x"===L.dir&&(L.dir="y"),c=L.dir,"x"===c?(t.y=e.y,L.limit=Math.max(L.limit,D)):"y"===c&&(t.x=e.x,L.limit=Math.max(L.limit,K))}var A=d._isEditEdgeSourceTarget();if(A){var i=d._editEdgeSourceTarget(A,t,j);i&&(X=i.tipText)}else if(!j){var H=d._guidingToEdit(t,c),R="realPoint"===F?d._interactor.gridGuide.findClosest(t,c,!0):null,p=1/0,$=1/0;R&&(R.x&&(p=R.x),R.y&&($=R.y));var E=!1;H&&(H.xList&&(Math.abs(H.x)<=Math.abs(p)?(E=!0,p=H.x):delete H.xList),H.yList&&(Math.abs(H.y)<=Math.abs($)?(E=!0,$=H.y):delete H.yList),E&&(d._guideInfo=H)),isFinite(p)&&(t.x+=p),isFinite($)&&(t.y+=$),E&&(H.v=t)}}var k=d.screenInfo.curve;if("realPoint"===C.type){W=C.point,W.e!==q&&(t.e=W.e),k.moveRealPoint(W,t),C.point=t,d.highlight.point=t;var S=U.status,f=U.selections;if(d.activing={point:t,status:S},f){var _=t.clone().sub(W),w=0;f.forEach(function(B){var Y=B.clone().add(_);k.moveRealPoint(B,Y),f[w++]=Y}),d.activing.selections=f}}else if("ctrlPoint"===C.type){var n=U.pairs,M=n[C.pairId];k.moveCtrlPoint(M,t,C.ctrlType);var r=U.status,G=zp.Curve.PointType;if((r===G.Mirrored||r===G.Asymmetric)&&M.c1&&M.c2){var W=new zp.Math.Vector2(U.point),Q="c1"===C.ctrlType?"c2":"c1";if(r===zp.Curve.PointType.Mirrored)k.moveCtrlPoint(M,W.clone().multiplyScalar(2).sub(t),Q);else if(r===G.Asymmetric){var g=M[Q].clone().sub(W).length(),x=W.clone().sub(M[C.ctrlType]).setLength(g).add(W);isNaN(x.x)||k.moveCtrlPoint(M,x,Q)}}U._firePointChange()}else if("elevation"===C.type){e=C.startPoint;var I=e.e+(e.y-t.y)/y._zoom;d._setCurrentPointImpl("e",I),U._firePointChange(),X="E: "+zp.toFixed(I)}var Z=b.Default.getLogicalPoint(u,d._interactor._canvas);if(Z.x+=zp.Icons.TipShiftX,Z.y+=zp.Icons.TipShiftY,!X){var P=zp.toWorldPosition(y,t);X=""+zp.toFixed(P.x)+", "+zp.toFixed(P.y)}d.tipInfo={helperPos:Z,text:X,size:X.length},d._writeToHt(),d._interactor.fi({kind:"betweenEditPoint",event:u})}},$n.prototype._setCurrentPointImpl=function(b,n){var H=this,X=H._activing;if(!X)return!1;var o=H.target;if(!o)return!1;var c=X.getCurrentEditingPoint();if(!c)return!1;var h=X.editingCtrl;if(!h)var m=c.clone();if("e"===b)c.e=n;else{var S;if("x"===b||"y"===b){var u=X._lastFirePoint;S="x"===b?{x:n,y:u?u.y:0}:{x:u?u.x:0,y:n}}else"object"==typeof b?(S=b,b.e!==q&&(c.e=b.e)):(S={x:arguments[0],y:arguments[1]},arguments[2]!==q&&(c.e=arguments[2]));var z=zp.getDataMatrix(o);S=zp.toScreenPosition(H._interactor.gv,z.apply(S)),c.x=S.x,c.y=S.y}if(!h){var N=m.multiplyScalar(-1).add(c);c.e&&m.e&&(N.e=c.e-m.e),H.screenInfo.curve.moveCtrlDueToRealPointMovement(c,N)}return!0},$n.prototype.setCurrentPoint=function(q,m){return this._setCurrentPointImpl(q,m)?(this._writeToHt(),!0):!1},$n.prototype._isEditEdgeSourceTarget=function(){var R=this,N=R.target;if(!(N instanceof b.Edge))return!1;var V=R.editing.point,Q=R.screenInfo.curve._curves;return V===Q[0]._p1?"source":V===Q[Q.length-1]._p4?"target":!1},$n.prototype._editEdgeSourceTarget=function(C,F,h){var P,d=this,S=d.target;if(P="source"===C?S.getSource():S.getTarget()){var y=d._interactor.gv,K=zp.toWorldPosition(y,F),z=d._calcHostAnchor(S,C,K,P);if(!h){var O=d._interactor.getStyle("anchorRound"),V=d._interactor.getStyle("anchorSensitivity");z.x=zp.roundTo(z.x,O,V),z.y=zp.roundTo(z.y,O,V)}if(d._interactor.getStyle("edgeHostDetectPerFrame")||z.x<0||z.x>1||z.y<0||z.y>1){var n=y.getDataAt(K,function($){return y.isSelectable($)?uq($)?!0:!1:!1});if(n){var $=d._calcHostAnchor(S,C,K,n);P=n,d._nextChangeEdgeHost={type:C,host:n},z=$,h||(z.x=zp.roundTo(z.x,O,V),z.y=zp.roundTo(z.y,O,V))}}if(!h){var q=zb(y,P,0,0,0,z.x,z.y),u=zp.toScreenPosition(y,q);F.x=u.x,F.y=u.y}return d._edgeHostGuideInfo=zp.getTargetCornersOnScreen(y,P),{host:P,anchor:z,tipText:""+z.x.toFixed(2)+", "+z.y.toFixed(2)}}},$n.prototype._guidingToEdit=function(m,t){var X,b,C=this;if(X=C.screenInfo.curve){b=X._curves;var F,G,s,D,H,S,g,U,l=1/0,R=1/0,u=[];for(C.editing&&"realPoint"===C.editing.type&&(U=C.editing.point),H=0,S=2*b.length;S>H;H++)g=b[Math.floor(H/2)][H%2?"_p4":"_p1"],u.indexOf(g)>=0||(u.push(g),U&&U===g||(s=g.x-m.x,D=g.y-m.y,Math.abs(s)<Math.abs(l)?(l=s,F=[g]):s===l&&F.push(g),Math.abs(D)<Math.abs(R)?(R=D,G=[g]):D===R&&G.push(g)));var I=C._interactor.getStyle("smartGuideSensitivity");if((Math.abs(l)>I||"y"===t)&&(F=null),(Math.abs(R)>I||"x"===t)&&(G=null),F||G){var T=!1,d={};if(F&&(T=!0,d.xList=F,d.x=l),G&&(T=!0,d.yList=G,d.y=R),T)return d}}},$n.prototype._46O=function(X){var j=this;j.editing&&(j.editing=null,j._interactor.fi({kind:"endEditPoint",event:X})),j._guideInfo=null,j._edgeHostGuideInfo=null,j._pan&&(j._pan=null,j._interactor.fi({kind:"endPan",event:X})),j.tipInfo=null},$n.prototype._canDeletePoint=function(P,R){var w=this.target;if(!(w instanceof b.Edge))return!0;var E=P._curves[0],k=P._curves[P._curves.length-1];return E._p1===R||k._p4===R?!1:!0},$n.prototype.handleDelete=function(){var r=this;if(r.activing&&r.screenInfo){var V=b.Default.isShiftDown(),E=r.screenInfo.curve;r._canDeletePoint(E,r.activing.point)&&E.deleteRealPoint(r.activing.point,V),r.activing.selections&&r.activing.selections.forEach(function(L){r._canDeletePoint(E,L)&&E.deleteRealPoint(L,V)}),r.activing=null,delete r.editing,delete r.tipInfo,delete r._pan,r._writeToHt(),r._interactor.fp("deleteShapePoint",!1,!0)}},$n.prototype.handleDoubleClick=function(Z){var M=this,o=M._interactor._getLogicalPoint(Z);if(M.screenInfo&&M._checkEditRealPoint(o)){var _=M.getCurrentSelectintStatus(),l=zp.Curve.PointType;return _=_===l.Mirrored?l.Straight:l.Mirrored,M._setCurrentSelectionStatus(_),M._interactor._42(),!0}},$n.prototype._drawHighlight=function(k){var H=this,F=H.highlight;if(F){var y=F.bezier,M=H._interactor;y&&zp.Icons.DrawIcon(M,k,zp.Icons.ShapeHighlightCurve,[y._p1.x,y._p1.y,y._p2.x,y._p2.y,y._p3.x,y._p3.y,y._p4.x,y._p4.y]);var C=F.point;C&&"insertKnot"===F.type&&zp.Icons.DrawIcon(M,k,zp.Icons.ShapeHighlighPoint,C)}},$n.prototype._drawGuide=function(p){var u=this,x=u._guideInfo;if(x){var b,$,v,w,y=x.v;for(b=0;2>b;b++)if(w=0===b?x.xList:x.yList)for($=0,v=w.length;v>$;$++)zp.Icons.DrawIcon(u._interactor,p,zp.Icons.ShapeGuideLine,[y.x,y.y,w[$].x,w[$].y])}},$n.prototype._drawCurrentPoint=function(a){var S=this;if(S.activing){var r=S.activing,f=S.getCurrentSelectintStatus(),u=S._interactor;if(f!==zp.Curve.PointType.Straight){var q=r.pairs;r.hlpair,r.hltype;var e=r.selections,V=r.editingCtrl;if(q&&!e){var N,G,l;for(G=0,l=q.length;l>G;G++)N=q[G],V&&G===V.pairId&&N[V.type]?zp.Icons.DrawIcon(u,a,zp.Icons.ShapeActivingCtrl,{point:N.point,c1:N.c1,c2:N.c2,hl:V.type}):zp.Icons.DrawIcon(u,a,zp.Icons.ShapeActivingCtrl,N)}}zp.Icons.DrawIcon(u,a,zp.Icons.ShapeHighlighRealPoint,S.activing.point),e&&e.forEach(function(S){zp.Icons.DrawIcon(u,a,zp.Icons.ShapeHighlighRealPoint,S)})}},$n.prototype.clear=function(){var J=this;J.editing=null,J._guideInfo=null,J.activing=null,J.highlight=null},$n.prototype._42=function(n){var q=this;q.info={},q.editing||(q.screenInfo=null);var I=q._interactor;if(!I.editDetail)return q.clear(),void 0;if(!q.target||!q._interactor.gv.isSelected(q.target)||!q._interactor.gv.isVisible(q.target))return I.editDetail=!1,q.clear(),void 0;if(q.gatherSingleTarget(I.gv,q.target),zp.Icons.DrawIcon(I,n,zp.Icons.ShapeBgCurve,q.screenInfo),q._drawHighlight(n),q._drawCurrentPoint(n),q._getRealPoint().forEach(function(L){zp.Icons.DrawIcon(I,n,zp.Icons.ShapePoint,L)}),q._drawGuide(n),q.tipInfo&&zp.Icons.DrawIcon(I,n,zp.Icons.TipHelper,q.tipInfo),q._edgeHostGuideInfo&&zp.Icons.DrawIcon(I,n,zp.Icons.NodeHoverGuide,q._edgeHostGuideInfo),q._interactor.getStyle("curveElevationVisible")&&q.target instanceof b.Polyline&&q.activing){var z=q.activing.getCurrentEditingPoint();z&&zp.Icons.DrawIcon(I,n,zp.Icons.EdgeElevationGuide,z)}},$n.prototype._getRealPoint=function(){var Q,O=this.screenInfo,W=O.P,w=O.S,i=-1,u=[],x=-1,c=w.length;return w.each(function(d){x++;var B=1;if(3===d)B=2;else if(4===d)B=3;else if(5===d)return;i+=B,Q=x+1>=c?!0:1===w.get(x+1)?!0:!1,u.push({point:{x:W[2*i],y:W[2*i+1]},isEnd:Q})}),u};var Oi=zp.MoveHelper=function(e){var n=this;n.catalog="Move",n._interactor=e};Oi.prototype={},Oi.prototype.constructor=Oi,Oi.prototype.calcShift=function(q,I,K){var t,e,g=this,y=g._interactor.gv,D=y.lp(I);if("beginMove"===q&&g._gatherGridInfo(K._lastLogicalPoint||D),t=g._target){var u=t.downPosition;if(u){var k=g._interactor.getStyle("moveSensitivity")/y._zoom;if(u.distanceTo(D)<k)return{x:0,y:0};delete t.downPosition}var p;e=b.Default.isShiftDown(I),e&&(D=g._dealShiftDown(D),p=t.shiftGuide.dir);var B,a=t.rawPos={x:t.pos.x+D.x-t.lp.x,y:t.pos.y+D.y-t.lp.y};if(b.Default.isCtrlDown(I)){if(B=g._calcShiftByAddon(),g._target.node instanceof zp.Group){var U=g._target.node;U._position.x+=B.x,U._position.y+=B.y}return B}for(var v,h=t.x+a.x,j=t.y+a.y,P={x:h,y:j},z={x:h+t.w/2,y:j+t.h/2},J={x:h+t.w,y:j+t.h},O=g._interactor.rectGuide,n=g._interactor.gridGuide,l=[O.findClosest(P,p),O.findClosest(z,p),O.findClosest(J,p),n.findClosest(P,p),n.findClosest(z,p),n.findClosest(J,p)],d=1/0,$=1/0,A=0,X=l.length;X>A;A++)v=l[A],v&&(h=v.x,j=v.y,isFinite(h)&&Math.abs(h)<Math.abs(d)&&(d=h),isFinite(j)&&Math.abs(j)<Math.abs($)&&($=j));if(isFinite(d)||(d=0),isFinite($)||($=0),B=g._calcShiftByAddon(d,$),g._target.node instanceof zp.Group){var U=g._target.node;U._position.x+=B.x,U._position.y+=B.y}var M=t.node;if(!iq(M,y)){var w=a.x+d,F=a.y+$;g._interactor.rectGuide.gatherLines({node:M,x:t.x+w,y:t.y+F,w:t.w,h:t.h},p)}return B}},Oi.prototype._calcShiftByAddon=function(T,Y){var U=this._target,d=U.rawPos,V=U.node.getPosition();return T=T||0,Y=Y||0,{x:d.x-V.x+T,y:d.y-V.y+Y}},Oi.prototype._dealShiftDown=function(J){var v=this,S=v._target.shiftGuide,f=v._target.lp,N=Math.abs(J.x-f.x),u=Math.abs(J.y-f.y);N>u&&N>S.limit&&"y"===S.dir&&(S.dir="x"),u>N&&u>S.limit&&"x"===S.dir&&(S.dir="y");var F=S.dir;return"x"===F?(J.y=f.y,S.limit=Math.max(S.limit,N)):"y"===F&&(J.x=f.x,S.limit=Math.max(S.limit,u)),J},Oi.prototype._gatherGridInfo=function(O){var n,U=this,D=U._interactor,k=D._getValidSelection();if(1===k.length){if(n=k[0],!n.getRect)return U._target=null,void 0}else if(n=zp.Group.findOrCreateGroup(k),!n)return U._target=null,void 0;var p=n.getPosition(),I=n.getRect();U._target={node:n,x:I.x-p.x,y:I.y-p.y,w:I.width,h:I.height,lp:{x:O.x,y:O.y},pos:{x:p.x,y:p.y},shiftGuide:{dir:"x",limit:0},downPosition:new zp.Math.Vector2(O)},D.rectGuide.gatherRects()},Oi.prototype.clear=function(){var V=this;V._interactor.rectGuide.clear(),V._interactor._42()};var pc="directional",$b="point",os="spot",ye="light.color",Si=function(F,Z){Ub(Z)&&Dd.test(Z)?yn(F,Z):qc(Z)&&Z.modelType?Re(F,Z):So[F]=Z},ms=function(Q){if(qc(Q))return Q;var G=So[Q];return Q&&G===q&&Dd.test(Q)&&(zk&&zk[Q]||yn(Q,Q)),G};Pr(t,{graph3dViewAttributes:T,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:X/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:Xr,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:X/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,setShape3dModel:Si,getShape3dModel:ms,createMatrix:function(t,n){Wd(t)||(t=[t]);for(var u=t.length-1;u>=0;u--){var H=t[u];n=sf(H.mat,H.s3,H.r3,H.rotationMode,H.t3,n)}return n},transformVec:function(k,c){return rm(k,c)},createBoxModel:function(){return{vs:Wo,ns:Jl,uv:Ob,is:Eo}},createRoundRectModel:function(L,R){return ij.roundRect(L,R)},createStarModel:function(M,v){return ij.star(M,v)},createRectModel:function(X,d){return ij.rect(X,d)},createTriangleModel:function(r,I){return ij.triangle(r,I)},createRightTriangleModel:function(A,z){return ij.rightTriangle(A,z)},createParallelogramModel:function(q,z){return ij.parallelogram(q,z)},createTrapezoidModel:function(D,s){return ij.trapezoid(D,s)},createSmoothSphereModel:function(v,L,f,z,e,k,Z){return og(new bl(v,L,f,z,e,k,Z))},createSphereModel:function(Q,U,n,D,V,Y){return Q?jf(Q,U,n,D,V,Y):t.createSmoothSphereModel()},createSmoothConeModel:function(o,F,Y,i,p){return jc(o,F,Y,i,p)},createConeModel:function(H,i,k,M,Z,I){return H?lm(H,i,k,M,Z,I):jc(I)},createSmoothCylinderModel:function(F,C,g,s,c,P,p,o){return og(new gf(F,C,g,s,c,P,p,o))},createCylinderModel:function(s,t,X,M,u,A,E){return s?ug(s,t,X,M,u,A,E):ng(A,E)},createSmoothTorusModel:function(w,q,P,I,R,D){return og(new qk(w,q,P,I,R,D))},createTorusModel:function(f,h,Y,N,g,e,T){return f?ml(f,h,Y,N,g,e,T):Lo(e,T)},createExtrusionModel:function(Z,r,H,I,s,o,g,e){return Lj(Z,r,H,I,s,o,g,e)},createSmoothRingModel:function(Q,U,o,M,j,s){for(var r=[],w=0;w<Q.length-1;w+=2)r.push({x:Q[w],y:Q[w+1]});for(Q=jq(r,U,o)[0],r=[],w=0;w<Q.length;w++){var Y=Q[w];r.push(new pj(Y.x,0,Y.y))}return og(new jj(r,s,M,j))},createTextGeometry:function(w,W){return og(new oo(w,W))},loadFontFace:function(h,N){t.xhrLoad(h,function(j){if(!j)return N();var E;try{E=JSON.parse(j)}catch(K){E=JSON.parse(j.substring(65,j.length-2))}hq.loadFace(E),N&&N(E.familyName.toLowerCase())},N?null:{sync:!0})},createRingModel:function(C,d,v,b,V,p,a,H,n,R){for(var A=[],r=0;r<C.length-1;r+=2)A.push({x:C[r],y:C[r+1]});p=p||t.shapeSide,a=a||0,H=H||p;var x,w,m,E,$,F,e,L,q,z,r,k,W,N,u,X,Y,B,D=[],s=[],l=n?[]:T,M=n?[]:T,g=R?[]:T,f=R?[]:T,i=b?[]:T,I=b?[]:T,J=V?[]:T,G=V?[]:T,C=jq(A,d,v),K=Gb(C),c=0,O=2*Math.PI/p;return C.forEach(function(d){if(m=d.length,m>1){if(E=d[0],b)for(F=E.x,L=E.y,r=a;H>r;r++)k=r+1,W=r*O,N=k*O,u=o(W),X=U(W),Y=o(N),B=U(N),i.push(u*F,L,-X*F,Y*F,L,-B*F,0,L,0),I.push(.5-.5*u,.5-.5*X,.5-.5*Y,.5-.5*B,.5,.5);for(z=0;m>z;z++){for($=d[z],F=E.x,e=$.x,L=E.y,q=$.y,x=c/K,c+=Bc(E,$),w=c/K,r=a;H>r;r++)k=r+1,W=r*O,N=k*O,u=o(W),X=U(W),Y=o(N),B=U(N),D.push(u*e,q,-X*e,Y*e,q,-B*e,u*F,L,-X*F,Y*e,q,-B*e,Y*F,L,-B*F,u*F,L,-X*F),s.push(r/p,w,k/p,w,r/p,x,k/p,w,k/p,x,r/p,x),n&&r===a&&(l.push(0,L,0,0,q,0,u*e,q,-X*e,u*e,q,-X*e,u*F,L,-X*F,0,L,0),M.push(0,.5-L,0,.5-q,2*e,.5-q,2*e,.5-q,2*F,.5-L,0,.5-L)),R&&k===H&&(g.push(0,L,0,Y*e,q,-B*e,0,q,0,Y*e,q,-B*e,0,L,0,Y*F,L,-B*F),f.push(1,.5-L,1-2*e,.5-q,1,.5-q,1-2*e,.5-q,1,.5-L,1-2*F,.5-L));
E=$}if(V)for(F=E.x,L=E.y,r=a;H>r;r++)k=r+1,W=r*O,N=k*O,u=o(W),X=U(W),Y=o(N),B=U(N),J.push(Y*F,L,-B*F,u*F,L,-X*F,0,L,0),G.push(.5-.5*Y,.5+.5*B,.5-.5*u,.5+.5*X,.5,.5)}}),{vs:D,uv:s,bottom_vs:J,bottom_uv:G,top_vs:i,top_uv:I,from_vs:l,from_uv:M,to_vs:g,to_uv:f}}},!0),Pr(f,{"3d.move.mode":q,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":q,"edge.gradient.color":q,"edge.source.t3":q,"edge.target.t3":q,"light.type":$b,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":X/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":bk,"wf.short":!1,"wf.mat":q,"wf.geometry":!1,batch:q,"transparent.mask":!1,brightness:q,"select.brightness":.7,"repeat.uv.length":q,alphaTest:.4,"label.face":Af,"label.t3":q,"label.r3":q,"label.texture.scale":2,"label.rotationMode":oj,"label.light":!1,"label.blend":q,"label.reverse.flip":!1,"label.reverse.color":Ql,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Af,"label2.t3":q,"label2.r3":q,"label2.texture.scale":2,"label2.rotationMode":oj,"label2.light":!1,"label2.blend":q,"label2.reverse.flip":!1,"label2.reverse.color":Ql,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Af,"note.t3":q,"note.r3":q,"note.texture.scale":2,"note.rotationMode":oj,"note.light":!1,"note.blend":q,"note.reverse.flip":!1,"note.reverse.color":Ql,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Af,"note2.t3":q,"note2.r3":q,"note2.texture.scale":2,"note2.rotationMode":oj,"note2.light":!1,"note2.blend":q,"note2.reverse.flip":!1,"note2.reverse.color":Ql,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:q,"shape3d.color":hm,"shape3d.top.color":q,"shape3d.bottom.color":q,"shape3d.from.color":q,"shape3d.to.color":q,"shape3d.image":q,"shape3d.top.image":q,"shape3d.bottom.image":q,"shape3d.from.image":q,"shape3d.to.image":q,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":q,"shape3d.side.to":q,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":q,"shape3d.opacity":q,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Ql,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":q,"shape3d.uv.scale":q,"shape3d.top.uv.offset":q,"shape3d.top.uv.scale":q,"shape3d.bottom.uv.offset":q,"shape3d.bottom.uv.scale":q,"shape3d.from.uv.offset":q,"shape3d.from.uv.scale":q,"shape3d.to.uv.offset":q,"shape3d.to.uv.scale":q,"shape3d.top.cap":q,"shape3d.bottom.cap":q,"shape3d.start.angle":0,"shape3d.sweep.angle":p,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":q,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"all.light":!0,"all.visible":!0,"all.color":hm,"all.image":q,"all.blend":q,"all.opacity":q,"all.reverse.flip":!1,"all.reverse.color":Ql,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":q,"all.uv.offset":q,"all.uv.scale":q,"all.discard.selectable":!0,mat:q,"left.mat":q,"right.mat":q,"top.mat":q,"bottom.mat":q,"front.mat":q,"back.mat":q},!0);var Zo,mc=!1,us=[0,0,0,0],Nk={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:vn,2:ib,3:Nm,4:ak,5:Af,6:Yr}},Td=function(f,Y,C,P){if(Y.getFaceVisible(f,C)){vh(Y,ap(f,Y.getFaceMat(f,C)||Y.getMat(f)));var k=Y._26I;Y.getFaceReverseCull(f,C)?k.enable(k.CULL_FACE):k.disable(k.CULL_FACE),sm(k,Y._prg.uFixPickReverseColor,Nk[C]),Li(k),Ec(k,P,6),Gr(k),Qb(Y)}},Vr=function(I){return I instanceof oi},mr=function(r){return[r.x,r.e||0,r.y]},fo=function(w,p,z){for(var p=Uf(p),e=p[0],L=p[1],Y=p[2];z--;)w.push(e,L,Y)},Qo=function(z,_,x){for(var _=Uf(_),L=_[0],U=_[1],d=_[2],g=_[3];x--;)z.push(L,U,d,g)},sr=function(J,I,A){if(I)for(var w,N,X,c=I[0],E=I[1],i=I[2],b=I[4],u=I[5],a=I[6],S=I[8],j=I[9],R=I[10],q=I[12],O=I[13],o=I[14],l=A.length,W=0,W=0;l>W;W+=3)w=A[W],N=A[W+1],X=A[W+2],J.push(c*w+b*N+S*X+q,E*w+u*N+j*X+O,i*w+a*N+R*X+o);else fj(J,A)},mq=function(Z,X){var y=X.s("light.intensity"),b=Uf(X.s(ye)),v=b[0],R=b[1],f=b[2];1!==y&&(v*=y,R*=y,f*=y),Z.push(v,R,f,X.s("light.disabled")?1:0)},qf=function(T,s,I){sm(s,I.uHeadlightRange,T._headlightRange);var L=T._headlightIntensity,l=Uf(T._headlightColor);1!==L&&(l=[l[0]*L,l[1]*L,l[2]*L]),sm(s,I.uHeadlightColor,[l[0],l[1],l[2],T._headlightDisabled?1:0]);var g=T._59O,U=T._spots,Y=T._dirs;if(g.length){var R=[],P=[],t=[];g.forEach(function(C){mq(R,C),fj(P,T._transformPointToViewSpace(C.p3())),t.push(C.s("light.range"))}),s.uniform4fv(I.uPointColor,R),s.uniform1fv(I.uPointRange,t),s.uniform3fv(I.uPointPosition,P)}if(U.length){var O=[],m=[],v=[],Q=[],f=[],F=[];U.forEach(function(t){mq(O,t),fj(m,T._transformPointToViewSpace(t.p3())),fj(f,T._transformDirectionToViewSpace(t.p3(),t.s("light.center"))),v.push(t.s("light.range")),Q.push(o(t.s("light.angle")/2)),F.push(t.s("light.exponent"))}),s.uniform4fv(I.uSpotColor,O),s.uniform1fv(I.uSpotRange,v),s.uniform1fv(I.uSpotAngle,Q),s.uniform1fv(I.uSpotExponent,F),s.uniform3fv(I.uSpotPosition,m),s.uniform3fv(I.uSpotDirection,f)}if(Y.length){var p=[],E=[];Y.forEach(function(V){mq(p,V),fj(E,T._transformDirectionToViewSpace(V.p3()))}),s.uniform4fv(I.uDirColor,p),s.uniform3fv(I.uDirDirection,E)}},Xf=function(t){return t>0&&0===(t-1&t)},vi=function(J){return J=i(0,B(X,J)),J=i(or,B(X-or,J))},Hr=function(){return.05+v()/2},rj=function(B,I,A,z){var o,G=B.getEye();return B.isOrtho()?(o=nj(B.getCenter(),G),o[0]+=z[0],o[1]+=z[1],o[2]+=z[2]):o=G,Bp(I,A,z,o)},Bp=function(M,J,$,s){var E=zq(M,J),e=nj(s,$,!0),P=zq(e,J);if(S(P)<or)return T;var n=(E-zq($,J))/P;return[$[0]+e[0]*n,$[1]+e[1]*n,$[2]+e[2]*n]},Th=function(Z,w){return{x:2*Z.x-w.x,y:2*Z.y-w.y}},es=function(A,w,f,d){var B,j;if(!A)return B=J(w.y-f.y,f.x-w.x),{x:w.x+d*U(B),y:w.y+d*o(B)};if(!f)return B=J(A.y-w.y,w.x-A.x),{x:w.x+d*U(B),y:w.y+d*o(B)};var C=nj([A.x,A.y,0],[w.x,w.y,0],!0),b=nj([f.x,f.y,0],[w.x,w.y,0],!0),h=-(C[0]+b[0])/2,r=-(C[1]+b[1])/2,n=E(h*h+r*r);if(or>n)return B=J(A.y-w.y,w.x-A.x),{x:w.x+d*U(B),y:w.y+d*o(B)};var P=A.x-w.x,G=A.y-w.y,e=f.x-w.x,p=f.y-w.y,u=E(P*P+G*G),N=E(e*e+p*p);B=g(zq(C,b))/2,j=C[1]*b[0]-C[0]*b[1]>0?-1:1,h/=n,r/=n;var z=d/U(B),m=i(u,N)/o(B);n=Math.min(z,m);var q={x:w.x+j*n*h,y:w.y+j*n*r};return f.b&&z>N/o(B)&&(q.adjust=!0),q},wc=function(C){var S=C[1],r=C[2],F=C[3],$=C[6],G=C[7],x=C[11];C[1]=C[4],C[2]=C[8],C[3]=C[12],C[4]=S,C[6]=C[9],C[7]=C[13],C[8]=r,C[9]=$,C[11]=C[14],C[12]=F,C[13]=G,C[14]=x},Ih=function(v){var D=v[0],l=v[1],f=v[2],W=v[3],C=v[4],r=v[5],O=v[6],x=v[7],o=v[8],S=v[9],F=v[10],R=v[11],q=v[12],g=v[13],m=v[14],H=v[15],E=D*r-l*C,p=D*O-f*C,i=D*x-W*C,a=l*O-f*r,V=l*x-W*r,N=f*x-W*O,Q=o*g-S*q,_=o*m-F*q,j=o*H-R*q,$=S*m-F*g,n=S*H-R*g,G=F*H-R*m,s=E*G-p*n+i*$+a*j-V*_+N*Q;return s?(s=1/s,v[0]=(r*G-O*n+x*$)*s,v[1]=(f*n-l*G-W*$)*s,v[2]=(g*N-m*V+H*a)*s,v[3]=(F*V-S*N-R*a)*s,v[4]=(O*j-C*G-x*_)*s,v[5]=(D*G-f*j+W*_)*s,v[6]=(m*i-q*N-H*p)*s,v[7]=(o*N-F*i+R*p)*s,v[8]=(C*n-r*j+x*Q)*s,v[9]=(l*j-D*n-W*Q)*s,v[10]=(q*V-g*i+H*E)*s,v[11]=(S*i-o*V-R*E)*s,v[12]=(r*_-C*$-O*Q)*s,v[13]=(D*$-l*_+f*Q)*s,v[14]=(g*p-q*a-m*E)*s,v[15]=(o*a-S*p+F*E)*s,void 0):T},Nf=function(M,h){if(h){var Z=h[0],I=h[1],b=h[2];M[12]=M[0]*Z+M[4]*I+M[8]*b+M[12],M[13]=M[1]*Z+M[5]*I+M[9]*b+M[13],M[14]=M[2]*Z+M[6]*I+M[10]*b+M[14],M[15]=M[3]*Z+M[7]*I+M[11]*b+M[15]}},hb=function(o,r){if(r){var N=r[0],E=r[1],a=r[2];o[0]=o[0]*N,o[1]=o[1]*N,o[2]=o[2]*N,o[3]=o[3]*N,o[4]=o[4]*E,o[5]=o[5]*E,o[6]=o[6]*E,o[7]=o[7]*E,o[8]=o[8]*a,o[9]=o[9]*a,o[10]=o[10]*a,o[11]=o[11]*a}},nm=function(d,u,R){var _=u[0],B=u[1],J=u[2],G=u[3],s=u[4],q=u[5],h=u[6],L=u[7],T=u[8],C=u[9],n=u[10],o=u[11],V=u[12],X=u[13],c=u[14],a=u[15],f=R[0],D=R[1],E=R[2],r=R[3];return d[0]=f*_+D*s+E*T+r*V,d[1]=f*B+D*q+E*C+r*X,d[2]=f*J+D*h+E*n+r*c,d[3]=f*G+D*L+E*o+r*a,f=R[4],D=R[5],E=R[6],r=R[7],d[4]=f*_+D*s+E*T+r*V,d[5]=f*B+D*q+E*C+r*X,d[6]=f*J+D*h+E*n+r*c,d[7]=f*G+D*L+E*o+r*a,f=R[8],D=R[9],E=R[10],r=R[11],d[8]=f*_+D*s+E*T+r*V,d[9]=f*B+D*q+E*C+r*X,d[10]=f*J+D*h+E*n+r*c,d[11]=f*G+D*L+E*o+r*a,f=R[12],D=R[13],E=R[14],r=R[15],d[12]=f*_+D*s+E*T+r*V,d[13]=f*B+D*q+E*C+r*X,d[14]=f*J+D*h+E*n+r*c,d[15]=f*G+D*L+E*o+r*a,d},bp=function(c,U,I,l){var h,b,n,X,Y,v,N,D,d,P,e=U[0],C=U[1],w=U[2],x=l[0],B=l[1],V=l[2],M=I[0],z=I[1],f=I[2];return S(e-M)<or&&S(C-z)<or&&S(w-f)<or?wl(c):(N=e-M,D=C-z,d=w-f,P=1/E(N*N+D*D+d*d),N*=P,D*=P,d*=P,h=B*d-V*D,b=V*N-x*d,n=x*D-B*N,P=E(h*h+b*b+n*n),P?(P=1/P,h*=P,b*=P,n*=P):(h=0,b=0,n=0),X=D*n-d*b,Y=d*h-N*n,v=N*b-D*h,P=E(X*X+Y*Y+v*v),P?(P=1/P,X*=P,Y*=P,v*=P):(X=0,Y=0,v=0),c[0]=h,c[1]=X,c[2]=N,c[3]=0,c[4]=b,c[5]=Y,c[6]=D,c[7]=0,c[8]=n,c[9]=v,c[10]=d,c[11]=0,c[12]=-(h*e+b*C+n*w),c[13]=-(X*e+Y*C+v*w),c[14]=-(N*e+D*C+d*w),c[15]=1,c)},ki=function(h,l,k,y,$){var v=1/s(l/2),K=1/(y-$);return h[0]=v/k,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=v,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=($+y)*K,h[11]=-1,h[12]=0,h[13]=0,h[14]=2*$*y*K,h[15]=0,h},Bd=function(f,v,r,y,Y,L,C){var A=1/(v-r),p=1/(y-Y),D=1/(L-C);return f[0]=-2*A,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=-2*p,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=2*D,f[11]=0,f[12]=(v+r)*A,f[13]=(Y+y)*p,f[14]=(C+L)*D,f[15]=1,f},dr=function(m,i){var F=i[0],b=i[1],Y=i[2],Z=i[3],A=F*F+b*b+Y*Y+Z*Z,f=A?1/A:0;return m[0]=-F*f,m[1]=-b*f,m[2]=-Y*f,m[3]=Z*f,m},Vg=function(i,$){var L=$[0]+$[5]+$[10],v=0;return L>0?(v=2*Math.sqrt(L+1),i[3]=.25*v,i[0]=($[6]-$[9])/v,i[1]=($[8]-$[2])/v,i[2]=($[1]-$[4])/v):$[0]>$[5]&$[0]>$[10]?(v=2*Math.sqrt(1+$[0]-$[5]-$[10]),i[3]=($[6]-$[9])/v,i[0]=.25*v,i[1]=($[1]+$[4])/v,i[2]=($[8]+$[2])/v):$[5]>$[10]?(v=2*Math.sqrt(1+$[5]-$[0]-$[10]),i[3]=($[8]-$[2])/v,i[0]=($[1]+$[4])/v,i[1]=.25*v,i[2]=($[6]+$[9])/v):(v=2*Math.sqrt(1+$[10]-$[0]-$[5]),i[3]=($[1]-$[4])/v,i[0]=($[8]+$[2])/v,i[1]=($[6]+$[9])/v,i[2]=.25*v),i},Lq=function(F,b,L){var Y=b[0],Z=b[1],x=b[2],G=b[3],v=Y+Y,d=Z+Z,u=x+x,D=Y*v,l=Y*d,j=Y*u,$=Z*d,C=Z*u,w=x*u,q=G*v,o=G*d,B=G*u;return F[0]=1-($+w),F[1]=l+B,F[2]=j-o,F[3]=0,F[4]=l-B,F[5]=1-(D+w),F[6]=C+q,F[7]=0,F[8]=j+o,F[9]=C-q,F[10]=1-(D+$),F[11]=0,F[12]=L[0],F[13]=L[1],F[14]=L[2],F[15]=1,F},Fe=function(){var d=[0,0,0],f=[0,0,0],n=[0,0,0],j=function(d,l,B){d[0]=l[1]*B[2]-l[2]*B[1],d[1]=l[2]*B[0]-l[0]*B[2],d[2]=l[0]*B[1]-l[1]*B[0]},C=function(x){return x[0]*x[0]+x[1]*x[1]+x[2]*x[2]},P=function(S){var h=Math.sqrt(C(S));S[0]/=h,S[1]/=h,S[2]/=h},N=function(_,c,H){_[0]=c[0]-H[0],_[1]=c[1]-H[1],_[2]=c[2]-H[2]};return function(S,u,w){var H=nn();return N(n,S,u),0===C(n)&&(n[2]=1),P(n),j(d,w,n),0===C(d)&&(1===Math.abs(w[2])?n[0]+=1e-4:n[2]+=1e-4,P(n),j(d,w,n)),P(d),j(f,n,d),H[0]=d[0],H[4]=f[0],H[8]=n[0],H[1]=d[1],H[5]=f[1],H[9]=n[1],H[2]=d[2],H[6]=f[2],H[10]=n[2],H}}(),xg=function(v,J){if(v.vr.enable){var _=v.vr.getViewMatrix(J);if(_)return _}return bp(J?J:nn(),v._eye,v._center,v._up)},gh=function(P){if(P.vr.enable){var I=P.vr.getProjectMatrix();if(I)return I}var x=P.getAspect(),M=P._near,Z=P._far,y=nn();if(P._ortho){var r=P._orthoWidth/2,b=r/x;Bd(y,-r,r,-b,b,M,Z)}else ki(y,P._fovy,x,M,Z);return y},Jj=function(Y,I){if(!Y)return T;var i=0,p=1,D=2,g=[],U=0,_=Y.length,m=_/3;if(I){for(;_>U;U++)g[U]=0;for(U=0;U<I.length;U+=3){var q=[],S=[],y=[];q[i]=Y[3*I[U+1]+i]-Y[3*I[U]+i],q[p]=Y[3*I[U+1]+p]-Y[3*I[U]+p],q[D]=Y[3*I[U+1]+D]-Y[3*I[U]+D],S[i]=Y[3*I[U+2]+i]-Y[3*I[U+1]+i],S[p]=Y[3*I[U+2]+p]-Y[3*I[U+1]+p],S[D]=Y[3*I[U+2]+D]-Y[3*I[U+1]+D],y[i]=q[p]*S[D]-q[D]*S[p],y[p]=q[D]*S[i]-q[i]*S[D],y[D]=q[i]*S[p]-q[p]*S[i];for(var t=0;3>t;t++)g[3*I[U+t]+i]+=y[i],g[3*I[U+t]+p]+=y[p],g[3*I[U+t]+D]+=y[D]}}else for(U=0;m>U;U+=3){var q=[],S=[],y=[];q[i]=Y[3*(U+1)+i]-Y[3*U+i],q[p]=Y[3*(U+1)+p]-Y[3*U+p],q[D]=Y[3*(U+1)+D]-Y[3*U+D],S[i]=Y[3*(U+2)+i]-Y[3*(U+1)+i],S[p]=Y[3*(U+2)+p]-Y[3*(U+1)+p],S[D]=Y[3*(U+2)+D]-Y[3*(U+1)+D],y[i]=q[p]*S[D]-q[D]*S[p],y[p]=q[D]*S[i]-q[i]*S[D],y[D]=q[i]*S[p]-q[p]*S[i];for(var t=0;3>t;t++)g[3*(U+t)+i]=y[i],g[3*(U+t)+p]=y[p],g[3*(U+t)+D]=y[D]}for(U=0;_>U;U+=3){var W=[];W[i]=g[U+i],W[p]=g[U+p],W[D]=g[U+D];var B=E(W[i]*W[i]+W[p]*W[p]+W[D]*W[D]);0===B&&(B=or),W[i]=W[i]/B,W[p]=W[p]/B,W[D]=W[D]/B,g[U+i]=W[i],g[U+p]=W[p],g[U+D]=W[D]}return new Lg(g)},Yc=function(I,j,x,w){if(x||(x=I.createTexture()),j){var L=I.TEXTURE_2D,g=I.REPEAT,R=I.CLAMP_TO_EDGE,Q=I.TEXTURE_MIN_FILTER;w!==I.NEAREST&&(w=I.LINEAR),Kr(I,x),I.texImage2D(L,0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,j),qp(I,I.TEXTURE_MAG_FILTER,w);var F=j.naturalWidth||j.width,M=j.naturalHeight||j.height;Xf(F)&&Xf(M)&&!j.clampToEdge?(qp(I,I.TEXTURE_WRAP_S,g),qp(I,I.TEXTURE_WRAP_T,g),qp(I,Q,I.LINEAR_MIPMAP_LINEAR),I.generateMipmap(L)):(qp(I,I.TEXTURE_WRAP_S,R),qp(I,I.TEXTURE_WRAP_T,R),qp(I,Q,w)),Kr(I,T)}return x},Nb=function(t,G){var F=new Uint8Array(3);return G=G||t.createTexture(),Kr(t,G),qp(t,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGB,1,1,0,t.RGB,t.UNSIGNED_BYTE,F),G},xq=function(x){x._26I&&x._prg&&(x._26I.deleteProgram(x._prg),x._prg=T)},ho=function(t,O,Y,f){var d=t.createShader(Y);return t.shaderSource(d,f),t.compileShader(d),t.attachShader(O,d),d},Gl=function($){return $.createBuffer()},Kr=function(p,h){p.bindTexture(p.TEXTURE_2D,h)},Fk=function(H,W){H.bindFramebuffer(H.FRAMEBUFFER,W)},qp=function(M,G,R){M.texParameteri(M.TEXTURE_2D,G,R)},Xc=function(E,n){E.enable(E.POLYGON_OFFSET_FILL),E.polygonOffset(n[0],n[1])},Op=function(B){B.disable(B.POLYGON_OFFSET_FILL)},Sj=function(y,O){if(O){var O=Uf(O);y.clearColor(O[0],O[1],O[2],O[3])}},Cp=function(n,N){sm(n,N.uFix,!0),tl(n,N.aNormal)},ql=function(U,F){sm(U,F.uFix,!1),uj(U,F.aNormal)},as=function(m,s,J,k,C,N,z,S){m._picking||(J?(sm(m,s.uBlend,!0),sm(m,s.uBlendColor,J)):sm(m,s.uBlend,!1),sm(m,s.uLight,k==T?!0:k),bh(C)&&1!==C&&sm(m,s.uPartOpacity,C),sm(m,s.uReverseFlip,N==T?!1:N),sm(m,s.uFixPickReverseColor,z||Ql)),S?m.enable(m.CULL_FACE):m.disable(m.CULL_FACE)},wp=function(Q,P){Q._picking||sm(Q,P.uPartOpacity,1)},Li=function(R,y,M,c,h,g,$,Q,m){if(!M)return R.activeTexture(R.TEXTURE0),Kr(R,R._emptyTexture),R.activeTexture(R.TEXTURE1),Kr(R,R._emptyBlendTexture),void 0;sm(R,y.uTexture,!0),sm(R,y.uDiscardSelectable,lp(c)?c:!0),uj(R,y.aUv),Fg(R,h,g,y.aUv,2),m?(sm(R,y.uBlendTexture,!0),R.activeTexture(R.TEXTURE1),Kr(R,m),R.uniform1i(y.uBlendSampler,1)):(sm(R,y.uBlendTexture,!1),R.activeTexture(R.TEXTURE1),Kr(R,R._emptyBlendTexture)),R.activeTexture(R.TEXTURE0),Kr(R,M),R.uniform1i(y.uSampler,0);var D=[0,0,1,1];$&&(D[0]=$[0],D[1]=$[1]),Q&&(D[2]=Q[0],D[3]=Q[1]),sm(R,y.uOffsetScale,D)},Gr=function(z,s,o){z.activeTexture(z.TEXTURE0),Kr(z,T),z.activeTexture(z.TEXTURE1),Kr(z,T),o&&(tl(z,s.aUv),sm(z,s.uTexture,!1),sm(z,s.uBlendTexture,!1))},Ng=function(V,d,i,y,v,Q){!i||$||Jk||V.lineWidth(i),y&&!V._picking&&sm(V,d.uFixPickReverseColor,y),v&&Fg(V,v,Q,d.aPosition)},of=function(v,n,R,l){Zo&&(l=v[Zo]),v.drawArrays(l==T?v.TRIANGLES:l,n,R);var J=v._renderInfo;J&&(J.calls++,J.vertices+=R,(l==T||l===v.TRIANGLES)&&(J.faces+=R/3),l===v.LINES&&(J.lines+=R/2))},Ec=function(A,p,b,f){Zo&&(f=A[Zo]),A.drawElements(f==T?A.TRIANGLES:f,b,A.UNSIGNED_SHORT,p==T?0:2*p);var o=A._renderInfo;o&&(o.calls++,o.vertices+=b,(f==T||f===A.TRIANGLES)&&(o.faces+=b/3),f===A.LINES&&(o.lines+=b/2))},xr=function(o,R,e,G,b){var X=o.ARRAY_BUFFER;o.bindBuffer(X,R),e&&o.bufferData(X,e,o.STATIC_DRAW),G!=T&&o.vertexAttribPointer(G,b?b:3,o.FLOAT,!1,0,0)},Fg=function(I,o,O,r,E){return O?(an(I,I.ARRAY_BUFFER,o,O),r!=T&&I.vertexAttribPointer(r,E?E:3,I.FLOAT,!1,0,0),void 0):xr(I,o,O,r,E)},hd=function(Z,$,J){var l=Z.ELEMENT_ARRAY_BUFFER;Z.bindBuffer(l,$),J&&Z.bufferData(l,J,Z.STATIC_DRAW)},lh=function(I,X,L){an(I,I.ELEMENT_ARRAY_BUFFER,X,L)},an=function(H,Z,m,O){var i=O._bufId;i||(i=O._bufId=b.Math.generateIncreasingID());var m,U=H._bufPool;(m=U[i])&&m._buf?H.bindBuffer(Z,m._buf):(m=U[i]={_buf:Gl(H)},H.bindBuffer(Z,m._buf),H.bufferData(Z,O,H.STATIC_DRAW)),m._fid=H._renderInfo.frame},sm=function($,p,Q){if(Q!=T&&p!=T){Q=Uf(Q);var U=Q.length;3===U?$.uniform3fv(p,Q):4===U?$.uniform4fv(p,Q):16===U?$.uniformMatrix4fv(p,!1,Q):lp(Q)?$.uniform1i(p,Q?1:0):2===U?$.uniform2fv(p,Q):$.uniform1f(p,Q)}},uj=function(N,H){H!=T&&H>=0&&N.enableVertexAttribArray(H)},tl=function(S,f){f!=T&&f>=0&&S.disableVertexAttribArray(f)},Qb=function(q,p){var K=q.getGL(),A=q._prg;q._7O=q._8O.pop(),p&&(sm(K,A.uMVMatrix,q._7O),q._6O=p,sm(K,A.uNMatrix,p))},Sp=function($,b){return b||(b=nn()),rg(b,$),Ih(b),wc(b),b},vh=function(p,j){var q=p.getGL(),t=p._prg,X=p._7O;j&&(p._8O.push(bj(X)),nm(X,X,j),p._7O=X),sm(q,t.uMVMatrix,X),sm(q,t.uNMatrix,Sp(X,p._6O))},Vp=function(X,x,n,L,P,Q){if(n){if(L){var E=n.value++,z=2147483648|E,M=[(255&z>>16)/255,(255&z>>8)/255,(255&z)/255,(255&z>>24)/255];n[E]={data:P,part:Q}}else M=us;return sm(X,x.uFixPickReverseColor,M),M}},Bn=function(){var o={center:function(l,$,u,W,f){var U=-$[1]/2,g={x:-$[0]/2,y:U,width:$[0],height:$[1]},y=sj(l,g,u);return[y.x+W,-y.y-f,Hr()]},front:function(r,o,G,Z,D){var T=-o[1]/2,k={x:-o[0]/2,y:T,width:o[0],height:o[1]},q=sj(r,k,G);return[q.x+Z,-q.y-D,o[2]/2+Hr()]},back:function(T,i,u,Z,N){var d=-i[0]/2,r=-i[1]/2,G={x:d,y:r,width:i[0],height:i[1]},h=sj(T,G,u);return[-h.x-Z,-h.y-N,-i[2]/2-Hr()]},left:function(Z,R,I,c,V){var N=-R[1]/2,M={x:-R[2]/2,y:N,width:R[2],height:R[1]},e=sj(Z,M,I);return[-R[0]/2-Hr(),-e.y-V,e.x+c]},right:function(W,Y,M,D,A){var v=-Y[2]/2,V=-Y[1]/2,J={x:v,y:V,width:Y[2],height:Y[1]},t=sj(W,J,M);return[Y[0]/2+Hr(),-t.y-A,-t.x-D]},top:function(i,F,n,t,G){var O={x:-F[0]/2,y:-F[2]/2,width:F[0],height:F[2]},m=sj(i,O,n);return[m.x+t,F[1]/2+Hr(),m.y+G]},bottom:function(Y,c,w,y,e){var f=-c[2]/2,Z={x:-c[0]/2,y:f,width:c[0],height:c[2]},l=sj(Y,Z,w);return[l.x+y,-c[1]/2-Hr(),-l.y-e]}};return function(E,D,A,d,T,G){return o[d](E,D,A,T||0,G||0)}}(),Xb=function(l,Q,r,D,n,t,M,$,z,u){if(n&&(Q[0]+=n[0],Q[1]+=n[1],Q[2]+=n[2]),Nf(l,r),$){var w=nn();if(rn(w,z,u),rm(Q,w),Nf(l,Q),l.auto=$,l.pos=rm([0,0,0],l),t){var c=l.mat2=nn();rn(c,t,M)}}else rn(l,z,u),Nf(l,Q),D===vn?xm(l,-_):D===ib?xm(l,_):D===Nm?ef(l,-_):D===ak?ef(l,_):D===Yr&&xm(l,X),rn(l,t,M);return l},Eg=function(z,x){var F=x.auto,r=x.mat2,y=z.gv;if(F){var O,d=nn(),f=[0,0,0,0];O="string"==typeof F?[F.indexOf("x")<0?y._eye[0]:y._center[0],F.indexOf("y")<0?y._eye[1]:y._center[1],F.indexOf("z")<0?y._eye[2]:y._center[2]]:y._eye,Vg(f,bp(nn(),O,y._center,y._up)),Lq(d,dr(f,f),x.pos),r&&nm(d,d,r),vh(y,d)}else vh(y,x)},hp=function(X,x,T,Z,G){var t=X.s,B=X.gv,l=B.getGL(),c=B._prg,k=B._buffer,w=B._1O;Yc(l,Wq,w),Eg(X,T),as(l,c,t(x+".blend"),t(x+".light"),t(x+".opacity"),t(x+".reverse.flip"),t(x+".reverse.color"),t(x+".reverse.cull")),Li(l,c,w,G,k.uv,sc),Fg(l,k.vs,Z,c.aPosition),Fg(l,k.ns,mj,c.aNormal),lh(l,k.is,yb),Ec(l,0,yb.length),Gr(l,c,w),wp(l,c),Qb(B)},kf=function(p,W,T){var S=p.gv,d=p.data,$=p[W]={blend:S.getBodyColor(d)||S.getFaceBlend(d,W),light:S.getFaceLight(d,W),color:S.getFaceColor(d,W),opacity:S.getFaceOpacity(d,W),transparent:S.getFaceTransparent(d,W),reverseFlip:S.getFaceReverseFlip(d,W),reverseColor:S.getFaceReverseColor(d,W),reverseCull:S.getFaceReverseCull(d,W),texture:S.getFaceImage(d,W),blendTexture:S.getFaceBlendImage(d,W),discardSelectable:S.getFaceDiscardSelectable(d,W)};if("csg"!==W){$.uv=S.getFaceUv(d,W)||T&&T[W+"Uv"],$.uvScale=S.getFaceUvScale(d,W)||T&&T[W+"UvScale"],$.uvOffset=S.getFaceUvOffset(d,W)||T&&T[W+"UvOffset"];var K=S.getFaceMat(d,W);K&&($.mat=ap(d,K))}return $},Ud=function(S,F,L,t,Y){if(t){if(!Y(t.transparent))return;var O=S.data,U=S.gv,A=U._buffer,E=U.getTexture(t.texture,O),_=U.getTexture(t.blendTexture,O);Li(F,L,E,t.discardSelectable,A.uv,t.tuv,t.uvOffset,t.uvScale,_),as(F,L,t.blend,t.light,t.opacity,t.reverseFlip,t.reverseColor,t.reverseCull),sm(F,L.uDiffuse,t.color),Fg(F,A.vs,t.vs,L.aPosition),Fg(F,A.ns,t.ns,L.aNormal),of(F,0,t.vs.length/3),wp(F,L),Gr(F,L,E)}},In=function(T,x,w,K,I,N){var G,E,b,e,s,S,H,h,F,X,B,l=[K-x,I-w],M=T?T.length:0;for(b=0;M>b;b++){for(e=2,G=T[b],s=G[0],S=G[1];e+1<G.length;){if(H=G[e],h=G[e+1],E=pn(x,w,K,I,s,S,H,h,!0)){F=[H-s,h-S],X=Bc(F),F[0]/=X,F[1]/=X,X=zq(l,F),X=X>0?N:-N,B=[F[0]*X,F[1]*X];break}s=H,S=h,e+=2}if(B)break}if(B)for(K=x+B[0],I=w+B[1],b=0;M>b;b++)for(e=2,G=T[b],s=G[0],S=G[1];e+1<G.length;){if(H=G[e],h=G[e+1],E=pn(x,w,K,I,s,S,H,h,!0))return[0,0];s=H,S=h,e+=2}return B?B:[K-x,I-w]},ks=b.graph3d={},yr=function(x,Z,j){Nc(e+".graph3d."+x,Z,j)},Yf="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",Ke="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~<spmpd!>!eJ|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw<*yfusfWw.)f{jmbnspo!>!F!4dfw<*mbnspOw)f{jmbnspo!>!O!4dfw!gjeof$!<ftvggjEv!>!spmpd!ftmf$!~<ftvggjEv!>!spmpd|ftmf~<spmpDidubCw!>!spmpd|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!<spmpd!5dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";Pr(t,{setBatchInfo:function(w,J){Ug[w]=J},getBatchInfo:function(T){return Ug[T]}},!0);var Ag=[1,1,1],Ve=[1,0,0,0,0,1,0,1,1,1,1,0],Ho=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],vl=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Uk=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Zn=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],nh=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],Dm=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],xb=function(E,o){Ab(E,o,"_batchModelMap","_batchIndexMap"),vq(E,o,"_wireframeModelMap","_wireframeIndexMap"),vq(E,o,"_polylineModelMap","_polylineIndexMap"),vq(E,o,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),vq(E,o,"_polylineModelMapSwap","_polylineIndexMapSwap")},Ab=function(u,t,j,T){if(!t)return u[j]={},u[T]={},void 0;var m=t._id,Z=u[T],I=Z[m];if(I){var g=u[j],W=I.batch,h=g[W],M=h.ds,Y=I.index;if(h.invalidate=!0,delete Z[m],M.splice(Y,1),tj(M))return delete g[W],void 0;for(var p=I.begin,N=I.size,X=3*p,S=3*N,s=4*p,V=4*N,e=h.vs,c=h.ps,$=h.uv,D=h.cs,x=h.bs,K=h.rs,w=h.ns,d=h.ls;Y<M.length;Y++)I=Z[M[Y]._id],I.index--,I.begin-=N;e.splice(X,S),c.splice(s,V),$&&$.splice(2*p,2*N),D&&D.splice(s,V),x&&x.splice(X,S),K&&K.splice(p,N),w&&w.splice(X,S),d&&d.splice(p,N)}},vq=Ab,Pi=function(L,f,N,$){if(!$)return T;var r=f[$];if(!r){var j=Ug[$]||bi,O=j.image?[]:T;r=f[$]={vs:[],ns:[],uv:O,cs:O?T:j.color?T:[],bs:j.blend?[]:T,ps:[],rs:j.brightness?[]:T,ds:[]}}return r.invalidate=!0,L[N._id]={index:r.ds.length,begin:r.vs.length/3,batch:$},r.ds.push(N),r},nb=function(l,G){return G!=T&&1!==G?[l[0]*G,l[1]*G,l[2]*G,l[3]]:l},zh=function(A,o,T){var N=A.getBrightness(o),v=Uf(T.color||"white"),l=v[3]<1,u=Math.ceil(T.width)||1,J=(l?"T":"O")+u,w=A._wireframeIndexMap,q=A._wireframeModelMap,Q=q[J];Q||(Q=q[J]={vs:[],cs:[],ps:[],ds:[],T:l,W:u});var I,B=A.getData3dUI(o),X=Zr(B);if(T.geometry){if(!X)return;if(I=Ce(X),!I)return}else I=T.short?xd:qd;Q.invalidate=!0;var h=Q.vs,e=Q.cs,f=Q.ds,m=w[o._id]={index:f.length,begin:h.length/3,batch:J};f.push(o);var d=ap(o,T.mat),r=B._calcAnchorMat(o);r&&nm(d,d,r),sr(h,d,I);var k=m.size=h.length/3-m.begin;Qo(e,nb(v,N),k)},rd=function(x,X,r,e,u,P,f,_,k){var b=x.getBrightness(X);b==T&&(b=1);var M=nb(Uf(e),b),U=M[3]<1;P=Math.ceil(P)||1;var E=(U?"T":"O")+P;if(f){var S=f[0],w=(f[1]||S)+S;E+="-"+S+"-"+w,k&&(E+="-"+Ar(k)+"-"+b,k=nb(Uf(k),b))}var W=x._polylineIndexMap,y=x._polylineModelMap,z=y[E];z||(z=y[E]={vs:[],cs:[],ps:[],ds:[],ls:f?[]:T,T:U,W:P},f&&(z.D=S,z.G=w,z.A=k)),z.invalidate=!0;var i,t=z.vs,$=z.cs,C=z.ds,c=z.ls,p=W[X._id]={index:C.length,begin:t.length/3,batch:E};C.push(X),fj(t,r);var j,F=p.size=t.length/3-p.begin,V=r.length,A=0,J=[];if(f||u)for(i=0;V>i;i+=6)j=Bc([r[i],r[i+1],r[i+2]],[r[i+3],r[i+4],r[i+5]]),J.push(j),A+=j;if(A&&u){var m,R=nb(Uf(u),b),I=[R[0]-M[0],R[1]-M[1],R[2]-M[2],R[3]-M[3]],G=0;for(i=0;V>i;i+=6)m=G/A,Qo($,[M[0]+I[0]*m,M[1]+I[1]*m,M[2]+I[2]*m,M[3]+I[3]*m],1),G+=J[i/6],m=G/A,Qo($,[M[0]+I[0]*m,M[1]+I[1]*m,M[2]+I[2]*m,M[3]+I[3]*m],1)}else Qo($,M,F);if(f)for(G=_||0,i=0;V>i;i+=6)c.push(G),G+=J[i/6],c.push(G)},Sl=function(S,D,z){if(D)for(var V=4*D.begin,t=z[D.batch].ps,W=0;W<D.size;W++)t[V++]=S[0],t[V++]=S[1],t[V++]=S[2],t[V++]=S[3]},wd=function(z,f){var D=f+["32"],U=z[f],K=z[D];U?K&&K.length===U.length?(K.set(U),K._bufId=null):z[D]=new Lg(U):delete z[D]},fs=function($,v,M,h,U,L,I,D,C){if(Wd(M))M.forEach(function(Z){fs($,v,Z,h,U,L,I,D,C)});else if(Ub(M))fs($,v,Zr(h,M),h,U,L,I,D,C);else if(qc(M)){var K,E=cg(M.mat,v,$),w=cg(M.s3,v,$),R=cg(M.t3,v,$),e=cg(M.r3,v,$);if((w||e||R||E)&&(K=sf(E,w,e,cg(M.rotationMode,v,$),R),L.push(K)),M.shape3d)fs($,v,M.shape3d,h,U,L,I,D,M);else{var z=h.s;C=C||bi;var c=L[0],F=L.length,N=z("shape3d.color",M.color,C.color);if(U||(U=z("shape3d.blend",M.blend,C.blend)),F>1){c=bj(c);for(var j=1;F>j;j++)nm(c,c,L[j])}M.vs&&z(zd,M.visible,C.visible)&&Hk(c,I,D,M.vs,M.uv,M.is,U,N),M.top_vs&&z(Qi,M.topVisible,C.topVisible)&&Hk(c,I,D,M.top_vs,M.top_uv,M.top_is,U,z("shape3d.top.color",M.topColor,C.topColor)||N),M.bottom_vs&&z(Sg,M.bottomVisible,C.bottomVisible)&&Hk(c,I,D,M.bottom_vs,M.bottom_uv,M.bottom_is,U,z("shape3d.bottom.color",M.bottomColor,C.bottomColor)||N),M.from_vs&&z(Yg,M.fromVisible,C.fromVisible)&&Hk(c,I,D,M.from_vs,M.from_uv,M.from_is,U,z("shape3d.from.color",M.fromColor,C.fromColor)||N),M.to_vs&&z(Dl,M.toVisible,C.toVisible)&&Hk(c,I,D,M.to_vs,M.to_uv,M.to_is,U,z("shape3d.to.color",M.toColor,C.toColor)||N)}K&&L.pop()}},Hk=function(l,U,F,G,K,M,a,z){var e,r=U.cs,w=U.uv,s=U.bs;if(M){e=M.length;for(var V=0;e>V;V++){var j=M[V];sr(F,l,[G[3*j],G[3*j+1],G[3*j+2]]),w&&fj(w,[K[2*j],K[2*j+1]])}}else e=G.length/3,sr(F,l,G),w&&fj(w,K);r&&Qo(r,z,e),s&&(a?fo(s,a,e):fj(s,Ag,e))},Sd=function(V,e,D,K){var X=[];K?fs(V.gv,V.data,K,V,V.getBodyColor(),[e],D,X):(zo(V,vn,e,D,X),zo(V,ib,e,D,X),zo(V,Af,e,D,X),zo(V,Yr,e,D,X),zo(V,Nm,e,D,X),zo(V,ak,e,D,X),zo(V,"csg",e,D,X)),X.length&&(fj(D.vs,X),fj(D.ns,Jj(X)))},zo=function(y,v,C,o,Y){var F=y[v];if(F){var K=F.tuv;if(K){var n,D,x,f,Q=F.uvScale,M=F.uvOffset;if(Q)for(n=K.length,D=Q[0],x=Q[1],f=0;n>f;f+=2)K[f]*=D,K[f+1]*=x;if(M)for(n=K.length,D=M[0],x=M[1],f=0;n>f;f+=2)K[f]+=D,K[f+1]+=x
}Hk(C,o,Y,F.vs,K,T,F.blend,F.color)}},ji=function(v,h,U,A,M,j,Q,B){var O,x=U.cs,V=U.uv,I=U.bs;if(v.getFaceVisible(h,j)){var H=v.getFaceMat(h,j);if(H&&(M=ap(h,H)),sr(Q,M,B),x&&Qo(x,v.getFaceColor(h,j),6),V){var q=v.getFaceUv(h,j)||A[j+"Uv"],g=v.getFaceUvScale(h,j)||A[j+"UvScale"],P=v.getFaceUvOffset(h,j)||A[j+"UvOffset"];q=q?[q[6],q[7],q[0],q[1],q[2],q[3],q[2],q[3],q[4],q[5],q[6],q[7]]:Ve;var a=q[0],T=q[1],G=q[2],y=q[3],D=q[4],X=q[5],N=q[6],S=q[7],Z=q[8],o=q[9],k=q[10],n=q[11];if(g){var i=g[0],f=g[1];a*=i,T*=f,G*=i,y*=f,D*=i,X*=f,N*=i,S*=f,Z*=i,o*=f,k*=i,n*=f}if(P){var t=P[0],c=P[1];a+=t,T+=c,G+=t,y+=c,D+=t,X+=c,N+=t,S+=c,Z+=t,o+=c,k+=t,n+=c}V.push(a,T,G,y,D,X,N,S,Z,o,k,n)}I&&(O=v.getBodyColor(h)||v.getFaceBlend(h,j),O?fo(I,O,6):fj(I,Ag,6))}},Io=function(H,o,a,X){var L=H.getGL(),U=H._prg,V=H._buffer;if(!Fq(o)){vh(H),Cp(L,U);for(var x in o){var r=o[x];if(!(X&&!r.T||!X&&r.T)){r.invalidate?(r.invalidate=!1,wd(r,"vs"),wd(r,"cs"),wd(r,"ls"),wd(r,"ps")):a&&wd(r,"ps");var E=r.vs32,s=a?r.ps32:r.cs32;Ng(L,U,r.W,T,V.vs,E);var k=r.D,n=!H._dashDisabled&&k;sm(L,U.uAlphaTest,f.alphaTest),n&&(sm(L,U.uDash,!0),sm(L,U.uDashDistance,k),sm(L,U.uDashGapDistance,r.G),uj(L,U.aLineDistance),Fg(L,V.lineDistance,r.ls32,U.aLineDistance,1),sm(L,U.uDiffuse,r.A||rf));var v=!H._batchColorDisabled;v&&(sm(L,U.uBatchColor,!0),uj(L,U.aBatchColor),Fg(L,V.batchColor,s,U.aBatchColor,4)),Li(L),of(L,0,E.length/3,L.LINES),Gr(L),v&&(sm(L,U.uBatchColor,!1),tl(L,U.aBatchColor)),n&&(sm(L,U.uDash,!1),tl(L,U.aLineDistance))}}ql(L,U)}},Ci=function(u,b,O){var M,k,V,D,s,y,z,Y,c,X,P,$=u.getGL(),n=u._prg,Z=u._buffer,W=u._batchModelMap;if(!Fq(W)){vh(u);for(M in W)if(k=Ug[M]||bi,!(O&&!k.transparent||!O&&k.transparent)&&(V=W[M],b||!k.transparentMask)){var C=O&&k.autoSort!==!1&&(u._33Q||V.invalidate);if(V.invalidate?(V.invalidate=!1,wd(V,"vs"),wd(V,"ns"),wd(V,"cs"),wd(V,"rs"),wd(V,"ps"),wd(V,"bs"),wd(V,"uv")):b&&wd(V,"ps"),s=V.vs32,y=b?V.ps32:V.cs32,c=V.uv32,z=V.bs32,Y=V.rs32,P=s.length/3,C&&(V.is=ec(s,u.getEye())),P){D=k.light,X=u.getTexture(k.image),as($,n,T,k.light,k.opacity,k.reverseFlip,k.reverseColor,k.reverseCull),y?u._batchColorDisabled||(sm($,n.uBatchColor,!0),uj($,n.aBatchColor),Fg($,Z.batchColor,y,n.aBatchColor,4)):sm($,n.uDiffuse,k.color||rf);var j=k.alphaTest;sm($,n.uAlphaTest,j===q?f.alphaTest:j);var t=z&&!u._batchBlendDisabled;t&&(sm($,n.uBatchBlend,!0),uj($,n.aBatchBlend),Fg($,Z.batchBlend,z,n.aBatchBlend));var a=Y&&!u._batchBrightnessDisabled;a&&(sm($,n.uBatchBrightness,!0),uj($,n.aBatchBrightness),Fg($,Z.batchBrightness,Y,n.aBatchBrightness,1)),c?Li($,n,X,k.discardSelectable,Z.uv,c,k.uvOffset,k.uvScale):Li($),Fg($,Z.vs,s,n.aPosition),Fg($,Z.ns,V.ns32,n.aNormal),V.is?(hd($,Z.is,V.is),Ec($,0,P)):of($,0,P),c?Gr($,n,X):Gr($),y&&!u._batchColorDisabled&&(sm($,n.uBatchColor,!1),tl($,n.aBatchColor)),t&&(sm($,n.uBatchBlend,!1),tl($,n.aBatchBlend)),a&&(sm($,n.uBatchBrightness,!1),tl($,n.aBatchBrightness)),wp($,n)}}}},ec=function(V,q){for(var I=V.length/3,G=new Array(I),T=I/3,L=new Array(T),p=0;T>p;p++)L[p]=p;L.sort(function(u,z){var s=9*u,W=[(V[s]+V[s+3]+2*V[s+6])/4,(V[s+1]+V[s+4]+2*V[s+7])/4,(V[s+2]+V[s+5]+2*V[s+8])/4];s=9*z;var P=[(V[s]+V[s+3]+2*V[s+6])/4,(V[s+1]+V[s+4]+2*V[s+7])/4,(V[s+2]+V[s+5]+2*V[s+8])/4],d=Bc(q,W)-Bc(q,P);return d>0?-1:0>d?1:0});for(var p=0;T>p;p++){var o=3*p,K=3*L[p];G[o]=K,G[o+1]=K+1,G[o+2]=K+2}return new Ld(G)},hn={obj:function(V,H){var o={mat:V.mat,s3:V.s3,r3:V.r3,rotationMode:V.rotationMode,t3:V.t3,cube:V.cube==T?!0:V.cube,center:V.center==T?!0:V.center,ignoreMtls:V.ignoreMtls,ignoreTransparent:V.ignoreTransparent,ignoreColor:V.ignoreColor,ignoreImage:V.ignoreImage,ignoreNormal:V.ignoreNormal,prefix:V.prefix,flipY:V.flipY,flipFace:V.flipFace,reverseFlipMtls:V.reverseFlipMtls,finishFunc:function(n,b){if(n){var b=[];for(var C in n){var D=n[C];b.rawS3=D.rawS3,b.push(D),V.eachModel&&V.eachModel(C,D)}b.json=V,H(b)}else H()}};t.loadObj(V.obj,V.mtl,o)}};t.getModelTypeHandlers=function(){return hn},t.setModelTypeHandler=function(x,Y){hn[x]=Y},t.getModelTypeHandler=function(q){return hn[q]},t.handleModelLoaded=function(){},t.handleUnfoundModel=function(){};var zk=T,$k=T,cd=function(C){zk&&!C._loadingModelView_&&($k||($k={}),$k[C._loadingModelView_=tk()]=C)},yn=function(d,K){zk||(zk={});var Y=zk[d];if(Y){if(Y.url===K)return;Y.request.onload=Kd,Y.request.onerror=Kd}var $=new Ae;if(zk[d]={request:$,url:K},K=t.beforeLoadURL(K),K.data){var w=t.parse(K.data);Re(d,w,K)}else{$.onload=function(J){if(200===this.status||0===this.status){var F=t.parse(J.target.response||J.target.responseText);Re(d,F,K)}else Gd(d,t.handleUnfoundModel(d,K)||T)},$.onerror=function(){Gd(d,t.handleUnfoundModel(d,K)||T)};var A={};A.url=encodeURI(K),A.sync=!1,$.send(A)}},Re=function(q,U,a){var H=U.modelType;if(!H)return Gd(q,U),t.handleModelLoaded(q,U),void 0;var X=t.getModelTypeHandler(H);if(X){var L=function(F){F?(Gd(q,F),t.handleModelLoaded(q,F)):Gd(q,t.handleUnfoundModel(q,a)||T)};X(U,L)}else Gd(q,t.handleUnfoundModel(q,a)||T)},Gd=function(i,o){if(So[i]=o,delete zk[i],Fq(zk)&&(zk=T,$k)){for(var x in $k){var y=$k[x];y._2O&&(y._2O={}),y.invalidateAll&&y.invalidateAll(q,"modelLoaded",i),y.redraw&&y.redraw(),y.iv(),delete y._loadingModelView_}$k=T}if(o&&$k)for(var x in $k){var y=$k[x];y.invalidateAll&&y.invalidateAll(q,"modelLoading",i),y.redraw&&y.redraw(),y.iv()}},sc=new Lg([0,0,0,1,1,1,1,0]),mj=new Lg([0,0,1,0,0,1,0,0,1,0,0,1]),yb=new Ld([0,1,2,2,3,0]),Wo=new Lg([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Eo=new Ld([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Ob=new Lg([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Jl=Jj(Wo,Eo),Rb=(new Lg([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Ld([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[vn,Af,ib,Yr,Nm,ak]),qd=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],xd=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],jf=function(c,H,i,e,D,M){M=M||16,c=c||16,H=H||0,i=i||c;var j,t,C,E,L,q,F,N,d=.5,b=[],J=[],K=p/c,u=X/M;for(j=0;M>j;j++)for(L=j+1,E=j*u,N=L*u,t=H;i>t;t++)q=t+1,C=t*K,F=q*K,b.push(d*U(E)*o(C),d*o(E),-d*U(E)*U(C),d*U(N)*o(F),d*o(N),-d*U(N)*U(F),d*U(E)*o(F),d*o(E),-d*U(E)*U(F),d*U(E)*o(C),d*o(E),-d*U(E)*U(C),d*U(N)*o(C),d*o(N),-d*U(N)*U(C),d*U(N)*o(F),d*o(N),-d*U(N)*U(F)),J.push(t/c,j/M,q/c,L/M,q/c,j/M,t/c,j/M,t/c,L/M,q/c,L/M);if(e){var A=[],l=[];for(C=H*K,j=0;M>j;j++)L=j+1,E=j*u,N=L*u,A.push(0,0,0,d*U(N)*o(C),d*o(N),-d*U(N)*U(C),d*U(E)*o(C),d*o(E),-d*U(E)*U(C)),l.push(0,.5,H/c,L/M,H/c,j/M)}if(D){var T=[],z=[];for(C=i*K,j=0;M>j;j++)L=j+1,E=j*u,N=L*u,T.push(0,0,0,d*U(E)*o(C),d*o(E),-d*U(E)*U(C),d*U(N)*o(C),d*o(N),-d*U(N)*U(C)),z.push(1,.5,i/c,j/M,i/c,L/M)}return{vs:b,uv:J,from_vs:A,from_uv:l,to_vs:T,to_uv:z}},Lo=function(M,y,A){M=M||.17,y=y||12,A=A||18,0>M?M=0:M>.25&&(M=.25);var P,k,Q,L,T,x,F,r=.5,m=[],J=[],d=[],b=p/A,$=p/y,l=r-M;for(k=0;y>=k;k++)for(L=-X+k*$,x=o(L),T=U(L),P=0;A>=P;P++)Q=P*b,F=l+M*x,m.push(o(Q)*F,T*M,-U(Q)*F),J.push(P/A,1-k/y);for(k=0;y>k;k++){var s=k*(A+1),q=(k+1)*(A+1);for(P=0;A>P;P++)d.push(s+P,q+P+1,q+P,s+P,s+P+1,q+P+1)}return{vs:m,uv:J,is:d}},ml=function(I,J,j,v,r,h,O){O=O||12,I=I||18,J=J||0,j=j||I,h=h||.17,0>h?h=0:h>.25&&(h=.25);var x,d,Y,f,N,D,g,i,M,s,V=.5,F=[],y=[],q=p/I,T=p/O,Z=V-h;for(Y=0;O>Y;Y++)for(f=Y+1,g=-X+Y*T,i=-X+f*T,x=J;j>x;x++)d=x+1,N=x*q,D=d*q,M=Z+h*o(g),s=Z+h*o(i),F.push(o(N)*M,U(g)*h,-U(N)*M,o(D)*M,U(g)*h,-U(D)*M,o(D)*s,U(i)*h,-U(D)*s,o(N)*M,U(g)*h,-U(N)*M,o(D)*s,U(i)*h,-U(D)*s,o(N)*s,U(i)*h,-U(N)*s),y.push(x/I,1-Y/O,d/I,1-Y/O,d/I,1-f/O,x/I,1-Y/O,d/I,1-f/O,x/I,1-f/O);if(v){var c=[],z=[];for(Y=0;O>Y;Y++)f=Y+1,g=-X+Y*T,i=-X+f*T,N=J*q,M=Z+h*o(g),s=Z+h*o(i),c.push(o(N)*M,U(g)*h,-U(N)*M,o(N)*s,U(i)*h,-U(N)*s,o(N)*Z,0,-U(N)*Z),z.push(.5+.5*o(g),.5-.5*U(g),.5+.5*o(i),.5-.5*U(i),.5,.5)}if(r){var P=[],l=[];for(Y=0;O>Y;Y++)f=Y+1,g=-X+Y*T,i=-X+f*T,N=j*q,M=Z+h*o(g),s=Z+h*o(i),P.push(o(N)*M,U(g)*h,-U(N)*M,o(N)*Z,0,-U(N)*Z,o(N)*s,U(i)*h,-U(N)*s),l.push(.5-.5*o(g),.5-.5*U(g),.5,.5,.5-.5*o(i),.5-.5*U(i))}return{vs:F,uv:y,from_vs:c,from_uv:z,to_vs:P,to_uv:l}},ng=function(h,m){for(var i,H,q,g=.5,S=16,$=[],N=[],G=[],Z=p/S,n=0;S>=n;n++)i=n*Z,H=o(i)*g,q=U(i)*g,$.push(H,-g,q,H,g,q),N.push(1-n/S,1,1-n/S,0);for(n=0;S>n;n++)G.push(2*n,2*n+1,2*n+3,2*n,2*n+3,2*n+2);if(m){var s=[],f=[],a=[];for(s.push(0,-g,0),f.push(.5,.5),n=0;S>=n;n++)i=n*Z,H=o(i),q=U(i),s.push(H*g,-g,-q*g),f.push(.5+.5*H,.5+.5*q);for(n=0;S>n;n++)a.push(0,n+2,n+1)}if(h){var R=[],t=[],r=[];for(R.push(0,g,0),t.push(.5,.5),n=0;S>=n;n++)i=n*Z,H=o(i),q=U(i),R.push(H*g,g,-q*g),t.push(.5+.5*H,.5-.5*q);for(n=0;S>n;n++)r.push(0,n+1,n+2)}return{vs:$,uv:N,is:G,bottom_vs:s,bottom_uv:f,bottom_is:a,top_vs:R,top_uv:t,top_is:r}},ug=function(z,d,v,A,V,F,y){z=z||12,d=d||0,v=v||z;for(var g,O,H,Y,j,u,G,h,k=.5,K=[],w=[],q=p/z,r=d;v>r;r++)g=r+1,O=r*q,H=g*q,Y=o(O)*k,j=U(O)*k,u=o(H)*k,G=U(H)*k,K.push(Y,-k,-j,u,-k,-G,Y,k,-j,u,-k,-G,u,k,-G,Y,k,-j),w.push(r/z,1,g/z,1,r/z,0,g/z,1,g/z,0,r/z,0);if(y){var Z=[],X=[];for(r=d;v>r;r++)O=q*r,H=q*(r+1),Y=o(O),j=U(O),u=o(H),G=U(H),Z.push(Y*k,-k,-j*k,0,-k,0,u*k,-k,-G*k),X.push(.5+.5*Y,.5+.5*j,.5,.5,.5+.5*u,.5+.5*G)}if(F){var P=[],B=[];for(r=d;v>r;r++)O=q*r,H=q*(r+1),Y=o(O),j=U(O),u=o(H),G=U(H),P.push(Y*k,k,-j*k,u*k,k,-G*k,0,k,0),B.push(.5+.5*Y,.5-.5*j,.5+.5*u,.5-.5*G,.5,.5)}if(A){var _=[],W=[];O=q*d,Y=o(O)*k,j=U(O)*k,h=d/z,_.push(0,k,0,0,-k,0,Y,-k,-j,Y,-k,-j,Y,k,-j,0,k,0),W.push(0,0,0,1,h,1,h,1,h,0,0,0)}if(V){var i=[],m=[];O=q*v,Y=o(O)*k,j=U(O)*k,h=v/z,i.push(0,-k,0,0,k,0,Y,k,-j,Y,k,-j,Y,-k,-j,0,-k,0),m.push(1,1,1,0,h,0,h,0,h,1,1,1)}return{vs:K,uv:w,bottom_vs:Z,bottom_uv:X,top_vs:P,top_uv:B,from_vs:_,from_uv:W,to_vs:i,to_uv:m}},jc=function(H,k,q,y,b){k=k||18,q=q||0,y=y==T?p:y,b=b==T?.5:b;for(var h,V,v,P,C,t,f=[0,.5,.75,.875,.9375],z=[],D=[],B=[],u=y/k,$=0;$<f.length;$++){var Z=0===$%2?0:.5;for(h=0;k>=h;h++)V=(h+Z)*u+q,v=1-f[$],z.push(o(V)*b*v,-b+2*f[$]*b,-U(V)*b*v),D.push((h+Z)/k,v)}for($=0;$<f.length-1;$++){var x=$*(k+1),E=($+1)*(k+1);for(h=0;k>h;h++)B.push(x+h,E+h+1,E+h,x+h,x+h+1,E+h+1)}for(t=z.length/3-(k+1),h=0;k>h;h++)z.push(0,b,0),D.push((h+.5)/k,0);for(h=0;k>h;h++)B.push(t+h,t+h+1,t+(k+1)+h);if(H){var e=[],R=[],L=[];for(e.push(0,-b,0),R.push(.5,.5),h=0;k>=h;h++)V=h*u+q,P=o(V),C=U(V),e.push(P*b,-b,-C*b),R.push(.5+.5*P,.5+.5*C);for(h=0;k>h;h++)L.push(0,h+2,h+1)}return{vs:z,uv:D,is:B,bottom_vs:e,bottom_uv:R,bottom_is:L}},lm=function(K,Z,Q,I,O,V){K=K||16,Z=Z||0,Q=Q||K;for(var G=.5,y=[],L=[],S=p/K,r=Z;Q>r;r++){var N=r+1,u=S*r,A=S*N;y.push(o(u)*G,-G,-U(u)*G,o(A)*G,-G,-U(A)*G,0,G,0),L.push(r/K,1,N/K,1,(r+N)/2/K,0)}if(V){var m=[],H=[];for(r=Z;Q>r;r++){u=S*r,A=S*(r+1);var $=o(u),W=U(u),z=o(A),Y=U(A);m.push($*G,-G,-W*G,0,-G,0,z*G,-G,-Y*G),H.push(.5+.5*$,.5+.5*W,.5,.5,.5+.5*z,.5+.5*Y)}}if(I){var x=[],J=[];u=S*Z,x.push(0,G,0,0,-G,0,o(u)*G,-G,-U(u)*G),J.push(0,0,0,1,Z/K,1)}if(O){var f=[],R=[];u=S*Q,f.push(0,-G,0,0,G,0,o(u)*G,-G,-U(u)*G),R.push(1,1,1,0,Q/K,1)}return{vs:y,uv:L,bottom_vs:m,bottom_uv:H,from_vs:x,from_uv:J,to_vs:f,to_uv:R}},Lj=function(h,s,v,Q,M,r,O,P){for(var G=[],K=0;K<h.length-1;K+=2)G.push({x:h[K],y:h[K+1]});return _b(G,s,v,Q,M,r,O,P,!1)},ij={roundRect:function(H,j){return Lj([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],H,j,3)},star:function(y,r){return Lj([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],y,r)},rect:function(c,i){return Lj([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],c,i)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(Z,l){return Lj([0,-.5,.5,.5,-.5,.5],[1,2,2,5],Z,l)},rightTriangle:function(E,W){return Lj([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],E,W)},parallelogram:function(w,C){return Lj([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],w,C)},trapezoid:function(m,C){return Lj([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],m,C)}},ei={sphere:1,cylinder:1,cone:1,torus:1},Ie={torus:1,sphere:1},Ff=Pr(Tg(ij),{cylinder:1}),Am=Pr(Tg(ij),{cylinder:1,cone:1}),Kp=function(d,l,M){var E,m=cg(d.anchor3d,M,l),N=cg(d.mat,M,l),H=cg(d.s3,M,l),S=cg(d.t3,M,l),r=cg(d.r3,M,l),g=H||r||S||N;if(m||g){E=bj(l._6O);var U=g?sf(N,H,r,cg(d.rotationMode,M,l),S):nn();m&&Nf(U,[.5-m[0],.5-m[1],.5-m[2]]),vh(l,U)}return E},bf=function(F,c,k,h,H,X,m){if(Wd(k))k.forEach(function(w){bf(F,c,w,h,H,X,m)});else if(Ub(k))bf(F,c,Zr(h,k),h,H,X,m);else if(qc(k))if(k.shape3d){var E=Kp(k,F,c);bf(F,c,k.shape3d,h,H,X,k),E&&Qb(F,E)}else bc(F,c,k,h.s,H,X,m)},bc=function(V,D,u,U,p,H,Y){if(Y=Y||bi,!H||H(U("shape3d.transparent",u.transparent,Y.transparent))){var k=Kp(u,V,D);sl(u);var E=V._26I,N=V._prg,R=V._buffer,n=U("shape3d.color",u.color,Y.color);p||(p=U("shape3d.blend",u.blend,Y.blend));var G,a=u.opacity==T?Y.opacity:u.opacity,y=U("shape3d.opacity");G=y!=T&&a!=T?a*y:a!=T?a:y,as(E,N,p,U("shape3d.light",u.light,Y.light),G,U("shape3d.reverse.flip",u.reverseFlip,Y.reverseFlip),U("shape3d.reverse.color",u.reverseColor,Y.reverseColor),U("shape3d.reverse.cull",u.reverseCull,Y.reverseCull)),u.vs&&U(zd,u.visible,Y.visible)&&Df(E,N,R,n,V.getTexture(U("shape3d.image",u.image,Y.image),D),U("shape3d.discard.selectable",u.discardSelectable,Y.discardSelectable),u.vs,u.uv,u.ns,u.is,U("shape3d.uv.offset",u.uvOffset,Y.uvOffset),U("shape3d.uv.scale",u.uvScale,Y.uvScale),U("shape3d.polygonOffset",u.polygonOffset,Y.polygonOffset)),u.top_vs&&U(Qi,u.topVisible,Y.topVisible)&&Df(E,N,R,U("shape3d.top.color",u.topColor,Y.topColor)||n,V.getTexture(U("shape3d.top.image",u.topImage,Y.topImage),D),U("shape3d.top.discard.selectable",u.topDiscardSelectable,Y.topDiscardSelectable),u.top_vs,u.top_uv,u.top_ns,u.top_is,U("shape3d.top.uv.offset",u.topUvOffset,Y.topUvOffset),U("shape3d.top.uv.scale",u.topUvScale,Y.topUvScale),U("shape3d.top.polygonOffset",u.topPolygonOffset,Y.topPolygonOffset)),u.bottom_vs&&U(Sg,u.bottomVisible,Y.bottomVisible)&&Df(E,N,R,U("shape3d.bottom.color",u.bottomColor,Y.bottomColor)||n,V.getTexture(U("shape3d.bottom.image",u.bottomImage,Y.bottomImage),D),U("shape3d.bottom.discard.selectable",u.bottomDiscardSelectable,Y.bottomDiscardSelectable),u.bottom_vs,u.bottom_uv,u.bottom_ns,u.bottom_is,U("shape3d.bottom.uv.offset",u.bottomUvOffset,Y.bottomUvOffset),U("shape3d.bottom.uv.scale",u.bottomUvScale,Y.bottomUvScale),U("shape3d.bottom.polygonOffset",u.bottomPolygonOffset,Y.bottomPolygonOffset)),u.from_vs&&U(Yg,u.fromVisible,Y.fromVisible)&&Df(E,N,R,U("shape3d.from.color",u.fromColor,Y.fromColor)||n,V.getTexture(U("shape3d.from.image",u.fromImage,Y.fromImage),D),U("shape3d.from.discard.selectable",u.fromDiscardSelectable,Y.fromDiscardSelectable),u.from_vs,u.from_uv,u.from_ns,u.from_is,U("shape3d.from.uv.offset",u.fromUvOffset,Y.fromUvOffset),U("shape3d.from.uv.scale",u.fromUvScale,Y.fromUvScale),U("shape3d.from.polygonOffset",u.fromPolygonOffset,Y.fromPolygonOffset)),u.to_vs&&U(Dl,u.toVisible,Y.toVisible)&&Df(E,N,R,U("shape3d.to.color",u.toColor,Y.toColor)||n,V.getTexture(U("shape3d.to.image",u.toImage,Y.toImage),D),U("shape3d.to.discard.selectable",u.toDiscardSelectable,Y.toDiscardSelectable),u.to_vs,u.to_uv,u.to_ns,u.to_is,U("shape3d.to.uv.offset",u.toUvOffset,Y.toUvOffset),U("shape3d.to.uv.scale",u.toUvScale,Y.toUvScale),U("shape3d.to.polygonOffset",u.toPolygonOffset,Y.toPolygonOffset)),wp(E,N),k&&Qb(V,k)}},Df=function(d,l,H,c,p,n,R,e,g,B,N,M,C){R&&(C&&Xc(d,C),sm(d,l.uDiffuse,c),e?Li(d,l,p,n,H.uv,e,N,M):Li(d),Fg(d,H.vs,R,l.aPosition),Fg(d,H.ns,g,l.aNormal),B?(lh(d,H.is,B),Ec(d,0,B.length)):of(d,0,R.length/3),e?Gr(d,l,p):Gr(d),C&&Op(d))},Zr=function(z,m){var B=z.s;if(m||(m=B(td)),!m)return T;var H=ms(m);if(H)return H;if("text"===m){var f={amount:B("shape3d.text.amount"),size:B("shape3d.text.size"),font:B("shape3d.text.font"),style:B("shape3d.text.style"),weight:B("shape3d.text.weight"),fill:B("shape3d.text.fill"),curveSegments:B("shape3d.text.curveSegments"),spacing:B("shape3d.text.spacing")},n=z.gv.getShape3dText(z.data),d=n;for(var V in f)d+="_"+(f[V]===q?"U":f[V]);return z._cachedTextKey===d?z._cachedTextGeometry:(z._cachedTextKey=d,z._cachedTextGeometry=t.createTextGeometry(n,f))}var V=m;if(ei[m]){var F=B("shape3d.side"),x=B("shape3d.side.from"),e=B("shape3d.side.to"),A=B(Yg),p=B(Dl);3>F?(F=0,x=0,e=0,A=!1,p=!1):((x==T||0>x)&&(x=0),(e==T||e>F)&&(e=F),0===x&&e===F&&(A=!1,p=!1)),V+="-"+F+"-"+x+"-"+e+"-"+A+"-"+p}if(Ff[m]){var E=B(Qi);V+="-"+E}if(Am[m]){var o=B(Sg);V+="-"+o}if("torus"===m){var M=B("shape3d.torus.radius");0>M?M=0:M>.25&&(M=.25),V+="-"+M}if(Ie[m]){var X=B(Nq);V+="-"+X}return H=ll[V],H||("box"===m?H=t.createBoxModel():ij[m]?H=ij[m](E,o):"sphere"===m?H=t.createSphereModel(F,x,e,A,p,X):m===Wc?H=t.createCylinderModel(F,x,e,A,p,E,o):"cone"===m?H=t.createConeModel(F,x,e,A,p,o):"torus"===m&&(H=t.createTorusModel(F,x,e,A,p,M,X)),ll[V]=H),H},sl=function(){var j=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],H=["is","top_is","bottom_is","from_is","to_is"];return A=Kc(Yf.substr(Yf.indexOf("^#")+2)),Fp(t[um(re+j[15]+"n"+j[16])]())&&Rd()?function(T){T&&!T._complete_&&(T._complete_=!0,T.vs&&tj(T.ns)&&(T.ns=Jj(T.vs,T.is)),T.top_vs&&tj(T.top_ns)&&(T.top_ns=Jj(T.top_vs,T.top_is)),T.bottom_vs&&tj(T.bottom_ns)&&(T.bottom_ns=Jj(T.bottom_vs,T.bottom_is)),T.from_vs&&tj(T.from_ns)&&(T.from_ns=Jj(T.from_vs,T.from_is)),T.to_vs&&tj(T.to_ns)&&(T.to_ns=Jj(T.to_vs,T.to_is)),j.forEach(function(l){var d=T[l];Wd(d)&&(T[l]=new Lg(d))}),H.forEach(function(c){var W=T[c];Wd(W)&&(T[c]=new Ld(W))}))}:void 0}(),kq=function(r,O){var A=r[O];Wd(A)&&(r[O]=new Lg(A))};Pr(Er,{_25Q:function(k){k._16O=function(j,F,i,p,R,P,I,U,G){var d=this.info;if(d){var W,N,M,Y,n,o,v=nn();if(Jd[F]?(W=d.p3,N=d.c1,M=d.c2):dh[F]?(N=d.s1||d.c1,M=d.s2||d.c2):(N=d.t1||d.c1,M=d.t2||d.c2),W)o=Bn(F,uc,i,p,U,G);else{var D=nj(M,N),s=Bc(N,M);Y=[0,-J(D[2],D[0]),K(D[1]/s)],n="zyx",W=[(N[0]+M[0])/2,(N[1]+M[1])/2,(N[2]+M[2])/2],o=Bn(F,[s,0,0],i,p,U,G)}return Xb(v,o,W,p,R,P,I,j,Y,n)}return ro},k._80o=function(C,Z,d){var I=this,X=I.shapeModel;if(X){var J=I.gv;vh(J),bf(J,I.data,X,I,I.getBodyColor(),d)}},k.createLineModel=function(_,U,j,O,c){for(var $=this,m=$.s,e=db(_,U,m(Nq)),A=[],R=0;R<e.length;R++){var x=e[R],B=x.length;if(B>1){var w=x[0];A.push(w.x,w.y,w.z);for(var p=1;B-1>p;p++)w=x[p],A.push(w.x,w.y,w.z),A.push(w.x,w.y,w.z);w=x[B-1],A.push(w.x,w.y,w.z)}}var u,M,D,Q=m(O+".color"),t=m(c),h=0;return t&&(M=m(c+".color"),u=m(c+".pattern"),h=m(c+".offset"),D=Q),rd($.gv,$.data,A,M||Q,D?T:m(O+".gradient.color"),j,u||m(O+".pattern"),h,D),e},k.createTubeModel=function(g,R,n,k){for(var u=this,b=u.s,t=b("shape3d.side")||ee,a=b("shape3d.start.angle"),I=b("shape3d.sweep.angle"),Z=b(Qi)?b("shape3d.top.cap"):T,D=b(Sg)?b("shape3d.bottom.cap"):T,B="flat"===Z,$="flat"===D,V=B&&(k?k.uv:b("shape3d.top.image")),s=$&&(k?k.uv:b("shape3d.bottom.image")),x=k?k.uv:b("shape3d.image"),_={vs:[],uv:x?[]:T,top_vs:B?[]:T,top_uv:V?[]:T,bottom_vs:$?[]:T,bottom_uv:s?[]:T},l=db(g,R,b(Nq),n),L=0,P=l.length;P>L;L++)xs(_,l[L],b(Vl),n,t,a,I,Z,D);if(k){var i=[];fs(u.gv,u.data,_,u,u.getBodyColor(),[],k,i),i.length&&(fj(k.vs,i),fj(k.ns,Jj(i)))}else u.shapeModel=_;return l},k.getCache=function(){var r=this.info;if(r){var l=r.list;if(l){var e=r.cache;return e||(e=r.cache=Bf(l)),e}}return T}}});var wf=function(i,_){for(var r,s=0,N=i.length,m=0,z=N-1;z>=m;)if(s=l(m+(z-m)/2),r=i[s].length-_,0>r)m=s+1;else{if(!(r>0)){z=s;break}z=s-1}s=z;var q=i[s],U=q.point;return s===N-1||q.length===_||(U=(new pj).subVectors(i[s+1].point,U).normalize().multiplyScalar(_-q.length).add(U)),{point:U,tangent:q.tangent}},Bf=function(Z){for(var i,y,c=[],r=0,l=0;l<Z.length;l++){for(var h=Z[l],C=0;C<h.length;C++){i=h[C],y&&(r+=y.distanceTo(i));var x=new pj,Q=h[C+1];Q?x.subVectors(Q,i):y?x.subVectors(i,y):x.x=1,x.normalize(),c.push({point:i,length:r,tangent:x}),y=i}y=null}return c},db=function(g,y,e,j){e=e||_o;for(var c=[],L=0,t=g.size();t>L;L++){var w=g.get(L);c.push(new pj(w.x,w.e||0,w.y))}y&&(Co(y)&&(y=y._as),y.length||(y=null));for(var x,l,K,S,d,J=[],i=0,I=0,E=y?y.length:t;E>I;I++)if(d=y?y[I]:0===I?1:2,1===d)J.push(K=[]),K.push(c[i++]);else if(2===d||5===d)if(S=2===d?c[i++]:K[0],j){var M=y?y[I+1]:E>I+1?2:T;if(2===M||5===M){var A=K[K.length-1],s=2===M?c[i]:K[0],h=(new pj).subVectors(A,S),o=(new pj).subVectors(s,S),a=h.length(),W=o.length();if(a&&W)if(j>a/2&&j>W/2)K.push(S);else for(h.multiplyScalar(B(j,a/2)/a).add(S),o.multiplyScalar(B(j,W/2)/W).add(S),x=new ip(h,S,o).getPoints(e),l=0;e>=l;l++)K.push(x[l])}else K.push(S)}else K.push(S);else if(3===d)for(x=new ip(K[K.length-1],c[i++],c[i++]).getPoints(e),l=1;e>=l;l++)K.push(x[l]);else if(4===d)for(x=new pr(K[K.length-1],c[i++],c[i++],c[i++]).getPoints(e),l=1;e>=l;l++)K.push(x[l]);return J},Rh=function(q){for(var y,c,B=new pj,U=[],h=[],V=[],O=0,E=q.length;E>O;O++)y=q[O],c=q[O+1],c?B.subVectors(c,y):B.subVectors(y,q[O-1]),U.push(B.normalize().clone());var m,i,o,x,z=new pj,e=new pj,Z=new Ti,N=1e-4,K=Number.MAX_VALUE,W=U[0],l=h[0]=new pj,w=V[0]=new pj;for(i=S(W.x),o=S(W.y),x=S(W.z),K>=i&&(K=i,z.set(1,0,0)),K>=o&&(K=o,z.set(0,1,0)),K>=x&&z.set(0,0,1),e.crossVectors(W,z).normalize(),l.crossVectors(W,e),w.crossVectors(W,l),O=1;E>O;O++)h[O]=h[O-1].clone(),V[O]=V[O-1].clone(),e.crossVectors(U[O-1],U[O]),e.length()>N&&(e.normalize(),m=g(Mi(U[O-1].dot(U[O]),-1,1)),h[O].applyMatrix4(Z.makeRotationAxis(e,m))),V[O].crossVectors(U[O],h[O]);return{B:V,T:U,N:h}},xs=function(){var h=function(Y){for(var q=1;q<arguments.length;q++){var M=arguments[q];Y.push(M.x,M.y,M.z)}},n=function(A){for(var L=1;L<arguments.length;L++){var v=arguments[L].uv;A.push(v[0],v[1])}},b=function(n,J,d,Y,e){var k=-Y*o(e),Q=Y*U(e);return new pj(n.x+k*d.x+Q*J.x,n.y+k*d.y+Q*J.y,n.z+k*d.z+Q*J.z)},k=function(g,u,i,B,V,f,U,F){U=U||p;for(var d=[],W=U/V,o=0;V>=o;o++){var r=b(g,u,i,B,o*W+f);d.push(r),F!=T&&(r.uv=[F,o/V])}return d},u=function(G,F,I,z,c,k,e,M,w){w=w||p;var x=F?G.top_vs:G.bottom_vs;if(x)for(var j=F?G.top_uv:G.bottom_uv,i=w/e,m=0;e>m;m++){var d,E;F?(d=m*i+M,E=(m+1)*i+M):(E=m*i+M,d=(m+1)*i+M),h(x,b(I,z,c,k,d),b(I,z,c,k,E),I),j&&j.push(.5-.5*o(d),.5-.5*U(d),.5-.5*o(E),.5-.5*U(E),.5,.5)}};return function(L,m,f,Z,$,M,F,Y,s){var G=m.length;if(G>1){var w,o,V,c,z,t,U,W=Rh(m),S=W.T,R=W.N,B=W.B;"flat"===Y&&u(L,!0,m[0],B[0],R[0],Z,$,M,F),"flat"===s&&u(L,!1,m[G-1],B[G-1],R[G-1],Z,$,M,F);var A,X,e=[],r=d($/2),I="round"===Y,g="round"===s,P=m[0],H=S[0],N=B[0],_=R[0],x=m[G-1],v=S[G-1],l=B[G-1],K=R[G-1];if(I){for(V=1;r>=V;V++)R.splice(0,0,_),B.splice(0,0,N),S.splice(0,0,H),X=-V/r*Z,m.splice(0,0,H.clone().multiplyScalar(X).add(P)),e[r-V]=E(Z*Z-X*X);G+=r}if(g){for(V=1;r>=V;V++)R.push(K),B.push(l),S.push(v),X=V/r*Z,m.push(v.clone().multiplyScalar(X).add(x)),e[m.length-1]=E(Z*Z-X*X);G+=r}if(L.uv){var D=0,b=0,i=[];for(f&&(D=f),z=m[0],i[0]=0,V=1;G>V;V++)c=m[V],i[V]=z.distanceTo(c),z=c,f||(D+=i[V]);for(A=[],V=0;G>V;V++)b+=i[V],A[V]=D?b/D:0}for(V=0;G>V;V++){if(c=m[V],t=B[V],U=R[V],w=k(c,t,U,e[V]===q?Z:e[V],$,M,F,A?A[V]:T),o)for(var p=0;$>p;p++){var O=o[p],y=o[p+1]||o[0],j=w[p],Q=w[p+1]||w[0];h(L.vs,y,O,j,j,Q,y),L.uv&&n(L.uv,y,O,j,j,Q,y)}o=w}}}}();Pr(t,{getLineLength:function(L){return L[L.length-1].length},getLineOffset:function(t,Z){return wf(t,Z)},getLineCacheInfo:function(S,m,g,E){return Bf(db(S,m,g,E))}});var oi=b.Light=function(){Uo(oi,this),this.s(ye,f[ye]),this.s(td,"sphere"),this.s3(20,20,20)};Tn("Light",Ak,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(o,u,s){oi.superClass.onStyleChanged.apply(this,arguments),o===ye&&this.s("shape3d.color",s)}});var gg=ks.Graph3dView=function(Y,j){var U=this;U._attributes=j||t.graph3dViewAttributes,U._25I={},U._view=rc(1,U);var A=U._canvas=Uh(U._view);A.addEventListener("webglcontextlost",function(L){L.preventDefault(),xq(U),U._26I&&U._doBufferGC(U._26I,!0),U._26I=T,U._1o.texture=T,U._35O=!0},O),A.addEventListener("webglcontextrestored",function(){U._35O=!1,U.iv()},O),U._batchIndexMap={},U._batchModelMap={},U._wireframeIndexMap={},U._wireframeModelMap={},U._wireframeIndexMapSwap={},U._wireframeModelMapSwap={},U._polylineIndexMap={},U._polylineIndexMap={},U._polylineIndexMapSwap={},U._polylineIndexMapSwap={},U._8O=[],U._7O=nn(),U._6O=nn(),U._1o=new Gp(U),U._30O=new Qn(U),U._31O=new nf(U),U._32O=new Zk(U),U._raycaster=new kc(U),U.vr=new _g(U),U._33Q=!0,U._eye=Tg(t.graph3dViewEye),U._center=Tg(t.graph3dViewCenter),U._up=Tg(t.graph3dViewUp),U._lightChanged=!1,U._59O=[],U._spots=[],U._dirs=[],U._frameId=0,U.overlappingBox=new Bm(U),U.dm(Y?Y:new Dj),U._coreInteractor=new Ii(this),U.setInteractors([new Oe(U)])},uk={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1},Pf=0;yr("Graph3dView",w,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",gm,br,"firstPersonMode",ni,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",Jm,_l,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:t.graph3dViewEditHelperDisabled,_devicePixelRatio:q,_boundaries:q,_moveStep:t.graph3dViewMoveStep,_rotateStep:t.graph3dViewRotateStep,_pannable:t.graph3dViewPannable,_rotatable:t.graph3dViewRotatable,_walkable:t.graph3dViewWalkable,_resettable:t.graph3dViewResettable,_zoomable:t.graph3dViewZoomable,_firstPersonMode:t.graph3dViewFirstPersonMode,_mouseRoamable:t.graph3dViewMouseRoamable,_gridVisible:t.graph3dViewGridVisible,_gridSize:t.graph3dViewGridSize,_gridGap:t.graph3dViewGridGap,_gridColor:t.graph3dViewGridColor,_originAxisVisible:t.graph3dViewOriginAxisVisible,_centerAxisVisible:t.graph3dViewCenterAxisVisible,_axisXColor:t.graph3dViewAxisXColor,_axisYColor:t.graph3dViewAxisYColor,_axisZColor:t.graph3dViewAxisZColor,_ortho:t.graph3dViewOrtho,_orthoWidth:t.graph3dViewOrthoWidth,_fovy:t.graph3dViewFovy,_near:t.graph3dViewNear,_far:t.graph3dViewFar,_headlightColor:t.graph3dViewHeadlightColor,_headlightIntensity:t.graph3dViewHeadlightIntensity,_headlightRange:t.graph3dViewHeadlightRange,_headlightDisabled:t.graph3dViewHeadlightDisabled,_rectSelectable:t.graph3dViewRectSelectable,_rectSelectBackground:t.graph3dViewRectSelectBackground,_editSizeColor:t.graph3dViewEditSizeColor,_autoMakeVisible:qq,_fogDisabled:t.graph3dViewFogDisabled,_fogColor:t.graph3dViewFogColor,_fogNear:t.graph3dViewFogNear,_fogFar:t.graph3dViewFogFar,_dashDisabled:t.graph3dViewDashDisabled,_batchColorDisabled:t.graph3dViewBatchColorDisabled,_batchBlendDisabled:t.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:t.graph3dViewBatchBrightnessDisabled,setEye:function(m,R,Z){1===arguments.length&&(R=m[1],Z=m[2],m=m[0]);var Y=this._eye;Y[0]=m,Y[1]=R,Y[2]=Z,this.fp(Jm,T,Y)},setCenter:function(C,J,m){1===arguments.length&&(J=C[1],m=C[2],C=C[0]);var p=this._center;p[0]=C,p[1]=J,p[2]=m,this.fp(_l,T,p)},setUp:function(I,q,b){1===arguments.length&&(q=I[1],b=I[2],I=I[0]);var x=this._up;x[0]=I,x[1]=q,x[2]=b,this.fp("up",T,x)},getDevicePixelRatio:function(){return this._devicePixelRatio||ke},isTransparentMask:function(O){return O.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getAspect:function(){var T=this,X=T._aspect;return X?X:(X=T.getWidth()/T.getHeight(),X||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(j){var s=this,n=s._dataModel,g=s._selectionModel;n!==j&&(n&&(n.ump(s.handleDataModelPropertyChange,s),n.umm(s.handleDataModelChange,s),n.umd(s.handleDataPropertyChange,s),g||n.sm().ums(s.handleSelectionChange,s)),s._dataModel=j,j.mp(s.handleDataModelPropertyChange,s),j.mm(s.handleDataModelChange,s),j.md(s.handleDataPropertyChange,s),g?g._21I(j):j.sm().ms(s.handleSelectionChange,s),s.invalidateAll(!0),s.invalidateLight(),s.fp(pb,n,j),s._canvas.style.background=j.getBackground()||"")},handleDataModelPropertyChange:function(o){if("background"===o.property){var E=this._canvas.style.background,T=o.newValue||"";this._canvas.style.background=T,this.fp("canvasBackground",E,T)}},handleDataPropertyChange:function(K){var P=K.data;this.invalidateData(P),Vr(P)&&"s:light.type"===K.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(t){var G=this,k=t.property;G.iv(),G._18Q=T,"eye"===k?G._33Q=!0:"devicePixelRatio"===k?G._42(T,G.getDevicePixelRatio()):uk[k]&&xq(G)},_5O:function(O){var t=O._22Q();return t?new t(this,O):T},getData3dUI:function(l){var t=this._25I[l._id];return t===q&&(t=this._5O(l),this._25I[l._id]=t),t},invalidateAll:function(i){var b=this;if(i){for(var Q in b._25I){var N=b._25I[Q];N&&N.dispose()}b._25I={},b.iv(),xb(b)}else xb(b),b.dm().each(function(Q){b.invalidateData(Q)})},invalidateSelection:function(){var F=this;F.sm().each(function(u){F.invalidateData(u)})},invalidateData:function(e){var J=this,d=J.getData3dUI(e);d&&(d.iv(),J.iv()),xb(J,e)},getShape3dText:function(A){return A.getStyle("shape3d.text")||this.getLabel(A)},invalidateBatch:function(t){var k=this,P=k._batchModelMap,v=P[t],U=[],i={};if(v){v.ds.forEach(function(h){var J=k.getData3dUI(h);J&&J.iv(),delete k._batchIndexMap[h._id],U.push(h._id)}),delete P[t];for(var c,G,$,u,M,J,b,j,n,Q=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],H=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],h=0;h<Q.length;h++){var s=k[Q[h]],w=k[H[h]];for(i={},j=0;j<U.length;j++){var p=w[U[j]];if(p){delete w[U[j]],n=p.batch,c=s[n];var D=p.begin,C=p.size,Z=3*D,E=3*C,m=4*D,O=4*C;for(G=c.ds,$=c.vs,u=c.cs,M=c.ps,J=c.ls,b=p.index,c.invalidate=!0,G[b]=q,b=Z;Z+E>b;b++)$[b]=q;for(b=m;m+O>b;b++)u[b]=q;for(b=m;m+O>b;b++)M[b]=q;if(J)for(b=Z;Z+E>b;b++)J[b]=q;i[n]=!0}}for(n in i){c=s[n],G=c.ds,$=c.vs,u=c.cs,M=c.ps,J=c.ls;var T=[];for(b=0;b<G.length;b++)G[b]!==q&&T.push(G[b]);if(0===T.length)delete s[n];else{for(c.ds=T,T=[],b=0;b<$.length;b++)$[b]!==q&&T.push($[b]);for(c.vs=T,T=[],b=0;b<u.length;b++)u[b]!==q&&T.push(u[b]);for(c.cs=T,T=[],b=0;b<M.length;b++)M[b]!==q&&T.push(M[b]);if(c.ps=T,J){for(T=[],b=0;b<J.length;b++)J[b]!==q&&T.push(J[b]);c.ls=T}}}}k.iv()}},handleDataModelChange:function($){var R=this,M=$.kind,q=$.data;if("add"===M)R.invalidateData(q),Pn(q)&&q.getEdgeGroup()&&q.getEdgeGroup().eachSiblingEdge(R.invalidateData,R),Vr(q)&&R.invalidateLight();else if(M===Rl){var L=q._id,W=R._25I[L];W&&(W.dispose(),delete R._25I[L],R.iv()),q===R._currentSubGraph&&R.setCurrentSubGraph(T),xb(R,q),Vr(q)&&R.invalidateLight()}else M===ar&&(R.invalidateAll(!0),R.setCurrentSubGraph(T),xb(R),R.invalidateLight())
},toCanvas:function(K,w,N){var I=this,E=I.getGL();if(I.validate(),K){var Y=E.getParameter(E.COLOR_CLEAR_VALUE);Sj(E,K)}I._42(T,1);var F=I.getWidth(),v=I.getHeight(),o=new Uint8Array(4*F*v),d=Uh(),R=d.getContext("2d");E.readPixels(0,0,F,v,E.RGBA,E.UNSIGNED_BYTE,o),Dp(d,F,v,1);for(var A=R.getImageData(0,0,F,v),D=A.data,S=0;S<D.length;S+=4){var q=S/4,e=l(q/F),c=q-e*F;q=4*((v-1-e)*F+c),D[q]=o[S],D[q+1]=o[S+1],D[q+2]=o[S+2],D[q+3]=o[S+3]}if(R.putImageData(A,0,0),K&&Sj(E,Y),I._42(T,I.getDevicePixelRatio()),w&&N){var f=Uh(),V=f.getContext("2d");return w=w,N=N,Dp(f,w,N,1),t.drawImage(V,d,0,0,w,N),f}return d},toDataURL:function(v,w){var h=this,q=h.getGL();if(h.validate(),v){var $=q.getParameter(q.COLOR_CLEAR_VALUE);Sj(q,v)}h._42(T,1);var K=h._canvas.toDataURL(w||"image/png",1);return v&&Sj(q,$),h._42(T,h.getDevicePixelRatio()),K},getGL:function(){var I=this,N=I._26I,e=I._prg;if(!N)try{I._2O={},N=I._26I=I._canvas.getContext("webgl",I._attributes)||I._canvas.getContext("experimental-webgl",I._attributes),N._emptyTexture=Nb(N),N._emptyBlendTexture=Nb(N),N._bufPool={},N._id=++Pf,I._buffer={vs:Gl(N),ns:Gl(N),is:Gl(N),uv:Gl(N),batchColor:Gl(N),batchBlend:Gl(N),batchBrightness:Gl(N),lineDistance:Gl(N)},I._1O=Yc(N);var W=I._cube={vs:Gl(N),ns:Gl(N),is:Gl(N),uv:Gl(N)};xr(N,W.vs,Wo),xr(N,W.ns,Jl),xr(N,W.uv,Ob),hd(N,W.is,Eo)}catch(X){}if(N&&!e){if(e=I._prg=N.createProgram(),!e)return T;var k=I._dirs.length,J=I._spots.length,n=I._59O.length,l=["uPMatrix","uMVMatrix","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];k&&l.push("uDirColor","uDirDirection"),J&&l.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),n&&l.push("uPointColor","uPointRange","uPointPosition"),Sj(N,[0,0,0,0]),N.clearDepth(1),N.enable(N.DEPTH_TEST),N.depthFunc(N.LEQUAL),N.enable(N.BLEND),N.blendFuncSeparate(N.SRC_ALPHA,N.ONE_MINUS_SRC_ALPHA,N.ONE,N.ONE_MINUS_SRC_ALPHA),mc||(Yf=Kc(Yf.substring(0,Yf.indexOf("^#"))),Ke=Kc(Ke),mc=!0);var i=["#define MAX_DIR "+k,"#define MAX_SPOT "+J,"#define MAX_POINT "+n,I._fogDisabled?"":"#define FOG",I._dashDisabled?"":"#define DASH",I._batchColorDisabled?"":"#define BATCHCOLOR",I._batchBlendDisabled?"":"#define BATCHBLEND",I._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),F=ho(N,e,N.VERTEX_SHADER,Yf.replace("PREFIX",i)),v=ho(N,e,N.FRAGMENT_SHADER,Ke.replace("PREFIX",i));$?l.push("aPosition"):(e.aPosition=0,N.bindAttribLocation(e,0,"aPosition")),N.linkProgram(e),l.forEach(function(C){e[C]=/^u/.test(C)?N.getUniformLocation(e,C):N.getAttribLocation(e,C)}),N.useProgram(e),N.deleteShader(F),N.deleteShader(v)}return N},getBrightness:function(e){var v=e.s("brightness"),F=this.isSelected(e)?e.s("select.brightness"):T;return v==T?F:F==T?v:v*F},getWireframe:function(R){var f=R.s("wf.visible"),q=R.s("wf.width");return f===!0||q>0&&"selected"===f&&this.isSelected(R)?{color:R.s("wf.color"),width:q,"short":R.s("wf.short"),mat:R.s("wf.mat")}:void 0},_transformPointToViewSpace:function(I){var Z=[I[0],I[1],I[2]];return rm(Z,this._viewMatrix),Z},_transformDirectionToViewSpace:function(p,d){var E=[p[0],p[1],p[2]];rm(E,this._viewMatrix);var r=d?[d[0],d[1],d[2]]:[0,0,0];rm(r,this._viewMatrix);var z=r[0]-E[0],P=r[1]-E[1],F=r[2]-E[2],g=Math.sqrt(z*z+P*P+F*F);return g?[z/g,P/g,F/g]:[z,P,F]},getWireframeGeometry:function(X){return X.s("wf.geometry")?{color:X.s("wf.color"),width:X.s("wf.width"),mat:X.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(D){return D.s("body.color")},getMat:function(W){return W.getMat?W.getMat():W.s("mat")},getFaceMat:function(V,b){return V.getFaceMat?V.getFaceMat(b):V.s(b+".mat")},getFaceBlend:function(h,M){return h.s(M+".blend")||h.s("all.blend")},getFaceColor:function(g,d){return g.s(d+".color")||g.s("all.color")},getFaceImage:function(j,b){return j.s(b+".image")||j.s("all.image")},getFaceBlendImage:function(f,L){return f.s(L+".blend.image")||f.s("all.blend.image")},getFaceDiscardSelectable:function(q,A){var N=q.s(A+".discard.selectable");return N==T?q.s("all.discard.selectable"):N},getFaceUv:function(w,c){return w.s(c+".uv")||w.s("all.uv")},getFaceUvOffset:function(k,Z){return k.s(Z+".uv.offset")||k.s("all.uv.offset")},getFaceUvScale:function(b,f){return b.s(f+".uv.scale")||b.s("all.uv.scale")},getFaceLight:function(y,X){var J=y.s(X+".light");return J==T?y.s("all.light"):J},getFaceVisible:function($,D){var n=$.s(D+".visible");return n==T?$.s("all.visible"):n},getFaceOpacity:function(K,y){var c=K.s(y+".opacity");return c==T?K.s("all.opacity"):c},getFaceTransparent:function(Q,l){var E=Q.s(l+".transparent");return E==T?Q.s("all.transparent"):E},getFaceReverseColor:function(o,Y){return o.s(Y+".reverse.color")||o.s("all.reverse.color")},getFaceReverseFlip:function($,r){var Y=$.s(r+".reverse.flip");return Y==T?$.s("all.reverse.flip"):Y},getFaceReverseCull:function(f,I){var b=f.s(I+".reverse.cull");return b==T?f.s("all.reverse.cull"):b},getTextureMap:function(){return this._2O},deleteTexture:function(i){var Q=this,w=Q._2O[i];w&&(delete Q._2O[i],Q.getGL().deleteTexture(w))},invalidateShape3dCachedImage:function(z){var u=this.getData3dUI(z);u.invalidateCachedTexture(this.getGL())},isInteractive:function(i){return i.s("interactive")},getTexture:function(j,H){if(!j)return T;var q=this,A=q.getGL(),G=q._2O[j];if(!G){var C=xf(j);if(C)if(C.tagName){if(C.dynamic)return Yc(A,C,q._1O);G=q._2O[j]=Yc(A,C)}else{var D,P=H&&H.s("shape3d.image.cache")&&!q.isInteractive(H),u=q.vr.isPresenting();if(u&&(H._textureUpdateFrame===A._renderInfo.frame?P=!0:H._textureUpdateFrame=A._renderInfo.frame),P&&(D=q.getData3dUI(H),G=D.getCachedTexture()),!G){var M=H&&H.s("shape3d.fixSizeOnScreen"),c=M?A.NEAREST:A.LINEAR;if(!M&&H&&H.s("shape3d.vector.dynamic")&&(D||(D=q.getData3dUI(H)),M=D.getVectorDynamicSize())){var x=q.getDevicePixelRatio();M[0]*=x,M[1]*=x}var z=H&&H.s("shape3d.texture.scale")||1,E=M&&M[0]>0?M[0]:z*Sq(C,H),Y=M&&M[1]>0?M[1]:z*Bg(C,H);if(E>=1&&Y>=1){var k=ge(E,Y);if(!D&&H&&(D=q.getData3dUI(H)),D&&D.interactiveInfo){var b=D.interactiveInfo[j]={};k.interactiveInfo=b.bodyInfo={compInfos:[],matrix:new yp,rect:{x:0,y:0,width:E,height:Y}}}Bh(k,C,0,0,E,Y,H,q),k.interactiveInfo&&(k.interactiveInfo=null),k.restore(),(P||u)&&Xq(C,H)?(G=Yc(A,Wq,null,c),D.setCachedTexture(G),Wq=null):G=Yc(A,Wq,q._1O,c)}}}}return G},redraw:function(){this.iv()},validateImpl:function(){var C=this;if(C._lightChanged){C._lightChanged=!1;var b=[],U=[],R=[];C.dm().each(function(P){if(Vr(P)){var h=P.s("light.type");h===$b?b.push(P):h===os?U.push(P):h===pc&&R.push(P)}}),(b.length!==C._59O.length||U.length!==C._spots.length||R.length!==C._dirs.length)&&xq(C),C._59O=b,C._spots=U,C._dirs=R}C._42(),C._1o.iv()},getRenderInfo:function(){var Z=this.getGL();return Z?Z._renderInfo:void 0},showDebugTip:function(){var X=this,b=X._debugDiv;if(!b){b=X._debugDiv=R.createElement("div"),b.style.position="absolute",b.style.overflow="hidden",b.style.backgroundColor="white",b.style.color="black";var y=X.getView();X._79O?y.insertBefore(b,X._79O):y.appendChild(b),X._debugTipTimerId=setInterval(function(){var z=X.getRenderInfo();if(z){var S=X.getGL()._validBufCount||0,A="Draw Calls: "+z.calls+"<br/>"+"Vertices: "+z.vertices+"<br/>"+"Faces: "+z.faces+"<br/>"+"Lines: "+z.lines+"<br/>"+"Buffer Count: "+S;b.innerHTML=A}},10)}},hideDebugTip:function(){var j=this,A=j._debugDiv;A&&(delete j._debugDiv,cancelAnimationFrame(j._debugTipTimerId),delete j._debugTipTimerId,j.getView().removeChild(A))},_42:function(B,l){var R=this;if(!R._35O&&(!Rm||ln(Rm))){var x,k;B&&(B instanceof Ak?k=B:x=B);var m=R._canvas,N=R.getGL(),h=R._prg;if(N){var c=R.getWidth(),M=R.getHeight();l?B||Dp(m,c,M,l):(l=R.getDevicePixelRatio(),B||c===m.clientWidth&&M===m.clientHeight||Dp(m,c,M,l)),N.clear(N.COLOR_BUFFER_BIT),N._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:B?R._frameId:++R._frameId};var H=function(){if(R.overlappingBox.clear(),R._81O=T,N.clear(N.DEPTH_BUFFER_BIT),sm(N,h.uBrightness,1),sm(N,h.uOpacity,1),sm(N,h.uPartOpacity,1),N._picking=!!B,sm(N,h.uPick,!!B),sm(N,h.uTexture,!1),sm(N,h.uBlendTexture,!1),sm(N,h.uAlphaTest,f.alphaTest),sm(N,h.uTransparent,!1),sm(N,h.uFix,!1),sm(N,h.uBatchColor,!1),sm(N,h.uBatchBlend,!1),sm(N,h.uBatchBrightness,!1),sm(N,h.uPMatrix,R._projectMatrix=gh(R)),sm(N,h.uViewMatrix,xg(R,R._7O)),R._viewMatrix=bj(R._7O),B||(qf(R,N,h),R._fogDisabled||(sm(N,h.uFogColor,R._fogColor),sm(N,h.uFogNear,R._fogNear),sm(N,h.uFogFar,R._fogFar))),uj(N,h.aPosition),uj(N,h.aNormal),tl(N,h.aUv),tl(N,h.aBatchColor),tl(N,h.aBatchBlend),tl(N,h.aBatchBrightness),tl(N,h.aLineDistance),k){var A=N.getParameter(N.COLOR_CLEAR_VALUE);N.clearColor(0,0,0,0),N.disable(N.BLEND),tl(N,h.aNormal),xr(N,R._cube.vs,T,h.aPosition),hd(N,R._cube.is),Td(k,R,vn,0),Td(k,R,Af,6),Td(k,R,ib,12),Td(k,R,Yr,18),Td(k,R,Nm,24),Td(k,R,ak,30),uj(N,h.aNormal),Sj(N,A)}else if(x){x.value=2;var A=N.getParameter(N.COLOR_CLEAR_VALUE);N.clearColor(0,0,0,0),N.disable(N.BLEND),R._95I(N,h,x),Ci(R,x),Io(R,R._polylineModelMap,x),Io(R,R._wireframeModelMap,x),sm(N,h.uTransparent,!0),R._95I(N,h,x,!0),Ci(R,x,!0),Io(R,R._polylineModelMap,x,!0),Io(R,R._wireframeModelMap,x,!0),sm(N,h.uTransparent,!1),N.clear(N.DEPTH_BUFFER_BIT),R._swapLineMap(),R._95I(N,h,x,!1,!0),Io(R,R._polylineModelMap,x),Io(R,R._wireframeModelMap,x),R._swapLineMap(),N.disable(N.DEPTH_TEST),R._30O._42(N,h,x),N.enable(N.DEPTH_TEST),Sj(N,A)}else N.disable(N.BLEND),R.drawSky(N,h),R._31O._42(N,h),R._95I(N,h),Ci(R),Io(R,R._polylineModelMap),Io(R,R._wireframeModelMap),N.enable(N.BLEND),sm(N,h.uTransparent,!0),N.depthMask(!1),R._95I(N,h,T,!0),Ci(R,T,!0),Io(R,R._polylineModelMap,T,!0),Io(R,R._wireframeModelMap,T,!0),N.depthMask(!0),sm(N,h.uTransparent,!1),N.clear(N.DEPTH_BUFFER_BIT),R._swapLineMap(),R._95I(N,h,T,!1,!0),Io(R,R._polylineModelMap),Io(R,R._wireframeModelMap),R._swapLineMap(),N.disable(N.DEPTH_TEST),N.disable(N.BLEND),R._32O._42(N,h),R._30O._42(N,h),N.enable(N.DEPTH_TEST);xr(N,T),hd(N,T)},j=!1,d=c*l,u=M*l,U=R.vr;U.enable&&U._42(N,d,u,H)&&(j=!0);var D=R.envRenderer;D&&D.enable&&D._42(N,d,u,H)&&(j=!0),j||(N.viewport(0,0,c*l,M*l),H()),R._33Q=!1,R._doBufferGC(N)}}},setBufferGCInterval:function(n){this._bufferGCInterval=n},_doBufferGC:function(v,k){var e,g,A=v._bufPool,D=0,U=0,n=v._renderInfo.frame,p=this._bufferGCInterval||10;for(e in A)D++,g=A[e],g&&(k||n-g._fid>p?(v.deleteBuffer(g._buf),g._buf=null,A[e]=null):U++);if(D/2>U&&D>128){var G={};for(e in A)A[e]&&(G[e]=A[e]);v._bufPool=G}v._validBufCount=U},_swapLineMap:function(){var R=this;a=R._polylineModelMap,R._polylineModelMap=R._polylineModelMapSwap,R._polylineModelMapSwap=a,a=R._wireframeModelMap,R._wireframeModelMap=R._wireframeModelMapSwap,R._wireframeModelMapSwap=a,a=R._polylineIndexMap,R._polylineIndexMap=R._polylineIndexMapSwap,R._polylineIndexMapSwap=a,a=R._wireframeIndexMap,R._wireframeIndexMap=R._wireframeIndexMapSwap,R._wireframeIndexMapSwap=a},_updateSkyBoxPosition:function(P){if(this._skyBox&&P&&"eye"===P.property){var S=P.newValue;this._skyBox.p3(S[0],S[1],S[2]),this.invalidateData(this._skyBox)}},setSkyBox:function(P){var S=this._skyBox;S&&this._skyBoxStyleMap&&(S.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null),this._skyBox=P,this.ump(this._updateSkyBoxPosition,this),P&&(P.dm()&&P.dm().remove(P),this._skyBoxStyleMap=b.Default.clone(P.getStyleMap()),P.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBoxPosition,this),this._updateSkyBoxPosition({property:"eye",newValue:this.getEye()})),this.fp("skyBox",S,P)},drawSky:function(k,F,r){var P=this,v=P._skyBox;if(v){var i=P._headlightIntensity,I=Uf(P._headlightColor),F=P._prg;1!==i&&(I=[I[0]*i,I[1]*i,I[2]*i]),sm(k,F.uHeadlightColor,[I[0],I[1],I[2],1]);var J=P.getData3dUI(v);J&&J._42(k,F,r,function(){return!0}),k.clear(k.DEPTH_BUFFER_BIT),sm(k,F.uHeadlightColor,[I[0],I[1],I[2],P._headlightDisabled?1:0])}},_95I:function(l,h,z,L,M){function A(B){if(!!B.s("shape3d.alwaysOnTop")==!!M&&F.isVisible(B)&&(!Y||c)){if(!z&&F.isTransparentMask(B))return;var k=F.getData3dUI(B);k&&k._42(l,h,z,n)}}var F=this,n=function(N){return L?N:!N};F.sky&&l.clear(l.DEPTH_BUFFER_BIT),F.dm().each(A)},getLogicalPoint:function(Z){return mk(Z,this._canvas)},isRectOverlapping:function(c){var o=this.getData3dUI(c);return o._rectOverlapping},getHitFaceInfo:function(u){u.target&&(u=this.lp(u));var P=this.getDataInfoAt(u);if(P){var a=this._1o.face(P.data,ob(u.x,u.y));if(a)return{data:P.data,face:a}}return T},unproject:function(t,O){var k=this,w=k.getWidth(),y=k.getHeight(),n=t.target?k.lp(t):t,m=n.x-w/2,v=n.y-y/2,I=2*(m/w),g=2*(-1*v/y);O=O||0;var $=nn(),p=gh(k),x=xg(k);nm($,p,x),Ih($);var q=fb([I,g,O,1],$);return[q[0]/q[3],q[1]/q[3],q[2]/q[3]]},getDataAt:function(Y){var B=this.getDataInfoAt(Y);return B?B.data:T},getDataInfoAt:function(B,K){return B.target&&(B=this.lp(B)),this._1o.get(ob(B.x,B.y,K),!0)},getDatasInRect:function(h){return this._1o.get(h)},setEditable:function(e){var Y=this,M=Y._editable;Y._editable=e,this.fp(Ol,M,e)},isEditable:function(M){var n=this;return n._editable?uq(M)?M.s("3d.editable")?n._editableFunc?n._editableFunc(M):!0:!1:!1:!1},isSelectable:function(c){return c.s("3d.selectable")&&this.sm().isSelectable(c)},isMovable:function(C){var A=this;return Pn(C)&&C.getStyle(Zj)!==ek?!1:C.s("3d.movable")?A._movableFunc?A._movableFunc(C):!0:!1},isSizeEditable:function(a){return uq(a)?this._sizeEditableFunc?this._sizeEditableFunc(a):!0:!1},isRotationEditable:function(b){return uq(b)&&b.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(b):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(e){this.setZoom(Kq,e)},zoomOut:function(p){this.setZoom(1/Kq,p)},setZoom:function(C,$){if(1!==C){var a=this;if(a._ortho)return a.setOrthoZoom(C,$),void 0;a._14o&&a._14o.stop(!0);var t=1/C,S=a._eye,Z=a._center,J=Z[0]+(S[0]-Z[0])*t-S[0],B=Z[1]+(S[1]-Z[1])*t-S[1],Y=Z[2]+(S[2]-Z[2])*t-S[2];if(!(Bc(S,Z)<a._moveStep&&1>t)){if($=_m($)){var X=Tg(S);return $.action=function(c){a.fi({kind:a._zooming?"betweenZoom":"beginZoom"}),a._zooming=1,S[0]=X[0]+J*c,S[1]=X[1]+B*c,S[2]=X[2]+Y*c,a.fp(Jm,T,S)},$._37o=function(){delete a._14o,delete a._zooming,a.fi({kind:"endZoom"}),a.onZoomEnded()},a._14o=jr($)}S[0]+=J,S[1]+=B,S[2]+=Y,a.fp(Jm,T,S)}}},setOrthoZoom:function(f,g){if(1!==f){var B=this;B._14o&&B._14o.stop(!0);var Q=B._orthoWidth,N=Q/f-Q;if(!(Q<B._moveStep&&f>1))return(g=_m(g))?(g.action=function(i){B.fi({kind:B._zooming?"betweenZoom":"beginZoom"}),B._zooming=1,B.setOrthoWidth(Q+N*i)},g._37o=function(){delete B._14o,delete B._zooming,B.fi({kind:"endZoom"}),B.onZoomEnded()},B._14o=jr(g)):(B.setOrthoWidth(Q/f),void 0)}},getPositionInfo:function(O){var c=this,V=c._eye,g=c._center,v=c.getAspect(),W=O?zq(nj(g,V,!0),nj(O,V)):Bc(V,g);if(c._ortho){var r=c._orthoWidth;return{length:W,height:r/v,width:r}}var d=2*s(c._fovy/2)*W;return{length:W,height:d,width:d*v}},getCenterInfo:function(){var P=this;return P._81O||(P._81O=P.getPositionInfo()),Tg(P._81O)},rotate:function(h,Q,$,D){var H=this;if(h||Q){D==T&&(D=H._firstPersonMode),H._88O&&H._88O.stop(!0);var j=H._center,R=H._eye,Z=H.getCenterInfo().length,k=D?j:R,W=D?R:j,K=nj(k,W),u=J(K[0],K[2]),v=J(E(K[0]*K[0]+K[2]*K[2]),K[1]),M=D?_l:Jm;return D&&(Q=-Q),($=_m($))?($.action=function(S){H.fi({kind:H._rotating?"betweenRotate":"beginRotate"}),H._rotating=1;var R=u+h*S,p=v+Q*S;p=vi(p),K[0]=Z*U(p)*U(R),K[1]=Z*o(p),K[2]=Z*U(p)*o(R),k[0]=W[0]+K[0],k[1]=W[1]+K[1],k[2]=W[2]+K[2],H.fp(M,T,k)},$._37o=function(){delete H._88O,delete H._rotating,H.fi({kind:"endRotate"}),H.onRotateEnded()},H._88O=jr($)):(u+=h,v+=Q,v=vi(v),K[0]=Z*U(v)*U(u),K[1]=Z*o(v),K[2]=Z*U(v)*o(u),k[0]=W[0]+K[0],k[1]=W[1]+K[1],k[2]=W[2]+K[2],H.fp(M,T,k),void 0)}},pan:function(u,$,G,b){if(u||$){var c=this;b==T&&(b=c._firstPersonMode),c._89O&&c._89O.stop(!0);var q=xg(c),U=[q[0]*u,q[4]*u,q[8]*u],m=[q[1]*$,q[5]*$,q[9]*$],Z=U[0]+m[0],o=U[1]+m[1],h=U[2]+m[2],C=c._center,H=c._eye;if(b){var i=In(c.getBoundaries(),H[0],H[2],H[0]+Z,H[2]+h,E(Z*Z+h*h));Z=i[0],h=i[1]}if(G=_m(G)){var X=Tg(H),F=Tg(C);return G.action=function(U){c.fi({kind:c._panning?"betweenPan":"beginPan"}),c._panning=1,C[0]=F[0]+Z*U,C[1]=F[1]+o*U,C[2]=F[2]+h*U,H[0]=X[0]+Z*U,H[1]=X[1]+o*U,H[2]=X[2]+h*U,c.fp(Jm,T,H),c.fp(_l,T,C)},G._37o=function(){delete c._89O,delete c._panning,c.fi({kind:"endPan"}),c.onPanEnded()},c._89O=jr(G)}C[0]+=Z,C[1]+=o,C[2]+=h,H[0]+=Z,H[1]+=o,H[2]+=h,c.fp(Jm,T,H),c.fp(_l,T,C)}},walk:function(r,u,O){if(r){var v=this;O==T&&(O=v._firstPersonMode),v._90O&&v._90O.stop(!0);var f=v._center,$=v._eye,H=nj(f,$,!0);if(O){var n=In(v.getBoundaries(),$[0],$[2],$[0]+H[0]*r,$[2]+H[2]*r,S(r));if(r=Bc(n),!r)return;H=[n[0]/r,0,n[1]/r]}if(u=_m(u)){var R=Tg($),s=Tg(f);return u.action=function(G){v.fi({kind:v._walking?"betweenWalk":"beginWalk"}),v._walking=1;var y=r*G;$[0]=R[0]+H[0]*y,$[1]=R[1]+H[1]*y,$[2]=R[2]+H[2]*y,f[0]=s[0]+H[0]*y,f[1]=s[1]+H[1]*y,f[2]=s[2]+H[2]*y,v.fp(Jm,T,$),v.fp(_l,T,f)},u._37o=function(){delete v._90O,delete v._walking,v.fi({kind:"endWalk"}),v.onWalkEnded()},v._90O=jr(u)}$[0]+=H[0]*r,$[1]+=H[1]*r,$[2]+=H[2]*r,f[0]+=H[0]*r,f[1]+=H[1]*r,f[2]+=H[2]*r,v.fp(Jm,T,$),v.fp(_l,T,f)}},handleScroll:function(b,J){b.preventDefault();var U=this,r=U._moveStep;U.isFirstPersonMode()?U.isPannable()&&U.pan(0,J>0?r:-r):U.isZoomable()&&U.setZoom(0>J?1/to:to)},handlePinch:function(J,a){this.isZoomable()&&this.setZoom(a>J?1/Fr:Fr)},reset:function(){this.setCenter(t.graph3dViewCenter),this.setEye(t.graph3dViewEye),this.setUp(t.graph3dViewUp)},moveSelection:function(c,j,i){var r=this;r.dm().beginTransaction(),je(this.sm().toSelection(this.isMovable,this),c,j,i),r.dm().endTransaction()},getMoveMode:function(x,e){var b=e.s("3d.move.mode");if(b)return b;var t="88",P="89",i="90";return fk(x)||Eh[t]&&Eh[P]&&Eh[i]?"xyz":Eh[t]&&Eh[P]?"xy":Eh[t]&&Eh[i]?"xz":Eh[P]&&Eh[i]?"yz":Eh[t]?"x":Eh[P]?"y":Eh[i]?"z":"xz"},handleTick:function(){var H=this,W=!1,b=H._moveStep,w=b,D=!1,o=!0,F=H._rotateStep*(o?-1:1);if(H.isWalkable()||(w=0),H.isPannable()||(b=0),H.isRotatable()||(F=0),H._32Q){var e=(Wm()-H._32Q)/50;w*=e,b*=e,F*=e}H._31Q&&(bb(H._31Q),delete H._31Q,delete H._32Q),Lb()&&(W=!0,H.pan(-b,0,D,o)),Vi()&&(W=!0,H.pan(b,0,D,o)),ve()&&(W=!0,fk()?H.pan(0,b,D,o):H.walk(w,D,o)),Lp()&&(W=!0,fk()?H.pan(0,-b,D,o):H.walk(-w,D,o)),Cc()&&(W=!0,H.rotate(-F,0,D,o)),zn()&&(W=!0,H.rotate(F,0,D,o)),Lr()&&(W=!0,H.rotate(0,-F/2,D,o)),Ei()&&(W=!0,H.rotate(0,F/2,D,o)),W&&(H._32Q=Wm(),H._31Q=Zh(H.handleTick,H))},handleKeyDown:function(r){var v=this;!ti(r)&&Yp[r.keyCode]?v.handleTick():Di(r)?v.selectAll():If(r)?v.handleDelete(r):jm(r)&&this.isResettable()&&v.reset()},checkDoubleClickOnNote:function(M,J,z){var K=this;if(z===Mr){if(J.s("note.toggleable"))return J.s(Jn,!J.s(Jn)),K.fi({kind:"toggleNote",event:M,data:J,part:z}),!0}else if(z===lf&&J.s("note2.toggleable"))return J.s(lg,!J.s(lg)),K.fi({kind:"toggleNote2",event:M,data:J,part:z}),!0;return!1},checkDoubleClickOnRotation:function(A,Q,k){return k===fn?(Q.setRotationX(0),!0):k===qm?(Q.setRotationY(0),!0):k===_j?(Q.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(x){var O=this;if(O.isOrtho())return O.getWidth()/O.getOrthoWidth();var T=O.getCenter(),f=O.getHeight(),C=O.getEye(),S=[T[0]-C[0],T[1]-C[1],T[2]-C[2]],q=[x[0]-C[0],x[1]-C[1],x[2]-C[2]],X=Math.sqrt(S[0]*S[0]+S[1]*S[1]+S[2]*S[2]),s=1/Math.tan(O.getFovy()/2);return f*X*s/(q[0]*S[0]+q[1]*S[1]+q[2]*S[2])},inViewSpace:function(U){var c,N=this,g=N._transformPointToViewSpace(U),L=N.getAspect(),o=N.getNear(),A=N.getFar();return-g[2]<o||-g[2]>A?!1:N.isOrtho()?(c=N.getOrthoWidth()/2,Math.abs(g[0])<=c&&Math.abs(g[1]*L)<=c):(c=Math.sqrt(g[0]*g[0]+g[1]*g[1]+g[2]*g[2])*Math.tan(N.getFovy()/2),Math.abs(g[1]<=c)&&Math.abs(g[0])<=c*L)},toViewPosition:function(e){var N=this,j=N.getWidth()/2,h=N.getHeight()/2,F=N._18Q;return F&&F._wh===j/h||(F=gh(N),N._18Q=nm(F,F,xg(N)),N._18Q._wh=j/h),e=fb([e[0],e[1],e[2],1],F),{x:j+j*e[0]/e[3],y:h-h*e[1]/e[3]}},getHitPosition:function(w,A,V){var H=this,W=H.getWidth(),S=H.getHeight(),a=w.target?H.lp(w):w,y=a.x-W/2,Q=a.y-S/2,t=H.getCenterInfo(),n=xg(H);A=A?A:[0,0,0],V=V?V:[0,1,0],y=y/W*t.width,Q=-1*Q/S*t.height;var B=[n[0]*y,n[4]*y,n[8]*y],j=[n[1]*Q,n[5]*Q,n[9]*Q],h=[B[0]+j[0],B[1]+j[1],B[2]+j[2]],o=H.getCenter(),c=rj(H,A,V,[h[0]+o[0],h[1]+o[1],h[2]+o[2]]);return c?c:[0,0,0]},intersectObject:function(I,e){return this._raycaster.intersectObject(I,e)},intersectObjects:function(f,$,w){return this._raycaster.intersectObjects(f,$,w)},getLineLength:function(y){this.validate();var N=this.getData3dUI(y);if(N&&N.getCache){var U=N.getCache();if(U)return U[U.length-1].length}return 0},getLineOffset:function(q,F){var g=this.getData3dUI(q);if(g&&g.getCache){var b=g.getCache();if(b)return wf(b,F)}return T},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},flyTo:function(){function v($,a,q){if(q instanceof b.Node){Z.fromArray(ap(q,a.getMat(q)));var T=q.getAnchor3d();$.push((new Dr).set(0-T.x,0-T.y,0-T.z).applyMatrix4(Z)),$.push((new Dr).set(0-T.x,0-T.y,1-T.z).applyMatrix4(Z)),$.push((new Dr).set(0-T.x,1-T.y,0-T.z).applyMatrix4(Z)),$.push((new Dr).set(0-T.x,1-T.y,1-T.z).applyMatrix4(Z)),$.push((new Dr).set(1-T.x,0-T.y,0-T.z).applyMatrix4(Z)),$.push((new Dr).set(1-T.x,0-T.y,1-T.z).applyMatrix4(Z)),$.push((new Dr).set(1-T.x,1-T.y,0-T.z).applyMatrix4(Z)),$.push((new Dr).set(1-T.x,1-T.y,1-T.z).applyMatrix4(Z))}}var $=new Dr,M=new Dr,B=new Dr,y=new Dr,Z=new Up,O=new b.Math.Quaternion,Q=new dg;return function(T,z,o){var D=this;if(o!==q)z={animation:z,ratio:o};else{var w=typeof z;("boolean"===w||"object"===w&&z.duration)&&(z={animation:z})}z=z||{},$.fromArray(D.getEye()),M.fromArray(D.getCenter());var E,X,Y=[],j=z.center,p=z.distance===q;if(j&&B.fromArray(j),T instanceof b.Node)j||B.fromArray(T.p3()),p&&(v(Y,D,T),E=Y.length);else{if(T||(T=D.dm().getDatas()),!T.length)return;if((p||!j)&&(Y=[],T.forEach(function(k){v(Y,D,k)}),E=Y.length),!E)return;if(!j){for(B.set(0,0,0),X=0;E>X;X++)B.add(Y[X]);B.multiplyScalar(1/E)}}if(D.setCenter(B.x,B.y,B.z),y.subVectors($,M),z.direction||z.worldDirection){!z.worldDirection&&T instanceof b.Node?O.setFromEuler(Q.set(T.r3(),T.getRotationMode(),!0)):O.set(0,0,0,1);var s=y.length();y.fromArray(z.worldDirection||z.direction).applyQuaternion(O).setLength(s)}if(p){for(var K,U,H,m,u,I=D.getNear(),J=10,o=z.ratio||.8;J--;){for(D._eye[0]=y.x+B.x,D._eye[1]=y.y+B.y,D._eye[2]=y.z+B.z,K=gh(D),nm(K,K,xg(D)),m=!0,u=-1/0,X=0;E>X;X++){if(H=Y[X],U=fb([H.x,H.y,H.z,1],K),U[3]<I&&J){y.multiplyScalar(2),m=!1;break}u=Math.max(u,Math.max(Math.abs(U[0]),Math.abs(U[1]))/o-U[3])}if(m)break}y.setLength(u+y.length()).add(B)}else y.setLength(z.distance).add(B);D._flyAnim&&D._flyAnim.stop(!0);var R=_m(z.animation);if(R){D.setEye($.x,$.y,$.z),D.setCenter(M.x,M.y,M.z);var N=(new Dr).subVectors(y,$),V=(new Dr).subVectors(B,M),L=new Dr,i=new Dr;return R.action=function(P){L.copy($).addScaledVector(N,P),i.copy(M).addScaledVector(V,P),D.setCenter(i.x,i.y,i.z),D.setEye(L.x,L.y,L.z)},R._37o=function(){delete D._flyAnim},{lastEye:$,lastCenter:M,eye:y,center:B,animation:D._flyAnim=jr(R)}}return D.setEye(y.x,y.y,y.z),{lastEye:$,lastCenter:M,eye:y,center:B}}}(),getBoundingBox:function(){function $(u,C,U){S.fromArray(ap(U,C.getMat(U)));var d=U.getAnchor3d();u.push((new Dr).set(0-d.x,0-d.y,0-d.z).applyMatrix4(S)),u.push((new Dr).set(0-d.x,0-d.y,1-d.z).applyMatrix4(S)),u.push((new Dr).set(0-d.x,1-d.y,0-d.z).applyMatrix4(S)),u.push((new Dr).set(0-d.x,1-d.y,1-d.z).applyMatrix4(S)),u.push((new Dr).set(1-d.x,0-d.y,0-d.z).applyMatrix4(S)),u.push((new Dr).set(1-d.x,0-d.y,1-d.z).applyMatrix4(S)),u.push((new Dr).set(1-d.x,1-d.y,0-d.z).applyMatrix4(S)),u.push((new Dr).set(1-d.x,1-d.y,1-d.z).applyMatrix4(S))}var S=new Up;return function(o){if(o=o||this.sm().getSelection(),o instanceof b.Node&&(o=[o]),0===o.length)return T;var L=[];o.forEach(function(T){$(L,this,T)},this);var m=[1/0,1/0,1/0],I=[-1/0,-1/0,-1/0];return L.forEach(function($){m[0]=Math.min($.x,m[0]),m[1]=Math.min($.y,m[1]),m[2]=Math.min($.z,m[2]),I[0]=Math.max($.x,I[0]),I[1]=Math.max($.y,I[1]),I[2]=Math.max($.z,I[2])}),{min:m,max:I}}}()}),ks.RenderEnv=function(s){this.gv=s,this.enable=!1},w.defineProperties(ks.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(C){this._debugOn=C,this.capture&&this.capture()}}}),w.assign(ks.RenderEnv.prototype,{renderEnvToCube:function(V,b,m,D){var x=this,P=x.gv;if(!V||!b||!m)return x.enable=!1,x._42=null,void 0;x.enable=!0;var q=Math.floor(D/V*b),X=P.getGL(),K=x._renderTargets;K?K.length<m&&(K=x._renderTargets=K.concat(new Array(m-K.length))):K=x._renderTargets=new Array(m);for(var y=0;m>y;y++)K[y]?K[y].setSize(X,D,q):K[y]=new ks.RenderTarget(P,X,D,q);var p=!1;x.capture=function(){p=!0,P._42(),p=!1};var o=new Dr,U=new Dr,u=new Dr,s=new Dr,H=(new Dr).setY(0),v=2*Math.PI/m,Y=V/2/Math.tan(Math.PI/m),l=2*Math.atan2(b/2,Y),h=V/b;x._42=function(V,M,g,y){var A=x._debugOn;if(!p&&!A)return!1;o.copy(P.getEye()),s.copy(P.getCenter()).sub(o);var C=Math.atan2(s.z,s.x),R=P.getNear(),S=P.getFovy(),c=P.getAspect();U.copy(P.getCenter());for(var w,I=0;m>I;I++)if(w=K[I],H.setZ(Math.cos(C)).setX(Math.sin(C)).multiplyScalar(Y),C-=v,u.addVectors(o,H),P.setNear(Y),P.setCenter([u.x,u.y,u.z]),P.setFovy(l),P.setAspect(h),A){var J=Math.round(M/m);V.viewport(J*I,0,J,g),y()}else Fk(V,w.frame),V.viewport(0,0,w.width,w.height),V.clear(V.COLOR_BUFFER_BIT),y(),Fk(V,T),w.assureTexture();return P.setNear(R),P.setCenter([U.x,U.y,U.z]),P.setFovy(S),P.setAspect(c),!0},x.capture()},getTextureInfo:function(A){var t=this._renderTargets;if(!t)return null;var J=this._renderTargets[A];return J?{index:A,texture:J.texture,textureName:J.uuid}:null}}),w.assign(ks.Graph3dView.prototype,{renderEnvToCube:function(b,M,y,c){var $=this;$.envRenderer||($.envRenderer=new ks.RenderEnv($)),$.envRenderer.renderEnvToCube(b,M,y,c)}}),ks.RenderTarget=function(B,M,G,u){var a=this;a.uuid=b.Math.generateUUID(),a.gv=B,a.init(B,M),a.setSize(M,G,u)},w.assign(ks.RenderTarget.prototype,{init:function(m,s){var t=this,u=t.texture=s.createTexture();s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,u),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.NEAREST),s.bindTexture(s.TEXTURE_2D,null),t.render=s.createRenderbuffer(),t.frame=s.createFramebuffer(),m._2O[t.uuid]=u},assureTexture:function(){var Y=this,f=Y.uuid,t=Y.gv._2O;t[f]||(t[f]=Y.texture)},setSize:function(Y,l,r){var i=this;if(i.width!==l||i.height!==r){var R=Y.RGBA,w=Y.TEXTURE_2D,a=Y.RENDERBUFFER,Q=Y.FRAMEBUFFER;Kr(Y,i.texture),Y.texImage2D(w,0,R,l,r,0,R,Y.UNSIGNED_BYTE,T),qp(Y,Y.TEXTURE_MIN_FILTER,Y.LINEAR),Y.bindRenderbuffer(a,i.render),Y.renderbufferStorage(a,Y.DEPTH_COMPONENT16,l,r),Fk(Y,i.frame),Y.framebufferTexture2D(Q,Y.COLOR_ATTACHMENT0,w,i.texture,0),Y.framebufferRenderbuffer(Q,Y.DEPTH_ATTACHMENT,a,i.render),Kr(Y,T),Y.bindRenderbuffer(a,T),Fk(Y,T),i.width=l,i.height=r}},toCanvas:function(){var u=this,t=u.gv.getGL();t.bindFramebuffer(t.FRAMEBUFFER,u.frame);var i=u.width,v=u.height,o=new Uint8Array(4*i*v);t.readPixels(0,0,i,v,t.RGBA,t.UNSIGNED_BYTE,o),t.bindFramebuffer(t.FRAMEBUFFER,null);var G=R.createElement("canvas");G.width=i,G.height=v;var w=G.getContext("2d"),s=w.createImageData(i,v);return s.data.set(o),w.putImageData(s,0,0),G}});var Mp=ks.Interactor=function(h){this.gv=h};yr("Interactor",w,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var Oe=ks.DefaultInteractor=function(D){Uo(Oe,this,[D])};yr("DefaultInteractor",Mp,{handle_contextmenu:function(B){en(B)},handle_mousewheel:function(I){this.gv.handleScroll(I,I.wheelDelta/40)},handle_DOMMouseScroll:function(w){2===w.axis&&this.gv.handleScroll(w,-w.detail)},handle_keydown:function(q){this.gv.handleKeyDown(q)},handle_mousedown:function(q){this.handle_touchstart(q)},handle_touchstart:function(R){en(R);var i=this,S=i.gv,c=Cq(R),j=S.getDataInfoAt(R),J=j?j.data:T,B=j?j.part:T,g=S.sm(),H=Qd(R),k=id(R);S.setFocus(R)&&(i._62O=T,i._57I=T,J?ti(R)?g.co(J)?g.rs(J):g.as(J):g.co(J)||g.ss(J):c&&(ti(R)?S.isRectSelectable()&&(i._62O=wk):i._57I=kl(R)),i._31Q&&(bb(i._31Q),delete i._31Q,delete i._32Q),i._62O||(S.isFirstPersonMode()&&(fk(R)||k>2?i._62O="pan":S.isMouseRoamable()||tb?(i._62O="roaming",i.foward=H&&Cq(R),i._32Q=Wm(),i._31Q=Zh(i.tick,i)):c||(i._62O="roaming")),i._62O||(c&&H&&Jq[B]?(i._62O=B,i.p3=J.p3()):c&&H&&uq(J)&&S.isSelected(J)?S.isMovable(J)?(i._62O="move",i.p3=J.p3(),i.movedata=J):S.isInteractive(J)&&(i._62O="none"):tb&&(k>2?i._62O="pan":2===k&&(i.dist=sd(R),i._62O="pinch")))),i.point=S.lp(R),El(i,R),no(R)?S.handleDoubleClick(R,J,B):S.handleClick(R,J,B))},tick:function(){var C=this,D=C.gv,H=D._moveStep;C.point&&D.isWalkable()&&(C._32Q&&(H*=(Wm()-C._32Q)/50),D.walk(C.foward?H:-H),C._32Q=Wm(),C._31Q=Zh(C.tick,C))},handle_mouseup:function(f){this.handle_touchend(f)},handle_touchend:function(U){var H=this._57I;H&&(Bc(H,kl(U))<=1&&this.gv.sm().cs(),this._57I=T)},handleWindowMouseMove:function(v){this.handleWindowTouchMove(v)},handleWindowTouchMove:function(u){var B,j,i=this,m=i.gv,b=i._62O,d=i.point,n=m.dm(),R=m.lp(u),a=R.x-d.x,h=R.y-d.y,M=m.getWidth(),_=m.getHeight();if(M&&_){var T=-p*a/M,N=-p*h/_;if("roaming"===b)i.rotate(u,T/2,N/2);else if(b===fn||b===qm||b===_j)m._86O||n.beginTransaction(),m.fi({kind:m._86O?"betweenEditRotation":"beginEditRotation",event:u}),m._86O=1,m.sm().each(function(f){if(uq(f)&&m.isRotationEditable(f)){var E=S(T)>S(N)?T:N;b===fn?f.setRotationX(f.getRotationX()+E):b===qm?f.setRotationY(f.getRotationY()+E):b===_j&&f.setRotationZ(f.getRotationZ()+E)}});else if("move"===b||Jq[b]){b===ah||b===Zl||b===lj?(m._87O||n.beginTransaction(),m.fi({kind:m._87O?"betweenEditScale":"beginEditScale",event:u}),m._87O=1):(m._moving||n.beginTransaction(),m.fi({kind:m._moving?"betweenMove":"beginMove",event:u}),m._moving=1);var X,e=i.p3,q=m.getPositionInfo(e),F=xg(m);X=b===jd?"x":b===Od?"y":b===ud?"z":b===ah?"sx":b===Zl?"sy":b===lj?"sz":m.getMoveMode(u,i.movedata),a=a/M*q.width,h=-1*h/_*q.height;var E,s,r=[F[0]*a,F[4]*a,F[8]*a],z=[F[1]*h,F[5]*h,F[9]*h],y=r[0]+z[0],Y=r[1]+z[1],x=r[2]+z[2],A=[e[0]+y,e[1]+Y,e[2]+x],G=nj(m.getEye(),A,!0);if("xyz"===X?(E=A,m.moveSelection(y,Y,x)):"xz"===X?(E=rj(m,e,[0,1,0],A),E&&m.moveSelection(E[0]-e[0],0,E[2]-e[2])):"xy"===X?(E=rj(m,e,[0,0,1],A),E&&m.moveSelection(E[0]-e[0],E[1]-e[1],0)):"yz"===X?(E=rj(m,e,[1,0,0],A),E&&m.moveSelection(0,E[1]-e[1],E[2]-e[2])):"x"===X||"sx"===X?(G[0]=0,E=rj(m,e,G,A),E&&(s=E[0]-e[0],"x"===X?m.moveSelection(s,0,0):m.sm().each(function(q){uq(q)&&m.isSizeEditable(q)&&(B=q.getScaleX()+s/100,j=B/q.getScaleX(),q.setScaleX(B),fk(u)&&(q.setScaleY(q.getScaleY()*j),q.setScaleTall(q.getScaleTall()*j)))}))):"y"===X||"sy"===X?(G[1]=0,E=rj(m,e,G,A),E&&(s=E[1]-e[1],"y"===X?m.moveSelection(0,s,0):m.sm().each(function(T){uq(T)&&m.isSizeEditable(T)&&(B=T.getScaleTall()+s/100,j=B/T.getScaleTall(),T.setScaleTall(B),fk(u)&&(T.setScaleY(T.getScaleY()*j),T.setScaleX(T.getScaleX()*j)))}))):("z"===X||"sz"===X)&&(G[2]=0,E=rj(m,e,G,A),E&&(s=E[2]-e[2],"z"===X?m.moveSelection(0,0,s):m.sm().each(function(e){uq(e)&&m.isSizeEditable(e)&&(B=e.getScaleY()+s/100,j=B/e.getScaleY(),e.setScaleY(B),fk(u)&&(e.setScaleX(e.getScaleX()*j),e.setScaleTall(e.getScaleTall()*j)))
}))),!E)return;i.p3=E}else if(b===wk){var W=i.div;W||(W=i.div=Zp(),Xk(i.getView(),W),W.op=d,W.style.background=m.getRectSelectBackground()),m.fi({kind:m._rectSelecting?"betweenRectSelect":"beginRectSelect",event:u}),m._rectSelecting=1,W.rect=ps(W.op,R),$c(W,W.rect)}else if("pinch"===b&&2===id(u)){m.fi({kind:m._pinching?"betweenPinch":"beginPinch",event:u}),m._pinching=1;var s=sd(u);m.handlePinch(s,i.dist),i.dist=s}else"pan"===b||fk(u)?i.pan(u,a,h):"none"===b||m.isFirstPersonMode()||(Cq(u)?i.rotate(u,T,N):(i.pan(u,a,0),m.isWalkable()&&(m.fi({kind:m._walking?"betweenWalk":"beginWalk",event:u}),m._walking=1,m.walk(h/m.getHeight()*m.getCenterInfo().height))));i.point=R}},pan:function(p,F,n){var j=this.gv;if(j.isPannable()){var q=j.getWidth(),w=j.getHeight();if(!q||!w)return;var R=j.getCenterInfo(),Z=F/q*R.width,m=-1*n/w*R.height;j.fi({kind:j._panning?"betweenPan":"beginPan",event:p}),j._panning=1,j.pan(-Z,-m)}},rotate:function(U,q,u){var f=this.gv;f.isRotatable()&&(f.fi({kind:f._rotating?"betweenRotate":"beginRotate",event:U}),f._rotating=1,f.rotate(q,u))},handleWindowMouseUp:function(K){this.handleWindowTouchEnd(K)},handleWindowTouchEnd:function(I){var J=this,n=J.gv,z=n.dm(),Y=J.div;if(Y){var V=n.getDatasInRect(Y.rect);if(!V.isEmpty()){var P=n.sm(),i=P.toSelection();V.each(function(e){P.co(e)?i.remove(e):i.add(e)}),P.ss(i)}Ln(Y)}n._moving&&(delete n._moving,n.fi({kind:"endMove",event:I}),n.onMoveEnded(),z.endTransaction()),n._panning&&(delete n._panning,n.fi({kind:"endPan",event:I}),n.onPanEnded()),n._rotating&&(delete n._rotating,n.fi({kind:"endRotate",event:I}),n.onRotateEnded()),n._86O&&(delete n._86O,n.fi({kind:"endEditRotation",event:I}),z.endTransaction()),n._87O&&(delete n._87O,n.fi({kind:"endEditScale",event:I}),z.endTransaction()),n._pinching&&(delete n._pinching,n.fi({kind:"endPinch",event:I}),n.onPinchEnded()),n._rectSelecting&&(delete n._rectSelecting,n.fi({kind:"endRectSelect",event:I}),n.onRectSelectEnded()),n._walking&&(delete n._walking,n.fi({kind:"endWalk",event:I}),n.onWalkEnded()),J.dist=J.point=J._62O=J.p3=J.movedata=J.div=J._57I=J._32Q=J._31Q=J.foward=T}});var Wi=ks.MapInteractor=function(U){Uo(Wi,this,[U]),this._minPhi=0,this._maxPhi=5*X/12,this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01};yr("MapInteractor",Mp,{handle_contextmenu:function(d){en(d)},handle_mousewheel:function(U){this.gv.handleScroll(U,U.wheelDelta/40)},handle_DOMMouseScroll:function(E){2===E.axis&&this.gv.handleScroll(E,-E.detail)},handle_keydown:function(d){this.gv.handleKeyDown(d)},handle_mousedown:function(C){this.handle_touchstart(C)},handle_touchstart:function($){en($);var S=this,j=S.gv;if(j.setFocus($)){j.lp($);var b=j.getDataInfoAt($),i=b?b.data:T,v=b?b.part:T;if(!i||!j.isInteractive(i)){var M=S.editing={point:j.lp($)};tb?M.touch=!0:(M.touch=!1,M.pan=Cq($)),El(S,$)}no($)?j.handleDoubleClick($,i,v):j.handleClick($,i,v)}},handle_mouseup:function(I){this.handle_touchend(I)},handle_touchend:function(){},handleWindowMouseMove:function(M){this.handleWindowTouchMove(M)},handleWindowTouchMove:function(L){var A=this,t=A.gv,I=A.editing;if(I){var a=t.lp(L),M=I.point,O=a.x-M.x,c=a.y-M.y;if(!I.moved){if(Math.abs(O)<A.threshold&&Math.abs(c)<A.threshold&&!(L.touches&&L.touches.length>1))return;I.moved=!0}if(I.point=a,I.touch){var o=L.touches.length;if(2!==o)A.pan(L,O,c);else{if(1>=o)return;var R=L.touches,W={x:R[0].clientX,y:R[0].clientY},v={x:R[1].clientX,y:R[1].clientY},D={x:v.x-W.x,y:v.y-W.y},E=I.lastCenter,J=Math.atan2(D.y,D.x),f=I.theta,G=0;f==T?f=I.theta=J:(G=J-f,I.thetaStarted||Math.abs(G)>A.touchRotateThreshold?(I.thetaStarted=!0,I.theta=J):G=0);var V=X*(W.y+v.y)/2/t.getHeight(),y=I.phi,N=0;y==T?y=I.phi=V:(N=V-y,I.phiStarted||Math.abs(N)>A.touchRotateThreshold?(I.phiStarted=!0,I.phi=V):N=0);var $,q=Math.sqrt(D.x*D.x+D.y*D.y),z=I.vlen;if(z){var K=W.x-E.x,u=W.y-E.y,k=v.x-E.x,Y=v.y-E.y,d=Math.sqrt(K*K+u*u),g=Math.sqrt(k*k+Y*Y),r=z/2,H=A._sign2(d-r),h=A._sign2(g-r);0>H*h||0===H&&0===h?($=1,I.vlen=q):($||($=q/z),I.scaleStarted||Math.abs($-1)>A.touchScaleThreshold?(I.vlen=q,I.scaleStarted=!0):$=1)}else z=I.vlen=q,$=1;1!==$&&t.setZoom($),(N||G)&&A.rotate(L,G,-N),I.lastCenter={x:(v.x+W.x)/2,y:(v.y+W.y)/2}}}else if(I.pan)A.pan(L,O,c);else{var P=t.getWidth(),C=t.getHeight();if(!P||!C)return;var j=-p*O/P,s=-p*c/C;A.rotate(L,j,s)}}},_sign2:function(E){return Math.abs(E)<this._touchScaleCheckAccuracy?0:E>0?1:-1},handleWindowMouseUp:function(H){this.handleWindowTouchEnd(H)},handleWindowTouchEnd:function(B){var U=this,L=U.editing;if(U.editing=null,L){var o=U.gv;if(!L.moved&&L.pan){var d=o.getDataAt(B);d?o.sm().setSelection([d]):o.sm().clearSelection()}else o._panning=null,o._rotating=null,o.fi({kind:L.pan?"endPan":"endRotate",event:B})}},pan:function(Q,g,z){var Z=this,b=Z.gv;if(b.isPannable()){var R=b.getWidth(),N=b.getHeight();if(R&&N){var p=b.getCenterInfo(),M=-g/R*p.width,s=1*z/N*p.height;b.fi({kind:b._panning?"betweenPan":"beginPan",event:Q}),b._panning=1;var r=Z.keepHorizon,x=Z.editing.touch;if((x&&Q.touches&&Q.touches.length>1||!x&&fk(Q))&&(r=!r),!r)return b.pan(M,s);if(M||s){var U=xg(b),v=[U[0]*M,U[4]*M,U[8]*M],K=[U[1],0,U[9]],_=Math.sqrt(K[0]*K[0]+K[2]*K[2]);_&&(K=[K[0]/_*s,0,K[2]/_*s]);var $=v[0]+K[0],i=v[1]+K[1],n=v[2]+K[2],I=b._center,W=b._eye;I[0]+=$,I[1]+=i,I[2]+=n,W[0]+=$,W[1]+=i,W[2]+=n,b.fp(Jm,T,W),b.fp(_l,T,I)}}}},rotate:function(S,i,g){var v=this,j=v.gv;if(j.isRotatable()){var R=j._center,p=j._eye,d=nj(p,R),c=J(E(d[0]*d[0]+d[2]*d[2]),d[1]),k=c+g;k=Math.max(v.minPhi,Math.min(v.maxPhi,k)),g=k-c,j.fi({kind:j._rotating?"betweenRotate":"beginRotate",event:S}),j._rotating=1,j.rotate(i,g)}}}),w.defineProperties(Wi.prototype,{minPhi:{get:function(){return this._minPhi},set:function(A){this._minPhi=A}},maxPhi:{get:function(){return this._maxPhi},set:function(o){this._maxPhi=o}},keepHorizon:{get:function(){return this._keepHorizon},set:function(S){this._keepHorizon=S}},threshold:{get:function(){return this._threshold},set:function(U){this._threshold=U}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(c){this._touchScaleThreshold=c}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(F){this._touchRotateThreshold=F}}});var Gp=function(r){this.gv=r};Nc(Gp,w,{_iv:!0,iv:function(){this._iv=!0},face:function(W,z){var w=this,j=w.gv.getGL();if(!j||!uq(W))return T;var V=z.x,I=z.width,p=z.height,J=w.height-z.y-p,r=l(I/2),H=new Uint8Array(4*I*p),d=0;for(w.iv(),w.validate(W),Fk(j,w.frame),j.readPixels(V,J,I,p,j.RGBA,j.UNSIGNED_BYTE,H),Fk(j,T),w.iv();r>=d;d++)for(var R=r-d,L=r+d,D=R;L>=D;D++)for(var P=R;L>=P;P++)if(D===R||D===L||P===R||P===L){var m=Nk.m[H[4*(D*I+P)]];if(m)return m}},get:function(M,u){this.validate();var A=this,b=A.gv.getGL();if(!b)return T;var p,s,K=M.x,I=M.width,L=M.height,z=A.height-M.y-L,w=l(I/2),G=new Uint8Array(4*I*L),H=0,E=G.length,W=u?T:new Bk,f=u?T:{};if(Fk(b,A.frame),b.readPixels(K,z,I,L,b.RGBA,b.UNSIGNED_BYTE,G),Fk(b,T),u){for(;w>=H;H++)for(var U=w-H,F=w+H,S=U;F>=S;S++)for(var Z=U;F>=Z;Z++)if((S===U||S===F||Z===U||Z===F)&&(p=A.info(G,4*(S*I+Z))))return p}else for(;E>H;H+=4)p=A.info(G,H),p&&(s=p.data,f[s._id]||(W.add(s),f[s._id]=s));return W},info:function(k,B){return this.colorMap[(k[B]<<16)+(k[B+1]<<8)+k[B+2]+((127&k[B+3])<<24)]},validate:function(D){var o=this,y=o.gv,M=y.getGL();if(M){var U=y.getWidth(),W=y.getHeight(),I=M.RGBA,v=M.TEXTURE_2D,k=M.RENDERBUFFER,x=M.FRAMEBUFFER;o.texture||(o.texture=Yc(M),o.render=M.createRenderbuffer(),o.frame=M.createFramebuffer()),(o.width!==U||o.height!==W)&&(Kr(M,o.texture),M.texImage2D(v,0,I,U,W,0,I,M.UNSIGNED_BYTE,T),qp(M,M.TEXTURE_MIN_FILTER,M.LINEAR),M.bindRenderbuffer(k,o.render),M.renderbufferStorage(k,M.DEPTH_COMPONENT16,U,W),Fk(M,o.frame),M.framebufferTexture2D(x,M.COLOR_ATTACHMENT0,v,o.texture,0),M.framebufferRenderbuffer(x,M.DEPTH_ATTACHMENT,k,o.render),Kr(M,T),M.bindRenderbuffer(k,T),Fk(M,T),o.width=U,o.height=W),o._iv&&(o._iv=!1,Fk(M,o.frame),y._42(D||(o.colorMap={}),1),Fk(M,T))}}});var nf=function(V){this.gv=V};Nc(nf,w,{gap:0,size:0,_42:function(p,R){var B=this,d=B.gv,y=d._gridGap,j=d._gridSize;if(d._gridVisible){if(B.gap!==y||B.size!==j){for(var N=[],f=d._gridSize/2,r=y*f,h=0;2*f+1>h;h++){var D=6*h,V=6*(2*f+1)+D;N[D]=-r,N[D+1]=0,N[D+2]=-r+h*y,N[D+3]=r,N[D+4]=0,N[D+5]=-r+h*y,N[V]=-r+h*y,N[V+1]=0,N[V+2]=-r,N[V+3]=-r+h*y,N[V+4]=0,N[V+5]=r}B.vs=new Lg(N),B.gap=y,B.size=j}vh(d),Cp(p,R),Li(p),Ng(p,R,1,d._gridColor,d._buffer.vs,B.vs),of(p,0,B.vs.length/3,p.LINES),Gr(p),ql(p,R)}else B.vs=B.gap=B.size=T}});var Zk=function(b){this.gv=b};Nc(Zk,w,{_42:function(h,I){var F=this.gv,J=F._buffer.vs,b=F._axisXColor,P=F._axisYColor,M=F._axisZColor,E=F._originAxisVisible,L=F._centerAxisVisible;if(E||L){var r=$?h.TRIANGLES:h.TRIANGLE_FAN,N=h.LINES;if(vh(F),Cp(h,I),Li(h),E){var W=F.getCenterInfo(),G=B(W.width,W.height)/5,z=.8*G,c=.05*G;Ng(h,I,1.5,b,J,new Lg([0,0,0,G,0,0,z,c,0,z,0,c,z,-c,0,z,0,-c,z,c,0,0,0,0,0,G,0,c,z,0,0,z,c,-c,z,0,0,z,-c,c,z,0,0,0,0,0,0,G,c,0,z,0,c,z,-c,0,z,0,-c,z,c,0,z])),of(h,0,2,N),of(h,1,6,r),Ng(h,I,T,P),of(h,7,2,N),of(h,8,6,r),Ng(h,I,T,M),of(h,14,2,N),of(h,15,6,r)}if(L){var _=F._center,a=_[0],f=_[1],H=_[2],W=F.getPositionInfo(_);G=B(W.width,W.height)/20,Ng(h,I,1.5,b,J,new Lg([a,f,H,a+G,f,H,a,f,H,a,f+G,H,a,f,H,a,f,H+G])),of(h,0,2,N),Ng(h,I,T,P),of(h,2,2,N),Ng(h,I,T,M),of(h,4,2,N)}Gr(h),ql(h,I)}}});var Qn=function(i){this.gv=i},jd="edit_tx",Od="edit_ty",ud="edit_tz",fn="edit_rx",qm="edit_ry",_j="edit_rz",ah="edit_sx",Zl="edit_sy",lj="edit_sz",Jq={};Jq[jd]=1,Jq[Od]=1,Jq[ud]=1,Jq[fn]=1,Jq[qm]=1,Jq[_j]=1,Jq[ah]=1,Jq[Zl]=1,Jq[lj]=1,Nc(Qn,w,{_42:function(k,V,w){var p=this,r=p.gv,t=r.sm().ld();if(r.isEditable(t)&&!r.isEditHelperDisabled()&&uq(t)&&(!r.isFirstPersonMode()||!r.isMouseRoamable()&&!tb)){vh(r);var b,W,O=r.isMovable(t),f=r.isRotationEditable(t),U=r.isSizeEditable(t),L=r._axisXColor,v=r._axisYColor,z=r._axisZColor,A=r._editSizeColor,I=t.p3(),x=Bc(r.getEye(),I)/10,s=x/(w?5:10),m=.7*x,e=.4*m,J=I[0],Q=I[1],B=I[2];b=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],O&&p._17O(k,V,t,w,jd,L,b,[J,Q-s,B,J+m,Q-s,B,J+m,Q,B,J+m,Q,B,J,Q,B,J,Q-s,B,J,Q-s,B+s,J+m,Q-s,B+s,J+m,Q-s,B,J+m,Q-s,B,J,Q-s,B,J,Q-s,B+s]),W=J+m,U&&p._17O(k,V,t,w,ah,A,b,[W,Q-s,B,W+e,Q-s,B,W+e,Q,B,W+e,Q,B,W,Q,B,W,Q-s,B,W,Q-s,B+s,W+e,Q-s,B+s,W+e,Q-s,B,W+e,Q-s,B,W,Q-s,B,W,Q-s,B+s]),W+=e,f&&p._17O(k,V,t,w,fn,L,b,[W,Q-s,B,W+e,Q-s,B,W+e,Q,B,W+e,Q,B,W,Q,B,W,Q-s,B,W,Q-s,B+s,W+e,Q-s,B+s,W+e,Q-s,B,W+e,Q-s,B,W,Q-s,B,W,Q-s,B+s]),b=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],O&&p._17O(k,V,t,w,Od,v,b,[J,Q,B,J,Q+m,B,J-s,Q+m,B,J-s,Q+m,B,J-s,Q,B,J,Q,B,J,Q,B,J,Q,B-s,J,Q+m,B-s,J,Q+m,B-s,J,Q+m,B,J,Q,B]),W=Q+m,U&&p._17O(k,V,t,w,Zl,A,b,[J,W,B,J,W+e,B,J-s,W+e,B,J-s,W+e,B,J-s,W,B,J,W,B,J,W,B,J,W,B-s,J,W+e,B-s,J,W+e,B-s,J,W+e,B,J,W,B]),W+=e,f&&p._17O(k,V,t,w,qm,v,b,[J,W,B,J,W+e,B,J-s,W+e,B,J-s,W+e,B,J-s,W,B,J,W,B,J,W,B,J,W,B-s,J,W+e,B-s,J,W+e,B-s,J,W+e,B,J,W,B]),b=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],O&&p._17O(k,V,t,w,ud,z,b,[J,Q,B,J,Q,B+m,J,Q-s,B+m,J,Q-s,B+m,J,Q-s,B,J,Q,B,J,Q-s,B,J-s,Q-s,B,J-s,Q-s,B+m,J-s,Q-s,B+m,J,Q-s,B+m,J,Q-s,B]),W=B+m,U&&p._17O(k,V,t,w,lj,A,b,[J,Q,W,J,Q,W+e,J,Q-s,W+e,J,Q-s,W+e,J,Q-s,W,J,Q,W,J,Q-s,W,J-s,Q-s,W,J-s,Q-s,W+e,J-s,Q-s,W+e,J,Q-s,W+e,J,Q-s,W]),W+=e,f&&p._17O(k,V,t,w,_j,z,b,[J,Q,W,J,Q,W+e,J,Q-s,W+e,J,Q-s,W+e,J,Q-s,W,J,Q,W,J,Q-s,W,J-s,Q-s,W,J-s,Q-s,W+e,J-s,Q-s,W+e,J,Q-s,W+e,J,Q-s,W])}},_17O:function(d,K,q,A,D,i,M,g){var Z=this.gv._buffer;Vp(d,K,A,!0,q,D),as(d,K,T,!0,T,!0,T,!1),sm(d,K.uDiffuse,i),xr(d,Z.vs,new Lg(g),K.aPosition),xr(d,Z.ns,new Lg(M),K.aNormal),Li(d),of(d,0,12),Gr(d),wp(d,K)}});var kc=b.Raycaster=function(Z){this.gv=Z};Tn("Raycaster",w,{intersect:function(c){var e=this,T=e.gv,R=T.getDataAt(c);return R?e.intersectObject(c,R):null},intersectObjects:function(l,H,V){var y,$,j,b,W=this,f=1/0,G=l.origin||(new Dr).fromArray(W.gv.getEye());return H.forEach(function(U){V&&V(U)===!1||U.s("intersect")!==!1&&(y=W.intersectObject(l,U),y&&($=G.distanceToSquared(y.world),f>$&&(j=U,b=y,f=$)))}),{data:j,intersect:b}},intersectObject:function(e,R){if(e instanceof Yk)return this._intersectObjectImpl(e,R);var Z,N,p=this,m=p.gv;N=m.unproject(e);var V=m.getEye();m.isOrtho()?(Z=nj(m.getCenter(),V),Z[0]+=Z[0],Z[1]+=Z[1],Z[2]+=Z[2]):Z=V,Z=new Dr(Z);var S=new Dr(N).sub(Z).normalize(),T=new b.Math.Ray(Z,S);return p._intersectObjectImpl(T,R)},_intersectObjectImpl:function(){function Z(){var f=new Dr;return f.subVectors(d,q),Y.subVectors(A,q),f.cross(Y).normalize(),f}function T(V,D,f,E,m,i,G){return od.barycoordFromPoint(V,D,f,E,v),m.multiplyScalar(v.x),i.multiplyScalar(v.y),G.multiplyScalar(v.z),m.add(i).add(G),m.clone()}var U=new Up,X=new Up,g=new Yk,j=new Dr,R=new Dr,E=new Dr,t=new Dr,J=new Dr,A=new Dr,q=new Dr,d=new Dr,$=new cf,W=new cf,y=new cf,Y=new Dr,u={vs:Wo,is:Eo,uv:Ob},v=new Dr;return function(F,H){var p=this.gv.getData3dUI(H),V=H.mat||p.mat;if(V){U.fromArray(V),X.getInverse(U),g.copy(F).applyMatrix4(X);var m,N,C="body",_=p.shapeModel;if(_||(_=Zr(p)),_||(H instanceof b.Node&&!(H instanceof b.Shape)?(m=!0,_=u):(N=!0,_=[p.left,p.front,p.right,p.back,p.top,p.bottom])),!_)return console.log("Can not find shape model."),null;Wd(_)||(_=[_]);var f,i,Q,z,B,Y,r,L,K,o,s,I,a,D,v=1/0,x=["","top_","bottom_"],O=!1;for(f=0,i=_.length;i>f;f++)if(I=_[f])for(Q=0,z=x.length;z>Q;Q++)if(a=x[Q],r=I[a+"vs"],L=I[a+"is"],K=I[a+"uv"]||I[a+"tuv"],r){if(D=I[a+"boundingBox"]){if(!g.intersectBox(D))continue}else I[a+"boundingBox"]=D=new b.Math.Box3;for(B=0,Y=L?L.length:r.length/3;Y>B;B+=3)L?(R.fromArray(r,3*L[B]),E.fromArray(r,3*L[B+1]),t.fromArray(r,3*L[B+2])):(R.fromArray(r,3*B),E.fromArray(r,3*(B+1)),t.fromArray(r,3*(B+2))),D.expandByPoint(R),D.expandByPoint(E),D.expandByPoint(t),o=g.intersectTriangle(R,E,t,!1,j),o&&(s=g.origin.distanceTo(o),v>s&&(v=s,J.copy(o),A.copy(R),q.copy(E),d.copy(t),""!==a?C=a.slice(0,-1):m?C=Rb[Math.floor(B/6)]:N&&(C=Rb[f]),K&&(O=!0,L?($.fromArray(K,2*L[B]),W.fromArray(K,2*L[B+1]),y.fromArray(K,2*L[B+2])):($.fromArray(K,2*B),W.fromArray(K,2*(B+1)),y.fromArray(K,2*(B+2))))))}if(!isFinite(v))return null;var l,k=J.clone().applyMatrix4(U);O&&(l=T(J,A,q,d,$,W,y));var e=Z(A,q,d),G=Z(A.applyMatrix4(U),q.applyMatrix4(U),d.applyMatrix4(U)),n=g.direction.dot(e);return n>0&&(e.multiplyScalar(-1),G.multiplyScalar(-1)),{world:k,local:J.clone(),worldNormal:G,normal:e,uv:l,part:C}}}}()});var yq=function(z,y){this.gv=z,this.s=function(k,w,Q){return w==T&&(w=Q),w==T?y.getStyle(k):cg(w,y,z)},this.data=y};Nc(yq,w,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(K,B,Q,b){var r=this,u=r.data;if(!(u instanceof Tf)){var n,W,s,g,Y,h,v,E=r.gv,$=u._id,d=r.s("shape3d.alwaysOnTop")?null:r.s("batch"),O=E._batchIndexMap,l=E._batchModelMap,M=E.isSelectable(u),H=E.getBrightness(u),p=H!=T&&1!==H;if(r.needValidate(K)){if(s=Pi(O,l,u,d),r.validate(s,d?Ug[d]||bi:T),s&&(g=O[$],Y=g.size=s.vs.length/3-g.begin,v=s.rs))for(H=p?H:1,h=0;Y>h;h++)v.push(H);if(uq(u)){var L=E.getWireframeGeometry(u);if(L)zh(E,u,L);else{var f=E.getWireframe(u);f&&zh(E,u,f)}}r.labelInfo=r.label2Info=r.noteInfo=r.note2Info=r._38o=T,r._24O(Rg,"getLabel"),r._24O(Ul,"getLabel2"),r._26O(Mr,"getNote"),r._26O(lf,"getNote2"),r._15O(),r.interactiveInfo=E.isInteractive(u)?{}:T,r._iv=!1}p&&sm(K,B.uBrightness,H),sm(K,B.uAlphaTest,r.s("alphaTest")),W=Vp(K,B,Q,M,u,de),W&&(Sl(W,O[$],l),Sl(W,E._polylineIndexMap[$],E._polylineModelMap),Sl(W,E._wireframeIndexMap[$],E._wireframeModelMap)),O[$]||r._80o(K,B,b),E.isLabelVisible(u)&&((n=r.labelInfo)&&(Vp(K,B,Q,M,u,Rg),r._28O(n,Rg,b)),(n=r.label2Info)&&(Vp(K,B,Q,M,u,Ul),r._28O(n,Ul,b))),E.isNoteVisible(u)&&((n=r.noteInfo)&&(Vp(K,B,Q,M,u,Mr),r._29O(n,Mr,b)),(n=r.note2Info)&&(Vp(K,B,Q,M,u,lf),r._29O(n,lf,b))),(n=r._38o)&&r._99O(K,B,n,Q,M,b),p&&sm(K,B.uBrightness,1)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return ro},_80o:function(){},dispose:function(){},_calcAnchorMat:function(J){if(J.hasOwnProperty("_anchor")||J.hasOwnProperty("_anchorElevation")){var e=J.getAnchor3d(),b={x:e.x-.5,y:e.y-.5,z:e.z-.5},a=nn();return Nf(a,[-b.x,-b.y,-b.z]),a}},getBodyColor:function(Y){var g=this.data,d=this.gv.getBodyColor(g);return d?d:Y?g.getStyle(Y):T},_24O:function(J,L){var z=this,H=z.data,R=z.gv,G=z.s,U=R[L](H);if(U!=T){var r=G(J+".scale"),q=G(J+".max"),A=z[J+"Info"]={label:U,textureScale:G(J+".texture.scale"),color:R[L+"Color"](H),font:G(J+".font"),align:G(J+".align"),background:R[L+"Background"](H)},b=A.rect=fc(A,U);q>0&&q<b.width&&(A.labelWidth=b.width,b.width=q),b.x=b.y=0,b.width*=r,b.height*=r,A.mat=z._16O(G(J+".autorotate"),G(J+".position"),b,G(J+".face"),G(J+".t3"),G(J+".r3"),G(J+".rotationMode"));var f=b.width/2,l=b.height/2;A.vs=new Lg([-f,l,0,-f,-l,0,f,-l,0,f,l,0]),b.width/=r,b.height/=r}},_26O:function(w,M){var V=this,e=V.data,t=V.gv,C=V.s,Z=t[M](e);if(Z!=T){var H=C(w+".scale"),K=this[w+"Info"]={note:Z,textureScale:C(w+".texture.scale"),expanded:C(w+".expanded"),font:C(w+".font"),color:C(w+".color"),align:C(w+".align"),borderWidth:C(w+".border.width"),borderColor:C(w+".border.color"),background:t[M+"Background"](e)};if(K.expanded){var g=C(w+".max"),h=fc(K,Z);h.width+=6,h.height+=2,g>0&&g<h.width&&(K.labelWidth=h.width,h.width=g);var u={x:-h.width/2,y:-8-h.height,width:h.width,height:h.height+8}}else u={x:-6,y:-18,width:12,height:18};K.mat=V._16O(C(w+".autorotate"),C(w+".position"),T,C(w+".face"),C(w+".t3"),C(w+".r3"),C(w+".rotationMode")),K.rect=u,1!==H&&(u=Tg(u),u.x*=H,u.height*=H,u.y=-u.height,u.width*=H);var D=u.x,W=u.y,A=u.width,z=u.height;K.vs=new Lg([D,-W,0,D,-W-z,0,D+A,-W-z,0,D+A,-W,0])}},_28O:function(s,Z,l){if(l(this.s(Z+".transparent"))){var F=s.rect,R=s.textureScale,x=F.width*R,C=F.height*R;if(x>=1&&C>=1){var h=ge(x,C);1!==R&&(h.translate(h,F.x,F.y),h.scale(R,R),h.translate(h,-F.x,-F.y)),jl(h,s),h.restore(),hp(this,Z,s.mat,s.vs,!0)}}},_29O:function(l,$,d){if(d(this.s($+".transparent"))){var s=l.rect,v=l.textureScale,G=s.x,Q=s.y,O=s.width*v,g=s.height*v;if(O>=1&&g>=1){s.x=s.y=0;var T=ge(O,g);1!==v&&T.scale(v,v),Mb(T,l),T.restore(),s.x=G,s.y=Q,hp(this,$,l.mat,l.vs,!1)}}},_99O:function(h,j,o,Q,R,t){if(o){var z=this,d=z.gv,M=z.data,F=d._buffer,Z=d._1O,K=o.icons;for(var a in K){var E=K[a],v=o.rects[a];if(v&&t(cg(E.transparent,M,d))){Vp(h,j,Q,R,M,a);var k=cg(E.shape3d,M,d),l=k?[k]:cg(E.names,M,d),c=l?l.length:0,g=cg(E.textureScale,M,d)||1,O=cg(E.light,M,d);O==T&&(O=k?!0:!1),as(h,j,cg(E.blend,M,d),O,cg(E.opacity,M,d),cg(E.reverseFlip,M,d),cg(E.reverseColor,M,d),cg(E.reverseCull,M,d));for(var U=0;c>U;U++){var _=l[U],q=v[U];if(Eg(z,q.mat),k)bf(d,M,Zr(z,k),z);else{var I=xf(_);if(I){var A=q.width*g,Y=q.height*g;if(A>=1&&Y>=1){var n=ge(A,Y);np(n,I,cg(E.stretch,M,d),0,0,A,Y,M,d),n.restore(),Yc(h,Wq,Z),Li(h,j,Z,cg(E.discardSelectable,M,d),F.uv,sc),xr(h,F.vs,q.vs,j.aPosition),Fg(h,F.ns,mj,j.aNormal),lh(h,F.is,yb),Ec(h,0,yb.length),Gr(h,j,Z)}}}Qb(d)}wp(h,j)}}}}});var _c=function(a,B){Uo(_c,this,[a,B])};Nc(_c,yq,{_16O:function(q,N,i,f,d,y,s,h,A){var c=this.data,o=c.getFinalScale3d(),Q=Bn(N,o,i,f,h,A);if(c.hasOwnProperty("_anchor")||c.hasOwnProperty("_anchorElevation")){var L=c.getAnchor3d();Q[0]-=(L.x-.5)*o[0],Q[1]-=(L.y-.5)*o[1],Q[2]-=(L.z-.5)*o[2]}return Xb(nn(),Q,c.p3(),f,d,y,s,q,c.getFinalRotation3d(),c.getRotationMode())},clear:function(){var e=this;e.faceMat=e.mat=e.shapeModel=e.left=e.right=e.front=e.back=e.top=e.bottom=e.csg=T},needValidate:function(n){if(this._iv)return this._validateFrameId=n._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var J=n._renderInfo.frame;if(this._validateFrameId!==J)return this._validateFrameId=J,!0}return!1},validate:function(t,V){var $=this,K=$.gv,B=$.data,z=Zr($);$._updateAutoRotation(),$._updateFixSize2d(),$._updateOverlapping(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(vq(K,B,"_wireframeModelMap","_wireframeIndexMap"),vq(K,B,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var O=ap(B,K.getMat(B),z?$.s("shape3d.scaleable"):!0),y=$._calcAnchorMat(B);if(y&&nm(O,O,y),B.mat=O,$.clear(),t){var s=[];z?fs(K,B,z,$,$.getBodyColor(),[O],t,s):(ji(K,B,t,V,O,vn,s,Ho),ji(K,B,t,V,O,ib,s,vl),ji(K,B,t,V,O,Nm,s,Uk),ji(K,B,t,V,O,ak,s,Zn),ji(K,B,t,V,O,Af,s,nh),ji(K,B,t,V,O,Yr,s,Dm)),s.length&&(fj(t.vs,s),fj(t.ns,Jj(s)))}else $.mat=O,($.shapeModel=z)||($._cubeUvs=null,$.vf(vn,0),$.vf(ib,16),$.vf(Af,8),$.vf(Yr,24),$.vf(Nm,32),$.vf(ak,40))},_updateAutoRotation:function(){var z=new dg;return function(){var D=this,t=D.data,B=D.s("shape3d.autorotate");if(!B)return t._dynamicRotation&&delete t._dynamicRotation,void 0;var r,g=D.gv;r="string"==typeof B?[B.indexOf("x")<0?g._eye[0]:g._center[0],B.indexOf("y")<0?g._eye[1]:g._center[1],B.indexOf("z")<0?g._eye[2]:g._center[2]]:g._eye;var R=g._center,L=t.p3(),M=Fe([L[0]+r[0]-R[0],L[1]+r[1]-R[1],L[2]+r[2]-R[2]],L,g._up),k=t.r3();z.set(0,0,0,t.getRotationMode(),!0).setFromRotationMatrix(M),Math.abs(k[0]-z.x)<1e-5&&Math.abs(k[1]-z.y)<1e-5&&Math.abs(k[2]-z.z)<1e-5||(t._dynamicRotation=[z.x,z.y,z.z])}}(),_updateFixSize2d:function(){var G=this,e=G.data,l=G.s("shape3d.fixSizeOnScreen");if(!l)return e._dynamicScale3d&&delete e._dynamicScale3d,void 0;var j=G.gv;e.getFinalScale3d();var E=ap(e,j.getMat(e)),K=rm([0,0,0],E),v=j.toViewPosition(K);if(!isNaN(v.x)&&!isNaN(v.y)){var h=rm([1,0,0],E),I=j.toViewPosition(h),_=rm([0,1,0],E),W=j.toViewPosition(_),i=I.x-v.x,b=W.y-v.y,r=e._dynamicScale3d||[1,1,1],m=xf(e.s("shape3d.image")),X=l[0]>0?l[0]:m?Sq(m,G):20,N=l[1]>0?l[1]:m?Bg(m,G):20,Y=Math.abs(i/X),t=Math.abs(b/N);Math.abs(Y-1)<.001&&Math.abs(t-1)<.001||(e._dynamicScale3d=[r[0]/Y,r[1]/t,r[2]])}},_updateOverlapping:function(){var L=this,P=L.s("hide.overlapping.group");if(!P)return L._rectOverlapping&&(L._rectOverlapping=q),void 0;var E,l,o,K=L.gv,$=L.data,U=ap($,K.getMat($)),F=1/0,Z=1/0,v=-1/0,s=-1/0,b=$.getAnchor3d(),k=b.x,d=b.y,i=b.z;for(E=0;8>E;E++){if(l=rm([(E>>2)-k,(1&E>>1)-d,(1&E)-i],U),o=K.toViewPosition(l),isNaN(o.x)||isNaN(o.y))return;F=Math.min(F,o.x),v=Math.max(v,o.x),Z=Math.min(Z,o.y),s=Math.max(s,o.y)}var G={x:F,y:Z,w:v-F,h:s-Z};L._rectOverlapping=K.overlappingBox.isOverlapping(P,G)},getVectorDynamicSize:function(){var Z,c=this,_=c.s("shape3d"),C=c.data;if("billboard"===_||"plane"===_||(Z=C._currentCubeElementId)!=T){var H,d,S=c.gv,u=ap(C,S.getMat(C)),O=function(H,z){var r=S.toViewPosition(rm(H,u)),P=S.toViewPosition(rm(z,u)),c=r.x-P.x,m=r.y-P.y;return Math.min(2048,Math.sqrt(c*c+m*m))};if("billboard"===_)H=O([-.5,0,0],[.5,0,0]),d=O([0,-.5,0],[0,.5,0]);else if("plane"===_)H=O([-.5,0,0],[.5,0,0]),d=O([0,0,-.5],[0,0,.5]);else if(C._currentCubeElementId!=T){var w=3*Eo[Z+1],R=3*Eo[Z],f=3*Eo[Z+2];H=O([Wo[w],Wo[w+1],Wo[w+2]],[Wo[f],Wo[f+1],Wo[f+2]]),d=O([Wo[w],Wo[w+1],Wo[w+2]],[Wo[R],Wo[R+1],Wo[R+2]])}return[H,d]}},getCachedTexture:function(){var G=this,f=G.data,C=f._currentCubeElementId;return C!=T?G._cubeCachedImage?G._cubeCachedImage[C]:null:G._shape3dCachedImage},setCachedTexture:function(n){var Y=this,F=Y.data,I=F._currentCubeElementId;if(I!=T){if(!Y._cubeCachedImage)return Y._cubeCachedImage={};Y._cubeCachedImage[I]=n}else Y._shape3dCachedImage=n},invalidateCachedTexture:function(h){var r,K,e,N=this;if((e=N._shape3dCachedImage)&&(h.deleteTexture(e),N._shape3dCachedImage=null),K=N._cubeCachedImage){for(r in K)h.deleteTexture(K[r]);N._cubeCachedImage=null}},vf:function(E,N){var D=this;if(D.gv.getFaceVisible(D.data,E)){var d=kf(D,E);d.mat&&(D.faceMat=!0);var h=d.uv;if(h){var Q=D._cubeUvs;Q||(Q=D._cubeUvs=new Lg([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var X=0;8>X;X++)Q[N+X]=h[X]}return d}},_80o:function(I,j,r){var q=this;if(q._rectOverlapping)return!0;var t=q.gv,H=q.data,Q=t._cube,F=q.shapeModel;vh(t,q.mat),F?bf(t,H,F,q,q.getBodyColor(),r):(xr(I,Q.vs,T,j.aPosition),xr(I,Q.ns,T,j.aNormal),hd(I,Q.is),q._18O(I,j,q.left,0,r),q._18O(I,j,q.front,6,r),q._18O(I,j,q.right,12,r),q._18O(I,j,q.back,18,r),q._18O(I,j,q.top,24,r),q._18O(I,j,q.bottom,30,r)),Qb(t),q.faceMat&&(q._18O(I,j,q.left,0,r,!0),q._18O(I,j,q.front,6,r,!0),q._18O(I,j,q.right,12,r,!0),q._18O(I,j,q.back,18,r,!0),q._18O(I,j,q.top,24,r,!0),q._18O(I,j,q.bottom,30,r,!0))},_18O:function(f,x,t,E,l,k){if(t){if(!l(t.transparent))return;if(k&&!t.mat||!k&&t.mat)return;k&&vh(this.gv,t.mat);var N=this,$=N.data;$._currentCubeElementId=E;var g=N.gv,p=g.getTexture(t.texture,$),H=t.uv,b=t.uvScale,j=t.uvOffset,R=t.discardSelectable;p?H?Li(f,x,p,R,g._buffer.uv,N._cubeUvs,j,b):Li(f,x,p,R,g._cube.uv,T,j,b):Li(f),as(f,x,t.blend,t.light,t.opacity,t.reverseFlip,t.reverseColor,t.reverseCull),sm(f,x.uDiffuse,t.color),Ec(f,E,6),wp(f,x),Gr(f,x,p),k&&Qb(g),$._currentCubeElementId=null}}});var Bs=function(Z,c){Uo(Bs,this,[Z,c])};Nc(Bs,yq,{_25Q:1,validate:function(r){var K=this,f=K.gv,j=K.data,W=K.s,X=W("edge.width"),$=j._40I,x=j._41I;if(K.shapeModel=K.info=T,$&&x){var L,H,U,I,Q,N,l,g,C,V,D=j.isLooped(),z=W(Zj),P=t.getEdgeType(z);if(P){var _=P(j,Db(K,f,j,D,z),f,K._19Q);if(!_.points||_.points.isEmpty())return;N=K.info={},l=_.segments,Q=_.points,g=Q.size();for(var h=$.getElevation(),F=x.getElevation(),d=0;g>d;d++){var Y=Q.get(d);Y.e==T&&(Y.e=h+(F-h)*d/(g-1))}C=mr(Q.get(0)),V=mr(Q.get(g-1));var i=g%2;0===i?(N.c1=mr(Q.get(g/2-1)),N.c2=mr(Q.get(g/2))):N.p3=mr(Q.get((g-i)/2)),N.s1=C,N.s2=mr(Q.get(1)),N.t1=mr(Q.get(g-2)),N.t2=V}else{Q=new Bk,N=K.info={};var u=W("edge.offset"),k=W("edge.center"),v=W("edge.source.t3"),y=W("edge.target.t3"),e=$.p3(),S=x.p3();if(v&&(e[0]+=v[0],e[1]+=v[1],e[2]+=v[2]),y&&(S[0]+=y[0],S[1]+=y[1],S[2]+=y[2]),z===ek){l=W("edge.segments");var A=N.points=W(Zf)||xk;if(g=A.size()){C=mr(A.get(0)),V=mr(A.get(g-1)),!k&&u&&(U=nj(C,e,!0),u=B(u,Bc(e,C)),e=[e[0]+U[0]*u,e[1]+U[1]*u,e[2]+U[2]*u],U=nj(S,V,!0),u=B(u,Bc(V,S)),S=[S[0]-U[0]*u,S[1]-U[1]*u,S[2]-U[2]*u]);var i=g%2;0===i?(L=mr(A.get(g/2-1)),H=mr(A.get(g/2))):N.p3=mr(A.get((g-i)/2)),N.s1=e,N.s2=C,N.t1=V,N.t2=S}else!k&&u&&(U=nj(S,e,!0),I=Bc(e,S),u=Qm(u,I),e=[e[0]+U[0]*u,e[1]+U[1]*u,e[2]+U[2]*u],S=[S[0]-U[0]*u,S[1]-U[1]*u,S[2]-U[2]*u]),L=e,H=S;Q.add({x:e[0],y:e[2],e:e[1]}),Q.addAll(A),Q.add({x:S[0],y:S[2],e:S[1]})}else{var s=Db(K,f,j,D,z);if(K._19Q||(s=-s),D){var b=e[0],n=e[1],m=e[2],c=$.getTall()/2+s;L=[b-s,n+c,m],H=[b+s,n+c,m],Q.add({x:b-s,y:m,e:n}),Q.add({x:b-s,y:m,e:n+c}),Q.add({x:b+s,y:m,e:n+c}),Q.add({x:b+s,y:m,e:n})}else{U=nj(S,e,!0),I=Bc(e,S);var o={x:e[0],y:e[2]},q={x:S[0],y:S[2]},E=es(T,o,q,s),R=E.x-o.x,M=E.y-o.y;u=Qm(u,I),U[0]*=u,U[1]*=u,U[2]*=u,L=[e[0]+U[0]+R,e[1]+U[1],e[2]+U[2]+M],H=[S[0]-U[0]+R,S[1]-U[1],S[2]-U[2]+M],k?(Q.add({x:e[0],y:e[2],e:e[1]}),Q.add({x:L[0],y:L[2],e:L[1]}),Q.add({x:H[0],y:H[2],e:H[1]}),Q.add({x:S[0],y:S[2],e:S[1]})):(Q.add({x:L[0],y:L[2],e:L[1]}),Q.add({x:H[0],y:H[2],e:H[1]}))}}N.c1=L,N.c2=H}N.list=W(td)===Wc?K.createTubeModel(Q,l,X/2,r):K.createLineModel(Q,l,X,"edge","edge.dash")}}});var Yl=function(G,x){Uo(Yl,this,[G,x])};Nc(Yl,_c,{_80o:function(X,j,W){var t=this,s=t.gv,c=t.shapeModel;vh(s,t.mat),c?bf(s,t.data,c,t,t.getBodyColor(),W):(Ud(t,X,j,t.left,W),Ud(t,X,j,t.front,W),Ud(t,X,j,t.right,W),Ud(t,X,j,t.back,W),Ud(t,X,j,t.top,W),Ud(t,X,j,t.bottom,W)),Qb(s)},validate:function(z,N){var U,Q,o=this,s=o.s,e=o.data,Z=e.p3(),R=e._thickness/2,S=e.isClosePath(),h=e.getPoints(),k=e.getSegments(),G=s(Nq),y=z&&z.uv;if(o.clear(),0>R)Q=o.shapeModel=_b(h,k,s(Qi),s(Sg),G,s(Vl),e.getTall(),e.getShapeElevation(),S),s(zd)?s("shape3d.image")||delete Q.uv:(delete Q.vs,delete Q.ns,delete Q.uv),s("shape3d.top.image")||delete Q.top_uv,s("shape3d.bottom.image")||delete Q.bottom_uv;else if(s(td)===Wc)U=jq(h,k,G,S),Q=o.shapeModel={vs:[]},s("shape3d.image")&&(Q.uv=[],Q.sum=s(Vl)||Gb(U)||1,Q.len=0),s(Qi)&&!S&&(Q.top_vs=[],s("shape3d.top.image")&&(Q.top_uv=[])),s(Sg)&&!S&&(Q.bottom_vs=[],s("shape3d.bottom.image")&&(Q.bottom_uv=[])),o._12O(U,R);else{var p,M,c,Y,v,C,f,D,J,L;if(U=jq(h,k,G,S),v=o.vf(Af,y,!1,N),R&&(C=o.vf(Yr,y,!1,N),f=S?T:o.vf(vn,y,!1,N),D=S?T:o.vf(ib,y,!1,N),J=o.vf(Nm,y,!1,N),L=o.vf(ak,y,!1,N)),R){for(var q=0,j=U.length;j>q;q++)U[q]=o._tryRemoveBezierPoints(U[q],R);o._12O(U,R)}else v&&U.forEach(function(H){if(Y=H.length,Y>0)for(p=H[0],c=1;Y>c;c++)M=H[c],o.addV(v.vs,p,M),p=M});o._20Q(U),z||(v&&(v.ns=Jj(v.vs),kq(v,"vs"),kq(v,tr)),R&&(C&&(C.ns=Jj(C.vs),kq(C,"vs"),kq(C,tr)),f&&(f.ns=Jj(f.vs),kq(f,"vs"),kq(f,tr)),D&&(D.ns=Jj(D.vs),kq(D,"vs"),kq(D,tr)),J&&(J.ns=Jj(J.vs),kq(J,"vs"),kq(J,tr)),L&&(L.ns=Jj(L.vs),kq(L,"vs"),kq(L,tr))))}var H=o.mat=nn();Nf(H,Z),rn(H,e.getFinalRotation3d(),e.getRotationMode());var l=e.getScale3d(),P=e._dynamicScale3d;P&&(l[0]*=P[0],l[1]*=P[1],l[2]*=P[2]),hb(H,l),Nf(H,bq(Z)),z&&(Sd(o,H,z,Q),o.clear())},_20Q:function(J){var I,t,k,n,d,q,F,f=this,G=f.front,W=f.back,e=f.top,E=f.bottom,b=G?G.tuv:T,g=W?W.tuv:T,N=e?e.tuv:T,B=E?E.tuv:T,C=0;(b||g||N||B)&&(I=f.s(Vl)||Gb(J)||1,J.forEach(function(r){if(t=r.length,t>0)for(q=r[0],k=1;t>k;k++)F=r[k],n=C/I,C+=Bc(q,F),d=C/I,f._14O(G,n,d),f._14O(W,1-d,1-n),f._14O(e,n,d),f._14O(E,n,d),q=F}))},_14O:function(z,L,N){if(z){var q=z.uv,V=z.tuv;if(V){if(q)var J=q[0]+(q[6]-q[0])*L,Y=q[1]+(q[7]-q[1])*L,s=q[2]+(q[4]-q[2])*L,c=q[3]+(q[5]-q[3])*L,j=q[2]+(q[4]-q[2])*N,o=q[3]+(q[5]-q[3])*N,r=q[0]+(q[6]-q[0])*N,_=q[1]+(q[7]-q[1])*N;else J=L,Y=0,s=L,c=1,j=N,o=1,r=N,_=0;V.push(s,c,j,o,r,_,r,_,J,Y,s,c)}}},_13O:function(g){var h=g.uv,Q=g.tuv;Q&&(h?Q.push(h[2],h[3],h[4],h[5],h[6],h[7],h[6],h[7],h[0],h[1],h[2],h[3]):Q.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(f,o){var M=f.length;if(4>M)return f;var A,Q,i,d,O,B,L=!1,x=function(c){return f[c]},e=function(F){return f[M-1-F]};for(O=0;1>=O;O++)for(B=O?e:x,Q=B(0),i=B(1),A=2;M-1>A;A++)if(d=B(A),!d.remove)if(d.b){var b=es(Q,i,d,o);b.adjust?(d.remove=!0,L=!0):(Q=i,i=d)}else Q=i,i=d;if(!L)return f;var R=[];for(A=0;M>A;A++)f[A].remove||R.push(f[A]);return R},_12O:function(r,k){var e,R,X,c,l,z=this;r.forEach(function(n){if(l=n.length,l>0)for(e={p:n[0],n:!0},c=1;l>c;c++)R=n[c],X=l-1>c?n[c+1]:T,z.addPoint(e,R,X,k,n)})},addPoint:function(w,a,N,c,S){var L,m,r,J,D,k,G,U,Z,X=this,s=w.p,W=w.f,u=w.b,y=X.s("shape3d.side")||ee,H=X.s("shape3d.start.angle"),V=X.s("shape3d.sweep.angle"),I=X.shapeModel,O=X.data.isClosePath();if(w.n&&(w.n=!1,W=O&&S.length>2?es(S[S.length-2],s,a,c):es(T,s,a,c),u=Th(s,W),I?I.top_vs&&X._10O(u,W,y,H,V,I.top_vs,I.top_uv):(L=X.left)&&(X.addV(L.vs,u,W),X._13O(L))),m=N?es(s,a,N,c):O&&S.length>2?es(s,a,S[1],c):es(s,a,T,c),r=Th(a,m),I){var h,C,q=I.vs,i=I.uv,p=I.sum;for(i&&(h=I.len/p,I.len+=Bc(s,a),C=I.len/p),k=X._9O(u,W,y,H,V),G=X._9O(r,m,y,H,V),U=0;y>U;U++)Z=U+1,fj(q,k[Z]),fj(q,G[U]),fj(q,k[U]),fj(q,G[U]),fj(q,k[Z]),fj(q,G[Z]),i&&(J=U/y,D=Z/y,i.push(h,D,C,J,h,J,C,J,h,D,C,D));!N&&I.bottom_vs&&X._10O(r,m,y,H,V,I.bottom_vs,I.bottom_uv,!0)}else!N&&(L=X.right)&&(X.addV(L.vs,m,r),X._13O(L)),(L=X.front)&&X.addV(L.vs,W,m),(L=X.back)&&X.addV(L.vs,r,u),(L=X.top)&&X.addH(L.vs,W,m,r,u,!0),(L=X.bottom)&&X.addH(L.vs,u,r,m,W);w.p=a,w.f=m,w.b=r},_10O:function(r,I,B,G,M,D,C,S){var L,O,X=this,W=X.data,x=X._9O(r,I,B,G,M),l=(r.x+I.x)/2,Q=(r.y+I.y)/2,f=W.getShapeElevation(),e=0;for(e=0;B>e;e++)S?(fj(D,x[e]),fj(D,x[e+1])):(fj(D,x[e+1]),fj(D,x[e])),fj(D,[l,f,Q]),C&&(S?(L=p*(e+1)/B+G,O=p*e/B+G):(L=p*e/B+G,O=p*(e+1)/B+G),C.push(.5-.5*o(O),.5-.5*U(O),.5-.5*o(L),.5-.5*U(L),.5,.5))},_9O:function(a,z,T,F,j){var Q,Z,J=this,r=J.data,n=[],I=(a.x+z.x)/2,R=(a.y+z.y)/2,u=r.getTall()/2,s=r.getShapeElevation(),E=0;for(j=j||p;T>=E;E++)Q=j*E/T+F,Z=o(Q),n.push([I+(a.x-I)*Z,s+u*U(Q),R+(a.y-R)*Z]);return n},addV:function(y,E,L){var z=E.x,h=E.y,V=L.x,B=L.y,I=this.data,v=I.getShapeElevation(),j=I.getTall()/2;y.push(z,v-j,h,V,v-j,B,V,v+j,B,V,v+j,B,z,v+j,h,z,v-j,h)},addH:function(v,b,p,e,o,f){var W=this.data,$=W.getTall()/2,g=W.getShapeElevation()+(f?$:-$);v.push(b.x,g,b.y,p.x,g,p.y,e.x,g,e.y,e.x,g,e.y,o.x,g,o.y,b.x,g,b.y)},vf:function(b,u,S,r){var i,n=this,L=n.gv.getFaceVisible(n.data,b);return(S||L)&&(i=kf(n,b,r),i.vs=[],i.tuv=L&&(i.texture||u)?[]:T,i.visible=L),i}});var Dq=function(d,N){Uo(Dq,this,[d,N])};Nc(Dq,yq,{_25Q:1,validate:function(f){var c=this,a=c.data,j=c.s,A=a.getPoints(),u=A.size();if(c.shapeModel=c.info=T,u>1){var S=c.info={},W=a.getSegments(),e=a.getThickness(),N=mr(A.get(0)),s=mr(A.get(u-1)),n=u%2;
0===n?(S.c1=mr(A.get(u/2-1)),S.c2=mr(A.get(u/2))):S.p3=mr(A.get((u-n)/2)),S.s1=N,S.s2=mr(A.get(1)),S.t1=mr(A.get(u-2)),S.t2=s,S.list=j(td)===Wc?c.createTubeModel(A,W,e/2,f):c.createLineModel(A,W,e,"shape.border","shape.dash")}var t=a.p3(),G=c.mat=nn();Nf(G,t),rn(G,a.getFinalRotation3d(),a.getRotationMode());var o=a.getScale3d(),Z=a._dynamicScale3d;Z&&(o[0]*=Z[0],o[1]*=Z[1],o[2]*=Z[2]),hb(G,o),Nf(G,bq(t))},_80o:function(k,M,$){var H=this,E=H.shapeModel;if(E){var e=H.gv;vh(e,H.mat),bf(e,H.data,E,H,H.getBodyColor(),$),Qb(e)}}});var _g=b.graph3d.VR=function(B){var T=this;T.gv=B,T._controllers=[],T.switch=new vj(T),T._enable=!1,T._defaultCallLater=b.Default.callLater,"undefined"!=typeof x&&"VRFrameData"in x&&(T._frameData=new x.VRFrameData),T.measureOflength=1,T.eyesOffset=[0,0,0],T._orientation=new b.Math.Quaternion,T._lastHeadPose=[0,0,0],T._offsetToBeAdd=[0,0,0]};Nc(_g,w,{ms_fire:!0,_42:function(C,D,k,S){var J=this,E=J.gv;if(J._deviceInAction){var K=J._device;if(K){var g=J._measureOflength;K.depthNear=E.getNear()*g,K.depthFar=E.getFar()*g;var x=J._offsetToBeAdd;if(J.eyesOffset[0]+=x[0],J.eyesOffset[1]+=x[1],J.eyesOffset[2]+=x[2],x[0]=0,x[1]=0,x[2]=0,K.isPresenting===!1)return J._controllers.forEach(function(l){l&&l.update()}),E.iv(),!1;var $=J._frameData;K.getFrameData($);var Z=$.pose.position;return Z&&(E.setEye(J.toViewPosition(Z)),J._orientation.fromArray($.pose.orientation)),J._controllers.forEach(function(y){y&&y.update()}),C.viewport(0,0,D/2,k),J._viewMatrix=J._copyViewMatrix($.leftViewMatrix),J._projectMatrix=J._copyProjectMatrix($.leftProjectionMatrix),S(),C.viewport(D/2,0,D/2,k),J._viewMatrix=J._copyViewMatrix($.rightViewMatrix),J._projectMatrix=J._copyProjectMatrix($.rightProjectionMatrix),S(),J._lastViewMatrix=J._viewMatrix,J._lastProjectMatrix=J._projectMatrix,J._viewMatrix=null,J._projectMatrix=null,J.submitFrame(),!0}}},onVRDisplayPresentChange:function(){var j=this.isPresenting();this._injectGraphView(j),this.fp("present",!j,j)},getOrientation:function(){return this._orientation},addController:function(S){S=S||0;var h=this,g=h.getController(S);return g?g:(g=new Np(h,S),h._controllers.push(g),g)},getController:function(j){j=j||0;for(var f=this._controllers,a=0,A=f.length;A>a;a++)if(f[a]&&f[a].id===j)return f[a];return null},removeController:function(i){i=i||0;for(var h=this._controllers,g=0,u=h.length;u>g;g++)if(h[g]&&h[g].id===i)return h.splice(g,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(k,p){var $=this,v=$._scaleFactor,M=$._eyesOffset,K=$._lastHeadPose;return K[0]=k[0]*v,K[1]=k[1]*v,K[2]=k[2]*v,p?(p[0]=K[0]+M[0],p[1]=K[1]+M[1],p[2]=K[2]+M[2],p):[K[0]+M[0],K[1]+M[1],K[2]+M[2]]},addEyesOffset:function(M,T,L){var Z=this._offsetToBeAdd;Z[0]+=M,Z[1]+=T,Z[2]+=L},_copyViewMatrix:function(d){var D=this.dup(d),H=this._scaleFactor;D[12]*=H,D[13]*=H,D[14]*=H;var Y=this._eyesOffset;if(Y&&(Y[0]||Y[1]||Y[2])){var V=Y[0],Q=Y[1],W=Y[2];D[12]-=D[0]*V+D[4]*Q+D[8]*W,D[13]-=D[1]*V+D[5]*Q+D[9]*W,D[14]-=D[2]*V+D[6]*Q+D[10]*W}return D},shutdown:function(){var P=this._device;P&&P.isPresenting&&P.exitPresent()},isPresenting:function(){var $=this._device;return $&&$.isPresenting},_copyProjectMatrix:function(D){var n=this.dup(D),Q=this._scaleFactor;return n[14]*=Q,n},dup:function(T,C){for(var S=T.length,O=C||new Array(S);S--;)O[S]=T[S];return O},getViewMatrix:function(a){var c=this._viewMatrix;return c?this.dup(c,a):void 0},getProjectMatrix:function(){var G=this._projectMatrix;return G?this.dup(G):void 0},submitFrame:function(){var V=this;if(V._enable&&V._deviceInAction){var o=V._device;o&&o.isPresenting&&(o.submitFrame(),V.gv.iv())}},intersectWorld:function(W){var L=this.gv;return L.intersectObjects(W,L.dm().getDatas())},setDevice:function(f){var l=this;l._device=f},_injectGraphView:function(){var X,n,B;return function(x){var c=this.gv;if(!x)return X&&(c.getWidth=X,c.getHeight=n,c.getDevicePixelRatio=B),void 0;var W=this._device,Z=W.getEyeParameters("left"),d=Z.renderWidth,e=Z.renderHeight;X=c.getWidth,n=c.getHeight,B=c.getDevicePixelRatio,c.getWidth=function(){return 2*d},c.getHeight=function(){return e},c.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(o){var f=this;if(!o)return Zh=b.Default.callLater=f._defaultCallLater,void 0;var f=this;Zh=b.Default.callLater=function(U,K,J,E){var N=f._device;return N&&N.isPresenting?E?n(function(){Zh(U,K,J)},E):N.requestAnimationFrame(function(){f._deviceInAction=!0,U.apply(K,J),f._deviceInAction=!1}):f._defaultCallLater(U,K,J,J)}}}),w.defineProperties(_g.prototype,{enable:{get:function(){return this._enable},set:function(m){var l=this;l._enable!==m&&(l._enable=m,m?(l.switch.showButton(),l._injectCallLaterFunc(!0)):(l.shutdown(),l.switch.hideButton(),l._injectCallLaterFunc(!1)),l.fp("enable",!m,m))}},measureOflength:{get:function(){return this._measureOflength},set:function(b){this._measureOflength=b;var j=this._scaleFactor=1/b;this._controllers.forEach(function(A){A&&A._setScaleFactor(j)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(s){this._eyesOffset=s}},controllerModel:{get:function(){return this._controllerModel},set:function(g){var q;"object"==typeof g?(q=g.mtl,g=g.obj):(q=g+".mtl",g+=".obj");var T=this,H=T._controllerModel;H&&H.obj===g&&H.mtl===q||(H=T._controllerModel={obj:g,mtl:q},t.loadObj(g,q,{finishFunc:function(o,D){T._controllerModel===H&&t.setShape3dModel("vrControllerModel",D)}}))}},interactive:{get:function(){return!!this._interactive},set:function(q){!!q!=!!this._interactive&&(this._interactive=q,q&&this.addController(0),this.gv.getCoreInteractor().enableVR(q))}}});var Np=function(G,F){function l(m){var D=navigator.getGamepads&&navigator.getGamepads();if(D)for(var z=0,S=0,b=D.length;b>z;z++){var J=D[z];if(J){var h=J.id;if("OpenVR Gamepad"===h||"OpenVR Controller"===h||0===h.indexOf("Oculus Touch")||0===h.indexOf("Spatial Controller")){if(S===m)return J;S++}}}}function j(k,f,K){return Math.abs(k[0]-f[0])<K&&Math.abs(k[1]-f[1])<K&&Math.abs(k[2]-f[2])<K?!0:!1}var z=this;z.vr=G,z.id=F;var X,T,i=[0,0],d=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],S=new Ak;S.s("shape3d","vrControllerModel"),S.isController=!0,S.s("intersect",!1),z.getGamepad=function(){return T},z.getButtonState=function($){d.forEach(function(q){return q.id===$?q.pressed:void 0})},z.getNode=function(){return S};var O=.003;z.setRotationEpsilon=function(x){O=x};var D=5e-4,M=D;z.setPositionEpsilon=function(T){D=T,M=T*z.vr._scaleFactor},z._setScaleFactor=function(v){S.s3(v,v,v),M=D*v},z._setScaleFactor(z.vr._scaleFactor);var _,H=new qn,h=new Up,a=[0,0,0],p=[0,0,0],P=new dg,Z=new Dr,c=new Yk;z.getRay=function(){return _?(c.origin.fromArray(a),c.direction.copy(Z),_=!1,c):c},z.update=function(){if(X=T,T=l(F),X!=T&&console.log("gamepad changed",T),!T||T.pose===q)return T=null,S.s("3d.visible",!1),void 0;if(t.getShape3dModel("vrControllerModel")){S.dm()||G.gv.dm().add(S),S.s("3d.visible",!0);var u=T.pose;if(null!==u){u.position&&(z.vr.toViewPosition(u.position,a),j(S.p3(),a,M)||(_=!0,S.p3(a))),u.orientation&&(H.fromArray(u.orientation),Z.set(0,0,-1).applyQuaternion(H).normalize(),h.makeRotationFromQuaternion(H),P.set(0,0,0,S.getRotationMode(),!0).setFromRotationMatrix(h),p[0]=P.x,p[1]=P.y,p[2]=P.z,j(S.r3(),p,O)||(_=!0,S.r3(p))),_&&G.fp("gamepad.pose",null,{position:a,rotation:p,id:F});var k=T.axes;(i[0]!==k[0]||i[1]!==k[1])&&(i=[k[0],k[1]],G.fp("gamepad.axes",null,{id:F,axes:i}));var b,A,o,m,n=T.buttons;for(b=0,A=n.length;A>b;b++)o=n[b],m=o.pressed,m!==d[b].pressed&&(d[b].pressed=m,G.fp("gamepad.button."+d[b].id,null,{id:F,_62O:m?"down":"up"}))}}}},vj=function(t){this.vr=t,this._button=null};Nc(vj,w,{showButton:function(){var d=this.assureButton();if(!d.parentNode){var Z=this.vr.gv,e=Z.getView();Z._79O?e.insertBefore(d,Z._79O):e.appendChild(d)}},hideButton:function(){var l=this._button;l&&l.parentNode&&l.parentNode.removeChild(l)},assureButton:function(){var S=this._button;return S?S:this._button=this.createButton(this.vr.gv)},createButton:function(X){function s(B,e){B.textContent=e&&e.isPresenting?"关闭 VR 显示":"开启 VR 显示"}function h(d){L.style.display="",L.style.cursor="pointer",L.style.left="calc(50% - 50px)",L.style.width="100px",s(L,d),L.onmouseenter=function(){L.style.opacity="1.0"},L.onmouseleave=function(){L.style.opacity="0.5"},L.onclick=function(){d.isPresenting?d.exitPresent():d.requestPresent([{source:X.getCanvas()}])},X.vr.setDevice(d)}function G(){L.style.display="",L.style.cursor="auto",L.style.left="calc(50% - 75px)",L.style.width="150px",s(L,null),L.onmouseenter=null,L.onmouseleave=null,L.onclick=null,X.vr.setDevice(null)}function M(g){g.style.position="absolute",g.style.bottom="20px",g.style.padding="12px 6px",g.style.border="1px solid #fff",g.style.borderRadius="4px",g.style.color="#000",g.style.font="normal 13px sans-serif",g.style.textAlign="center",g.style.opacity="0.5",g.style.outline="none",g.style.zIndex="999"}if("getVRDisplays"in navigator){var L=this._button=R.createElement("button");return L.style.display="none",M(L),x.addEventListener("vrdisplayconnect",function(S){h(S.display)},O),x.addEventListener("vrdisplaydisconnect",function(){G()},O),x.addEventListener("vrdisplaypresentchange",function(F){s(L,F.display),X.vr.onVRDisplayPresentChange()},O),navigator.getVRDisplays().then(function(i){i.length>0?h(i[0]):G()}),L}var C=R.createElement("a");return C.href="https://webvr.info",C.innerHTML="当前不支持 webvr",C.style.left="calc(50% - 90px)",C.style.width="180px",C.style.textDecoration="none",M(C),C}}),w.defineProperties(vj.prototype,{}),Pr(t,{accordionViewExpandIcon:ub(nd),accordionViewCollapseIcon:ub(nd,!0),accordionViewLabelColor:Ik,accordionViewLabelFont:Tl,accordionViewTitleBackground:si,accordionViewSelectBackground:bk,accordionViewSelectWidth:3,accordionViewSeparatorColor:q,splitViewDividerSize:1,splitViewDividerBackground:si,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:kr,rect:[2,2,12,12],background:nd}]},propertyViewLabelColor:Wl,propertyViewLabelSelectColor:Ik,propertyViewLabelFont:Tl,propertyViewExpandIcon:ub(Oo),propertyViewCollapseIcon:ub(Oo,!0),propertyViewBackground:Id,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:ce,propertyViewColumnLineColor:ce,propertyViewSelectBackground:bk,listViewLabelColor:Wl,listViewLabelSelectColor:Ik,listViewLabelFont:Tl,listViewRowLineVisible:!1,listViewRowLineColor:ce,listViewSelectBackground:bk,treeViewLabelColor:Wl,treeViewLabelSelectColor:Ik,treeViewLabelFont:Tl,treeViewExpandIcon:ub(De),treeViewCollapseIcon:ub(De,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:ce,treeViewSelectBackground:bk,treeViewDoubleClickToToggle:!0,tableViewLabelColor:Wl,tableViewLabelSelectColor:Ik,tableViewLabelFont:Tl,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:ce,tableViewColumnLineColor:ce,tableViewSelectBackground:bk,treeTableViewLabelColor:Wl,treeTableViewLabelSelectColor:Ik,treeTableViewLabelFont:Tl,treeTableViewExpandIcon:ub(De),treeTableViewCollapseIcon:ub(De,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:ce,treeTableViewColumnLineColor:ce,treeTableViewSelectBackground:bk,tableHeaderLabelColor:Wl,tableHeaderLabelFont:Tl,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:gq,tableHeaderBackground:Id,tableHeaderMoveBackground:Pd,tableHeaderInsertColor:bk,tableHeaderSortDescIcon:Cl(Oo,!0),tableHeaderSortAscIcon:Cl(Oo),tabViewTabGap:1,tabViewLabelColor:Ik,tabViewLabelFont:Tl,tabViewTabBackground:si,tabViewSelectWidth:3,tabViewSelectBackground:bk,tabViewMoveBackground:Pd,tabViewInsertColor:bk,toolbarLabelColor:Wl,toolbarLabelSelectColor:Ik,toolbarLabelFont:Tl,toolbarBackground:Id,toolbarSelectBackground:bk,toolbarItemGap:8,toolbarSeparatorColor:ne},!0);var ff={translateX:1,sortColumn:1},Kl={sortable:1,sortOrder:1,sortFunc:1},Ue={focusData:1},Le={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},tp={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},tn=function(E,$){$.add(E),E.hasChildren()&&E.eachChild(function(l){tn(l,$)})},Hc=function(Z,g,O,k,q,y,C,z,h,H,L){var G,n=O.getValueType(H),Q=O.getAlign(H);if(O.getEnumValues(H)){var M=O.toEnumLabel(g,H),o=Rc||0,U=0,x=y,j=t.getTextSize(k,M).width;return G=xf(O.toEnumIcon(g,H)),G&&(U=y+Rc/2,"center"===Q?U+=(z-(o+j))/2:"right"===Q&&(U=U+z-(o+j)),Tm(Z,G,U,C+h/2,H,L),x=U+Rc/2),M!=T&&(G?jn(Z,M,k,q,x,C,z-(x-y),h):jn(Z,M,k,q,y,C,z,h,Q)),void 0}return g=O.formatValue(g),g!=T?n===so?(Of(Z,y,C,z,h,g),void 0):n===$q||!n&&lp(g)?(G=xf(g?cl:Rk),Tm(Z,G,y+z/2,C+h/2,H,L),void 0):(jn(Z,g,k,q,y,C,z,h,Q),void 0):void 0},ck=function(E,V){var w=V.view,a=vr(E),L=V.column||V.property;w.getDataModel().beginTransaction(),V.editor=E,E.info=V,w.setCurrentEditor(E),w.getView().insertBefore(a,w._79O),$c(E,V.editorRect),E.setFocus?E.setFocus():hk(E),E.commitValue=function(J,K){E._17Q&&(E=E._17Q),K||w.setValue(V.data,L,E.getValue?E.getValue():E.value),E.close&&E.close(),Ln(a)},L.onEditorCreated&&L.onEditorCreated(V)},Xd=function(a,Z,V,G,y){var b=ws(a,V),X=Z.value,s=Z.view,f=y.getValueType(Z.data);return b.onblur=b.onchange=function(){s.endEditing()},"input"===a?(X=y.formatValue(X),X!=T&&(b.value=X),b.onkeydown=function(Z){op(Z)?s.endEditing():qi(Z)&&s.endEditing(!0)},(f===re||f===Lf)&&b.addEventListener(kh,t.numberListener,O)):a===wk&&G.forEach(function(l){var U=R.createElement("option");U.innerHTML=y.toEnumLabel(l),U.value=l,y.isEnumEqual(X,l)&&(U.selected=!0),Xk(b,U)}),ck(b,Z),b},Yi=b.widget={},up=function(I,b,L){Nc(e+".widget."+I,b,L)};Pr(Er,{ms_value:function(n){n.getValue=function($){var E=this.getItemById($),U=E.element;return Ub(U)?U:U?U.getValue?U.getValue():U.value:E.selected},n.setValue=function(M,R){var H=this.getItemById(M);if(H){var j=H.element;j&&!Ub(j)?j.setValue?j.setValue(R):j.value=R:lp(R)?(H.selected=R,this.iv()):(H.element=R,this.iv())}},n.v=function(v,B){var A=this;if(2===arguments.length)A.setValue(v,B);else{if(!qc(v))return A.getValue(v);for(var z in v)A.setValue(z,v[z])}return A}},_46o:function(n){n._icon=T,n._accessType=T,n._valueType=T,n._editable=!1,n._batchEditable=!0,n._align=vn,n._nullable=!0,n._emptiable=!1,n.setParent=Wg,n.formatValue=function(N){var U=this,Z=U._valueType;return U.getEnumValues()?U.toEnumLabel(N):Z===$q?!!N:N!=T&&Z===re?z(N):N},n.setEnum=function(v,b,D,O,F,H,o){var u=this;v&&!Wd(v)&&v.values&&(O=v.editable,D=v.icons,b=v.labels,F=v.strict,H=v.maxHeight,o=v.dropDownWidth,v=v.values),Co(v)&&(v=v._as),Co(b)&&(b=b._as),Co(D)&&(D=D._as),u._enumValues=v,u._enumLabels=b,u._enumIcons=D,u._enumEditable=O,u._enumStrict=F==T?!0:F,u._enumMaxHeight=H,u._enumDropDownWidth=o,v&&v.length&&bh(v[0])&&(u._valueType=Lf),u.fp("enum",!1,!0)},n.getEnumDropDownWidth=function(){return this._enumDropDownWidth},n.getEnumMaxHeight=function(){return this._enumMaxHeight},n.isEnumEditable=function(){return this._enumEditable},n.getEnumValues=function(){return this._enumValues},n.getEnumLabels=function(){return this._enumLabels},n.getEnumIcons=function(){return this._enumIcons},n.isEnumStrict=function(){return this._enumStrict},n.isEnumEqual=function(Q,H){return this._enumStrict?Q===H:Q==H},n.toEnumLabel=function(V,F){var f=this,R=f.getEnumValues(F),N=f.getEnumLabels(F);if(R&&N)for(var l=0;l<R.length;l++)if(f.isEnumEqual(V,R[l]))return N[l];return V},n.toEnumIcon=function(E,r){var c=this,l=c.getEnumValues(r),G=c.getEnumIcons(r);if(l&&G)for(var U=0;U<l.length;U++)if(c.isEnumEqual(E,l[U]))return G[U];return q}},_45o:function(h){h._87o=function(g,F,L,k,A,j){if(g){var B=this,C=B._90I,h=Zp(1);B._columnLineVisible&&(A-=1),B._rowLineVisible&&(j-=1),0>=A||0>=j||(B._90I||(C=B._90I={}),C[F]||(C[F]=new Bk),$c(h,B.tx()+L,B.ty()+k,A,j),Xk(h,g),B._view.insertBefore(h,B._79O),g.onParentAdded&&g.onParentAdded(h),C[F].add(h))}},h._76o=function(){var s=this,p=s._90I;if(p){for(var o in p)p[o].each(function(x){Ln(x)});delete s._90I}},h._77o=function(e){var l=this;if(l._90I){var R=l._90I[e];R&&(R.each(function(N){Ln(N)}),delete l._90I[e])}}},_47o:function(Y){Y.getValue=function(K,T){return T.getValue?T.getValue(K,T,this):il(K,T.getAccessType(),T.getName())},Y.setValue=function(v,w,y){if(w.isEmptiable(v)||""!==y||(y=q),w.isNullable(v)||y!=T){var o=this,Z=w.getName(v),z=w.getAccessType(v),M=w.getValueType(v);M===re&&Ub(y)?y=j(y):M===Lf&&Ub(y)?y=parseFloat(y):M===$q&&Ub(y)&&(y="true"===y),o._batchEditable&&w._batchEditable&&o.isSelected(v)?o.sm().each(function(p){w.setValue?w.setValue(p,w,y,o):ep(p,z,Z,y)}):w.setValue?w.setValue(v,w,y,o):ep(v,z,Z,y)}},Y.setCurrentEditor=function(H){this.endEditing(),this._currentEditor=H,this.redraw()},Y.isEditing=function(b,J){var R=this,A=R._currentEditor;if(!A)return!1;if(J){var s=A.info;return s?(s.column||s.property)===J&&s.data===b:!1}return!0},Y.endEditing=function(V){var Z=this,Y=Z._currentEditor;Y&&(delete Z._currentEditor,Y.commitValue&&Y.commitValue(Y.info,V),Z.redraw(),Z.getDataModel().endTransaction())},Y.beginEditing=function(I){this.endEditing();var x=this,v=I.column||I.property;if(v.beginEditing)v.beginEditing(I);else{var G=I.data,y=I.value,K=x.getSelectBackground(G),C=v.getEnumValues(G),W=v.getSlider(G),F=v.getColorPicker(G);if(W){var m=ad(Yi.Slider,W);return m.setValue(y),m.getView().onblur=function(){x.endEditing()},m.isInstant()&&(m.onValueChanged=function(){x.setValue(G,v,m.getValue())}),ck(m,I),void 0}if(F||v.getValueType(G)===so){var d=ad(Yi.ColorPicker,F);return d.setValue(y),d.onClosed=function(){x.endEditing()},d.isInstant()&&(d.onValueChanged=function(e,V){x.setValue(G,v,V)}),ck(d,I),d.open(),void 0}if(C){if(Yi.ComboBox){var _=new Yi.ComboBox;_.setValue(y),_.setValues(C),_.setLabels(v.getEnumLabels(G)),_.setIcons(v.getEnumIcons(G)),_.setEditable(v.isEnumEditable(G)),_.setStrict(v.isEnumStrict(G)),_.setMaxHeight(v.getEnumMaxHeight(G)),_.setDropDownWidth(v.getEnumDropDownWidth(G)),_.onClosed=function(){x.endEditing()},ck(_,I),_.open()}else Xd(wk,I,K,C,v);return}var u=v.getValueType(G);if(u===$q||lp(y))return x.setValue(G,v,!y),void 0;if(v.getItemEditor(G)){var z=rh(v.getItemEditor(G)),N=new z(G,v,x,I),V=N.getView();return V._17Q=N,N.setValue(y),Kf(V),ck(V,I),N.editBeginning&&N.editBeginning(),void 0}Xd("input",I,K,T,v)}}},_44o:function(z){z.init=function(E){var b=this,C=b.th=new Hm(E),M=b._view=rc(1,b);b.tv=b._tableView=E,Xk(M,C.getView()),Xk(M,E.getView()),C.mp(function(k){k.property===tf&&b.iv()}),b.iv()},z.getTableView=function(){return this.tv},z.getTableHeader=function(){return this.th},z.getDataModel=function(){return this.tv.dm()},z.getColumnModel=function(){return this.tv.getColumnModel()},z.setColumns=function(W){this.tv.setColumns(W)},z.addColumns=function(h){this.tv.addColumns(h)},z.endEditing=function(){this.tv.endEditing()},z.validateImpl=function(){var V=this,Z=V.th,_=Yq(Z),m={x:0,y:0,width:V.getWidth(),height:_};$c(Z,m),m.y=_,m.height=i(0,V.getHeight()-_),$c(V.tv,m)}},ms_vs:function(X){X._41o=function(){return this._29I.height<this._59I},X._43o=function(){var _=this;_._41o()&&(_._58I||(n(function(){_._94O()},qh),_.iv()),_._58I=new Date)},X._94O=function(){var B=this;if(B._58I){var e=new Date;e.getTime()-B._58I.getTime()>=qh?(delete B._58I,B.iv()):n(function(){B._94O()},qh)}},X._93I=function(){var K=this,k=K._27I;if(K._58I||!K._autoHideScrollBar){k||Xk(K._79O,k=K._27I=Zp());var $=K._29I,R=$.height,p=K._59I,D=K.getScrollBarSize(),Q=$.width-D-2,Z=R*(-K.ty()/p),F=R*(R/p),j=k.style;p>R?(li>F&&(Z=Z+F/2-li/2,0>Z&&(Z=0),Z+li>R&&(Z=R-li),F=li),j.visibility=Ge,j.background=K.getScrollBarColor(),j.borderRadius=D/2+vs,$c(k,Q,Z,D,F)):j.visibility=un}else k&&(k.style.visibility=un)}},ms_hs:function(w){w._40o=function(){return this._29I.width<this._91I},w._42o=function(){var O=this;O._40o()&&(O._95O||(n(function(){O._94I()},qh),O.iv()),O._95O=new Date)},w._94I=function(){var o=this;if(o._95O){var U=new Date;U.getTime()-o._95O.getTime()>=qh?(delete o._95O,o.iv()):n(function(){o._94I()},qh)}},w._92I=function(){var x=this,P=x._28I;if(x._95O||!x._autoHideScrollBar){P||Xk(x._79O,P=x._28I=Zp());var f=x._29I,O=f.width,H=x._91I,R=x.getScrollBarSize(),b=f.height-R-2,i=O*(-x.tx()/H),d=O*(O/H),M=P.style;H>O?(li>d&&(i=i+d/2-li/2,0>i&&(i=0),i+li>O&&(i=O-li),d=li),M.visibility=Ge,M.background=x.getScrollBarColor(),M.borderRadius=R/2+vs,$c(P,i,b,d,R)):M.visibility=un}else P&&(P.style.visibility=un)}}}),yk(cl,Tb(16,16,[{type:zm,rect:[1,1,14,14],background:bk},{type:Zq,rect:[1,1,14,14],width:1,color:Cb},{type:Mo,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),yk(Rk,Tb(16,16,{type:Zq,rect:[1,1,14,14],width:1,color:Cb})),yk(Mj,Tb(16,16,[{type:Qq,rect:[2,2,12,12],borderWidth:1,borderColor:Cb,background:"#FFF"},{type:Qq,rect:[4,4,8,8],background:bk}])),yk(gk,Tb(16,16,{type:Qq,rect:[2,2,12,12],borderWidth:1,borderColor:Cb})),Er._15Q=function(Q){Q._29I=gs,Q._59I=0,Q._91I=0,Q._5o=function(y){var u=this;u._30I=new Bk,u._rows=new Bk,u._rowMap={},u._31I=0,u._14I=0,u._view=rc(1,u),u._canvas=Uh(u._view),Xk(u._view,u._79O=Zp()),u.dm(y?y:new Dj)},Q.getCheckIcon=function(X){var k=this.sm(),Y=k.co(X);return k.sg()?xf(Y?Mj:gk):xf(Y?cl:Rk)},Q.checkData=function(e){var N=this.sm(),c=N.co(e);N.sg()&&c||(this._32o=1,c?N.rs(e):N.as(e),delete this._32o)},Q.getDataAt=function(N){N.target&&(N=this.lp(N));var g=l(N.y/this._rowHeight),a=this._rows;return 0>g||g>=a.size()?T:a.get(g)},Q.onDataDoubleClicked=function(){},Q.onDataClicked=function(){},Q.adjustTranslateX=function(){return 0},Q.adjustTranslateY=function(J){var o=this.getHeight()-this._59I;return o>J&&(J=o),J>0?0:z(J)},Q.onPropertyChanged=function(d){var m=this,x=d.property;Le[x]?m.ivm():Ue[x]||m.redraw(),x===Sh?m._42o():x===eb&&m._43o()},Q.getLabel=function(w){return w.toLabel()},Q.getLabelFont=function(){return this._labelFont},Q.getLabelColor=function(q){var x=this;if(x.isCheckMode()){if(x._focusData===q)return x._labelSelectColor}else if(x.isSelected(q))return x._labelSelectColor;return x._labelColor},Q.getStartRowIndex=function(){return this._31I},Q.getEndRowIndex=function(){return this._14I},Q.getRowDatas=function(){return this._rows},Q.getRowIndex=function(j){return this._rowMap[j._id]},Q.getRowSize=function(){return this._rows.size()},Q.getViewRect=function(){return Tg(this._29I)},Q.isVisible=function(t){return this._visibleFunc?this._visibleFunc(t):!0},Q.getCurrentSortFunc=function(){return this._sortFunc},Q.setDataModel=function(i){var L=this,T=L._dataModel,P=L._selectionModel;T!==i&&(T&&(T.umm(L.handleDataModelChange,L),T.umd(L.handleDataPropertyChange,L),T.umh(L.handleHierarchyChange,L),P||T.sm().ums(L.handleSelectionChange,L)),L._dataModel=i,i.mm(L.handleDataModelChange,L),i.md(L.handleDataPropertyChange,L),i.mh(L.handleHierarchyChange,L),P?P._21I(i):i.sm().ms(L.handleSelectionChange,L),L.fp("dataModel",T,i))},Q.validateModel=function(){var O=this;O._rows.clear(),O._rowMap={},O.buildChildren(O._dataModel._roots);var l=O._rows=O._rows.toList(O.isVisible,O),k=0,i=O.getCurrentSortFunc(),K=l.size();for(i&&l.sort(i);K>k;k++)O._rowMap[l.get(k)._id]=k},Q.buildChildren=function(X){var J=this;X.each(function(T){J._rows.add(T),J.buildChildren(T._children)})},Q.handleDataModelChange=function(){this.ivm()},Q.handleDataPropertyChange=function(v){"parent"===v.property?this.ivm():this.invalidateData(v.data)},Q.handleHierarchyChange=function(){this.ivm()},Q.handleSelectionChange=function(d){d.datas.each(this.invalidateData,this),this.onSelectionChanged(d)},Q.onSelectionChanged=function(k){var d=this,w=d.sm();!d.isAutoMakeVisible()||1!==w.size()||"set"!==k.kind&&"append"!==k.kind||d._32o||d.makeVisible(w.ld())},Q.handleBackgroundClick=function(Y){Cq(Y)&&!this.isCheckMode()&&this.sm().cs()},Q.makeVisible=function(c){c&&(this._23I=c,this.iv())},Q.scrollToIndex=function(v){var h=this,W=h._29I,R=W.height,u=h._rowHeight,d=u*v;v>=0&&v<h._rows.size()&&R>0&&(d+u>W.y+R?h.ty(-d+R-u):d<W.y&&h.ty(-d))},Q.autoScroll=function(x,X){var Z=this,L=Z._rowHeight,m=L,N=L/4,d=Z._29I,J=Z.lp(x),e={x:Z.tx(),y:Z.ty()};return L>0&&d&&(J.x-d.x<m?Z.translate(N,0):d.x+d.width-J.x<m&&Z.translate(-N,0),J.y-d.y<m?Z.translate(0,N):d.y+d.height-J.y<m&&Z.translate(0,-N)),e.x=Z.tx()-e.x,e.y=Z.ty()-e.y,X&&(X.x+=e.x,X.y+=e.y),e},Q.getTopRowOrderSelection=function(){var p=this.sm().getTopSelection(),t={},J=new Bk;return p.each(function(z){t[z._id]=z}),this._rows.each(function(Y){t[Y._id]&&J.add(Y)}),J},Q.getRowOrderSelection=function(){var o=new Bk;return this._rows.each(function(q){this.isSelected(q)&&o.add(q)},this),o},Q.ivm=function(){this.invalidateModel()},Q.invalidateModel=function(){var R=this;R._96I||(R._96I=1,R._32I=1,delete R._24I),R.iv()},Q.redraw=function(){var z=this;z._32I||(z._32I=1,delete z._24I,z.iv())},Q.invalidateData=function(N){var x=this;D?x.redraw():x._32I||(x._24I||(x._24I={}),x._24I[N._id]=N,x.iv())},Q.getFocusData=function(){return this._focusData},Q.setFocusDataById=function(e){this.setFocusData(this.dm().getDataById(e))},Q.setFocusData=function(m){var t=this,o=t._focusData;o!==m&&(t._focusData=m,t.fp("focusData",o,m),o&&t.invalidateData(o),m&&(t.invalidateData(m),t.isAutoMakeVisible()&&t.makeVisible(m)))},Q.drawRowBackground=function(V,Z,O,u,J,l,p){var A=this,j=A.isCheckMode();(Z===A._focusData&&j||O&&!j)&&Of(V,u,J,l,p,A.getSelectBackground(Z))},Q.drawData=function(p,n,e){var G=this,K=G._rowHeight,C=K*e,r=G._29I,o=r.x,k=r.width;p.save(),p.beginPath(),p.rect(o,C,k,K),p.clip(),G._87o(G.drawRow(p,n,G.isSelected(n),o,C,k,K),e,o,C,k,K),p.restore(),G._rowLineVisible&&Of(p,o,C+K-1,k,1,G._rowLineColor)},Q._12I=function(r){var X=this,w=X._31I,Q=X._29I,H=Q.x,t=Q.y,C=Q.width,Z=Q.height;for(r.beginPath(),r.rect(H,t,C,Z),r.clip(),r.clearRect(H,t,C,Z),X._76o(),X._93db(r);w<X._14I;w++)X.drawData(r,X._rows.get(w),w);X._92db(r)},Q._13I=function(I){for(var V,W=this,n=W._rowHeight,C=W._29I,E=C.x,_=C.width,j=W._31I,T=W._30I;j<W._14I;j++)V=W._rows.get(j),W._24I[V._id]&&T.add({data:V,index:j});T.isEmpty()||(I.beginPath(),T.each(function(c){I.rect(E,c.index*n,_,n)}),I.clip(),T.each(function(t){I.clearRect(E,t.index*n,_,n)}),T.each(function(x){W._77o(x.index)}),W._93db(I),T.each(function(Z){W.drawData(I,Z.data,Z.index)}),W._92db(I),T.clear())},Q.preValidateModel=function(){this.endEditing&&this.endEditing()},Q.validateImpl=function(){var S=this,n=S._canvas,u=S.getWidth(),K=S.getHeight(),h=S._rowHeight,H=S._32I;(u!==n.clientWidth||K!==n.clientHeight)&&(Dp(n,u,K),H=1);var B=Y&&!c;S._96I&&!B&&(S.preValidateModel(),S.validateModel());var I=S._29I,L={x:-S.tx(),y:-S.ty(),width:u,height:K},m=S._rows.size(),b=Cn(n),r=S._23I;H||mb(L,I)||(H=1),S._29I=L,S._59I=m*h,S._31I=l(L.y/h),S._14I=d((L.y+L.height)/h),S._31I<0&&(S._31I=0),S._14I>m&&(S._14I=m),S._99I&&H&&S._99I(),Ek(b,S.tx(),S.ty(),1),H?S._12I(b):S._24I&&S._13I(b),S._93I(),S._92I(),b.restore(),S._32I=S._24I=S._96I=T,r&&(S.scrollToIndex(S.getRowIndex(r)),delete S._23I),S.tx(S.tx()),S.ty(S.ty())}},Er._48o=function(P){P._rootVisible=!0,P._rootData=T,P._35o=function(){this._expandMap={},this._levelMap={}},P.validateModel=function(){var v=this,U=v._rootData;v._rows.clear(),v._levelMap={},v._rowMap={},v._currentLevel=0,U?v._rootVisible?v.isVisible(U)&&v.buildData(U):v.buildChildren(U):v.buildChildren(),delete v._currentLevel},P.buildData=function(k){var U=this,A=k._id,z=U._rows;U._rowMap[A]=z.size(),z.add(k),U._levelMap[A]=U._currentLevel,U.isExpanded(k)&&(U._currentLevel++,U.buildChildren(k),U._currentLevel--)},P.buildChildren=function(t){var s=this,Z=t?t._children:s._dataModel._roots,S=s.getCurrentSortFunc();S&&s.isChildrenSortable(t)?Z.toList(s.isVisible,s).sort(S).each(s.buildData,s):Z.each(function(u){s.isVisible(u)&&s.buildData(u)})},P.getLevel=function(r){return this._levelMap[r._id]},P.getToggleIcon=function(x){var W=this,Z=W._loader,z=W._collapseIcon;return Z&&!Z.isLoaded(x)?z:x.hasChildren()?W.isExpanded(x)?W._expandIcon:z:T},P.isCheckMode=function(){return this._checkMode!=T},P.isChildrenSortable=function(){return!0},P.handleDataModelChange=function(p){var R=this;p.kind===Rl?delete R._expandMap[p.data._id]:p.kind===ar&&(R._expandMap={}),R.ivm()},P.toggle=function(e){var q=this;q.isExpanded(e)?q.collapse(e):q.expand(e)},P.isExpanded=function(s){return 1===this._expandMap[s._id]},P.expand=function(J){var M=this,l=M._loader;M.isExpanded(J)||(l&&!l.isLoaded(J)&&l.load(J),M._expandMap[J._id]=1,M.ivm(),M.onExpanded(J))},P.onExpanded=function(){},P.collapse=function(W){var N=this;N.isExpanded(W)&&(delete N._expandMap[W._id],N.ivm(),N.onCollapsed(W))},P.onCollapsed=function(){},P.expandAll=function(_){if(_)this.expand(_),_.eachChild(function(m){this.expandAll(m)},this);else{var r=this;r._dataModel.each(function(f){f.hasChildren()&&(r._expandMap[f._id]=1)}),r.ivm()}},P.collapseAll=function(){this._expandMap={},this.ivm()},P.makeVisible=function(U){if(U){var K=this;if(!K._rootData||U.isDescendantOf(K._rootData)){for(var T=U._parent;T;)K.expand(T),T=T._parent;K._23I=U,K.iv()}}},P.checkData=function(m){var v,h=this,k=h._checkMode,o=h.sm(),c=o.co(m);if(!o.sg()||!c){if(h._32o=1,k===lo)c?o.rs(m):o.as(m);else if(k===Tk)v=new Bk(m),v.addAll(m._children);else if("descendant"===k)v=new Bk,tn(m,v);else if("all"===k&&(v=new Bk,tn(m,v),!c))for(var V=m._parent;V;)v.add(V),V=V._parent;v&&(c?o.rs(v):o.as(v)),delete h._32o}},P._97I=function(H,a,I,Q,f,c,e){var W=this,o=W._indent,R=W._levelMap[a._id],y=W.getIconWidth(a),n=xf(W.getToggleIcon(a));n?(Q+=o*R,Tm(H,n,Q+o/2,f+e/2,a,W),Q+=o):Q+=o*(R+1),W._checkMode&&(Tm(H,W.getCheckIcon(a),Q+o/2,f+e/2,a,W),Q+=o),W.drawIcon(H,a,Q,f,y,e),W.drawLabel(H,a,Q+y,f,e)}},Er._14Q=function(q){q.getIcon=function(l){return l.getIcon()},q.getIconWidth=function(y){return this.getIcon(y)?this._indent:0},q.drawIcon=function(B,P,G,S,r,j){if(r){var t=this,g=t.getBodyColor(P),E=xf(t.getIcon(P),g);E&&(j-=t.isRowLineVisible()?1:0,np(B,E,co,G,S,r,j,P,t,g),We(B,t.getBorderColor(P),G,S,r,j))}},q.drawLabel=function(K,M,U,c,C){var i=this;jn(K,i.getLabel(M),i.getLabelFont(M),i.getLabelColor(M),U,c,0,C)}},Er._50o=function(v){v._98I=function(){var I=this,v=I._39o=new Dj;I._60I=new Bk,v.mm(I._17o,I),v.md(I._18o,I),v.mh(I._19o,I)},v.setColumns=function(c){this._39o.clear(),this.addColumns(c)},v.addColumns=function(w){var M=this._39o;w.forEach(function(L){if(!(L instanceof be)){var u=rh(L.className);L=ad(u?u:be,L)}M.add(L)})},v.onColumnClicked=function(){},v.onCheckColumnClicked=function(){},v._3Q=function(s){for(var v,U=0,o=this._60I,y=o.size();y>U;U++)if(v=o.get(U),v.column===s)return v;return T},v.getColumnAt=function(b){var Y=this._4Q(b);return Y?Y.column:T},v._4Q=function(j){for(var L=this,F=j.target?L.lp(j).x:j.x,_=L._60I,Q=0;Q<_.size();Q++){var n=_.get(Q),h=n.startX;if(F>=h&&F<h+n.column.getWidth())return n}return T},v.getToolTip=function(p){var y=this,i=y.getDataAt(p),x=y.getColumnAt(p);return i&&x?x.getToolTip(i,y):T},v.adjustTranslateX=function(B){var g=this.getWidth()-this._91I;return g>B&&(B=g),B>0?0:z(B)},v._99I=function(){var J=this,k=J._29I,W=J._60I;W.clear(),J._91I=0,J._39o._roots.each(function(E){if(E.isVisible()){var j=J._91I+E.getWidth();J._91I<=k.x+k.width&&j>=k.x&&W.add({column:E,startX:J._91I}),J._91I=j}})},v.drawData=function(L,f,K){var p=this,l=p._rowHeight,Z=l*K,S=p.isSelected(f),z=p._29I,i=z.x,t=z.width;p.drawRowBackground(L,f,S,i,Z,t,l),p._60I.each(function(Q){var d=Q.column,B=Q.startX,J=d.getWidth();J>0&&!p.isEditing(f,d)&&(L.save(),L.beginPath(),L.rect(B,Z,J,l),L.clip(),p._87o(p.drawCell(L,f,S,d,B,Z,J,l),K,B,Z,J,l),p._columnLineVisible&&Of(L,B+J-1,Z,1,l,p._columnLineColor),L.restore())}),p._rowLineVisible&&Of(L,i,Z+l-1,t,1,p._rowLineColor)},v.drawCell=function(l,I,T,A,b,J,M,t){var W=this;if(A.drawCell)return A.drawCell(l,I,T,A,b,J,M,t,W);var N=W.getValue(I,A);Hc(l,N,A,W.getLabelFont(I,A,N),W.getLabelColor(I,A,N),b,J,M,t,I,W)},v.getColumnModel=function(){return this._39o},v._17o=function(){this.redraw()},v._18o=function(z){var P=this;z.data===P._sortColumn&&Kl[z.property]?P.ivm():(P._42o(),P.redraw())},v._19o=function(){this.redraw()},v.getCurrentSortFunc=function(){var T=this,_=T._sortColumn;if(_&&_.isSortable()){var D=_.getSortFunc(),F=fe===_.getSortOrder()?1:-1;return D||(D=$l),function(h,w){return D.call(T,T.getValue(h,_),T.getValue(w,_),h,w)*F
}}return T._sortFunc},v.isCellEditable=function(O,D,T){return D.isEditable()&&this.isEditable()?D.isCellEditable?D.isCellEditable(O,D,T,this):!0:!1},v._37O=function(L,J){if(Cq(J))for(var m=this,g=m.lp(J),f=m._60I,k=m._rowHeight,h=m._29I,O=h.x,M=h.y,V=h.width,P=h.height,o=0;o<f.size();o++){var Z=f.get(o),b=Z.startX,W=Z.column,I=W.getWidth();if(W!==m._31o&&W!==m._4o&&g.x>=b&&g.x<b+I&&m.isCellEditable(L,W,J)){var x={x:b,y:m.getRowIndex(L)*k,width:I,height:k},s={x:x.x+m.tx(),y:x.y+m.ty(),width:x.width,height:x.height},a=0,Q=0;return x.x<O?a=x.x-O:x.x+x.width>O+V&&(a=x.x+x.width-O-V),a&&(m.tx(m.tx()-a),s.x-=a),x.y<M?Q=x.y-M:x.y+k>M+P&&(Q=x.y+k-M-P),Q&&(m.ty(m.ty()-Q),s.y-=Q),m.beginEditing({data:L,column:W,value:m.getValue(L,W),event:J,rect:x,editorRect:s,view:m}),void 0}}}},Yi.BaseItemEditor=function(j,R,D,f){this._data=j,this._column=R,this._master=D,this._editInfo=f},up("BaseItemEditor",w,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var _r=b.Tab=function(){Uo(_r,this)};Tn("Tab",Ck,{ms_ac:["view","closable","disabled"],_icon:T,_closable:!1,_disabled:!1,setParent:Wg});var be=b.Column=function(){Uo(be,this)};Tn("Column",Ck,{_46o:1,ms_ac:["accessType","valueType",Ge,Ol,Vd,Mc,"align",so,"sortOrder",$p,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:fe,_sortFunc:T,_sortable:!0,_clickable:!0,setWidth:function(H){16>H&&(H=16);var a=this._width;this._width=H,this.fp(Mc,a,H)},getToolTip:function(V,S){return this.formatValue(S.getValue(V,this))}});var ci=b.Property=function(){Uo(ci,this)};Tn("Property",Ck,{_46o:1,ms_ac:["accessType","valueType",Ol,Vd,"categoryName",so,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:T,getToolTip:function(I,e,B){var P=this;return e?P.formatValue(B.getValue(I,P)):B.getPropertyName(P)}}),Yi.AccordionView=function(){var $=this;$._20o={},$._21o=new Bk,$._10o=T,$._9o=T,$._11o=T,$._view=rc(0,$),$.iv()},up("AccordionView",w,{ms_v:1,ms_fire:1,ms_ac:[em,Gj,"titleHeight",he,Lh,"titleBackground","selectWidth",Yj,"orientation","separatorColor"],_expandIcon:t.accordionViewExpandIcon,_collapseIcon:t.accordionViewCollapseIcon,_titleHeight:ri,_labelColor:t.accordionViewLabelColor,_labelFont:t.accordionViewLabelFont,_titleBackground:t.accordionViewTitleBackground,_selectBackground:t.accordionViewSelectBackground,_selectWidth:t.accordionViewSelectWidth,_orientation:"v",_separatorColor:t.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(j,m,h,N){var n=this,o=Zp();if(n._20o[j])throw j+" already exists";o.onmousedown=en,o.style.cursor=qo,o.addEventListener(tb?vo:bg,function(b){en(b)},O),o.addEventListener(tb?Ko:pm,function(G){en(G),Cq(G)&&(n._10o===j?n.collapse():n.expand(j))},O),Xk(n._view,o),n._20o[j]={content:m,div:o,canvas:Uh(o),icon:N},n._21o.add(j),h&&n.expand(j),n.iv()},remove:function(g){var Y=this,b=Y._20o[g];b&&(Ln(b.div),delete Y._20o[g],Y._21o.remove(g),Y.iv())},clear:function(){var j=this;j._21o.toArray().forEach(j.remove,j),j._20o={},j._21o.clear(),j.iv()},isExpanded:function(w){return this._10o===w},expand:function(H){var b=this;b._20o[H]&&b._10o!==H&&(b._10o=H,b.onExpanded(H),b.iv())},onExpanded:function(){},collapse:function(){var $=this;$._10o&&($.onCollapsed($._10o),delete $._10o,$.iv())},onCollapsed:function(){},initCanvas:function(R,N,i){Dp(R,N,i);var s=Cn(R);return Ek(s,0,0,1),s.clearRect(0,0,N,i),s},drawTitle:function(r,d,u,O,$){var V=this,Y=xf($.icon),X=V.isExpanded(d),U=V._titleHeight,Q=V._titleBackground,C=V._selectWidth,y=V._separatorColor,M=xf(X?V._expandIcon:V._collapseIcon),S=C+4;Of(r,0,0,u,O,Q),X&&C&&Of(r,0,0,C,O,V._selectBackground),(X||V._21o.get(V._21o.size()-1)!==d)&&Of(r,0,O-1,u,1,y?y:ie(Q)),Y&&(Tm(r,Y,S+Sq(Y)/2,U/2),S+=Sq(Y)+2),jn(r,d,V.getLabelFont(d),V.getLabelColor(d),S,0,0,U),M&&Tm(r,M,u-Sq(M)/2-4,U/2)},validateImpl:function(){var y=this,p=y._view,e=0,t=0,Z=y.getWidth(),K=y.getHeight(),g=y._titleHeight,Y=y._21o.size()*g,v=y._11o,U=y._9o;delete y._11o,delete y._9o,y._21o.each(function(R){var U,A,s=y._20o[R],L=s.content,u=y._10o===R;Je(y)?($c(s.div,e,0,g,K),U=y.initCanvas(s.canvas,g,K),ts(U,0,K),eg(U,-_),y.drawTitle(U,R,K,g,s),U.restore(),u?(A=i(0,Z-Y),L&&(y._11o=L,y._9o=vr(L),$c(L,e+g,0,A,K)),e+=g+A):e+=g):($c(s.div,0,t,Z,g),U=y.initCanvas(s.canvas,Z,g),y.drawTitle(U,R,Z,g,s),U.restore(),u?(A=i(0,K-Y),L&&(y._11o=L,y._9o=vr(L),$c(L,0,t+g,Z,A)),t+=g+A):t+=g)});var q=y._9o;v&&v!==y._11o&&v.endEditing&&v.endEditing(),q&&q!==U&&Xk(p,q),U&&U!==q&&Ln(U)}}),Yi.SplitView=function(R,f,P,o){var A=this,z=A._dividerDiv=Zp(),w=A._60O=Uh(),r=A._61O=Uh(),g=w.style,a=r.style;A._view=rc(1,A),Xk(A._view,z),g.msTouchAction=Ok,g.pointerEvents=Ok,g.cursor=qo,a.msTouchAction=Ok,a.pointerEvents=Ok,a.cursor=qo,R&&A.setLeftView(R),f&&A.setRightView(f),P&&A.setOrientation(P),o!=T&&A.setPosition(o),A.setStatus(gr),new Wr(A)},up("SplitView",w,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:t.splitViewDividerSize,_dividerBackground:t.splitViewDividerBackground,_dragOpacity:t.splitViewDragOpacity,_toggleIcon:t.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(i,Q){var X=this,v=X._position;isNaN(i)||(Q||(X._82O=0>i?-1:i>1?1:0),X._position=i,X.fp(wr,v,i))},getLeftView:function(){return this._leftView},setLeftView:function(J){var V=this,R=V._leftView,D=V._view;if(V._leftView!==J){if(R&&R!==V._rightView){var S=vr(R);S.parentNode===D&&Ln(S)}if(V._leftView=J,J){var Q=vr(J);Q.parentNode!==D&&D.insertBefore(Q,V._dividerDiv)}V.fp("leftView",R,J)}},getRightView:function(){return this._rightView},setRightView:function(j){var Y=this,P=Y._rightView,l=Y._view;if(Y._rightView!==j){if(P&&P!==Y._leftView){var R=vr(P);R.parentNode===l&&Ln(R)}if(Y._rightView=j,j){var A=vr(j);A.parentNode!==l&&l.insertBefore(A,Y._dividerDiv)}Y.fp("rightView",P,j)}},validateImpl:function(){var U=this,t=U._draggable,n=U._position,C=U.getWidth(),Z=U.getHeight(),W=U._dividerSize,S=U._dividerBackground,j=tb?18:8,p=U._dividerDiv,E=U._82O,N=U._60O,M=U._61O,R=U._toggleIcon,L=U._status,V=p.style,y=null,o=tb?20:4,d=R.comps[0];W>=j||0===W?U._coverDiv&&(Ln(U._coverDiv),delete U._coverDiv):U._coverDiv||(U._coverDiv=Zp(),$&&(U._coverDiv.style.background=hf),Xk(p,U._coverDiv)),U._togglable?N.parentNode||(Xk(p,N),Xk(p,M)):(Ln(N),Ln(M));var s=U._coverDiv,k=U._leftView,H=U._rightView;if(Je(U)){if(W>C&&(W=C),L===gr)if(1===E)var I=B(n,C),O=i(0,C-W-I);else-1===E?(O=B(-n,C),I=i(0,C-W-O)):(I=z((C-W)*n),O=i(0,C-W-I));else"cl"===L?(I=0,O=i(0,C-W)):"cr"===L&&(O=0,I=i(0,C-W));k&&$c(k,0,0,I,Z),H&&$c(H,I+W,0,O,Z),$c(p,I,0,W,Z),U._22o=I,s&&($c(s,W/2-j/2,0,j,Z),s.style.cursor=t?cm:""),p.style.cursor=t?cm:"";var K=p.clientHeight/2,Y=p.clientWidth;Dp(N,Y,Y),$c(N,0,K-Y-o,Y,Y),y=Cn(N),Ek(y,0,0,1),d.rotation=-_,Bh(y,R,0,0,Y,Y),y.restore(),Dp(M,Y,Y),$c(M,0,K+o,Y,Y),y=Cn(M),Ek(y,0,0,1),d.rotation=_,Bh(y,R,0,0,Y,Y),y.restore()}else{if(W>Z&&(W=Z),L===gr)if(1===E)var D=B(n,Z),x=i(0,Z-W-D);else-1===E?(x=B(-n,Z),D=i(0,Z-W-x)):(D=z((Z-W)*n),x=i(0,Z-W-D));else"cl"===L?(D=0,x=i(0,Z-W)):"cr"===L&&(x=0,D=i(0,Z-W));k&&$c(k,0,0,C,D),H&&$c(H,0,D+W,C,x),$c(p,0,D,C,W),U._22o=D,s&&($c(s,0,W/2-j/2,C,j),s.style.cursor=t?lr:""),V.cursor=t?lr:"";var c=p.clientWidth/2,Y=p.clientHeight;Dp(N,Y,Y),$c(N,c-Y-o,0,Y,Y),y=Cn(N),Ek(y,0,0,1),d.rotation=0,Bh(y,R,0,0,Y,Y),y.restore(),Dp(M,Y,Y),$c(M,c+o,0,Y,Y),y=Cn(M),Ek(y,0,0,1),d.rotation=X,Bh(y,R,0,0,Y,Y),y.restore()}V.background=S}});var Wr=function(u){this.sv=u,this.addListeners()};Nc(Wr,w,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(Z){var q=this,P=q.sv,G=P._dividerDiv,w=P._60O,S=P._61O,C=P._status,y=Z.target;if(y===w)C===gr?P.setStatus("cl"):"cr"===C&&P.setStatus(gr);else if(y===S)C===gr?P.setStatus("cr"):"cl"===C&&P.setStatus(gr);else if(Qd(Z)&&(y===G||y===P._coverDiv)&&(en(Z),P.isDraggable())){P.getLeftView(),P.getRightView();var v=q.maskDiv=Zp();if(v.style.left=0,v.style.top=0,v.style.width=P.getWidth()+"px",v.style.height=P.getHeight()+"px",P.getView().appendChild(v),!P.isContinuousLayout()){var V=q.resizeDiv=Zp();V.style.left=G.style.left,V.style.top=G.style.top,V.style.width=G.style.width,V.style.height=G.style.height,V.style.opacity=P.getDragOpacity(),V.style.background=P.getDividerBackground(),Xk(q.getView(),V)}q._lastAbsPosition=P._22o,q._86o=Je(P)?kl(Z).x:kl(Z).y,El(q,Z)}},handleWindowTouchMove:function(E){Qd(E)&&this.update(E,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(t){var X=this;X.update(t,!0),X.sv.setStatus(gr),X.maskDiv&&Ln(X.maskDiv),X.resizeDiv&&Ln(X.resizeDiv),X.maskDiv=X.resizeDiv=T},handle_mousedown:function(w){Cq(w)&&this.handle_touchstart(w)},handleWindowMouseMove:function($){this.handleWindowTouchMove($)},handleWindowMouseUp:function(o){this.handleWindowTouchEnd(o)},update:function(p,F){var w=this,N=w.sv,q=Je(N)?N.getWidth():N.getHeight(),t=N._dividerSize,f=w._lastAbsPosition-w._86o;Je(N)?(f+=kl(p).x,f>q-t&&(f=q-t),0>f&&(f=0),w.resizeDiv&&(w.resizeDiv.style.left=f+vs)):(f+=kl(p).y,f>q-t&&(f=q-t),0>f&&(f=0),w.resizeDiv&&(w.resizeDiv.style.top=f+vs)),F&&q!==t&&(1===N._82O?N.setPosition(f,1):-1===N._82O?N.setPosition(f-q+t,1):N.setPosition(f/(q-t),1))}}),Yi.TabView=function(){var n=this,_=n._view=rc(1,n),W=n._91O=Zp(1),w=n._tabModel=new Dj,j=w.sm(),B=n.invalidate;n._7o=new Bk,n._canvas=Uh(W),Xk(_,W),Xk(_,n._92O=Zp(1)),j.setSelectionMode(Fn),j.ms(n.handleSelectionChange,n),w.mm(B,n),w.md(B,n),w.mh(B,n),n._interactor=new wq(n),n.iv()},up("TabView",w,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",he,Lh,"tabBackground","selectWidth",Yj,"moveBackground","insertColor"],_tabPosition:Nm,_tabHeight:ri,_tabGap:t.tabViewTabGap,_labelColor:t.tabViewLabelColor,_labelFont:t.tabViewLabelFont,_tabBackground:t.tabViewTabBackground,_selectWidth:t.tabViewSelectWidth,_selectBackground:t.tabViewSelectBackground,_moveBackground:t.tabViewMoveBackground,_insertColor:t.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(g,y,c){var w=new _r,U=this._tabModel;return w.setName(g),w.setView(y),U.add(w),c&&U.sm().ss(w),w},getLabel:function(o){return o.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(d){this._23o=d,this.iv()},get:function(P){var O=this,w=O._tabModel;if(bh(P))return w._roots.get(P);if(Ub(P)){var F;return w.each(function(N){P===O.getLabel(N)&&(F=N)}),F}return P instanceof _r?P:T},select:function(T){this._tabModel.sm().ss(this.get(T))},remove:function(g){var Y=this;if(g=Y.get(g)){var $=Y._tabModel,o=$._roots.indexOf(g);Y._tabModel.remove(g),Y.selectByIndex(--o)}},getCurrentTab:function(){return this._8o},hideTabView:function(P,F){F.parentNode===this._92O&&(is(F)?(F.style.display=tc,F._tab_=P):Ln(F),Xm())},showTabView:function(b,j){is(j)&&(j.style.display="block",j._tab_=b),j.parentNode!==this._92O&&(Xk(this._92O,j),Xm())},_24o:function(){var C,x=this,b=x._8o,m=x._9o,r=x._tabModel.sm().ld();r&&(C=vr(r.getView())),C!==m&&(m&&(b.getView()&&b.getView().endEditing&&b.getView().endEditing(),x.hideTabView(b,m)),C&&x.showTabView(r,C)),x._8o=r,x._9o=C,b!==r&&x.onTabChanged(b,r)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(Q,k){this.selectByIndex(--k)},selectByIndex:function(R){var X=this,q=X._tabModel,V=q.size();if(V&&!q.sm().ld()){R==T&&(R=0),R>=V&&(R=V-1),0>R&&(R=0);for(var N=R;N>=0;N--){var b=X.get(N);if(!b.isDisabled())return X.select(b),b}for(N=R+1;V>N;N++)if(b=X.get(N),!b.isDisabled())return X.select(b),b}},getTabWidth:function(_){var d=4,F=xf(_.getIcon());F&&(d+=Sq(F,_)+4);var J=this.getLabel(_);return J&&(d+=jp(this.getLabelFont(_),J).width+4),_.isClosable()&&(d+=10),d},drawTab:function(h,R,o,b,W,N,k){var D,p=this,v=p._tabPosition,e=o+4,Z=p._selectWidth,u=xf(R.getIcon()),Y=R.isDisabled(),i=p.getLabelColor(R),I=p.getLabelFont(R),f=p.getLabel(R),L=p._selectBackground,H=v===vn+"-vertical",M=v===ib+"-vertical";(H||M)&&(e=b+4),Y&&(h.globalAlpha=hc),Of(h,o,b,W,N,k),R===p._8o&&Z&&(v===Nm?Of(h,o,b+N-Z,W,Z,L):v===vn?Of(h,o+W-Z,b,Z,N,L):v===ib?Of(h,o,b,Z,N,L):H?Of(h,o+W-Z,b,Z,N,L):M?Of(h,o,b,Z,N,L):Of(h,o,b,W,Z,L));var G=W/2;if(H&&(ts(h,G,b+N/2),eg(h,X),ts(h,-G,-b-N/2)),u){var Q=Bg(u,R),z=Sq(u,R);if(H||M){var E=o+W/2,q=e+Q/2;ts(h,E,q),eg(h,_),ts(h,-E,-q),Tm(h,u,o+W/2,e+Q/2,R,p),ts(h,E,q),eg(h,-_),ts(h,-E,-q),e+=Q+4}else Tm(h,u,e+z/2,b+N/2,R,p),e+=z+4}return H||M?(ts(h,W/2,e+W/2),eg(h,_),ts(h,-W/2,-e-W/2),jn(h,f,I,i,o,e,N,W),ts(h,W/2,e+W/2),eg(h,-_),ts(h,-W/2,-e-W/2)):jn(h,f,I,i,e,b,W,N),H&&(ts(h,G,b+N/2),eg(h,-X),ts(h,-G,-b-N/2)),R.isClosable()&&(D=M?{x:o+W-12,y:b+N-12,width:12,height:12}:{x:o+W-12,y:b+2,width:12,height:12},this.drawCloseIcon(R,h,i,D)),Y&&(h.globalAlpha=1),D},drawCloseIcon:function(r,v,M,m){var Z=m.x,n=m.y;v.strokeStyle=M,v.lineWidth=1,v.beginPath(),v.moveTo(Z+2,n+8),v.lineTo(Z+8,n+2),v.moveTo(Z+8,n+8),v.lineTo(Z+2,n+2),v.stroke()},getTabAt:function(J){var U=this._interactor._8Q(J);return U?U.tab:null},validateImpl:function(){var M=this;M._24o();var n,S=M._canvas,k=M._tabPosition,l=M._91O,P=M._92O,b=M._tabModel,N=M.getWidth(),O=M.getHeight(),W=M._tabHeight,x=M._7o,d=M._tabGap,U=k===Nm,$=k===vn,A=k===ib,Z=k===vn+"-vertical",Q=k===ib+"-vertical",m=M._23o,z=0;if(($||A)&&b._roots.each(function(p){z=i(M.getTabWidth(p),z)}),U?($c(l,0,0,N,W),n={x:0,y:W,width:N,height:i(0,O-W)}):$?($c(l,0,0,z,O),n={x:z,y:0,width:i(0,N-z),height:O}):A?($c(l,N-z,0,z,O),n={x:0,y:0,width:i(0,N-z),height:O}):Z?($c(l,0,0,W,O),n={x:W,y:0,width:i(0,N-W),height:O}):Q?($c(l,N-W,0,W,O),n={x:0,y:0,width:i(0,N-W),height:O}):($c(l,0,O-W,N,W),n={x:0,y:0,width:N,height:i(0,O-W)}),$c(P,n),Z||Q){M._9o&&(n.x=0,$c(M._8o.getView(),n)),Dp(S,W,O);var V=Cn(S),f=0;if(Ek(V,0,M.ty(),1),V.clearRect(0,0,W,O),x.clear(),b._roots.each(function(a){var z,Y=M.getTabWidth(a);m&&m.tab===a||(z=M.drawTab(V,a,0,f,W,Y,M._tabBackground)),x.add({_75o:z,tab:a,startY:f,endY:f+Y,height:Y}),f+=Y+d}),M._23Q=i(0,f-d),m){var r=m.position;M.drawTab(V,m.tab,0,m.startY,W,m.height,M._moveBackground),Of(V,0,r,W,1,M._insertColor)}if(V.restore(),M._selectionChanged){M._selectionChanged=!1;for(var y=M.ty(),C=0;C<x.size();C++){var v=x.get(C);if(v.tab===M._8o){if(v.endY+y<0){M.ty(-v.startY);break}if(v.startY+y>O){M.ty(O-v.endY);break}}}}M.ty(M.ty())}else if($||A){M._9o&&(n.x=0,$c(M._8o.getView(),n)),Dp(S,z,O);var V=Cn(S),f=0;if(Ek(V,0,M.ty(),1),V.clearRect(0,0,z,O),x.clear(),b._roots.each(function(D){var P;m&&m.tab===D||(P=M.drawTab(V,D,0,f,z,W,M._tabBackground)),x.add({_75o:P,tab:D,startY:f,endY:f+W,height:W}),f+=W+d}),M._23Q=i(0,f-d),m){var r=m.position;M.drawTab(V,m.tab,0,m.startY,z,m.height,M._moveBackground),Of(V,0,r,z,1,M._insertColor)}if(V.restore(),M._selectionChanged){M._selectionChanged=!1;for(var y=M.ty(),C=0;C<x.size();C++){var v=x.get(C);if(v.tab===M._8o){if(v.endY+y<0){M.ty(-v.startY);break}if(v.startY+y>O){M.ty(O-v.endY);break}}}}M.ty(M.ty())}else{M._9o&&(n.y=0,$c(M._8o.getView(),n)),Dp(S,N,W);var V=Cn(S),R=0;if(Ek(V,M.tx(),0,1),V.clearRect(0,0,N,W),x.clear(),b._roots.each(function(f){var b,K=M.getTabWidth(f);m&&m.tab===f||(b=M.drawTab(V,f,R,0,K,W,M._tabBackground)),x.add({_75o:b,tab:f,startX:R,endX:R+K,width:K}),R+=K+d}),M._64I=i(0,R-d),m){var r=m.position;M.drawTab(V,m.tab,m.startX,0,m.width,W,M._moveBackground),Yh(V,M._insertColor,r,0,W)}if(V.restore(),M._selectionChanged){M._selectionChanged=!1;for(var H=M.tx(),C=0;C<x.size();C++){var v=x.get(C);if(v.tab===M._8o){if(v.endX+H<0){M.tx(-v.startX);break}if(v.startX+H>N){M.tx(N-v.endX);break}}}}M.tx(M.tx())}for(var I=[],g=P.children,C=0;C<g.length;C++){var a=g[C],e=a._tab_;e&&!b.contains(e)&&I.push(a)}I.forEach(function(v){P.removeChild(v)})}});var wq=function(z){this.tv=z,this.addListeners()};Nc(wq,w,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(Z){this.handleScroll(Z,10*(Z.wheelDelta/40))},handle_DOMMouseScroll:function(A){this.handleScroll(A,10*-A.detail)},handleScroll:function(U,L){en(U);var i=this.tv,H=i._tabPosition;!i._40o()||H!==Nm&&H!==ak||i.tx(this.tv.tx()+L),!i._41o()||H!==vn&&H!==ib&&H!==vn+"-vertical"&&H!==ib+"-vertical"||i.ty(this.tv.ty()+L)},_8Q:function(I){var V,Q,h=this.tv,w=h._tabPosition,X=h._7o;if(w===Nm||w===ak){var x=h.lp(I).x;for(V=0;V<X.size();V++)if(Q=X.get(V),Q.startX<=x&&x<=Q.endX)return Q}else if(w===vn||w===ib||w===vn+"-vertical"||w===ib+"-vertical"){var b=h.lp(I).y;for(V=0;V<X.size();V++)if(Q=X.get(V),Q.startY<=b&&b<=Q.endY)return Q}return T},isClickable:function(z){var j=this.tv,R=j._tabPosition,l=this._73o=this._8Q(z);return!j._40o()||R!==Nm&&R!==ak?!j._41o()||R!==vn&&R!==ib&&R!==vn+"-vertical"&&R!==ib+"-vertical"?l&&(!l.tab.isDisabled()||j.isMovable()):!0:!0},handle_mousemove:function(L){var l=this;_e?l._74o=l._8Q(L):l.getView().style.cursor=l.isClickable(L)?qo:""},handle_mousedown:function(o){this.handle_mousemove(o),this.handle_touchstart(o)},handle_touchstart:function(L){var U=this,Q=U.tv,I=Q._tabPosition;en(L),Cq(L)&&U.isClickable(L)&&(I===Nm||I===ak?(U.x=kl(L).x,U.lp=Q.lp(L),U.tx=Q.tx()):(U.y=kl(L).y,U.lp=Q.lp(L),U.ty=Q.ty()),El(U,L))},handleWindowMouseMove:function(R){this.handleWindowTouchMove(R)},handleWindowTouchMove:function(p){var n,x=this,z=x.tv,s=z._tabPosition,K=x._73o;if(s===Nm||s===ak){if(n=kl(p).x-x.x,!x._25o&&!x.moving&&S(n)>2&&(z._40o()&&!ti(p)?x._25o=1:K&&z.isMovable()&&(x.moving=1)),x._25o)z.tx(x.tx+n);else if(x.moving){var W=x.lp.x+n,N=z._tabGap/2;z._7o.each(function(O){var x=O.endX,s=W-O.startX<x-W;W>=O.startX&&x>=W&&z._7Q({tab:K.tab,startX:K.startX+n,width:K.width,front:s,insertTab:O.tab,position:s?i(0,O.startX-N):B(z._64I,x+N)})})}}else if(n=kl(p).y-x.y,!x._25o&&!x.moving&&S(n)>2&&(z._41o()&&!ti(p)?x._25o=1:K&&z.isMovable()&&(x.moving=1)),x._25o)z.ty(x.ty+n);else if(x.moving){var t=x.lp.y+n,N=z._tabGap/2;z._7o.each(function(J){var w=J.endY,q=t-J.startY<w-t;t>=J.startY&&w>=t&&z._7Q({tab:K.tab,startY:K.startY+n,height:K.height,front:q,insertTab:J.tab,position:q?i(0,J.startY-N):B(z._23Q,w+N)})})}},handleWindowMouseUp:function(R){this.handleWindowTouchEnd(R)},handleWindowTouchEnd:function(){var X=this,H=X.tv,M=H._tabPosition,E=H.getTabModel(),Y=E._roots,g=X._73o;if(X.moving){var j=H._23o;if(j&&j.insertTab!==j.tab){var h=j.tab,s=Y.remove(h),Q=Y.indexOf(j.insertTab);Q>=0&&(j.front||Q++,Q<=Y.size()&&(Y.add(h,Q),E._38I(h,s,Q)))}H._7Q(T),delete X.moving}else if(!X._25o&&g){h=g.tab;var K=X._74o;if(!K||K.tab===h)if(!h.isDisabled()&&Fi(g._75o,X.lp)){var I=function(){var G=Y.indexOf(h);E.remove(h),H.onTabClosed(h,G)};H.onTabClosing(h,I)&&I()}else h.isDisabled()||H._8o===h||E.sm().ss(h)}X._25o=X._73o=X._74o=M===Nm||M===ak?X.x=X.lp=X.tx=T:X.y=X.lp=X.ty=T}}),Yi.PropertyView=function(B){var X=this;X._view=rc(1,X),X._canvas=Uh(X._view),Xk(X._view,X._79O=Zp()),X._rows=new Bk,X._28o=new Bk,X._26o={},X._26Q={};var j=X._propertyModel=new Dj,e=X.ivm;j.mm(e,X),j.md(e,X),j.mh(e,X),X.dm(B?B:new Dj),new el(X)},up("PropertyView",w,{ms_ac:[he,Dc,Lh,Ol,Vd,"categorizable",rl,$p,ni,em,Gj,Ze,mn,Sr,"selectRowIndex",Yj,"background",Og,Em,No,ue,Rp],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:gs,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:Rc,_background:t.propertyViewBackground,_expandIcon:t.propertyViewExpandIcon,_collapseIcon:t.propertyViewCollapseIcon,_scrollBarColor:bo,_scrollBarSize:xp,_autoHideScrollBar:dm,_selectBackground:t.propertyViewSelectBackground,_rowHeight:Nn,_rowLineVisible:t.propertyViewRowLineVisible,_rowLineColor:t.propertyViewRowLineColor,_10I:.5,_columnLineVisible:t.propertyViewColumnLineVisible,_columnLineColor:t.propertyViewColumnLineColor,_labelColor:t.propertyViewLabelColor,_labelSelectColor:t.propertyViewLabelSelectColor,_labelFont:t.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(n){0>n&&(n=0),n>1&&(n=1);var i=this,b=i._10I;i._10I=n,i.fp("columnPosition",b,n)},getPropertyName:function(y){return y.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(q,v,X){return X===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(W,i){return i===this._selectRowIndex?this._labelSelectColor:W.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(v){var A=this.getHeight()-this._59I;return A>v&&(v=A),v>0?0:z(v)},isExpanded:function(C){if(!C)return!0;var S=this._26o[C];return S?S.isExpanded:!(this._26Q[C]===!1)},toggle:function(z){var S=this;S.isExpanded(z)?S.collapse(z):S.expand(z)},expandAll:function(){this.validate();for(var j in this._26o)this.expand(j)},expand:function(c){if(c&&c!==tc){var L=this,s=L._26o[c];s&&!s.isExpanded&&(s.isExpanded=!0,L.onExpanded(c),L.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var n in this._26o)this.collapse(n)},collapse:function(d){if(d&&d!==tc){var $=this,y=$._26o[d];y&&y.isExpanded&&(y.isExpanded=!1,$.onCollapsed(d),$.ivm())}},onCollapsed:function(){},getCategoryName:function(T){if(!this.isCategorizable())return tc;var z=T.getCategoryName();return z?z:tc},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function($){var H=this,v=H._dataModel;v!==$&&(v&&(v.umd(H.handlePropertyChange,H),H._selectionModel||v.sm().ums(H.handleSelectionChange,H)),H._dataModel=$,$.md(H.handlePropertyChange,H),H._selectionModel?H._selectionModel._21I($):$.sm().ms(H.handleSelectionChange,H),H.fp(pb,v,$))},isVisible:function(b){return this._visibleFunc?this._visibleFunc(b):!0},onPropertyChanged:function(T){var m=this,E=T.property;tp[E]?m.ivm():m.iv(),E===eb&&m._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:xk},handlePropertyChange:function(H){this._27o===H.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var Y=this;Y._96I||(Y.setSelectRowIndex(-1),Y._96I=1,Y.iv())},redraw:function(){this.iv()},validateModel:function(){var O=this,x=O._rows,$=O._28o,z={},k=new Bk,W=O._27o;O.updateCurrentData(),W!==O._27o&&O.endEditing(),x.clear(),$.clear(),O.getRawProperties().each(function(Q){if(O.isVisible(Q)){k.add(Q);var i=O.getCategoryName(Q);z[i]||($.add(i,i===tc?0:q),z[i]={isExpanded:O.isExpanded(i),properties:new Bk})}}),O._sortFunc&&k.sort(O._sortFunc);for(var Y in O._26o)O._26Q[Y]=O.isExpanded(Y);O._26o=z,$.each(function(C){C!==tc&&x.add(C);var W=z[C];W.isExpanded&&k.each(function(z){O.getCategoryName(z)===C&&(W.properties.add(z),x.add({property:z,data:O._27o}))},O)})},validateImpl:function(){var s=this;s._76o(),s._96I&&(s.validateModel(),delete s._96I);var Y=s._canvas,x=s.getWidth(),m=s.getHeight(),r=-s.ty(),c=s._rowHeight,k=s._indent,o=x-k,n=s._rows,C=n.size(),v=s._9I=k+o*s._10I,g=s._59I=C*c;Dp(Y,x,m),s._29I={x:0,y:r,width:x,height:m},s._31I=l(r/c),s._14I=d((r+m)/c),s._31I<0&&(s._31I=0),s._14I>C&&(s._14I=C);var P,R=Cn(Y),_=s._background;Ek(R,0,-r,1),R.beginPath(),R.rect(0,r,x,m),R.clip(),R.clearRect(0,r,x,m),s._93db(R),_&&Of(R,0,0,k,g,_);for(var G=s._31I;G<s._14I;G++){var S=n.get(G),r=c*G;if(Ub(S))_&&Of(R,k,r,o,c,_),P=xf(s.isExpanded(S)?s._expandIcon:s._collapseIcon),P&&np(R,P,co,0,r,k,c),R.save(),R.beginPath(),R.rect(k,r,o,c),R.clip(),s.drawCategoryName(R,S,G,k,r,o,c),R.restore();else{var h=S.property,D=S.data,P=xf(h.getIcon()),H=s._selectRowIndex===G?s.getSelectBackground():T;if(P&&np(R,P,co,0,r,k,c),H&&Of(R,k,r,o,c,H),R.save(),R.beginPath(),R.rect(k,r,v-k,c),R.clip(),s.drawPropertyName(R,h,G,k,r,v-k,c),R.restore(),!s.isEditing(D,h)){var y=v+1,$=x-v-1;R.save(),R.beginPath(),R.rect(y,r,$,c),R.clip(),s._87o(s.drawPropertyValue(R,h,s.getValue(D,h),G,y,r,$,c,D),G,y,r,$,c),R.restore()}}s._rowLineVisible&&Of(R,k,r+c-1,o,1,s._rowLineColor)}s._columnLineVisible&&(Of(R,v,0,1,g,s._columnLineColor),Of(R,x-1,0,1,g)),s._92db(R),s._93I(),R.restore(),s.ty(s.ty())},drawCategoryName:function(l,O,T,A,X,g,W){jn(l,O,this.getCategoryFont(O),this.getCategoryColor(O),A,X,g,W)},drawPropertyName:function(B,w,F,J,X,e,Y){return w.drawPropertyName?(w.drawPropertyName(B,w,F,J,X,e,Y,this),void 0):(jn(B,this.getPropertyName(w),this.getPropertyFont(w,F),this.getPropertyColor(w,F),J,X,e,Y),void 0)},drawPropertyValue:function(H,X,T,F,s,$,i,u,N){return X.drawPropertyValue?X.drawPropertyValue(H,X,T,F,s,$,i,u,N,this):(Hc(H,T,X,this.getLabelFont(X,T,F),this.getLabelColor(X,T,F),s,$,i,u,N,this),void 0)},isPropertyEditable:function(q){return q.isEditable()&&this.isEditable()},setProperties:function(z){this._propertyModel.clear(),this.addProperties(z)},addProperties:function(o){if(o){var O=this._propertyModel;o.forEach(function(R){if(!(R instanceof ci)){var k=rh(R.className);R=ad(k?k:ci,R)}O.add(R)})}},getRowIndexAt:function(y){var B=this,K=l(B.lp(y).y/B._rowHeight);return K>=0&&K<B._rows.size()?K:-1},getPropertyAt:function(I){var r=this,f=r.getRowIndexAt(I);return f>=0?r._rows.get(f).property:T},getToolTip:function(r){var C=this,q=C.getPropertyAt(r),Q=C._27o;return q&&Q?q.getToolTip(Q,C._9I<C.lp(r).x,C):T}});var el=function(C){this.pv=C,this.addListeners()};Nc(el,w,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(A){this.getView().style.cursor=A},clear:function(){var w=this;w._62O=w.cp=w.ty=w.p=T,w.setCursor(lo)},handle_mousedown:function(e){this.handle_touchstart(e)},handle_touchstart:function(Q){var m=this,M=m.pv;en(Q),M.setFocus(Q)&&(Cq(Q)?(m.cp=kl(Q),m.ty=M.ty(),m.p=M.getColumnPosition(),m.handle_touchmove(Q)):M.setSelectRowIndex(M.getRowIndexAt(Q)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(K){this.handle_touchend(K)},handle_touchend:function(v){var a=this;if(a.cp&&!a._62O){var k=a.pv,g=k.lp(v),D=g.x,G=g.y,p=k._indent,n=k.getRowIndexAt(v),i=k._9I;if(n>=0){var r=k._rowHeight,e=r*n,F=k._rows.get(n),P=F.property;if(Ub(F))xf(k.isExpanded(F)?k._expandIcon:k._collapseIcon)&&D>=0&&p>=D&&G>=e&&e+r>=G?k.toggle(F):no(v)&&k.toggle(F);else if(D>i&&k.isPropertyEditable(P,v)){var E={x:i+1,y:e,width:k.getWidth()-i-1,height:r},H={x:E.x+k.tx(),y:E.y+k.ty(),width:E.width,height:E.height},U=0,s=k._29I;E.y<s.y?U=E.y-s.y:E.y+r>s.y+s.height&&(U=E.y+r-s.y-s.height),U&&(k.ty(k.ty()-U),H.y-=U),k.beginEditing({data:F.data,property:P,value:k.getValue(F.data,P),event:v,rect:E,editorRect:H,view:k})}}k.setSelectRowIndex(n)}a.clear()},handleWindowMouseMove:function(E){this.handleWindowTouchMove(E)},handleWindowTouchMove:function(f){var v=this,O=v.pv,S=v.ty,H=v.cp,I=kl(f),Z=v._62O;if("p"===Z)O.setTranslateY(S+I.y-H.y);else if("c"===Z){var r=O.getWidth()-O._indent;if(r>16){var x=v.p-(H.x-I.x)/r,n=16/r;n>x&&(x=n),x>1-n&&(x=1-n),O.setColumnPosition(x)}}else"s"===Z&&O.setTranslateY(S+(H.y-I.y)*O._59I/O._29I.height)},handle_mousemove:function(g){this.handle_touchmove(g)},handle_touchmove:function(J){if(!_e&&Cq(J)){var m=this,L=m.pv,t=S(L.lp(J).x-L._9I)<=(tb?8:3);m.cp?m._62O||(t?(m._62O="c",El(m)):S(kl(J).y-m.cp.y)>=2&&(m._62O=m.isV(J)?"s":"p",El(m))):(t?m.setCursor(cm):m.setCursor(lo),m.isV(J)&&L._43o())}},isV:function(c){var k=this.pv,s=k._29I;return k._41o()&&s.x+s.width-k.lp(c).x<Vn},handle_mousewheel:function(z){this.handleScroll(z,z.wheelDelta/40)},handle_DOMMouseScroll:function(B){2===B.axis&&this.handleScroll(B,-B.detail)},handleScroll:function(X,K){var k=this.pv;en(X),k.endEditing(),k.translate(0,K*k.getRowHeight())},handle_keydown:function(z){var q=this.pv,r=q._rows.size(),C=q._selectRowIndex+(Lr(z)?-1:1);(Lr(z)||Ei(z))&&(0>C&&(C=0),C>=r&&(C=r-1),q.setSelectRowIndex(C))}}),Yi.ListView=function(h){this._5o(h),new vk(this)},up("ListView",w,{ms_ac:[he,Dc,Lh,Og,rl,Em,No,$p,ni,Ze,mn,Sr,br,Yj],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:Rc,_rowHeight:Nn,_rowLineVisible:t.listViewRowLineVisible,_rowLineColor:t.listViewRowLineColor,_scrollBarColor:bo,_scrollBarSize:xp,_autoMakeVisible:qq,_autoHideScrollBar:dm,_selectBackground:t.listViewSelectBackground,_labelColor:t.listViewLabelColor,_labelSelectColor:t.listViewLabelSelectColor,_labelFont:t.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(F){var z=this,c=z._checkMode;z._checkMode=F,z.fp(fi,c,F)},drawRow:function(M,X,u,F,i,H,l){var s=this,e=0,c=s._indent,T=s.getIconWidth(X);s.drawRowBackground(M,X,u,F,i,H,l),s._checkMode&&(Tm(M,xf(s.getCheckIcon(X)),e+c/2,i+l/2,X,s),e+=c),s.drawIcon(M,X,e,i,T,l),s.drawLabel(M,X,e+T,i,l)}});var vk=function(O){this.list=O,this._lastSelectDataTime=Wm(),this.addListeners()};Nc(vk,w,{ms_listener:1,getView:function(){return this.list._view},clear:function(c){var J=this,i=J.list;c&&"d"===J._62O&&!J.dragCancel&&i.handleDragAndDrop(c,"end"),i.draggingData&&(i.draggingData=null,i.redraw()),J.dragCancel=J._62O=J._isV=J._isH=J.cp=J.tx=J.ty=T},handle_mousedown:function(Q){this.handle_touchstart(Q)},handle_touchstart:function(c){var j=this,M=j.list;if(en(c),M.setFocus(c)){var W=M.getDataAt(c);j.cp=kl(c),j.tx=M.tx(),j.ty=M.ty(),Cq(c)?W&&M.handleDragAndDrop&&!j.isV(c)&&!j.isH(c)&&(M.draggingData=W,M.redraw(),M.handleDragAndDrop(c,"prepare")):(W&&j._33o(c,W),j.clear(c))}},handleWindowMouseUp:function(F){this.clear(F)},handleWindowTouchEnd:function(d){this.clear(d)},handle_mouseup:function(l){this.handle_touchend(l)},handle_touchend:function(E){var s=this,t=s.list;if(!s._isV&&!s._isH&&s.cp&&!s._62O){var g=t.getDataAt(E);g?(t.isCheckMode()?s._34o(E,g):s._33o(E,g),no(E)?t.onDataDoubleClicked(g,E):t.onDataClicked(g,E)):t.handleBackgroundClick(E)}s.clear(E)},handleWindowMouseMove:function(i){this.handleWindowTouchMove(i)},handleWindowTouchMove:function(z){var x=this,n=x.list,v=x._62O,w=x.tx,a=x.ty,B=x.cp,s=kl(z),t=n._29I;"p"===v?n.setTranslate(w+s.x-B.x,a+s.y-B.y):"v"===v?n.ty(a+(B.y-s.y)*n._59I/t.height):"h"===v?n.tx(w+(B.x-s.x)*n._91I/t.width):"d"===v&&(x.dragCancel||n.handleDragAndDrop(z,"between"))},handle_mousemove:function(d){this.handle_touchmove(d)},handle_touchmove:function(p){if(!_e&&Cq(p)){var M=this,x=M.list;if(M._isV=M.isV(p),M._isH=M.isH(p),M.cp){if(!M._62O){if(Bc(kl(p),M.cp)<2)return;M._isV?M._62O="v":M._isH?M._62O="h":x.draggingData&&!this.dragCancel?(M._62O="d",x.handleDragAndDrop(p,"begin")):M._62O="p",M._62O&&"d"!==M._62O&&x.draggingData&&(x.draggingData=null,x.redraw()),El(M)}}else M._isV&&x._43o(),M._isH&&x._42o()}},isV:function(I){var $=this.list,O=$._29I;return $._41o()&&O.x+O.width-$.lp(I).x<Vn},isH:function(Z){var M=this.list,l=M._29I;return M._40o()&&l.y+l.height-M.lp(Z).y<Vn},handle_mousewheel:function(W){this.handleScroll(W,W.wheelDelta/40,W.wheelDelta!==W.wheelDeltaX)},handle_DOMMouseScroll:function(Q){this.handleScroll(Q,-Q.detail,1)},handleScroll:function(d,p,u){var b=this.list;en(d),b.endEditing&&b.endEditing(),u&&b._41o()?b.translate(0,p*b.getRowHeight()):b._40o()&&b.translate(10*p,0)},handle_keydown:function(e){if(!t.isInput(e.target)){var Q,P=this.list,C=P.sm(),I=P._rows,X=I.size();if(Di(e))P.selectAll();else if(If(e))P.handleDelete&&P.handleDelete(e);else if(qi(e))"d"!==this._62O||this.dragCancel||(P.handleDragAndDrop(e,"cancel"),this.dragCancel=!0);else if(jm(e))P.isCheckMode()&&(Q=P.getFocusData(),Q&&P.checkData(Q));else if(Lr(e)||Ei(e)){var B=P.isCheckMode();if(Q=B?P.getFocusData():C.ld()){var z=P.getRowIndex(Q);
z>=0&&(Lr(e)?0!==z&&(Q=I.get(z-1),B?P.setFocusData(Q):C.ss(Q)):z!==X-1&&(Q=I.get(z+1),B?P.setFocusData(Q):C.ss(Q)))}else X>0&&(Q=I.get(0),B?P.setFocusData(Q):C.ss(Q))}}},_34o:function(G,a){var m=this.list,I=m.lp(G).x;return I>=0&&I<=m._indent?(m.checkData(a),void 0):(m.setFocusData(a),void 0)},_33o:function(N,w){var m=this.list,c=m.sm(),E=c.ld();if(ti(N))m.isSelected(w)?c.rs(w):c.as(w);else if(fk(N))if(E)for(var o=m.getRowIndex(E),D=m.getRowIndex(w);o!==D;)o+=D>o?1:-1,c.as(m._rows.get(o));else c.ss(w);else if(Cq(N)){var d=Wm();if(c.contains(w)){var n=d-this._lastSelectDataTime;m.handleDataDoubleSelect&&n>500&&1500>n&&m.handleDataDoubleSelect(N,w)}c.ss(w),this._lastSelectDataTime=d}else c.contains(w)||c.ss(w)}}),Yi.TreeView=function(z){var I=this;I._35o(),I._5o(z),new Oq(I)},up("TreeView",w,{ms_ac:[he,Dc,Lh,"rootVisible",fi,"rootData",$p,ni,Ze,mn,Sr,rl,Og,Em,No,em,Gj,br,Yj,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:T,_indent:Rc,_rowHeight:Nn,_rowLineVisible:t.treeViewRowLineVisible,_rowLineColor:t.treeViewRowLineColor,_scrollBarColor:bo,_scrollBarSize:xp,_autoHideScrollBar:dm,_expandIcon:t.treeViewExpandIcon,_collapseIcon:t.treeViewCollapseIcon,_autoMakeVisible:qq,_selectBackground:t.treeViewSelectBackground,_labelColor:t.treeViewLabelColor,_labelSelectColor:t.treeViewLabelSelectColor,_labelFont:t.treeViewLabelFont,_doubleClickToToggle:t.treeViewDoubleClickToToggle,drawRow:function(v,f,I,$,L,W,c){var R=this;R.drawRowBackground(v,f,I,$,L,W,c),R._97I(v,f,I,0,L,W,c)},isOnToggleIcon:function(F){var m=this.getDataAt(F);if(m){var M=this.getIndent(),U=this.lp(F).x;if(xf(this.getToggleIcon(m))){var g=M*this.getLevel(m);if(U>=g&&g+M>=U)return!0}}return!1}});var Oq=function(k){Uo(Oq,this,[k])};Nc(Oq,vk,{toggle:function(X,T,m,s){var q=this.list,G=q.lp(X).x;if(xf(q.getToggleIcon(T))){var h=m*s;if(G>=h&&h+m>=G)return q.toggle(T),!0}return q.isDoubleClickToToggle()&&no(X)?(q.toggle(T),!0):!1},_34o:function(E,y){var A=this.list,h=A.lp(E).x,s=A._levelMap[y._id],N=A._indent,F=N*(s+1);return h>=F&&F+N>=h?(A.checkData(y),void 0):(this.toggle(E,y,N,s)||A.setFocusData(y),void 0)},_33o:function(F,_){var w=this,E=w.list;w.toggle(F,_,E._indent,E.getLevel(_))||Oq.superClass._33o.call(w,F,_)},handle_keydown:function(E){if(Cc(E)||zn(E)){var O=this.list,J=O._rows,M=O.isCheckMode(),m=O.sm(),y=M?O.getFocusData():m.ld();y?y.hasChildren()&&(Cc(E)?O.collapse(y):O.expand(y)):J.size()>0&&(y=J.get(0),M?O.setFocusData(y):m.ss(y))}else Oq.superClass.handle_keydown.call(this,E)}});var Kh=Yi.TableView=function(o){this._98I(),this._5o(o),new Bi(this)};up("TableView",w,{ms_ac:[he,Dc,Lh,"sortMode",Ol,Vd,Og,Em,No,ue,Rp,"sortColumn",$p,ni,Ze,mn,Sr,br,Yj],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:pq,_editable:!0,_batchEditable:!1,_rowHeight:Nn,_rowLineVisible:t.tableViewRowLineVisible,_rowLineColor:t.tableViewRowLineColor,_columnLineVisible:t.tableViewColumnLineVisible,_columnLineColor:t.tableViewColumnLineColor,_scrollBarColor:bo,_scrollBarSize:xp,_autoHideScrollBar:dm,_autoMakeVisible:qq,_selectBackground:t.tableViewSelectBackground,_labelColor:t.tableViewLabelColor,_labelSelectColor:t.tableViewLabelSelectColor,_labelFont:t.tableViewLabelFont,getCheckColumn:function(){var U=this;if(!U._31o){var K=U._31o=new be;K.setEditable(!0),K.setWidth(40),K.getValue=U.getCheckColumValue,K.drawCell=U.drawCheckColumnCell}return U._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(y){var P=this,B=P._39o,$=P.getCheckColumn();y!==P.isCheckMode()&&(y?B.add($,0):B.remove($),P.fp(fi,!y,y))},getCheckColumValue:function(w,e,P){return P.isSelected(w)},drawCheckColumnCell:function(v,h,A,E,t,Z,B,f,z){Tm(v,z.getCheckIcon(h),t+B/2,Z+f/2,h,z)}});var Bi=function(E){Uo(Bi,this,[E])};Nc(Bi,vk,{_34o:function(R,b){var I=this.list,$=I._31o;if(I.isCellEditable(b,$,R)){var t=I._3Q($),W=I.lp(R).x;if(t&&W>=t.startX&&W<t.startX+$.getWidth())return I.checkData(b),void 0}I._37O(b,R),I.setFocusData(b)},_33o:function(w,o){this.list._37O(o,w),Bi.superClass._33o.apply(this,arguments)}});var Ed=Yi.TreeTableView=function(E){var z=this,a=z._4o=new be;z._35o(),z._98I(),z._5o(E),a.setDisplayName("Name"),a.setEditable(!0),a.setWidth(180),a.drawCell=Uq,a.getValue=zf,z._39o.add(a),new Gm(z)},Uq=function(e,K,S,o,A,b,L,G,D){D._97I(e,K,S,A,b,L,G)},zf=function(x,R,M){return M.getLabel(x)};up("TreeTableView",w,{ms_ac:[he,Dc,Lh,"sortMode",Ol,Vd,rl,fi,"rootData","rootVisible",$p,ni,"sortColumn",em,Gj,Ze,mn,Sr,br,No,Og,Em,ue,Rp,Yj,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:pq,_checkMode:T,_editable:!0,_batchEditable:!1,_indent:Rc,_rowHeight:Nn,_rowLineVisible:t.treeTableViewRowLineVisible,_rowLineColor:t.treeTableViewRowLineColor,_columnLineVisible:t.treeTableViewColumnLineVisible,_columnLineColor:t.treeTableViewColumnLineColor,_expandIcon:t.treeTableViewExpandIcon,_collapseIcon:t.treeTableViewCollapseIcon,_scrollBarColor:bo,_scrollBarSize:xp,_autoHideScrollBar:dm,_autoMakeVisible:qq,_selectBackground:t.treeTableViewSelectBackground,_labelColor:t.treeTableViewLabelColor,_labelSelectColor:t.treeTableViewLabelSelectColor,_labelFont:t.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var Gm=function(N){Uo(Gm,this,[N])};Nc(Gm,vk,{_34o:function(i,O){var k=this.list,C=k._4o,x=k._3Q(C),M=k.lp(i).x;if(x){var $=k._indent,N=x.startX+$*k.getLevel(O);if(xf(k.getToggleIcon(O))&&M>=N&&N+$>=M)return k.toggle(O),void 0;if(k.isCellEditable(O,C)&&(N+=$,M>=N&&N+$>=M))return k.checkData(O),void 0}k._37O(O,i),k.setFocusData(O)},_33o:function(V,Y){var A=this.list,$=A.lp(V).x;if(xf(A.getToggleIcon(Y))){var m=A._3Q(A._4o);if(m){var o=A._indent,x=m.startX+o*A.getLevel(Y);if($>=x&&x+o>=$)return A.toggle(Y),void 0}}A._37O(Y,V),Gm.superClass._33o.apply(this,arguments)}});var Hm=Yi.TableHeader=function(B){var C=this,z=C._view=rc(1,C),T=C._39o=B.getColumnModel(),J=C.iv;C.tv=C._tableView=B,C._60I=new Bk,C._canvas=Uh(z),z.style.background=t.tableHeaderBackground||"",z.style.height=$e+vs,T.mm(J,C),T.md(J,C),T.mh(J,C),B.mp(function(m){ff[m.property]&&C.iv()},C),new Dn(C),C.iv()};up("TableHeader",w,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",he,Lh,rl,"moveBackground","insertColor",ue,Rp,"resizable","movable"],_checkIcon:Rk,_movable:!0,_resizable:!0,_labelColor:t.tableHeaderLabelColor,_labelFont:t.tableHeaderLabelFont,_columnLineColor:t.tableHeaderColumnLineColor,_columnLineVisible:t.tableHeaderColumnLineVisible,_sortDescIcon:t.tableHeaderSortDescIcon,_sortAscIcon:t.tableHeaderSortAscIcon,_moveBackground:t.tableHeaderMoveBackground,_insertColor:t.tableHeaderInsertColor,_indent:Rc,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(P){return P.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(i){return i.getColor()||this._labelColor},getLabelAlign:function(J){return J._align},onPropertyChanged:function(){this.iv()},_5Q:function(C){this._61I=C,this.iv()},getLogicalPoint:function($){return mk($,this._canvas,this.tv.tx())},validateImpl:function(){var y=this,T=y._canvas,u=y.getWidth(),a=y.getHeight(),m=y.tv,j=y._60I,s=y._61I,i=-m.tx(),e=0;(u!==T.clientWidth||a!==T.clientHeight)&&Dp(T,u,a),j.clear(),y._39o._roots.each(function(k){if(k.isVisible()){var M=e+k.getWidth();i+u>=e&&M>=i&&j.add({column:k,startX:e}),e=M}});var R=Cn(T);if(Ek(R,-i,0,1),R.beginPath(),R.rect(i,0,u,a),R.clip(),R.clearRect(i,0,u,a),j.each(function(Z){var H=Z.column,w=Z.startX,U=H.getWidth();U>0&&(R.save(),R.beginPath(),R.rect(w,0,U,a),R.clip(),s&&s.column===H||y.drawColumn(R,H,w,0,U,a),y._columnLineVisible&&Of(R,w+U-1,0,1,a,y._columnLineColor),R.restore())}),s){var B=s.column,e=s.startX,c=s.position,K=B.getWidth();R.save(),R.beginPath(),R.rect(e,0,K,a),R.clip(),R.fillStyle=y._moveBackground,R.fill(),y.drawColumn(R,B,e,0,K,a),R.restore(),Yh(R,y._insertColor,c,0,a)}R.restore()},_6Q:function(g){var v=this.tv;return v._31o===g&&v.sm().getSelectionMode()===fh},drawColumn:function(H,h,C,$,x,F){var m=this,N=m.tv,v=xf(h.getIcon()),w=m.getLabelAlign(h);if(m._6Q(h)){var X=xf(m._checkIcon);Tm(H,X,C+x/2,$+F/2,h,m)}else{var R=m.getLabel(h),Y=m.getLabelFont(h),p=m.getLabelColor(h),k=jp(Y,R).width,Z=v?m._indent:0;w===vn?(v&&np(H,v,co,C,$,Z,F),jn(H,R,Y,p,C+Z,$,x,F,vn)):w===ib?(v&&np(H,v,co,C+x-k-Z,$,Z,F),jn(H,R,Y,p,C,$,x,F,ib)):(v&&np(H,v,co,C+(x-k-Z)/2,$,Z,F),jn(H,R,Y,p,C+(x-k+Z)/2,$,0,F,vn))}if(h.isSortable()&&N.getSortColumn()===h&&(v=xf(h.getSortOrder()===fe?m._sortAscIcon:m._sortDescIcon))){var M=Sq(v,h)/2+2;Tm(H,v,w===ib?C+M:C+x-M,$+F/2,h,N)}}});var Dn=function(z){var n=this;n.th=z,n.tv=z._tableView,n.addListeners()};Nc(Dn,w,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(P){this.getView().style.cursor=P},handle_mousemove:function(n){if(!_e){var M=this;delete M._29o,M.setCursor(lo);for(var W=M.th,L=W._60I,J=W.lp(n).x,d=L.size()-1;d>=0;d--){var x=L.get(d),$=x.column,h=x.startX+$.getWidth();if(W.isResizable()&&S(h-J)<=(tb?10:3))return M._29o=x,M.setCursor(cm),void 0;J>x.startX&&h>J&&(M._29o=x),($.isClickable()||$.isSortable()||W.isMovable()||M.tv.getCheckColumn&&$===M.tv.getCheckColumn())&&J>x.startX&&h>J&&M.setCursor(qo)}}},handle_mousedown:function(w){this.handle_touchstart(w)},handle_touchstart:function($){var s=this;en($),s.tv.endEditing(),s.handle_mousemove($),s._29o&&(s.x=kl($).x,s.lx=s.th.lp($).x,s.w=s._29o.column.getWidth(),El(s,$))},handleWindowMouseMove:function(s){this.handleWindowTouchMove(s)},handleWindowTouchMove:function(p){var t=this,$=t.th,d=t.getView().style.cursor,E=t._29o,U=kl(p).x-t.x;if(t.resizing||t.moving||(d===cm?t.resizing=1:$.isMovable()&&d===qo&&S(U)>2&&(t.moving=1)),t.resizing)E.column.setWidth(t.w+U);else if(t.moving){var P=t.lx+U;$._60I.each(function(n){var b=n.startX,H=b+n.column.getWidth();if(P>=b&&H>=P){var e={column:E.column,startX:E.startX+U,front:H-P>P-b,insertColumn:n.column};e.position=e.front?b:H,$._5Q(e)}})}},_16Q:function(J,i){var R=this,f=R.tv,K=R.th,y=K._checkIcon;if(K._6Q(J)){var A=xf(y),U=R.lx,M=J.getWidth(),T=Sq(A,J);if(U>=i+M/2-T&&i+M/2+T>=U){K.setCheckIcon(y===cl?Rk:cl);var j=f.sm(),V=f._rows;return y===cl?j.rs(V):j.ss(V),f.onCheckColumnClicked(J),!0}}return!1},handleWindowMouseUp:function(t){this.handleWindowTouchEnd(t)},handleWindowTouchEnd:function(O){var N=this,Y=N.tv,R=N.th,L=N._29o;if(N.moving){var r=R._61I;if(r&&r.insertColumn!==r.column){var I=r.column,y=Y.getColumnModel()._roots,t=y.remove(I),z=y.indexOf(r.insertColumn);z>=0&&(r.front||z++,z<=y.size()&&(y.add(I,z),Y.getColumnModel()._38I(I,t,z)))}R._5Q(T),delete N.moving}else if(!N.resizing&&L){I=L.column;var W=R.lp(O).x,K=L.startX,f=!0;if(R.onColumnClicked){var d=R.onColumnClicked(I,O,K);d===!1&&(f=!1)}if(f&&W>=K&&W<=K+I.getWidth()&&!N._16Q(I,K)){if(I.isSortable()){var U=Y.getSortMode(),i=I.getSortOrder();U===pq?Y.getSortColumn()===I?(i===jb&&Y.setSortColumn(T),I.setSortOrder(i===fe?jb:fe)):Y.setSortColumn(I):"bistate"===U&&(Y.getSortColumn()===I?I.setSortOrder(i===fe?jb:fe):Y.setSortColumn(I))}Y.onColumnClicked(I,O,K)}}N._29o=N.resizing=N.x=N.lx=N.w=T}}),Yi.TablePane=function($){this.init(new Kh($))},up("TablePane",w,{ms_v:1,_44o:1}),Yi.TreeTablePane=function(C){this.init(new Ed(C))},up("TreeTablePane",w,{ms_v:1,_44o:1}),Yi.Toolbar=function(y){var P=this,K=P._view=rc(1,P),l=K.style;l.background=t.toolbarBackground||"",l.height=ri+vs,P._canvas=Uh(K),P._30o=new Bk,P._90I=new Bk,P.setItems(y||[]),K.handleGroupSelectedChanged=function(k){if(k.isSelected()){var p=k.getGroupId();null!=p&&P._items.forEach(function($){var O=$.element;O&&O!==k&&O.setSelected&&O.getGroupId&&O.getGroupId()===p&&O.setSelected(!1)})}},new qr(P)},up("Toolbar",w,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[rq,he,Lh,Dc,Yj,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:t.toolbarLabelColor,_labelSelectColor:t.toolbarLabelSelectColor,_labelFont:t.toolbarLabelFont,_selectBackground:t.toolbarSelectBackground,_itemGap:t.toolbarItemGap,_separatorColor:t.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(F){var R=this.getItemInfoAt(F);return R?R.item.toolTip:T},getLabelColor:function(J){return J&&J.selected&&J.type!==cl&&J.type!==Ah?this._labelSelectColor:this._labelColor},onPropertyChanged:function(D){this.iv(),D.property===rq&&this._items.forEach(function(S){Ap(S)})},redraw:function(){this.iv()},addItem:function(R,c){var t=this._items;c==T?t.push(R):t.splice(c,0,R),this.fp(rq,T,t)},removeItem:function(I){if(I)for(var q=this._items,B=0;B<q.length;B++)I===q[B]&&(q.splice(B,1),this.fp(rq,T,q))},removeItemById:function(_){if(_!=T)for(var L=this._items,i=0;i<L.length;i++)if(_===L[i].id){var O=L.splice(i,1)[0];return this.fp(rq,T,L),O}},getItemById:function(y){if(y!=T)for(var p=this._items,i=0;i<p.length;i++){var K=p[i];if(y===K.id)return K}},setItemVisible:function(t,Z){var v=this.getItemById(t);v&&(v.visible=Z)},getItemInfos:function(){return this._30o},getItemInfoAt:function(o){var G=this,j=0,k=G._30o,m=G.lp(o),B=m.x,C=m.y;if(C>=0&&C<=G.getHeight())for(;j<k.size();j++){var Z=k.get(j);if(Z.startX<=B&&B<=Z.endX)return Z}return T},drawItem:function(x,w,L,Z,M){if(w.visible===!1)return 0;if(Dk(w.visible)&&!w.visible())return 0;var f=this,g=w.disabled;g&&(x.globalAlpha=hc);var p=f.drawItemImpl(x,w,L,Z,M),I=f._itemGap;return g&&(x.globalAlpha=1),this._currentItem!==w||"separator"===w||w.separator===!0||w.unfocusable||We(x,f._separatorColor,L-I/2,0,p+I,Z),p},drawItemImpl:function(e,n,k,$,X){var t=this,P=t._view,f=t._itemGap,i=$/2,W=n.type,m=n.element,q=n.label;Ub(m)&&(q=m,m=T);var p,h=t.getLabelFont(n),y=t.getLabelColor(n),U=n.selected,o=xf(n.icon),w=Sq(o,n),Z=0,G=w+(q?jp(h,q).width:0);if("separator"===n||n.separator===!0)return Yh(e,t._separatorColor,k,$/4,i),1;if(m){o&&Tm(e,o,k+w/2,i,n,t),jn(e,q,h,y,k+w,0,0,$);var r=vr(m);X||t._90I.add(r),r.parentNode!==P&&Xk(P,r),m.iv&&m.iv(),m.validate&&m.validate();var M=r.getBoundingClientRect(),_=M.width,N=r.style;return Kf(r),N.left=t.tx()+k+G+vs,N.top=($-M.height)/2+vs,G+_}return W===Ah?p=xf(U?Mj:gk):W===cl&&(p=xf(U?cl:Rk)),p?(Z=Sq(p,n),Tm(e,p,k+Z/2,i,n,t),k+=Z,G+=Z):U&&Of(e,k-f/2,0,G+f,$,t.getSelectBackground(n)),o&&Tm(e,o,k+w/2,i,n,t),jn(e,q,h,y,k+w,0,0,$),G},validateImpl:function(){var C=this,u=C._canvas,g=C.getWidth(),m=C.getHeight(),L=C._30o,F=C._items;Dp(u,g,m);var o=Cn(u),K=C._itemGap,P=K/2;Ek(o,C.tx(),0,1),o.clearRect(0,0,g,m);var l=C._90I;C._90I=new Bk,L.clear(),F.forEach(function(B){var f=C.drawItem(o,B,P,m);L.add({item:B,startX:P,endX:P+f,width:f}),f&&(P+=f+K)}),l.each(function(K){C._90I.contains(K)||Ln(K)});var v=C._64I;C._64I=i(0,P),o.restore(),C._stickToRight?(C._65O=0,o=Cn(u),P=g-C._64I+K,Ek(o,0,0,1),o.clearRect(0,0,g,m),L.clear(),F.forEach(function(r){var X=C.drawItem(o,r,P,m,!0);L.add({item:r,startX:P,endX:P+X,width:X}),X&&(P+=X+K)}),o.restore()):C.tx(C.tx()),v!==C._64I&&C.onSumWidthChanged(v,C._64I)},onSumWidthChanged:function(){},handleClick:function(j,n){var o=this,i=j.type,F=j.action,l=j.groupId,W=j.selected;j.disabled||(l!=T?W||(j.selected=!0,this._items.forEach(function(u){u.groupId===l&&j!==u&&(u.selected=!1)}),F&&j.action(j,o,n)):i===cl||"toggle"===i?(j.selected=!W,F&&j.action(j,o,n)):F&&j.action(j,o,n)),Xm(),o.iv()}});var qr=function(p){this.tb=p,this.addListeners()};Nc(qr,w,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(K){this.handleScroll(K,10*(K.wheelDelta/40))},handle_DOMMouseScroll:function(e){this.handleScroll(e,10*-e.detail)},handleScroll:function(d,w){en(d);var f=this.tb;f.isScrollable()&&!f._stickToRight&&(f.tx(f.tx()+w),_d())},handle_mousemove:function(v){var c=this;_e||c.setItem(v)},handle_mouseout:function(v){var h=this;v.target===h.getView()?h.tb.setCurrentItem(T):h.handle_mousemove(v)},handle_mousedown:function(d){this.handle_mousemove(d),this.handle_touchstart(d)},handle_touchstart:function(o){var t=this,R=t.tb,I=o.target;Cq(o)&&(I===t.getView()||I===R._canvas)&&(en(o),R.setFocus(o)&&(this.setItem(o,!0),(R.isScrollable()||t.info&&!t.info.item.disabled)&&(t.x=kl(o).x,t.tx=R.tx(),El(t,o))))},handleWindowMouseMove:function(q){this.handleWindowTouchMove(q)},handleWindowTouchMove:function(k){var X=this,d=X.tb;if(!d._stickToRight){var C=kl(k).x-X.x;!X._25o&&S(C)>2&&d.isScrollable()&&(X._25o=1),X._25o&&d.tx(X.tx+C)}},handleWindowMouseUp:function(W){this.handleWindowTouchEnd(W)},handleWindowTouchEnd:function(d){var j=this,O=j.tb,G=j.info,N=j.tb.getItemInfoAt(d);if(!j._25o&&G){var a=G.item;N&&N.item===a&&O.handleClick(a,d)}j._25o=j.x=j.tx=T,j.setItem()},setItem:function(z,x){var v=this,J=v.tb,O=v.info=z?J.getItemInfoAt(z):T,G=O?O.item:T;J.setCurrentItem(G),x&&G&&Dk(G.onDown)&&G.onDown(z)}}),Yi.BorderPane=function(){this._view=rc(1,this),this.iv()},up("BorderPane",w,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(u,q){this._12o("leftView",u),q!=T&&this.setLeftWidth(q)},getRightView:function(){return this._rightView},setRightView:function(L,k){this._12o("rightView",L),k!=T&&this.setRightWidth(k)},getTopView:function(){return this._topView},setTopView:function(y,x){this._12o("topView",y),x!=T&&this.setTopHeight(x)},getBottomView:function(){return this._bottomView},setBottomView:function(K,z){this._12o("bottomView",K),z!=T&&this.setBottomHeight(z)},getCenterView:function(){return this._centerView},setCenterView:function(m){this._12o("centerView",m)},_12o:function(O,U){var L=this,M="_"+O,b=L._view,E=L[M];E!==U&&(E&&(E.getView?Ln(E.getView()):Ln(E)),L[M]=U,U&&(U.getView?Xk(b,U.getView(),1):Xk(b,U,1)),L.fp(O,E,U))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var P=this,K=P._topView,w=P._bottomView,e=P._leftView,o=P._rightView,Q=P._centerView,c=P.getWidth(),l=P.getHeight(),h=0,N=0,W=c,q=l,g=0,Z=0,x=0,M=0;K&&(g=P._topHeight==T?Yq(K):P._topHeight,N=g),w&&(Z=P._bottomHeight==T?Yq(w):P._bottomHeight,q=l-Z),e&&(x=P._leftWidth==T?pi(e):P._leftWidth,h=x),o&&(M=P._rightWidth==T?pi(o):P._rightWidth,W=c-M);var L=i(0,W-h),r=i(0,q-N);K&&$c(K,0,0,c,g),w&&$c(w,0,q,c,Z),e&&$c(e,0,N,x,r),o&&$c(o,W,N,M,r),Q&&$c(Q,h,N,L,r)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);